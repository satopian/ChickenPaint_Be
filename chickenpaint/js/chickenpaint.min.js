/*
    litaChix
    https://github.com/satopian/ChickenPaint_Be
    by satopian
    Customized from ChickenPaint by Nicholas Sherlock.
    GNU GENERAL PUBLIC LICENSE
    Version 3, 29 June 2007
    <http://www.gnu.org/licenses/>
*/
/*
    ChickenPaint

    ChickenPaint is a translation of ChibiPaint from Java to JavaScript
    by Nicholas Sherlock / Chicken Smoothie.

    ChibiPaint is Copyright (c) 2006-2008 Marc Schefer

    ChickenPaint is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    ChickenPaint is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with ChickenPaint. If not, see <http://www.gnu.org/licenses/>.
*/
/*
    Bootstrap (https://getbootstrap.com/)
    Copyright The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
    Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)

    EventEmitter v5.2.9 - git.io/ee
    Unlicense - http://unlicense.org/
    Oliver Caldwell - https://oli.me.uk/
*/
/*
    jQuery throttle / debounce - v1.1 - 3/7/2010
    http://benalman.com/projects/jquery-throttle-debounce-plugin/

    Copyright (c) 2010 "Cowboy" Ben Alman
    Dual licensed under the MIT and GPL licenses.
    http://benalman.com/about/license/
*/
!function(){function Ga(a){return a&&a.__esModule?a.default:a}function Lc(a,c,d,b){Object.defineProperty(a,c,{get:d,set:b,enumerable:!0,configurable:!0})}function wa(a){for(var c in wa.DEFAULTS)wa.DEFAULTS.hasOwnProperty(c)&&(this[c]=wa.DEFAULTS[c]);for(c in a)a.hasOwnProperty(c)&&(this[c]=a[c])}function za(a,c,d,b){this.left=a;this.top=c;this.right=d;this.bottom=b}function Zc(a,c){this.width=0|a;this.height=0|c}function $c(a,c){var d=document.createElement("canvas");return d.width=a,d.height=c,d}
function we(a,c){return document.createElement("canvas").getContext("2d").createImageData(a,c)}function I(a,c){"number"==typeof a?(Zc.call(this,a,c),this.imageData=we(this.width,this.height)):(Zc.call(this,a.width,a.height),this.imageData=a);this.data=this.imageData.data}function lf(a,c,d,b){var g,n=0,f=[0,0,0,0];var e=0;for(g=0;g<b&&g<d;g++){for(var k=0;k<I.BYTES_PER_PIXEL;k++)f[k]+=a[e++];n++}g=0;for(k=0;k<d;k++){if(k+b<d){e=(k+b)*I.BYTES_PER_PIXEL;for(var l=0;l<I.BYTES_PER_PIXEL;l++)f[l]+=a[e++];
n++}for(e=0;e<I.BYTES_PER_PIXEL;e++)c[g++]=Math.round(f[e]/n);if(k-b>=0){e=(k-b)*I.BYTES_PER_PIXEL;for(l=0;l<I.BYTES_PER_PIXEL;l++)f[l]-=a[e++];n--}}}function mf(a,c){if(0==(c%=4))return a;let d=$c(0,0),b=d.getContext("2d");switch(c%2==0?(d.width=a.width,d.height=a.height):(d.width=a.height,d.height=a.width),c){case 1:b.rotate(Math.PI/2);b.drawImage(a,0,-a.height);break;case 2:b.rotate(Math.PI);b.drawImage(a,-a.width,-a.height);break;case 3:b.rotate(-Math.PI/2);b.drawImage(a,-a.width,0);break;default:return a}return d}
function cb(a="",c=0){gb.call(this,a);this.layers=[];this.expanded=!0;this.blendMode=c}function Rg(a,c){return a+c}function Na(a,c,d){Zc.call(this,a,c);this.createBitmap(a,c,d)}function nf(a,c,d,b){var g,n=0,f=0;for(g=0;g<b&&g<d;g++)f+=a[g],n++;g=0;for(let e=0;e<d;e++)e+b<d&&(f+=a[e+b],n++),c[g++]=Math.round(f/n),e-b>=0&&(f-=a[e-b],n--)}function R(){}function gb(a){this.name=a||"";this.parent=null;this.lockAlpha=!1;this.alpha=100;this.visible=!0;this.blendMode=R.LM_NORMAL;this.mask=null;this.maskVisible=
this.maskLinked=!0;this.maskThumbnail=null;this.useLegacyMultiply=!1}function Da(a,c,d){gb.call(this,d);a>0&&c>0?this.image=new I(a,c):this.image=null;this.clip=!1;this.imageThumbnail=null}function Cd(a,c,d){d?(this.isGroup=d instanceof cb,this.image=d.image,this.mask=d.getEffectiveMask(),this.layer=d,this.blendMode=d.blendMode,this.alpha=d.alpha,this.visible=d.visible):(this.isGroup=!0,this.image=null,this.mask=null,this.layer=null,this.blendMode=R.LM_PASSTHROUGH,this.alpha=100,this.visible=!0);
this.dirtyRect=new za(0,0,a,c);this.layers=[];this.parent=null;this.clip=!1}function xe(a,c,d,b){function g(){return l.length>0?l.pop():new I(c,d)}function n(m){if(0==m.layers.length)return null;if(1==m.layers.length&&(null==m.mask||null==m.layers[0].mask)){let p=m.layers[0];return p.alpha=Math.round(m.alpha*p.alpha/100),m.blendMode!=R.LM_PASSTHROUGH&&(p.blendMode=m.blendMode),p.mask=m.mask||p.mask,m.layer&&h.set(m.layer,p),p}return m.blendMode==R.LM_PASSTHROUGH&&100==m.alpha&&null==m.mask?m.layers:
(m.image=g(),m)}function f(m){let p=new Cd(c,d,m);return h.set(m,p),p}function e(m,p){m&&(m.dirtyRect.union(p),e(m.parent,p))}let k,l=[],h=new Map;this.invalidateLayerRect=function(m,p){e(h.get(m),p)};this.buildTree=function(){if(!k){if(k=function q(p){if(0==p.getEffectiveAlpha())return null;let r=f(p);for(var u=0;u<p.layers.length;u++){let y=p.layers[u];var v=p.layers[u+1];if(y instanceof Da&&v&&v.clip){v=new Cd(c,d,null);v.blendMode=y.blendMode;v.alpha=100;v.clip=!0;v.addChildren(f(y));for(u+=1;u<
p.layers.length;u++)if(p.layers[u].clip)p.layers[u].getEffectiveAlpha()>0&&v.addChildren(f(p.layers[u]));else break;y.getEffectiveAlpha()>0&&r.addChildren(n(v));--u}else y instanceof cb?r.addChildren(q(y)):y.getEffectiveAlpha()>0&&r.addChildren(f(y))}return n(r)}(a)){if(Array.isArray(k)||b&&(k.alpha<100||k.mask)){let p=k;(k=new Cd(c,d)).blendMode=Array.isArray(p)?R.LM_NORMAL:p.blendMode;k.alpha=100;k.image=g();k.addChildren(p)}}else(k=new Cd(c,d,{image:g(),blendMode:R.LM_NORMAL,alpha:100,getEffectiveMask:()=>
null,visible:!0})).image.clearAll(0);l=[]}};this.resetTree=function(){k&&(!function q(p){if(p.isGroup)for(let r of(p.image&&l.push(p.image),p.layers))q(r)}(k),k=null,h.clear())};this.layerPropertyChanged=function(m,p){let q=h.get(m);q&&q.visible==m.visible&&q.alpha==m.alpha&&null==q.mask==(null==m.getEffectiveMask())&&q.blendMode==R.LM_PASSTHROUGH==(m.blendMode==R.LM_PASSTHROUGH)&&"clip"!==p?(q.blendMode=m.blendMode,e(q,new za(0,0,c,d))):this.resetTree()};this.blendTree=function(){return function q(p){if(!p||
!p.isGroup)return p;let r=p.dirtyRect;var u=!0,v=!0;if(p.blendMode==R.LM_PASSTHROUGH&&p.parent&&r.union(p.parent.dirtyRect),r.isEmpty())return p;if(p.blendMode==R.LM_PASSTHROUGH&&p.parent){u=!1;var y=p.image;var C=p.parent.image;r.getWidth()==y.width&&r.getHeight()==y.height?y.copyPixelsFrom(C):R.replaceOntoFusionWithOpaqueLayer(y,C,100,r)}for(y=0;y<p.layers.length;y++){var w=q(p.layers[y]);if(u){u=p.image;C=w.image;var D=w.alpha,x=r;w=w.mask;if(100!=D||w||x.getWidth()!=u.width||x.getHeight()!=u.height){let G=
"replaceOntoFusionWith";100==D?G+="OpaqueLayer":G+="TransparentLayer";w&&(G+="Masked");R[G](u,C,D,x,w)}else u.copyPixelsFrom(C);!0;u=!1}else v=v&&p.image.hasAlphaInRect(r),R.fuseImageOntoImage(p.image,v,w.image,w.alpha,w.blendMode,r,w.mask)}p.clip&&(v=p.layers[0],v.alpha<100?v.mask?R.replaceAlphaOntoFusionWithTransparentLayerMasked(p.image,v.image,v.alpha,r,v.mask):R.replaceAlphaOntoFusionWithTransparentLayer(p.image,v.image,v.alpha,r):v.mask?R.replaceAlphaOntoFusionWithOpaqueLayerMasked(p.image,
v.image,100,r,v.mask):R.replaceAlphaOntoFusionWithOpaqueLayer(p.image,v.image,100,r));return p.dirtyRect.makeEmpty(),p}(k)}}function Sg(){function a(h){if(null!=g&&h.curSize==n&&h.curSqueeze==f&&h.curAngle==e&&h.tip==k)return g;switch(h.tip){case wa.TIP_ROUND_AIRBRUSH:!function(m,p){if(p.curSize<1){var q=p.curSize/2;m[0]=0|Math.min(255,Math.PI*q*q*255)}else{q=p.curSize;var r=q/2,u=p.curSize/2*(p.curSize/2),v=1+10*p.curSqueeze,y=Math.cos(p.curAngle);p=Math.sin(p.curAngle);var C=0;for(let x=0;x<q;x++)for(let G=
0;G<q;G++){var w=G+.5-r;let H=x+.5-r;var D=(w*y-H*p)*v;w=H*y+w*p;D=D*D+w*w;D<=u?m[C++]=~~(255*(1-D/u)):m[C++]=0}}}(c,h);break;case wa.TIP_ROUND_AA:!function(m,p){if(p.curSize<1){var q=p.curSize/2;m[0]=0|Math.min(255,Math.PI*q*q*255)}else{var r=p.curSize;q=Math.ceil(r);var u=q/2,v=r/2;v*=v;var y=Math.pow((r-2)/2,2);r=Math.pow((r+2)/2,2);var C=1+10*p.curSqueeze,w=Math.cos(p.curAngle);p=Math.sin(p.curAngle);var D=0;for(let B=0;B<q;B++)for(let P=0;P<q;P++){var x=P+.5-u,G=B+.5-u,H=(x*w-G*p)*C;x=G*w+x*
p;H=H*H+x*x;if(H<=y)m[D++]=255;else if(H>r)m[D++]=0;else{H=0;for(x=0;x<4;x++)for(G=0;G<4;G++){var N=P+.25*G-u;let V=B+.25*x-u,L=(N*w-V*p)*C;N=V*w+N*p;L*L+N*N<=v&&(H+=1)}m[D++]=Math.min(16*H,255)}}}}(c,h);break;case wa.TIP_ROUND_PIXEL:!function(m,p){let q=Math.max(p.curSize,1),r=q/2,u=p.curSize/2*(p.curSize/2),v=1+10*p.curSqueeze,y=Math.cos(p.curAngle);p=Math.sin(p.curAngle);let C=0;for(let D=0;D<q;D++)for(let x=0;x<q;x++){var w=x+.5-r;let G=D+.5-r,H=(w*y-G*p)*v;w=G*y+w*p;H*H+w*w<=u?m[C++]=255:m[C++]=
0}}(c,h);break;case wa.TIP_SQUARE_AA:!function(m,p){if(p.curSize<1){var q=p.curSize/2;m[0]=0|Math.min(255,Math.PI*q*q*255)}else{q=p.curSize;var r=q/2,u=p.curSize*Math.sin(Math.PI/4),v=u/2/(1+10*p.curSqueeze);u/=2;var y=v-1,C=u-1,w=v+1,D=u+1,x=Math.cos(p.curAngle);p=Math.sin(p.curAngle);var G=0;for(let N=0;N<q;N++)for(let B=0;B<q;B++){var H=B+.5-r;let P=N+.5-r,V=Math.abs(H*x-P*p);H=Math.abs(P*x+H*p);if(V<=y&&H<=C)m[G++]=255;else if(V>w||H>D)m[G++]=0;else{let L=0;for(let ia=0;ia<4;ia++)for(let aa=0;aa<
4;aa++)V=Math.abs((H=B+(aa+.5)*.25-r)*x-(P=N+(ia+.5)*.25-r)*p),H=Math.abs(P*x+H*p),V<=v&&H<=u&&L++;m[G++]=Math.min(16*L,255)}}}}(c,h);break;case wa.TIP_SQUARE_PIXEL:!function(m,p){if(p.curSize<2)m[0]=255;else{var q=p.curSize,r=q/2,u=p.curSize*Math.sin(Math.PI/4),v=u/2/(1+10*p.curSqueeze);u/=2;var y=Math.cos(p.curAngle);p=Math.sin(p.curAngle);var C=0;for(let w=0;w<q;w++)for(let D=0;D<q;D++){let x=D+.5-r,G=w+.5-r,H=Math.abs(G*y+x*p);Math.abs(x*y-G*p)<=v&&H<=u?m[C++]=255:m[C++]=0}}}(c,h)}return g=c,
n=h.curSize,k=h.tip,f=h.curSqueeze,e=h.curAngle,c}let c=new Uint8Array(160801),d=new Uint8Array(161604),b=[new Float32Array(402),new Float32Array(402)],g=null,n,f,e,k,l=this;this.getDab=function(h,m,p){let q={alpha:p.curAlpha,width:Math.ceil(p.curSize),height:Math.ceil(p.curSize)},r=p.isAA&&p.tip!=wa.TIP_ROUND_PIXEL;r&&(q.width++,q.height++);h=h-q.width/2+.5;m=m-q.height/2+.5;let u=Math.floor(h),v=Math.floor(m);return r?q.brush=function(y,C,w){var D=a(y);let x=y.curSize;y=Math.ceil(y.curSize)+1;let G=
(1-C)*(1-w),H=C*(1-w),N=C*w,B=(1-C)*w,P=0;C=0;w=b[0];let V=b[1];w.fill(0);for(let ia=0;ia<x;ia++){var L=0;for(V[0]=0;L<x;L++,P++,C++){let aa=D[P];d[C]=w[L]+aa*G+.5|0;w[L+1]+=aa*H;V[L]+=aa*B;V[L+1]=aa*N}d[C++]=w[L]+.5|0;L=w;w=V;V=L}for(D=0;D<y;D++,C++)d[C]=w[D]+.5|0;return d}(p,h-u,m-v):q.brush=a(p),q.x=u,q.y=v,p.texture>0&&null!=this.texture&&(q.brush==c&&(d.set(c),q.brush=d),!function(y,C){C=Math.floor(255*C);let w=l.texture,D=y.x%w.width,x=y.y%w.height,G=0,H,N;D<0&&(D+=w.width);x<0&&(x+=w.height);
for(let B=0;B<y.height;B++){H=x*w.width+D;N=x*w.width+w.width;for(let P=0;P<y.width;P++)y.brush[G]=~~(y.brush[G]*(w.data[H]*C/255^255)/255),G++,++H==N&&(H-=w.width);++x==w.height&&(x=0)}}(q,p.texture)),q};this.setTexture=function(h){this.texture=h}}function ye(a,c,d){this.bmp=a;this.x=c;this.y=d}function Ud(a){if(0==a.saturation)return a.value<<16|a.value<<8|a.value;var c=a.hue/60;c-=Math.floor(c);var d=a.saturation/255,b=~~(a.value*(1-d)),g=~~(a.value*(1-d*c));c=~~(a.value*(1-d*(1-c)));switch(~~(a.hue/
60)){case 0:return a.value<<16|c<<8|b;case 1:return g<<16|a.value<<8|b;case 2:return b<<16|a.value<<8|c;case 3:return b<<16|g<<8|a.value;case 4:return c<<16|b<<8|a.value;case 5:return a.value<<16|b<<8|g;default:return 0}}function lb(a){this.value=this.saturation=this.hue=this.rgb=0;this.setRgb(a||0)}function Tg(){var a,c=!1;this.nextGaussian=function(){if(c)return c=!1,a;do var d=(b=2*Math.random()-1)*b+(g=2*Math.random()-1)*g;while(d>=1||0==d);var b,g;d=Math.sqrt(-2*Math.log(d)/d);return a=g*d,c=
!0,b*d}}function sb(){this.setToIdentity()}function uc(a,c,d){this.r=a;this.g=c;this.b=d}function of(a){let c=0;for(let d=0;d<a.length;d++)c+=a[d];return c/a.length}function pf(a){let c=new uc(0,0,0);for(let d=0;d<a.length;d++){let b=a[d];c.r+=b.r;c.g+=b.g;c.b+=b.b}return c.r/=a.length,c.g/=a.length,c.b/=a.length,c}function qf(a,c){let d=a.data;if(c.left>0)for(var b=c.top;b<c.bottom;b++){var g=b*a.width,n=g;g=d[g+c.left];for(var f=0;f<c.left;f++,n++)d[n]=g}if(c.right<a.width)for(b=c.top;b<c.bottom;b++)for(n=
b*a.width+c.right,g=d[n-1],f=c.right;f<a.width;f++,n++)d[n]=g;b=0;for(n=0;n<c.top;n++)for(g=c.top*a.width,f=0;f<a.width;f++,g++,b++)d[b]=d[g];b=c.bottom*a.width;for(n=c.bottom;n<a.width;n++)for(g=(c.bottom-1)*a.width,f=0;f<a.width;f++,g++,b++)d[b]=d[g]}function Vd(a,c){return a+c}function rf(a){return a?a.width*a.height*4:0}function ec(a,c){function d(E){pb=!1;(vc.size>0||pc.size>0)&&(E?e():fc||setTimeout(e,1E3))}function b(){Z.emitEvent("changeSelection",[])}function g(E){Z.emitEvent("updateRegion",
[E])}function n(){Z.emitEvent("changeStructure");ra.resetTree();u();g(Z.getBounds())}function f(E,O,Q){Z.emitEvent("changeLayer",[E]);Q||(ra.layerPropertyChanged(E,O),g(Z.getBounds()))}function e(){for(let E of vc)E.rebuildImageThumbnail(),Z.emitEvent("changeLayerImageThumb",[E]);for(let E of pc)E.rebuildMaskThumbnail(),Z.emitEvent("changeLayerMaskThumb",[E]);vc.clear();fc&&(clearTimeout(fc),fc=null)}function k(E,O,Q,Y){Array.isArray(E)||(E=[E]);E.forEach(ja=>ra.invalidateLayerRect(ja,O));let da=
!1;if(Q)for(let ja of(qa.union(O),E))ja instanceof Da&&(vc.add(ja),da=!0);Y&&(A.union(O),E.forEach(ja=>{pc.add(ja);Ea&&Ea.layer==ja&&Ea.invalidateRect(O)}),da=!0);da&&(fc&&(clearTimeout(fc),fc=null),pb||(fc=setTimeout(e,1E3)));g(O)}function l(E,O){k(E,O,!ba,ba)}function h(){return ba?X.mask:X.image}function m(){if(!S.isEmpty()){if(ba){var E=X.mask;wb.brushMode==wa.BRUSH_MODE_ERASE?ha[wa.BRUSH_MODE_PAINT].mergeOntoMask(E,M,4278190080):ha[wb.brushMode].mergeOntoMask(E,M,255&$b)}else{E=X.image;let O=
X.getLockAlpha();wb.brushMode==wa.BRUSH_MODE_ERASE&&O?ha[wa.BRUSH_MODE_PAINT].mergeOntoImage(E,ka,16777215):ha[wb.brushMode].mergeOntoImage(E,ka,$b);O&&E.copyAlphaFrom(ka,S)}S.makeEmpty()}}function p(){X instanceof Da&&!qa.isEmpty()&&(ka.copyBitmapRect(X.image,qa.left,qa.top,qa),qa.makeEmpty())}function q(){X.mask&&!A.isEmpty()&&(M.copyBitmapRect(X.mask,A.left,A.top,A),A.makeEmpty())}function r(){ba?q():p()}function u(){let E=Z.getBounds();qa.set(E);A.set(E)}function v(E){Z.setHasUnsavedChanges(!0);
Wb.length>0&&(Wb=[]);0!==Ta.length&&Ta[Ta.length-1].merge(E)?Ta[Ta.length-1].noChange()&&Ta.pop():(Ta.length>=30&&Ta.shift(),Z.compactUndo(),Ta.push(E))}function y(E,O){E||O||(E=!ba,O=ba);let Q=Ha.clone(),Y=E?ka.copyRectXOR(X.image,Q):null,da=O?M.copyRectXOR(X.mask,Q):null;this.layer=X;Ha.makeEmpty();this.redo=this.undo=function(){Y&&this.layer.image.setRectXOR(Y,Q);da&&this.layer.mask.setRectXOR(da,Q);k(this.layer,Q,null!=Y,null!=da)};this.getMemoryUsed=function(ja,va){return(Y?Y.length:0)+(da?da.length:
0)}}function C(E){let O=E.maskLinked,Q=E.maskVisible;this.undo=function(){E.setMask(null);E.maskLinked=O;E.maskVisible=Q;n();Z.setActiveLayer(E,!1)};this.redo=function(){let Y=new Na(Z.width,Z.height,8);Y.clearAll(255);E.maskLinked=!0;E.maskVisible=!0;E.setMask(Y);n();Z.setActiveLayer(E,!0)};this.redo()}function w(E,O){let Q=E.mask,Y,da=!1;Y=O&&E instanceof Da?E.image.clone():null;da=X==E&&ba;this.undo=function(){E.setMask(Q);Y&&(E.image.copyPixelsFrom(Y),k(E,E.image.getBounds(),!0,!1));da&&Z.setActiveLayer(E,
!0);n()};this.redo=function(){Y&&(R.multiplyAlphaByMask(E.image,100,E.mask),k(E,Z.getBounds(),!0,!1));da&&Z.setActiveLayer(E,!1);E.setMask(null);n()};this.redo()}function D(E,O,Q){let Y=Q instanceof Da&&Q.clip,da=E.layers[O],ja=da instanceof Da&&da.clip,va=ba;this.undo=function(){E.removeLayer(Q);let Ja=E.layers[O-1]||E.layers[0]||E;da instanceof Da&&(da.clip=ja);Q instanceof Da&&(Q.clip=Y);n();Z.setActiveLayer(Ja,va)};this.redo=function(){E.insertLayer(O,Q);ja&&(Q instanceof Da?Q.clip=!0:da.clip=
!1);n();Z.setActiveLayer(Q,!1)};this.redo()}function x(E){let O=E.clone(),Q=ba;this.undo=function(){O.parent.removeLayer(O);n();Z.setActiveLayer(E,Q)};this.redo=function(){let Y=E.name;Y.endsWith(" Copy")||(Y+=" Copy");O.name=Y;E.parent.insertLayer(E.parent.indexOf(E)+1,O);n();Z.setActiveLayer(O,!1)};this.redo()}function G(E){let O=E.parent,Q=O.indexOf(E),Y=ba,da=0;if(E instanceof Da&&!E.clip)for(let ja=Q+1;ja<O.layers.length;ja++)if(O.layers[ja]instanceof Da&&O.layers[ja].clip)da++;else break;this.undo=
function(){O.insertLayer(Q,E);for(let ja=0;ja<da;ja++)O.layers[ja+Q+1].clip=!0;n();Z.setActiveLayer(E,Y)};this.redo=function(){var ja;for(ja=0;ja<da;ja++)O.layers[ja+Q+1].clip=!1;O.removeLayerAtIndex(Q);ja=0==O.layers.length?E.parent:O.layers[Math.max(Q-1,0)];n();Z.setActiveLayer(ja,!1)};this.getMemoryUsed=function(ja,va){return ja?0:E.getMemoryUsed()};this.redo()}function H(E){let O=E.parent.indexOf(E),Q=ba,Y=new Da(Z.width,Z.height,"");this.undo=function(){E.parent.setLayerAtIndex(O,E);n();Z.setActiveLayer(E,
Q)};this.redo=function(){E.parent.setLayerAtIndex(O,Y);n();Z.setActiveLayer(Y,!1)};this.getMemoryUsed=function(ja,va){return ja?0:E.getMemoryUsed()};var da=new xe(E,Z.width,Z.height,!1);da.buildTree();da=da.blendTree();Y.name=E.name;Y.alpha=da.alpha;Y.image=da.image;Y.blendMode=da.blendMode;Y.mask=da.mask;Y.blendMode==R.LM_PASSTHROUGH&&(Y.blendMode=R.LM_NORMAL);this.redo()}function N(E){let O=E.parent,Q=O.layers[O.indexOf(E)-1],Y=new Da(Z.width,Z.height,""),da=ba;this.undo=function(){let ja=O.indexOf(Y);
O.removeLayerAtIndex(ja);O.insertLayer(ja,E);O.insertLayer(ja,Q);n();Z.setActiveLayer(E,da)};this.redo=function(){if(Q.clip||!E.clip)Y.copyFrom(Q),E.getEffectiveAlpha()>0&&(Y.mask?R.multiplyAlphaByMask(Y.image,Y.alpha,Y.mask):R.multiplyAlphaBy(Y.image,Y.alpha),R.fuseImageOntoImage(Y.image,!0,E.image,E.alpha,E.blendMode,E.getBounds(),E.mask));else{var ja=new cb;ja.layers=[Q,E];ja.parent=null;ja.name="Temporary Group";ja=new xe(ja,Z.width,Z.height,!1);ja.buildTree();Y.image=ja.blendTree().image}Y.name=
Q.name;Y.alpha=100;Y.blendMode=Q.blendMode;Y.mask=null;ja=O.indexOf(Q);O.removeLayerAtIndex(ja);O.removeLayerAtIndex(ja);O.insertLayer(ja,Y);n();Z.setActiveLayer(Y,!1)};this.getMemoryUsed=function(ja,va){return ja?0:E.getMemoryUsed()+Y.getMemoryUsed()};this.redo()}function B(E=!1){let O=Z.getActiveLayer(),Q=ca.layers.slice(0),Y=new Da(Z.width,Z.height,"");this.undo=function(){ca.layers=Q.slice(0);n();Z.setActiveLayer(O,!1)};this.redo=function(){let da=Z.fusionLayers();Y.copyImageFrom(da);Y.setName(Z.getDefaultLayerName(!1));
E?ca.layers=Q.slice(0):ca.clearLayers();ca.addLayer(Y);n();Z.setActiveLayer(Y,!1)};this.getMemoryUsed=function(da,ja){return Q.map(va=>va.getMemoryUsed()).reduce(Vd,0)};this.redo()}function P(E,O=R.LM_NORMAL){if(!ba){var Q=Z.getActiveLayer(),Y=ca.layers.slice(0),da=new Da(Z.width,Z.height,"");this.undo=function(){ca.layers=Y.slice(0);n();Z.setActiveLayer(Q,!1)};this.redo=function(){var ja=Z.fusionLayers();da.copyImageFrom(ja);da.setName(Z.getDefaultLayerName(!1));da.setBlendMode(O);ca.layers=Y.slice(0);
ca.addLayer(da);n();Z.setActiveLayer(da,!1);ja=Z.getSelectionAutoSelect();let va=h();va&&(r(),Ha=ja.clone(),E(va,ja),l(X,ja))};this.redo()}}function V(E,O,Q){let Y=E.parent,da=E.parent.indexOf(E),ja=ba,va=Y.layers[Y.indexOf(E)+1],Ja=O.layers[Q],hb=E instanceof Da&&E.clip,nc=!!hb&&E.getClippingBase(),hc=0,Rb=0;if(E instanceof Da&&!E.clip)for(var Lb=da+1;Lb<Y.layers.length;Lb++)if(Y.layers[Lb]instanceof Da&&Y.layers[Lb].clip)hc++;else break;else if(E instanceof cb)for(Lb=Q;Lb<O.layers.length;Lb++)if(O.layers[Lb]instanceof
Da&&O.layers[Lb].clip)Rb++;else break;this.undo=function(){E.parent.removeLayer(E);var ob=va?Y.indexOf(va):Y.layers.length;Y.insertLayer(ob,E);E instanceof Da&&(E.clip=hb);for(ob=0;ob<hc;ob++)Y.layers[ob+da+1].clip=!0;for(ob=0;ob<Rb;ob++)O.layers[ob+Q].clip=!0;n();Z.setActiveLayer(E,ja)};this.redo=function(){for(var ob=0;ob<hc;ob++)Y.layers[ob+da+1].clip=!1;E.parent.removeLayer(E);ob=Ja?O.indexOf(Ja):O.layers.length;O.insertLayer(ob,E);for(var Ob=0;Ob<Rb;Ob++)O.layers[Ob+ob+1].clip=!1;E instanceof
Da&&(E.clip&&E.getClippingBase()!=nc&&(E.clip=!1),Ja instanceof Da&&Ja.clip&&(E.clip=!0));for(Ob=0;Ob<Rb;Ob++)O.layers[Ob+ob+1].clip=!1;n();Z.setActiveLayer(E,!1)};this.redo()}function L(E,O){let Q=E.substring(0,1).toUpperCase()+E.substring(1),Y=function(da,ja){Array.isArray(da)||(da=[da]);this.layers=da;this.from=this.layers.map(va=>va["get"+Q]());this.to=ja;this.redo()};return Y.prototype=Object.create(Xb.prototype),Y.prototype.constructor=Y,Y.prototype.undo=function(){this.layers.forEach((da,ja)=>
da["set"+Q](this.from[ja]));this.layers.forEach(da=>f(da,E,!O))},Y.prototype.redo=function(){this.layers.forEach(da=>da["set"+Q](this.to));this.layers.forEach(da=>f(da,E,!O))},Y.prototype.merge=function(da){var ja;if(ja=da instanceof Y)a:{ja=this.layers;var va=da.layers;if(ja.length!=va.length)ja=!1;else{for(let Ja=0;Ja<ja.length;Ja++)if(ja[Ja]!=va[Ja]){ja=!1;break a}ja=!0}}return!!ja&&(this.to=da.to,!0)},Y.prototype.noChange=function(){for(let da=0;da<this.from.length;da++)if(this.from[da]!=this.to)return!1;
return!0},Y}function ia(E,O){E=E.clone();O=O.clone();this.undo=function(){Z.setSelection(E);g(Z.getBounds())};this.redo=function(){Z.setSelection(O);g(Z.getBounds())};this.noChange=function(){return E.equals(O)}}function aa(E,O,Q){let Y=O?E.mask:E.image,da=Y.cloneRect(Q);Q=Q.clone();this.undo=function(){Y.copyBitmapRect(da,Q.left,Q.top,da.getBounds());Z.setActiveLayer(E,O);Z.setSelection(Q);k(E,Q,!O,O)};this.redo=function(){O?Y.clearRect(Q,0):Y.clearRect(Q,16777215);qb=new ye(da,Q.left,Q.top);Z.setActiveLayer(E,
O);Z.emptySelection();k(E,Q,!O,O)};this.getMemoryUsed=function(ja,va){return da==va?0:da.getMemorySize()};this.redo()}function ma(E){let O=Z.getSelection(),Q=ba,Y=new Da(Z.width,Z.height,Z.getDefaultLayerName(!1)),da=X,ja=da.parent;this.undo=function(){ja.removeLayer(Y);Z.setSelection(O);n();Z.setActiveLayer(da,Q)};this.redo=function(){var va=ja.indexOf(da);let Ja=E.bmp.getBounds(),hb,nc;(ja.insertLayer(va+1,Y),Ja.isInside(Z.getBounds())?(hb=E.x,nc=E.y):(hb=(Z.width-E.bmp.width)/2|0,nc=(Z.height-
E.bmp.height)/2|0),E.bmp instanceof Na)?(va=new I(E.bmp.width,E.bmp.height),va.copyPixelsFromGreyscale(E.bmp),Y.image.copyBitmapRect(va,hb,nc,Ja)):Y.image.copyBitmapRect(E.bmp,hb,nc,Ja);Z.emptySelection();n();Z.setActiveLayer(Y,!1)};this.getMemoryUsed=function(va,Ja){return E.bmp==Ja?0:E.bmp.getMemorySize()};this.redo()}a|=0;c|=0;let ca=new cb("Root",R.LM_NORMAL),ra=new xe(ca,a,c,!0),ka=new I(a,c),qa=new za(0,0,a,c),M=new Na(a,c,8),A=new za(0,0,a,c),K=new Na(a,c,32),S=new za(0,0,0,0),na=new Sg,Z=
this,ha=[],X=ca,ba=!1,Ea=null,Ha=new za(0,0,0,0),xb=!1,Ka=new za(0,0,0,0),Ua=null,Db=new Tg,kb=null,qb=null,Ta=[],Wb=[],wb=null,ac=0,mb=0,eb=0,Hb=!1,pb=!1,pc=new Set,vc=new Set,fc=null,$b=0,Yb="smooth";this.texture=null;this.getLayersRoot=function(){return ca};this.getSelectionAutoSelect=function(){return Ka.isEmpty()?this.getBounds():this.getSelection()};this.getSelection=function(){return Ka.clone()};this.setHasUnsavedChanges=function(E){E!=xb&&(xb=E,this.emitEvent("unsavedChanges",[E]))};this.getHasUnsavedChanges=
function(){return xb};this.isAddLayerMaskAllowed=function(){return!X.mask};this.addLayerMask=function(){this.isAddLayerMaskAllowed()&&v(new C(X))};this.isRemoveLayerMaskAllowed=function(){return null!==X.mask};this.removeLayerMask=function(){this.isRemoveLayerMaskAllowed()&&v(new w(X,!1))};this.isApplyLayerMaskAllowed=function(){return null!==X.mask&&X instanceof Da};this.applyLayerMask=function(E){this.isApplyLayerMaskAllowed()&&v(new w(X,!0))};this.addLayer=function(E){let O,Q;if(X instanceof cb&&
X.expanded?(O=X,Q=X.layers.length):Q=(O=X.parent).layers.indexOf(X)+1,"group"===E){for(;O.layers[Q]instanceof Da&&O.layers[Q].clip;)Q++;E=new cb(this.getDefaultLayerName(!0),R.LM_PASSTHROUGH)}else(E=new Da(this.width,this.height,this.getDefaultLayerName(!1))).image.clearAll(16777215);return v(new D(O,Q,E)),E};this.addLayerObject=function(E,O){E.addLayer(O);E==ca&&1==ca.layers.length&&(X=O);n()};this.addLayerGroupObject=function(E,O,Q){let Y=[];for(let da=0;da<Q;da++)Y.unshift(E.layers.pop());Y.forEach(da=>
O.addLayer(da));this.addLayerObject(E,O)};this.isRemoveLayerAllowed=function(){return X instanceof Da?ca.getLinearizedLayerList(!1).some(E=>E instanceof Da&&E!=X):X instanceof cb&&ca.getLinearizedLayerList(!1).some(E=>E instanceof Da&&!E.hasAncestor(X))};this.removeLayer=function(){return!!this.isRemoveLayerAllowed()&&(v(new G(X)),!0)};this.duplicateLayer=function(){v(new x(X))};this.isMergeDownAllowed=function(){let E=X.parent.indexOf(X);return E>0&&X instanceof Da&&X.parent.layers[E-1]instanceof
Da};this.mergeDown=function(){this.isMergeDownAllowed()&&v(new N(X))};this.isMergeGroupAllowed=function(){return X instanceof cb&&X.getEffectiveAlpha()>0};this.mergeGroup=function(){this.isMergeGroupAllowed()&&v(new H(X))};this.isMergeAllLayersAllowed=function(){return ca.getLinearizedLayerList(!1).length>1};this.mergeAllLayers=function(E=!1){this.isMergeAllLayersAllowed()&&v(new B(E))};this.relocateLayer=function(E,O,Q){E&&O&&E!=O&&!O.hasAncestor(E)&&v(new V(E,O,Q))};this.setLayerVisibility=function(E,
O){let Q=[];if(E.ancestorsAreVisible())E.visible!=O&&v(new wc(E,O));else{for(;null!=E;E=E.parent)E.visible||Q.push(E);v(new wc(Q,!0))}};this.expandLayerGroup=function(E,O){E.expanded!=O&&(E.expanded=O,!O&&X.hasAncestor(E)&&this.setActiveLayer(E,!1),f(E,"expanded",!0))};this.setLayerAlpha=function(E){X.getAlpha()!=E&&v(new Mb(X,E))};this.setLayerMaskLinked=function(E){X.maskLinked!=E&&v(new Ec(X,E))};this.setLayerMaskVisible=function(E,O){E.maskVisible!=O&&v(new Zb(E,O))};this.setLayerBlendMode=function(E){X.getBlendMode()!=
E&&(E!=R.LM_PASSTHROUGH||X instanceof cb)&&v(new Mc(X,E))};this.setLayerName=function(E,O){E.getName()!=O&&v(new ic(E,O))};this.paintDab=function(E,O,Q){if(wb){wb.applyPressure(Q);wb.scattering>0&&(E+=Db.nextGaussian()*wb.curScattering/4,O+=Db.nextGaussian()*wb.curScattering/4);Q=ha[wb.brushMode];E=na.getDab(E,O,wb);var Y=new za(0,0,E.width,E.height);O=new za(0,0,E.width,E.height);if(O.translate(E.x,E.y),Z.getBounds().clipSourceDest(Y,O),!O.isEmpty()){Ha.union(O);var da=ba?X.mask:X.image,ja=Hb&&!ba?
Ua:da,va=ba?null:Z.getSelection();if(!va||va.isEmpty())Q.paintDab(da,O,ja,wb,Y,E,$b);else{Y=O.getIntersection(va,!0);if(!Y||Y.isEmpty()||(Y.left=Math.max(0,Y.left),Y.top=Math.max(0,Y.top),Y.right=Math.min(da.width,Y.right),Y.bottom=Math.min(da.height,Y.bottom),Y.isEmpty()))return;va=new za(Y.left-E.x,Y.top-E.y,Y.left-E.x+Y.getWidth(),Y.top-E.y+Y.getHeight());Q.paintDab(da,Y,ja,wb,va,E,$b)}!ba&&Q.noMergePhase&&X.getLockAlpha()&&da.copyAlphaFrom(ka,O);Q.wantsOutputAsInput&&(m(),Hb&&!ba&&Z.fusionLayers());
l(X,O)}}};this.getDefaultLayerName=function(E){let O=E?"Group ":"Layer ";E=E?/^Group [0-9]+$/:/^Layer [0-9]+$/;let Q=0,Y=ca.getLinearizedLayerList(!1);for(let da=0;da<Y.length;da++){let ja=Y[da];E.test(ja.name)&&(Q=Math.max(Q,parseInt(ja.name.substring(O.length),10)))}return O+(Q+1)};this.addBackgroundLayer=function(){let E=new Da(Z.width,Z.height,this.getDefaultLayerName(!1));E.image.clearAll(4294967295);this.addLayerObject(this.getLayersRoot(),E)};this.addDefaultLayer=function(){let E=new Da(Z.width,
Z.height,this.getDefaultLayerName(!1));E.image.clearAll(16777215);this.addLayerObject(this.getLayersRoot(),E);this.setActiveLayer(E,!1)};this.fusionLayers=function(){m();ra.buildTree();return Ua=ra.blendTree().image};this.upgradeMultiplyLayers=function(E){let O=this.getLayersRoot().getLinearizedLayerList(!1,[]),Q=-1;for(var Y=0;Y<O.length;Y++){var da=O[Y];if(!(da instanceof Da)||da.mask||da.blendMode>R.LM_LAST_CHIBIPAINT)throw Error("Bad layer type during multiply upgrade");da.blendMode===R.LM_MULTIPLY&&
(Q=Y)}if(-1!==Q){Y=new I(this.width,this.height);let ja=da=!0,va=this.getBounds();Y.clearAll(va,16777215);for(let Ja=0;Ja<=Q;Ja++){let hb=O[Ja];ja||(da=da&&Y.hasAlphaInRect(va));hb.blendMode===R.LM_MULTIPLY&&("bake"===E?!da&&hb.getEffectiveAlpha()>0&&(100===hb.alpha?R.upgradeMultiplyOfOpaqueLayer(Y,hb.image,100,va):R.upgradeMultiplyOfTransparentLayer(Y,hb.image,hb.alpha,va),hb.setBlendMode(R.LM_MULTIPLY2)):da&&hb.setBlendMode(R.LM_MULTIPLY2));hb.getEffectiveAlpha()>0&&(ja=!1,R.fuseImageOntoImage(Y,
da,hb.image,hb.alpha,hb.blendMode,va,null))}}};this.isCreateClippingMaskAllowed=function(){var E=X.parent.indexOf(X);E=X.parent.layers[E-1];return X instanceof Da&&!X.clip&&E instanceof Da};this.createClippingMask=function(){this.isCreateClippingMaskAllowed()&&v(new ta(X,!0))};this.isReleaseClippingMaskAllowed=function(){return X instanceof Da&&X.clip};this.releaseClippingMask=function(){this.isReleaseClippingMaskAllowed()&&v(new ta(X,!1))};this.setActiveLayer=function(E,O){if(E){let Q=(O=E.mask&&
O)!=ba;if(X!=E||Q){let Y=X;X=E;ba=O;u();this.emitEvent("changeActiveLayer",[Y,E,ba]);Q&&this.emitEvent("editModeChanged",[ba?ec.EDITING_MODE_MASK:ec.EDITING_MODE_IMAGE]);Ea&&Ea.layer==Y&&(O?Ea.setLayer(E):this.closeMaskView())}}};this.closeMaskView=function(){Ea.close();Ea=null};this.toggleMaskView=function(){return null!=Ea&&Ea.isOpen()?this.closeMaskView():Ea=X.mask?new Ug(X,m):null,Ea};this.selectTopmostVisibleLayer=function(){let E=ca.getLinearizedLayerList(!1);for(var O=E.length-1;O>=0;O--)if(E[O]instanceof
Da&&E[O].getEffectiveAlpha()>0)return void this.setActiveLayer(E[O],!1);for(O=E.length-1;O>=0;O--)if(E[O]instanceof Da)return void this.setActiveLayer(E[O],!1);this.setActiveLayer(E[E.length-1],!1)};this.getActiveLayer=function(){return X};this.isEditingMask=function(){return ba};this.isActiveLayerDrawable=function(){return ba&&X.mask||!ba&&X instanceof Da};this.getUndoMemoryUsed=function(){let E=0;for(let O of Wb)E+=O.getMemoryUsed(!0,null);for(let O of Ta)E+=O.getMemoryUsed(!1,null);return E};this.isUndoAllowed=
function(){return Ta.length>0};this.isRedoAllowed=function(){return Wb.length>0};this.undo=function(){if(this.isUndoAllowed()){this.setHasUnsavedChanges(!0);var E=Ta.pop();E.undo();Wb.push(E)}};this.redo=function(){if(this.isRedoAllowed()){this.setHasUnsavedChanges(!0);var E=Wb.pop();E.redo();Ta.push(E)}};this.performIdleTasks=function(){r();m();ra.buildTree()};this.compactUndo=function(){Ta.length>0&&Ta[Ta.length-1].compact()};this.clearHistory=function(){Ta=[];Wb=[]};this.colorPicker=function(E,
O){return ba&&X.mask?lb.greyToRGB(X.mask.getPixel(~~E,~~O)):16777215&Ua.getPixel(~~E,~~O)};this.setSelection=function(E){Ka.set(E);Ka.roundNearest();Ka.clipTo(this.getBounds())};this.emptySelection=function(){Ka.makeEmpty()};this.floodFill=function(E,O,Q=0,Y=255,da=!0){da=!ba&&da?this.fusionLayers():null;let ja=h();ja&&(r(),Ha=this.getBounds(),ja.floodFillWithBorder(~~E,~~O,4278190080|$b,Q,Y,da),v(new y),l(X,this.getBounds()))};this.gradientFill=function(E,O,Q,Y,da){let ja=this.getSelectionAutoSelect(),
va=h();va&&(r(),Ha=ja.clone(),va.gradient(ja,E,O,Q,Y,da,!1),this.getLayerLockAlpha()&&va instanceof I&&va.copyAlphaFrom(ka,ja),v(new y),l(X,ja))};this.fill=function(E,O){let Q=this.getSelectionAutoSelect(),Y=h(),da=this.texture;if(Y){r();Ha=Q.clone();if(da&&!O){O=da.width;let hb=da.height,nc=Q.right-Q.left,hc=Q.bottom-Q.top;for(let Rb=0;Rb<hc;Rb++)for(let Lb=0;Lb<nc;Lb++){var ja,va,Ja;let ob=Q.left+Lb,Ob=Q.top+Rb,yc=1-da.data[Ob%hb*O+ob%O]/255,Eb=(255&((ja=E)>>24&255)*(va=yc)+((Ja=Y.getPixel(ob,Ob))>>
24&255)*(1-va))<<24|(255&(ja>>16&255)*va+(Ja>>16&255)*(1-va))<<16|(255&(ja>>8&255)*va+(Ja>>8&255)*(1-va))<<8|255&(255&ja)*va+(255&Ja)*(1-va);Y.setPixel(ob,Ob,Eb)}}else Y.clearRect(Q,E);v(new y);l(X,Q)}};this.clear=function(E=!0){ba?this.fill(0,E):this.fill(16777215,E)};this.flip=function(E){let O=this.getSelection(),Q=O.isEmpty();var Y=Q&&X instanceof Da&&X.mask&&X.maskLinked;let da=(!ba||Y)&&X instanceof Da;Y=(ba||Y)&&X.mask;E=E?"copyRegionHFlip":"copyRegionVFlip";(da||Y)&&(Q&&(O=this.getBounds()),
Ha=O.clone(),da&&(p(),X.image[E](O,ka)),Y&&(q(),X.mask[E](O,M)),v(new y(da,Y)),k(X,O,da,Y))};this.hFlip=function(){this.flip(!0)};this.vFlip=function(){this.flip(!1)};this.monochromaticNoise=function(){let E=this.getSelectionAutoSelect(),O=h();O&&(r(),Ha=E.clone(),O.fillWithNoise(E,$b),v(new y),l(X,E))};this.isColorNoiseAllowed=function(){return!this.isEditingMask()&&this.isActiveLayerDrawable()};this.isNotEditingMask=function(){return!this.isEditingMask()};this.isNotEditingMaskAndDrawable=function(){return!this.isEditingMask()&&
this.isActiveLayerDrawable()};this.colorNoise=function(){if(this.isColorNoiseAllowed()){let E=this.getSelectionAutoSelect();r();Ha=E.clone();X.image.fillWithColorNoise(E);v(new y(!0,!1));k(X,E,!0,!1)}};this.invert=function(){let E=this.getSelectionAutoSelect(),O=h();O&&(r(),Ha=E.clone(),O.invert(E),v(new y),l(X,E))};this.brightnessToOpacity=function(){if(!ba){var E=this.getSelectionAutoSelect(),O=h();O&&(r(),Ha=E.clone(),O.brightnessToOpacity(E),v(new y),l(X,E))}};this.boxBlur=function(E,O,Q,Y=!1){if(Y)return void v(new P(function(ja,
va){for(let Ja=0;Ja<Q;Ja++)ja.boxBlur(va,E,O)}));Y=this.getSelectionAutoSelect();let da=h();if(da){r();Ha=Y.clone();for(let ja=0;ja<Q;ja++)da.boxBlur(Y,E,O);v(new y);l(X,Y)}};this.chromaticAberration=function(E,O,Q=!1){if(!ba){if(Q)return void v(new P(function(da,ja){da.chromaticAberration(ja,E,O)}));Q=this.getSelectionAutoSelect();var Y=h();Y&&(r(),Ha=Q.clone(),Y.chromaticAberration(Q,E,O),v(new y),l(X,Q))}};this.edge=function(E,O){if(!ba){var Q=this.getSelectionAutoSelect(),Y=h();Y&&(r(),Ha=Q.clone(),
Y.edge(Q,E,$b,O),v(new y),l(X,Q))}};this.monoHalftone=function(E,O=!1){if(O)return void v(new P(function(Y,da){Y.monoHalftone(da,E,$b,.85)}));O=this.getSelectionAutoSelect();let Q=h();Q&&(r(),Ha=O.clone(),Q.monoHalftone(O,E,$b,.85),v(new y),l(X,O))};this.colorHalftone=function(E,O=!1){if(!ba){if(O)return void v(new P(function(Y,da){Y.colorHalftone(da,E,.85)},R.LM_MULTIPLY2));O=this.getSelectionAutoSelect();var Q=h();Q&&(r(),Ha=O.clone(),Q.colorHalftone(O,E,.85),v(new y),l(X,O))}};this.mosaic=function(E,
O=!1){if(O)return void v(new P(function(Y,da){Y.mosaic(da,E)}));O=this.getSelectionAutoSelect();let Q=h();Q&&(r(),Ha=O.clone(),Q.mosaic(O,E),v(new y),l(X,O))};this.rectangleSelection=function(E){E=E.clone();E.clipTo(this.getBounds());v(new ia(this.getSelection(),E));this.setSelection(E)};this.move=function(E,O,Q){if(O|=0,0!=(E|=0)||0!=O){var Y=Ta.length>0?Ta[Ta.length-1]:null;!Q&&Y instanceof qc&&Y.layer==this.getActiveLayer()?(Y.amend(E,O),Wb=[],this.setHasUnsavedChanges(!0)):(E=new qc(E,O,Q),v(E),
E.redo())}};this.setTransformInterpolation=function(E){Yb=E;kb instanceof bc&&kb.setInterpolation(E)};this.transformAffineAbort=function(){kb instanceof bc&&(kb.undo(),kb=null,d(!0))};this.transformAffineBegin=function(){if(kb instanceof bc)return{transform:kb.getTransform(),rect:kb.getInitialTransformRect(),selection:kb.getInitialSelectionRect()};let E=new sb,O;return(O=new bc(E,Yb)).getInitialTransformRect().isEmpty()?null:(kb=O,pb=!0,{transform:E,rect:O.getInitialTransformRect(),selection:O.getInitialSelectionRect()})};
this.transformAffineFinish=function(){kb instanceof bc&&(v(kb),kb=null,d(!0))};this.transformAffineAmend=function(E){kb instanceof bc&&kb.amend(E)};this.isCopySelectionAllowed=this.isCutSelectionAllowed=function(){return!this.getSelection().isEmpty()&&null!==h()};this.cutSelection=function(){this.isCutSelectionAllowed()&&v(new aa(X,ba,this.getSelection()))};this.copySelection=function(){if(this.isCopySelectionAllowed()){let E=Z.getSelection();qb=new ye(h().cloneRect(E),E.left,E.top)}};this.isCopySelectionMergedAllowed=
function(){return!this.getSelection().isEmpty()};this.copySelectionMerged=function(){if(this.isCopySelectionMergedAllowed()){let E=Z.getSelection();qb=new ye(this.fusionLayers().cloneRect(E),E.left,E.top)}};this.isPasteClipboardAllowed=function(){return!this.isClipboardEmpty()};this.pasteClipboard=function(){this.isPasteClipboardAllowed()&&v(new ma(qb))};this.getClipboard=function(){return qb};this.setClipboard=function(E){qb=E};this.isClipboardEmpty=function(){return null==qb};this.setSampleAllLayers=
function(E){Hb=E};this.getLayerLockAlpha=function(){return this.getActiveLayer().getLockAlpha()};this.setLayerLockAlpha=function(E){X.getLockAlpha()!=E&&v(new Nb(X,E))};this.setForegroundColor=function(E){$b=E};this.setBrush=function(E){wb=E};this.setBrushTexture=function(E){na.setTexture(E);this.texture=E};this.beginStroke=function(E,O,Q){return null!==wb&&!!this.isActiveLayerDrawable()&&(r(),Ha.makeEmpty(),K.clearAll(0),S.makeEmpty(),ac=E,mb=O,eb=Q,pb=!0,ha[wb.brushMode].beginStroke(),this.paintDab(E,
O,Q),!0)};this.continueStroke=function(E,O,Q){if(null!=wb){var Y=E-ac,da=O-mb,ja=Math.sqrt(Y*Y+da*da),va=Math.max(wb.minSpacing,wb.curSize*wb.spacing);if(ja>=va){Y/=ja;da/=ja;let Ja=(Q-eb)/ja,hb=va;for(;hb<=ja;)this.paintDab(ac+Y*hb,mb+da*hb,eb+Ja*hb),hb+=va;ac=E;mb=O;eb=Q}}};this.endStroke=function(){null!=wb&&(m(),ha[wb.brushMode].endStroke(),Ha.clipTo(this.getBounds()),Ha.isEmpty()||(v(new y),r()),d(!1))};this.hasAlpha=function(){return Ua.hasAlpha()};this.getFlatPNG=function(E){return this.fusionLayers(),
Ua.getAsPNG(E)};this.getFlatPNGBuffer=function(E){return this.fusionLayers(),Ua.getAsPNGBuffer(E)};y.prototype=Object.create(Xb.prototype);y.prototype.constructor=y;C.prototype=Object.create(Xb.prototype);C.prototype.constructor=C;w.prototype=Object.create(Xb.prototype);w.prototype.constructor=w;D.prototype=Object.create(Xb.prototype);D.prototype.constructor=D;x.prototype=Object.create(Xb.prototype);x.prototype.constructor=x;G.prototype=Object.create(Xb.prototype);G.prototype.constructor=G;H.prototype=
Object.create(Xb.prototype);H.prototype.constructor=H;N.prototype=Object.create(Xb.prototype);N.prototype.constructor=N;B.prototype=Object.create(Xb.prototype);B.prototype.constructor=B;P.prototype=Object.create(Xb.prototype);P.prototype.constructor=P;V.prototype=Object.create(Xb.prototype);V.prototype.constructor=V;let Mb=L("alpha",!0),Mc=L("blendMode",!0),wc=L("visible",!0),ta=L("clip",!0),Zb=L("maskVisible",!0),ic=L("name",!1),Nb=L("lockAlpha",!1),Ec=L("maskLinked",!1);ia.prototype=Object.create(Xb.prototype);
ia.prototype.constructor=ia;class Pa extends Xb{undo(){let E=[];this.dstRect.isEmpty()||E.push(this.dstRect);this.erasesSourceRect&&(E.push(this.srcRect),E=za.union(E));this.movingLayers.forEach(O=>{this.hasFullUndo?E.forEach(Q=>{O.moveImage&&O.layer.image.copyBitmapRect(O.imageUndo,Q.left,Q.top,Q);O.moveMask&&O.layer.mask.copyBitmapRect(O.maskUndo,Q.left,Q.top,Q)}):(O.moveImage&&O.imageRect.forEach((Q,Y)=>{O.layer.image.copyBitmapRect(Q,Y.left,Y.top,Q.getBounds())}),O.moveMask&&O.maskRect.forEach((Q,
Y)=>{O.layer.mask.copyBitmapRect(Q,Y.left,Y.top,Q.getBounds())}))});k(this.movingLayers.map(O=>O.layer),E.reduce((O,Q)=>O.getUnion(Q),new za(0,0,0,0)),!0,!0);this.dstRect.makeEmpty();Z.setSelection(this.fromSelection);Z.setActiveLayer(this.layer,this.fromMaskMode);b()}getMemoryUsed(E,O){return this.movingLayers.map(function(Q){return[Q.imageUndo,Q.maskUndo,Q.imageRect,Q.maskRect].map(Y=>Y?Y.getMemorySize():0).reduce(Vd,0)}).reduce(Vd,0)}buildFullUndo(){this.hasFullUndo||(this.movingLayers.forEach(function(E){E.moveImage&&
(E.imageUndo=E.layer.image.clone());E.moveMask&&(E.maskUndo=E.layer.mask.clone());E.imageRect.clear();E.maskRect.clear()}),this.hasFullUndo=!0)}compact(){if(this.hasFullUndo){let E=[];this.dstRect.isEmpty()||E.push(this.dstRect);this.erasesSourceRect&&(E.push(this.srcRect),E=za.union(E));this.movingLayers.forEach(O=>{O.imageRect.clear();O.maskRect.clear();E.forEach(Q=>{O.moveImage&&O.imageRect.set(Q,O.imageUndo.cloneRect(Q));O.moveMask&&O.maskRect.set(Q,O.maskUndo.cloneRect(Q))});O.imageUndo=null;
O.maskUndo=null});this.hasFullUndo=!1}}constructor(){super();this.layer=X;this.fromSelection=Z.getSelection();this.fromMaskMode=ba;this.movingWholeLayer=this.fromSelection.isEmpty();this.movingImage=!ba||this.movingWholeLayer&&this.layer.maskLinked;this.movingMask=ba||this.movingWholeLayer&&this.layer.maskLinked;this.erasesSourceRect=this.hasFullUndo=!1;this.dstRect=new za(0,0,0,0);this.movingLayers=[{layer:this.layer,moveImage:this.layer instanceof Da&&this.movingImage,moveMask:null!==this.layer.mask&&
this.movingMask,imageRect:new Map,maskRect:new Map}];this.layer instanceof cb&&this.movingImage&&this.movingWholeLayer&&(this.movingLayers=this.movingLayers.concat(this.layer.getLinearizedLayerList(!1).map(Y=>({layer:Y,moveImage:Y instanceof Da,moveMask:null!==Y.mask&&Y.maskLinked,imageRect:new Map,maskRect:new Map}))));let E=new za(0,0,0,0);if(this.movingWholeLayer){this.srcRect=Z.getBounds();for(var O=0;O<this.movingLayers.length&&!E.equals(this.srcRect);O++){var Q=this.movingLayers[O];Q.moveMask&&
E.union(Q.layer.mask.getValueBounds(this.srcRect,255));Q.moveImage&&E.union(Q.layer.image.getNonTransparentBounds(this.srcRect))}}else for(this.srcRect=this.fromSelection.clone(),O=0;O<this.movingLayers.length&&!E.equals(this.srcRect);O++)Q=this.movingLayers[O],Q.moveMask&&E.union(Q.layer.mask.getValueBounds(this.srcRect,0)),Q.moveImage&&E.union(Q.layer.image.getNonTransparentBounds(this.srcRect));this.srcRect=E}}class bc extends Pa{buildFullUndo(){if(!this.hasFullUndo){super.buildFullUndo();this.movingLayers.forEach(Q=>
{if(Q.moveImage){var Y=$c(this.srcRect.getWidth(),this.srcRect.getHeight());Y.getContext("2d").putImageData(Q.layer.image.getImageData(),-this.srcRect.left,-this.srcRect.top,this.srcRect.left,this.srcRect.top,this.srcRect.getWidth(),this.srcRect.getHeight());Q.imageSourceCanvas=Y}Q.moveMask&&(Y=$c(this.srcRect.getWidth(),this.srcRect.getHeight()),Y.getContext("2d").putImageData(Q.layer.mask.getImageData(this.srcRect.left,this.srcRect.top,this.srcRect.getWidth(),this.srcRect.getHeight()),0,0),Q.maskSourceCanvas=
Y)});this.composeCanvas=$c(Z.width,Z.height);this.composeCanvasContext=this.composeCanvas.getContext("2d",{willReadFrequently:!0});let E="smooth"===this.interpolation,O=this.composeCanvasContext;O&&(O.imageSmoothingEnabled=E);this.junk=this.composeCanvasContext.getImageData(0,0,1,1)}}redo(){this.buildFullUndo();var E=this.dstRect.clone();let O=this.srcRect.toPoints();this.affineTransform.transformPoints(O);this.dstRect.set(za.createBoundingBox(O).roundContain().clipTo(Z.getBounds()));let Q=za.subtract(this.dstRect,
this.srcRect),Y=za.subtract(E.isEmpty()?this.srcRect:this.srcRect.getIntersection(E),this.dstRect),da=this.srcRect.getIntersection(this.dstRect),ja=za.subtract(E,[this.dstRect,this.srcRect]);E=this.srcRect.getUnion(this.dstRect).getUnion(E);(this.movingLayers.forEach(va=>{if(Y.forEach(Ja=>{va.moveImage&&va.layer.image.clearRect(Ja,16777215);va.moveMask&&(this.movingWholeLayer?va.layer.mask.clearRect(Ja,255):va.layer.mask.clearRect(Ja,0))}),!this.dstRect.isEmpty()){if(va.moveImage){let Ja=va.imageUndo.getImageData();
Q.forEach(hb=>{this.composeCanvasContext.putImageData(Ja,0,0,hb.left,hb.top,hb.getWidth(),hb.getHeight())});this.composeCanvasContext.clearRect(da.left,da.top,da.getWidth(),da.getHeight());this.composeCanvasContext.save();this.composeCanvasContext.setTransform(this.affineTransform.m[0],this.affineTransform.m[1],this.affineTransform.m[2],this.affineTransform.m[3],this.affineTransform.m[4],this.affineTransform.m[5]);this.composeCanvasContext.drawImage(va.imageSourceCanvas,this.srcRect.left,this.srcRect.top);
this.composeCanvasContext.restore();va.layer.image.copyBitmapRect(new I(this.composeCanvasContext.getImageData(this.dstRect.left,this.dstRect.top,this.dstRect.getWidth(),this.dstRect.getHeight())),this.dstRect.left,this.dstRect.top,new za(0,0,this.dstRect.getWidth(),this.dstRect.getHeight()))}va.moveMask&&(Q.forEach(Ja=>{this.composeCanvasContext.putImageData(va.layer.mask.getImageData(Ja.left,Ja.top,Ja.getWidth(),Ja.getHeight()),Ja.left,Ja.top)}),this.movingWholeLayer?this.composeCanvasContext.fillStyle=
"#FFF":this.composeCanvasContext.fillStyle="#000",this.composeCanvasContext.fillRect(da.left,da.top,da.getWidth(),da.getHeight()),this.composeCanvasContext.save(),this.composeCanvasContext.setTransform(this.affineTransform.m[0],this.affineTransform.m[1],this.affineTransform.m[2],this.affineTransform.m[3],this.affineTransform.m[4],this.affineTransform.m[5]),this.composeCanvasContext.drawImage(va.maskSourceCanvas,this.srcRect.left,this.srcRect.top),this.composeCanvasContext.restore(),va.layer.mask.pasteImageData(this.composeCanvasContext.getImageData(this.dstRect.left,
this.dstRect.top,this.dstRect.getWidth(),this.dstRect.getHeight()),this.dstRect.left,this.dstRect.top))}ja.forEach(Ja=>{va.moveImage&&va.layer.image.copyBitmapRect(va.imageUndo,Ja.left,Ja.top,Ja);va.moveMask&&va.layer.mask.copyBitmapRect(va.maskUndo,Ja.left,Ja.top,Ja)})}),k(this.movingLayers.map(va=>va.layer),E,!0,!0),this.fromSelection.isEmpty())||(E=this.fromSelection.toPoints(),this.affineTransform.transformPoints(E),(E=za.createBoundingBox(E)).roundNearest(),Z.setSelection(E),b());Z.setActiveLayer(this.layer,
this.fromMaskMode)}amend(E){this.hasFullUndo||this.undo();this.affineTransform=E.clone();this.redo()}setInterpolation(E){if(E!=this.interpolation){this.interpolation=E;E="smooth"===this.interpolation;let O=this.composeCanvasContext;O&&(O.imageSmoothingEnabled=E);this.undo();this.redo()}}compact(){super.compact();this.composeCanvasContext=this.composeCanvas=null;this.movingLayers.forEach(E=>E.imageSourceCanvas=null)}getMemoryUsed(E,O){E=super.getMemoryUsed(E,O);return E+=rf(this.composeCanvas),E+=
this.movingLayers.map(Q=>rf(Q.imageSourceCanvas)).reduce(Vd,0)}getTransform(){return this.affineTransform.clone()}getInitialTransformRect(){return this.srcRect.clone()}getInitialSelectionRect(){return this.fromSelection.clone()}constructor(E,O){super();this.erasesSourceRect=!0;this.affineTransform=E.clone();this.interpolation=O||"smooth";this.composeCanvasContext=this.composeCanvas=null}}class qc extends Pa{redo(){var E=this.dstRect.clone();let O,Q,Y=E.clone(),da=null;(this.buildFullUndo(),this.dstRect.set(this.srcRect),
this.dstRect.translate(this.offsetX,this.offsetY),O=this.dstRect.clone(),this.dstRect.clipTo(Z.getBounds()),this.erasesSourceRect?(da=E.isEmpty()?this.srcRect:this.srcRect.getIntersection(E),Y.union(da),Q=E.subtract(this.srcRect)):Q=[E],this.movingLayers.forEach(ja=>{da&&(ja.moveImage&&ja.layer.image.clearRect(da,16777215),ja.moveMask&&ja.layer.mask.clearRect(da,255*!!this.movingWholeLayer));Q.forEach(function(va){ja.moveImage&&ja.layer.image.copyBitmapRect(ja.imageUndo,va.left,va.top,va);ja.moveMask&&
ja.layer.mask.copyBitmapRect(ja.maskUndo,va.left,va.top,va)});ja.moveImage&&R.normalFuseImageOntoImageAtPosition(ja.layer.image,ja.imageUndo,O.left,O.top,this.srcRect);ja.moveMask&&ja.layer.mask.copyBitmapRect(ja.maskUndo,O.left,O.top,this.srcRect)}),Y.union(this.dstRect),k(this.movingLayers.map(ja=>ja.layer),Y,!0,!0),this.fromSelection.isEmpty())||(E=this.fromSelection.clone(),E.translate(this.offsetX,this.offsetY),Z.setSelection(E),b())}amend(E,O){this.hasFullUndo||this.undo();this.offsetX+=E;this.offsetY+=
O;this.redo()}constructor(E,O,Q){super();this.offsetX=E;this.offsetY=O;this.erasesSourceRect=!Q}}aa.prototype=Object.create(Xb.prototype);aa.prototype.constructor=aa;ma.prototype=Object.create(Xb.prototype);ma.prototype.constructor=ma;ha=[ld,Vg,Wg,Xg,Dd,Yg,Zg,$g].map(E=>new E(K,S));this.width=a;this.height=c}function ib(a,c,d){this.data=a;this.eof=!1;this.start=void 0===c?0:c;this.end=void 0===d?a.length:d;this.pos=this.start}function md(a){for(var c=a.length;--c>=0;)a[c]=0}function ze(a,c,d,b,g){this.static_tree=
a;this.extra_bits=c;this.extra_base=d;this.elems=b;this.max_length=g;this.has_stree=a&&a.length}function Ae(a,c){this.dyn_tree=a;this.max_code=0;this.stat_desc=c}function sf(a){return a<256?Ed[a]:Ed[256+(a>>>7)]}function Fd(a,c){a.pending_buf[a.pending++]=255&c;a.pending_buf[a.pending++]=c>>>8&255}function jc(a,c,d){a.bi_valid>16-d?(a.bi_buf|=c<<a.bi_valid&65535,Fd(a,a.bi_buf),a.bi_buf=c>>16-a.bi_valid,a.bi_valid+=d-16):(a.bi_buf|=c<<a.bi_valid&65535,a.bi_valid+=d)}function zc(a,c,d){jc(a,d[2*c],
d[2*c+1])}function tf(a,c){var d=0;do d|=1&a,a>>>=1,d<<=1;while(--c>0);return d>>>1}function uf(a,c,d){var b,g=Array(16),n=0;for(b=1;b<=15;b++)g[b]=n=n+d[b-1]<<1;for(d=0;d<=c;d++)b=a[2*d+1],0!==b&&(a[2*d]=tf(g[b]++,b))}function vf(a){var c;for(c=0;c<286;c++)a.dyn_ltree[2*c]=0;for(c=0;c<30;c++)a.dyn_dtree[2*c]=0;for(c=0;c<19;c++)a.bl_tree[2*c]=0;a.dyn_ltree[512]=1;a.opt_len=a.static_len=0;a.last_lit=a.matches=0}function wf(a){a.bi_valid>8?Fd(a,a.bi_buf):a.bi_valid>0&&(a.pending_buf[a.pending++]=a.bi_buf);
a.bi_buf=0;a.bi_valid=0}function xf(a,c,d,b){var g=2*c,n=2*d;return a[g]<a[n]||a[g]===a[n]&&b[c]<=b[d]}function Be(a,c,d){for(var b=a.heap[d],g=d<<1;g<=a.heap_len&&(g<a.heap_len&&xf(c,a.heap[g+1],a.heap[g],a.depth)&&g++,!xf(c,b,a.heap[g],a.depth));)a.heap[d]=a.heap[g],d=g,g<<=1;a.heap[d]=b}function yf(a,c,d){var b,g,n=0;if(0!==a.last_lit){do{var f=a.pending_buf[a.d_buf+2*n]<<8|a.pending_buf[a.d_buf+2*n+1];var e=a.pending_buf[a.l_buf+n];n++;0===f?zc(a,e,c):(zc(a,(b=Gd[e])+256+1,c),0!==(g=Ce[b])&&jc(a,
e-De[b],g),zc(a,b=sf(--f),d),0!==(g=Wd[b])&&jc(a,f-Xd[b],g))}while(n<a.last_lit)}zc(a,256,c)}function Ee(a,c){var d,b=c.dyn_tree;var g=c.stat_desc.static_tree;var n=c.stat_desc.has_stree,f=c.stat_desc.elems,e=-1;var k=0;a.heap_len=0;for(a.heap_max=573;k<f;k++)0!==b[2*k]?(a.heap[++a.heap_len]=e=k,a.depth[k]=0):b[2*k+1]=0;for(;a.heap_len<2;)b[2*(d=a.heap[++a.heap_len]=e<2?++e:0)]=1,a.depth[d]=0,a.opt_len--,n&&(a.static_len-=g[2*d+1]);c.max_code=e;for(k=a.heap_len>>1;k>=1;k--)Be(a,b,k);d=f;do k=a.heap[1],
a.heap[1]=a.heap[a.heap_len--],Be(a,b,1),g=a.heap[1],a.heap[--a.heap_max]=k,a.heap[--a.heap_max]=g,b[2*d]=b[2*k]+b[2*g],a.depth[d]=(a.depth[k]>=a.depth[g]?a.depth[k]:a.depth[g])+1,b[2*k+1]=b[2*g+1]=d,a.heap[1]=d++,Be(a,b,1);while(a.heap_len>=2);a.heap[--a.heap_max]=a.heap[1];var l,h,m,p,q;k=c.dyn_tree;d=c.max_code;g=c.stat_desc.static_tree;n=c.stat_desc.has_stree;f=c.stat_desc.extra_bits;var r=c.stat_desc.extra_base,u=c.stat_desc.max_length,v=0;for(m=0;m<=15;m++)a.bl_count[m]=0;k[2*a.heap[a.heap_max]+
1]=0;for(c=a.heap_max+1;c<573;c++)(m=k[2*k[2*(l=a.heap[c])+1]+1]+1)>u&&(m=u,v++),k[2*l+1]=m,l>d||(a.bl_count[m]++,p=0,l>=r&&(p=f[l-r]),q=k[2*l],a.opt_len+=q*(m+p),!n||(a.static_len+=q*(g[2*l+1]+p)));if(0!==v){do{for(m=u-1;0===a.bl_count[m];)m--;a.bl_count[m]--;a.bl_count[m+1]+=2;a.bl_count[u]--;v-=2}while(v>0);for(m=u;0!==m;m--)for(l=a.bl_count[m];0!==l;)(h=a.heap[--c])>d||(k[2*h+1]!==m&&(a.opt_len+=(m-k[2*h+1])*k[2*h],k[2*h+1]=m),l--)}uf(b,e,a.bl_count)}function zf(a,c,d){var b,g=-1,n=c[1],f=0,e=
7,k=4;0===n&&(e=138,k=3);c[(d+1)*2+1]=65535;for(b=0;b<=d;b++){var l=n;n=c[(b+1)*2+1];++f<e&&l===n||(f<k?a.bl_tree[2*l]+=f:0!==l?(l!==g&&a.bl_tree[2*l]++,a.bl_tree[32]++):f<=10?a.bl_tree[34]++:a.bl_tree[36]++,f=0,g=l,0===n?(e=138,k=3):l===n?(e=6,k=3):(e=7,k=4))}}function Af(a,c,d){var b,g,n=-1,f=c[1],e=0,k=7,l=4;0===f&&(k=138,l=3);for(b=0;b<=d;b++)if(g=f,f=c[(b+1)*2+1],!(++e<k)||g!==f){if(e<l){do zc(a,g,a.bl_tree);while(0!=--e)}else 0!==g?(g!==n&&(zc(a,g,a.bl_tree),e--),zc(a,16,a.bl_tree),jc(a,e-3,
2)):e<=10?(zc(a,17,a.bl_tree),jc(a,e-3,3)):(zc(a,18,a.bl_tree),jc(a,e-11,7));e=0;n=g;0===f?(k=138,l=3):g===f?(k=6,l=3):(k=7,l=4)}}function Bf(a,c,d,b){jc(a,+!!b,3);wf(a);Fd(a,d);Fd(a,~d);Qa.arraySet(a.pending_buf,a.window,c,d,a.pending);a.pending+=d}function Nc(a,c){return a.msg=ad[c],c}function Oc(a){for(var c=a.length;--c>=0;)a[c]=0}function Pc(a){var c=a.state,d=c.pending;d>a.avail_out&&(d=a.avail_out);0!==d&&(Qa.arraySet(a.output,c.pending_buf,c.pending_out,d,a.next_out),a.next_out+=d,c.pending_out+=
d,a.total_out+=d,a.avail_out-=d,c.pending-=d,0===c.pending&&(c.pending_out=0))}function Ub(a,c){ah(a,a.block_start>=0?a.block_start:-1,a.strstart-a.block_start,c);a.block_start=a.strstart;Pc(a.strm)}function nb(a,c){a.pending_buf[a.pending++]=c}function Hd(a,c){a.pending_buf[a.pending++]=c>>>8&255;a.pending_buf[a.pending++]=255&c}function Cf(a,c){var d,b,g=a.max_chain_length,n=a.strstart,f=a.prev_length,e=a.nice_match,k=a.strstart>a.w_size-262?a.strstart-(a.w_size-262):0,l=a.window,h=a.w_mask,m=a.prev,
p=a.strstart+258,q=l[n+f-1],r=l[n+f];a.prev_length>=a.good_match&&(g>>=2);e>a.lookahead&&(e=a.lookahead);do if(l[(d=c)+f]===r&&l[d+f-1]===q&&l[d]===l[n]&&l[++d]===l[n+1]){n+=2;for(d++;l[++n]===l[++d]&&l[++n]===l[++d]&&l[++n]===l[++d]&&l[++n]===l[++d]&&l[++n]===l[++d]&&l[++n]===l[++d]&&l[++n]===l[++d]&&l[++n]===l[++d]&&n<p;);if(b=258-(p-n),n=p-258,b>f){if(a.match_start=c,f=b,b>=e)break;q=l[n+f-1];r=l[n+f]}}while((c=m[c&h])>k&&0!=--g);return f<=a.lookahead?f:a.lookahead}function bd(a){var c,d,b=a.w_size;
do{if(d=a.window_size-a.lookahead-a.strstart,a.strstart>=b+(b-262)){Qa.arraySet(a.window,a.window,b,b,0);a.match_start-=b;a.strstart-=b;a.block_start-=b;var g=c=a.hash_size;do{var n=a.head[--g];a.head[g]=n>=b?n-b:0}while(--c);g=c=b;do n=a.prev[--g],a.prev[g]=n>=b?n-b:0;while(--c);d+=b}if(0===a.strm.avail_in)break;g=a.strm;n=a.window;var f=a.strstart+a.lookahead,e=g.avail_in;if(c=(e>d&&(e=d),0===e)?0:(g.avail_in-=e,Qa.arraySet(n,g.input,g.next_in,e,f),1===g.state.wrap?g.adler=nd(g.adler,n,e,f):2===
g.state.wrap&&(g.adler=Pb(g.adler,n,e,f)),g.next_in+=e,g.total_in+=e,e),a.lookahead+=c,a.lookahead+a.insert>=3)for(d=a.strstart-a.insert,a.ins_h=a.window[d],a.ins_h=(a.ins_h<<a.hash_shift^a.window[d+1])&a.hash_mask;a.insert&&(a.ins_h=(a.ins_h<<a.hash_shift^a.window[d+3-1])&a.hash_mask,a.prev[d&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=d,d++,a.insert--,!(a.lookahead+a.insert<3)););}while(a.lookahead<262&&0!==a.strm.avail_in)}function Fe(a,c){for(var d,b;;){if(a.lookahead<262){if(bd(a),a.lookahead<
262&&0===c)return 1;if(0===a.lookahead)break}if(d=0,a.lookahead>=3&&(a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+3-1])&a.hash_mask,d=a.prev[a.strstart&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=a.strstart),0!==d&&a.strstart-d<=a.w_size-262&&(a.match_length=Cf(a,d)),a.match_length>=3)if(b=Qc(a,a.strstart-a.match_start,a.match_length-3),a.lookahead-=a.match_length,a.match_length<=a.max_lazy_match&&a.lookahead>=3){a.match_length--;do a.strstart++,a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+
3-1])&a.hash_mask,d=a.prev[a.strstart&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=a.strstart;while(0!=--a.match_length);a.strstart++}else a.strstart+=a.match_length,a.match_length=0,a.ins_h=a.window[a.strstart],a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+1])&a.hash_mask;else b=Qc(a,0,a.window[a.strstart]),a.lookahead--,a.strstart++;if(b&&(Ub(a,!1),0===a.strm.avail_out))return 1}return(a.insert=a.strstart<2?a.strstart:2,4===c)?(Ub(a,!0),0===a.strm.avail_out)?3:4:a.last_lit&&(Ub(a,!1),0===a.strm.avail_out)?
1:2}function od(a,c){for(var d,b,g;;){if(a.lookahead<262){if(bd(a),a.lookahead<262&&0===c)return 1;if(0===a.lookahead)break}if(d=0,a.lookahead>=3&&(a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+3-1])&a.hash_mask,d=a.prev[a.strstart&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=a.strstart),a.prev_length=a.match_length,a.prev_match=a.match_start,a.match_length=2,0!==d&&a.prev_length<a.max_lazy_match&&a.strstart-d<=a.w_size-262&&(a.match_length=Cf(a,d),a.match_length<=5&&(1===a.strategy||3===a.match_length&&
a.strstart-a.match_start>4096)&&(a.match_length=2)),a.prev_length>=3&&a.match_length<=a.prev_length){g=a.strstart+a.lookahead-3;b=Qc(a,a.strstart-1-a.prev_match,a.prev_length-3);a.lookahead-=a.prev_length-1;a.prev_length-=2;do++a.strstart<=g&&(a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+3-1])&a.hash_mask,d=a.prev[a.strstart&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=a.strstart);while(0!=--a.prev_length);if(a.match_available=0,a.match_length=2,a.strstart++,b&&(Ub(a,!1),0===a.strm.avail_out))return 1}else if(a.match_available){if(Qc(a,
0,a.window[a.strstart-1])&&Ub(a,!1),a.strstart++,a.lookahead--,0===a.strm.avail_out)return 1}else a.match_available=1,a.strstart++,a.lookahead--}return(a.match_available&&(Qc(a,0,a.window[a.strstart-1]),a.match_available=0),a.insert=a.strstart<2?a.strstart:2,4===c)?(Ub(a,!0),0===a.strm.avail_out)?3:4:a.last_lit&&(Ub(a,!1),0===a.strm.avail_out)?1:2}function Ac(a,c,d,b,g){this.good_length=a;this.max_lazy=c;this.nice_length=d;this.max_chain=b;this.func=g}function bh(){this.strm=null;this.status=0;this.pending_buf=
null;this.wrap=this.pending=this.pending_out=this.pending_buf_size=0;this.gzhead=null;this.gzindex=0;this.method=8;this.last_flush=-1;this.w_mask=this.w_bits=this.w_size=0;this.window=null;this.window_size=0;this.head=this.prev=null;this.nice_match=this.good_match=this.strategy=this.level=this.max_lazy_match=this.max_chain_length=this.prev_length=this.lookahead=this.match_start=this.strstart=this.match_available=this.prev_match=this.match_length=this.block_start=this.hash_shift=this.hash_mask=this.hash_bits=
this.hash_size=this.ins_h=0;this.dyn_ltree=new Qa.Buf16(1146);this.dyn_dtree=new Qa.Buf16(122);this.bl_tree=new Qa.Buf16(78);Oc(this.dyn_ltree);Oc(this.dyn_dtree);Oc(this.bl_tree);this.bl_desc=this.d_desc=this.l_desc=null;this.bl_count=new Qa.Buf16(16);this.heap=new Qa.Buf16(573);Oc(this.heap);this.heap_max=this.heap_len=0;this.depth=new Qa.Buf16(573);Oc(this.depth);this.bi_valid=this.bi_buf=this.insert=this.matches=this.static_len=this.opt_len=this.d_buf=this.last_lit=this.lit_bufsize=this.l_buf=
0}function Df(a,c){if(c<65534&&(a.subarray&&Ef||!a.subarray&&Ff))return String.fromCharCode.apply(null,Qa.shrinkBuf(a,c));for(var d="",b=0;b<c;b++)d+=String.fromCharCode(a[b]);return d}function cd(a){if(!(this instanceof cd))return new cd(a);this.options=Qa.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},a||{});var c,d,b;a=this.options;a.raw&&a.windowBits>0?a.windowBits=-a.windowBits:a.gzip&&a.windowBits>0&&a.windowBits<16&&(a.windowBits+=16);this.err=0;this.msg=
"";this.ended=!1;this.chunks=[];this.strm=new Ge;this.strm.avail_out=0;var g=this.strm;var n=a.level;var f=a.method,e=a.windowBits,k=a.memLevel,l=a.strategy;if(g){var h,m,p,q=1;if(-1===n&&(n=6),e<0?(q=0,e=-e):e>15&&(q=2,e-=16),k<1||k>9||8!==f||e<8||e>15||n<0||n>9||l<0||l>4)n=Nc(g,-2);else{8===e&&(e=9);var r=new bh;n=(g.state=r,r.strm=g,r.wrap=q,r.gzhead=null,r.w_bits=e,r.w_size=1<<r.w_bits,r.w_mask=r.w_size-1,r.hash_bits=k+7,r.hash_size=1<<r.hash_bits,r.hash_mask=r.hash_size-1,r.hash_shift=~~((r.hash_bits+
3-1)/3),r.window=new Qa.Buf8(2*r.w_size),r.head=new Qa.Buf16(r.hash_size),r.prev=new Qa.Buf16(r.w_size),r.lit_bufsize=1<<k+6,r.pending_buf_size=4*r.lit_bufsize,r.pending_buf=new Qa.Buf8(r.pending_buf_size),r.d_buf=+r.lit_bufsize,r.l_buf=3*r.lit_bufsize,r.level=n,r.strategy=l,r.method=f,0===(p=g&&g.state?(g.total_in=g.total_out=0,g.data_type=2,(h=g.state).pending=0,h.pending_out=0,h.wrap<0&&(h.wrap=-h.wrap),h.status=h.wrap?42:113,g.adler=+(2!==h.wrap),h.last_flush=0,ch(h),0):Nc(g,-2))&&((m=g.state).window_size=
2*m.w_size,Oc(m.head),m.max_lazy_match=Id[m.level].max_lazy,m.good_match=Id[m.level].good_length,m.nice_match=Id[m.level].nice_length,m.max_chain_length=Id[m.level].max_chain,m.strstart=0,m.block_start=0,m.lookahead=0,m.insert=0,m.match_length=m.prev_length=2,m.match_available=0,m.ins_h=0),p)}}else n=-2;if(0!==n)throw Error(ad[n]);if(a.header&&(c=this.strm,d=a.header,c&&c.state&&2===c.state.wrap&&(c.state.gzhead=d)),a.dictionary){if(b="string"==typeof a.dictionary?He(a.dictionary):"[object ArrayBuffer]"===
Gf.call(a.dictionary)?new Uint8Array(a.dictionary):a.dictionary,0!==(n=dh(this.strm,b)))throw Error(ad[n]);this._dict_set=!0}}function Ie(a,c){c=new cd(c);if(c.push(a,!0),c.err)throw c.msg||ad[c.err];return c.result}function Hf(a){return(a>>>24&255)+(a>>>8&65280)+((65280&a)<<8)+((255&a)<<24)}function eh(){this.mode=0;this.last=!1;this.wrap=0;this.havedict=!1;this.total=this.check=this.dmax=this.flags=0;this.head=null;this.wnext=this.whave=this.wsize=this.wbits=0;this.window=null;this.extra=this.offset=
this.length=this.bits=this.hold=0;this.distcode=this.lencode=null;this.have=this.ndist=this.nlen=this.ncode=this.distbits=this.lenbits=0;this.next=null;this.lens=new Qa.Buf16(320);this.work=new Qa.Buf16(288);this.distdyn=this.lendyn=null;this.was=this.back=this.sane=0}function If(a,c,d,b){var g;a=a.state;return null===a.window&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new Qa.Buf8(a.wsize)),b>=a.wsize?(Qa.arraySet(a.window,c,d-a.wsize,a.wsize,0),a.wnext=0,a.whave=a.wsize):((g=a.wsize-a.wnext)>
b&&(g=b),Qa.arraySet(a.window,c,d-b,g,a.wnext),(b-=g)?(Qa.arraySet(a.window,c,d-b,b,0),a.wnext=b,a.whave=a.wsize):(a.wnext+=g,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=g))),0}function dd(a){if(!(this instanceof dd))return new dd(a);this.options=Qa.assign({chunkSize:16384,windowBits:0,to:""},a||{});var c,d,b,g,n,f,e,k,l,h=this.options;h.raw&&h.windowBits>=0&&h.windowBits<16&&(h.windowBits=-h.windowBits,0===h.windowBits&&(h.windowBits=-15));h.windowBits>=0&&h.windowBits<16&&(!a||!a.windowBits)&&
(h.windowBits+=32);h.windowBits>15&&h.windowBits<48&&(15&h.windowBits)==0&&(h.windowBits|=15);this.err=0;this.msg="";this.ended=!1;this.chunks=[];this.strm=new Ge;this.strm.avail_out=0;a=(c=this.strm,d=h.windowBits,c?(c.state=g=new eh,g.window=null,0!==(n=d,b=c&&c.state?(e=c.state,n<0?(f=0,n=-n):(f=(n>>4)+1,n<48&&(n&=15)),n&&(n<8||n>15))?-2:(null!==e.window&&e.wbits!==n&&(e.window=null),e.wrap=f,e.wbits=n,c&&c.state?((k=c.state).wsize=0,k.whave=0,k.wnext=0,c&&c.state?(l=c.state,c.total_in=c.total_out=
l.total=0,c.msg="",l.wrap&&(c.adler=1&l.wrap),l.mode=1,l.last=0,l.havedict=0,l.dmax=32768,l.head=null,l.hold=0,l.bits=0,l.lencode=l.lendyn=new Qa.Buf32(852),l.distcode=l.distdyn=new Qa.Buf32(592),l.sane=1,l.back=-1,0):-2):-2):-2)&&(c.state=null),b):-2);if(a!==Gb.Z_OK||(this.header=new Jf,fh(this.strm,this.header),h.dictionary&&("string"==typeof h.dictionary?h.dictionary=He(h.dictionary):"[object ArrayBuffer]"===Kf.call(h.dictionary)&&(h.dictionary=new Uint8Array(h.dictionary)),h.raw)&&(a=Lf(this.strm,
h.dictionary))!==Gb.Z_OK))throw Error(ad[a]);}function Je(a,c){c=new dd(c);if(c.push(a,!0),c.err)throw c.msg||ad[c.err];return c.result}function Ke(a){this.version=a.readU32BE();this.width=a.readU32BE();this.height=a.readU32BE();this.layersNb=a.readU32BE()}function Yd(a){let c=[,,,,];for(let d=0;d<c.length;d++)c[d]=String.fromCharCode(a.readByte());if(this.chunkType=c.join(""),this.chunkSize=a.readU32BE(),a.eof)throw"Truncated chunk";}function Mf(a){return{major:a>>16&65535,minor:65535&a}}function Le(a,
c){let d=new ib(new Uint8Array(Yd.HEADER_LENGTH+c));return d.writeString(a),d.writeU32BE(c),d}function Nf(a,c){function d(p){let q;var r=m;if(null!==r&&0!==r.length)if(null===p||0===p.length)p=r;else{var u=new Uint8Array(r.length+p.length);p=(u.set(r,0),u.set(p,r.length),u)}for(m=p;m;){if(k<m.length)m=m.subarray(k),k=0;else{k-=m.length;m=null;break}switch(g){case 0:if(m.length<Yd.HEADER_LENGTH)break;if(h=new Yd(q=new ib(m)),m=m.subarray(q.pos),l)if(h.chunkType=="ZEND")g=45;else{h.chunkType=="LAYR"?
(g=2,e=new gh(h,l.width,l.height)):h.chunkType=="GRUP"?(g=3,e=new hh(h,l.width,l.height)):(console.log("Unknown chunk type '"+h.chunkType+"', attempting to skip..."),k=h.chunkSize);continue}else if(h.chunkType=="HEAD"){g=1;continue}else g=5;break;case 1:if(m.length<h.chunkSize)break;if(Mf((l=new Ke(q=new ib(m))).version).major>0){g=5;break}f=(n=new ec(l.width,l.height)).getLayersRoot();k=h.chunkSize;g=0;continue;case 2:if(m=e.decode(m),e.done){n.addLayerObject(f,e.layer);g=0;continue}break;case 3:if(m=
e.decode(m),e.done){n.addLayerGroupObject(f,e.layer,e.childLayers);g=0;continue}}break}}c=c||{};let b=new (Ga(Me).Inflate)({}),g=0,n=null,f=null,e,k=0,l=null,h=null,m=null;return(new Promise(function(p){if(a instanceof ArrayBuffer)p(a);else{let q=new FileReader;q.onload=function(){p(this.result)};q.readAsArrayBuffer(a)}})).then(p=>new Promise(function(q,r){let u=new Uint8Array(p);(function(v){for(let y=0;y<8;y++)if(v[y]!="CHIBIOEK".charCodeAt(y))return!1;return!0})(u)?(u=u.subarray(8),b.onData=d,
b.onEnd=function(v){0===v&&45==g?(!1!==c.upgradeMultiplyLayers&&l.version<10&&n.upgradeMultiplyLayers(c.upgradeMultiplyLayers),n.selectTopmostVisibleLayer(),q(n)):r("Fatal error decoding ChibiFile: "+v)},b.push(u,!0)):r("This doesn't appear to be a ChibiPaint layers file, is it damaged?")}))}function pd(){}function Jd(a){function c(n,f){null===f?g.emitEvent("loadingProgress",[1,"Loading your "+n.friendly+"..."]):g.emitEvent("loadingProgress",[f,"Loading your "+n.friendly+" ("+Math.round(100*f)+"%)..."])}
var d=[],b={},g=this;a.loadChibiFileUrl&&(""+a.loadChibiFileUrl).length>0?d.push({url:a.loadChibiFileUrl,friendly:"drawing layers",name:"layers",required:!0}):a.loadImageUrl&&(""+a.loadImageUrl).length>0&&d.push({url:a.loadImageUrl,friendly:"drawing",name:"flat",required:!0});a.loadSwatchesUrl&&d.push({url:a.loadSwatchesUrl,friendly:"color swatches",name:"swatches",required:!1,noProgress:!0});this.load=function(){function n(){f.required?g.emitEvent("loadingFailure",["Failed to load your "+f.friendly+
", please try again later."]):g.load()}if(0==d.length)return void g.emitEvent("loadingComplete",[b]);var f=d.shift(),e=new XMLHttpRequest;e.addEventListener("progress",function(k){c(f,k.lengthComputable&&!f.noProgress?k.loaded/k.total:null)},!1);e.addEventListener("load",function(k){if(200==this.status){let l=this.response;g.emitEvent("loadingProgress",[1,"Starting litaChix..."]);setTimeout(function(){(function(h,m){switch(h.name){case "flat":return new Promise(function(p,q){let r=new Blob([m],{type:"image/png"}),
u=window.URL.createObjectURL(r);if(u){let v=new Image;v.onload=function(){let y=new ec(this.width,this.height),C=new Da(0,0,"Layer 1");C.image=I.createFromImage(v);y.addLayerObject(y.getLayersRoot(),C);v=null;window.URL.revokeObjectURL(u);p(y)};v.src=u}else q(null)});case "swatches":return(h=(new pd).read(m))?Promise.resolve(h):Promise.reject(null);case "layers":return Nf(m);default:return Promise.reject("Unexpected resource type '"+h.name+"'")}})(f,l).then(function(h){b[f.name]=h;g.load()},function(){g.emitEvent("loadingFailure",
["Failed to read your "+f.friendly])})},0)}else n()},!1);e.addEventListener("error",n);c(f,f.noProgress?null:0);e.open("GET",f.url,!0);e.responseType="arraybuffer";e.send()}}function Fc(a){if(a>2147483647)throw RangeError('The value "'+a+'" is invalid for option "size"');a=new Uint8Array(a);return Object.setPrototypeOf(a,oa.prototype),a}function oa(a,c,d){if("number"==typeof a){if("string"==typeof c)throw TypeError('The "string" argument must be of type string. Received type number');return Ne(a)}return Of(a,
c,d)}function Of(a,c,d){if("string"==typeof a){var b=c;if(("string"!=typeof b||""===b)&&(b="utf8"),!oa.isEncoding(b))throw TypeError("Unknown encoding: "+b);c=0|Pf(a,b);d=Fc(c);a=d.write(a,b);return a!==c&&(d=d.slice(0,a)),d}if(ArrayBuffer.isView(a))return Bc(a,Uint8Array)?(a=new Uint8Array(a),Qf(a.buffer,a.byteOffset,a.byteLength)):Oe(a);if(null==a)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof a);if(Bc(a,ArrayBuffer)||
a&&Bc(a.buffer,ArrayBuffer)||"u">typeof SharedArrayBuffer&&(Bc(a,SharedArrayBuffer)||a&&Bc(a.buffer,SharedArrayBuffer)))return Qf(a,c,d);if("number"==typeof a)throw TypeError('The "value" argument must not be of type number. Received type number');b=a.valueOf&&a.valueOf();if(null!=b&&b!==a)return oa.from(b,c,d);if(oa.isBuffer(a)){b=0|Pe(a.length);var g=Fc(b);b=(0===g.length||a.copy(g,0,0,b),g)}else void 0!==a.length?((b="number"!=typeof a.length)||(b=a.length,b=b!=b),b=b?Fc(0):Oe(a)):b="Buffer"===
a.type&&Array.isArray(a.data)?Oe(a.data):void 0;if(b)return b;if("u">typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof a[Symbol.toPrimitive])return oa.from(a[Symbol.toPrimitive]("string"),c,d);throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof a);}function Rf(a){if("number"!=typeof a)throw TypeError('"size" argument must be of type number');if(a<0)throw RangeError('The value "'+a+'" is invalid for option "size"');
}function Ne(a){return Rf(a),Fc(a<0?0:0|Pe(a))}function Oe(a){for(var c=a.length<0?0:0|Pe(a.length),d=Fc(c),b=0;b<c;b+=1)d[b]=255&a[b];return d}function Qf(a,c,d){var b;if(c<0||a.byteLength<c)throw RangeError('"offset" is outside of buffer bounds');if(a.byteLength<c+(d||0))throw RangeError('"length" is outside of buffer bounds');return Object.setPrototypeOf(b=void 0===c&&void 0===d?new Uint8Array(a):void 0===d?new Uint8Array(a,c):new Uint8Array(a,c,d),oa.prototype),b}function Pe(a){if(a>=2147483647)throw RangeError("Attempt to allocate Buffer larger than maximum size: 0x7fffffff bytes");
return 0|a}function Pf(a,c){if(oa.isBuffer(a))return a.length;if(ArrayBuffer.isView(a)||Bc(a,ArrayBuffer))return a.byteLength;if("string"!=typeof a)throw TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof a);var d=a.length,b=arguments.length>2&&!0===arguments[2];if(!b&&0===d)return 0;for(var g=!1;;)switch(c){case "ascii":case "latin1":case "binary":return d;case "utf8":case "utf-8":return Qe(a).length;case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return 2*
d;case "hex":return d>>>1;case "base64":return Sf(a).length;default:if(g)return b?-1:Qe(a).length;c=(""+c).toLowerCase();g=!0}}function ih(a,c,d){var b,g,n=!1;if((void 0===c||c<0)&&(c=0),c>this.length||((void 0===d||d>this.length)&&(d=this.length),d<=0||(d>>>=0)<=(c>>>=0)))return"";for(a||="utf8";;)switch(a){case "hex":return function(f,e,k){var l=f.length;(!e||e<0)&&(e=0);(!k||k<0||k>l)&&(k=l);for(l="";e<k;++e)l+=jh[f[e]];return l}(this,c,d);case "utf8":case "utf-8":return Tf(this,c,d);case "ascii":return function(f,
e,k){var l="";for(k=Math.min(f.length,k);e<k;++e)l+=String.fromCharCode(127&f[e]);return l}(this,c,d);case "latin1":case "binary":return function(f,e,k){var l="";for(k=Math.min(f.length,k);e<k;++e)l+=String.fromCharCode(f[e]);return l}(this,c,d);case "base64":return b=c,g=d,0===b&&g===this.length?Uf(this):Uf(this.slice(b,g));case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return function(f,e,k){f=f.slice(e,k);e="";for(k=0;k<f.length-1;k+=2)e+=String.fromCharCode(f[k]+256*f[k+1]);return e}(this,
c,d);default:if(n)throw TypeError("Unknown encoding: "+a);a=(a+"").toLowerCase();n=!0}}function ed(a,c,d){var b=a[c];a[c]=a[d];a[d]=b}function Vf(a,c,d,b,g){var n;if(0===a.length)return-1;if("string"==typeof d?(b=d,d=0):d>2147483647?d=2147483647:d<-2147483648&&(d=-2147483648),(n=d*=1)!=n&&(d=g?0:a.length-1),d<0&&(d=a.length+d),d>=a.length){if(g)return-1;d=a.length-1}else if(d<0)if(g)d=0;else return-1;if("string"==typeof c&&(c=oa.from(c,b)),oa.isBuffer(c))return 0===c.length?-1:Wf(a,c,d,b,g);if("number"==
typeof c)return(c&=255,"function"==typeof Uint8Array.prototype.indexOf)?g?Uint8Array.prototype.indexOf.call(a,c,d):Uint8Array.prototype.lastIndexOf.call(a,c,d):Wf(a,[c],d,b,g);throw TypeError("val must be string, number or Buffer");}function Wf(a,c,d,b,g){function n(l,h){return 1===f?l[h]:l.readUInt16BE(h*f)}var f=1,e=a.length,k=c.length;if(void 0!==b&&("ucs2"===(b=String(b).toLowerCase())||"ucs-2"===b||"utf16le"===b||"utf-16le"===b)){if(a.length<2||c.length<2)return-1;f=2;e/=2;k/=2;d/=2}if(g)for(b=
-1;d<e;d++)if(n(a,d)===n(c,-1===b?0:d-b)){if(-1===b&&(b=d),d-b+1===k)return b*f}else-1!==b&&(d-=d-b),b=-1;else for(d+k>e&&(d=e-k);d>=0;d--){e=!0;for(b=0;b<k;b++)if(n(a,d+b)!==n(c,b)){e=!1;break}if(e)return d}return-1}function Tf(a,c,d){d=Math.min(a.length,d);for(var b=[];c<d;){var g,n,f=a[c],e=null,k=f>239?4:f>223?3:f>191?2:1;if(c+k<=d)switch(k){case 1:f<128&&(e=f);break;case 2:(192&(g=a[c+1]))==128&&(n=(31&f)<<6|63&g)>127&&(e=n);break;case 3:g=a[c+1];var l=a[c+2];(192&g)==128&&(192&l)==128&&(n=(15&
f)<<12|(63&g)<<6|63&l)>2047&&(n<55296||n>57343)&&(e=n);break;case 4:g=a[c+1];l=a[c+2];var h=a[c+3];(192&g)==128&&(192&l)==128&&(192&h)==128&&(n=(15&f)<<18|(63&g)<<12|(63&l)<<6|63&h)>65535&&n<1114112&&(e=n)}null===e?(e=65533,k=1):e>65535&&(e-=65536,b.push(e>>>10&1023|55296),e=56320|1023&e);b.push(e);c+=k}a=b.length;if(a<=4096)return String.fromCharCode.apply(String,b);d="";for(g=0;g<a;)d+=String.fromCharCode.apply(String,b.slice(g,g+=4096));return d}function Sb(a,c,d){if(a%1!=0||a<0)throw RangeError("offset is not uint");
if(a+c>d)throw RangeError("Trying to access beyond buffer length");}function kc(a,c,d,b,g,n){if(!oa.isBuffer(a))throw TypeError('"buffer" argument must be a Buffer instance');if(c>g||c<n)throw RangeError('"value" argument is out of bounds');if(d+b>a.length)throw RangeError("Index out of range");}function Xf(a,c,d,b,g){c*=1;d>>>=0;if(!g&&(d+4>a.length||d<0))throw RangeError("Index out of range");return Yf(a,c,d,b,23,4),d+4}function Zf(a,c,d,b,g){c*=1;d>>>=0;if(!g&&(d+8>a.length||d<0))throw RangeError("Index out of range");
return Yf(a,c,d,b,52,8),d+8}function Qe(a,c){c=c||1/0;for(var d,b=a.length,g=null,n=[],f=0;f<b;++f){if((d=a.charCodeAt(f))>55295&&d<57344){if(!g){if(d>56319||f+1===b){(c-=3)>-1&&n.push(239,191,189);continue}g=d;continue}if(d<56320){(c-=3)>-1&&n.push(239,191,189);g=d;continue}d=(g-55296<<10|d-56320)+65536}else g&&(c-=3)>-1&&n.push(239,191,189);if(g=null,d<128){if(--c<0)break;n.push(d)}else if(d<2048){if((c-=2)<0)break;n.push(d>>6|192,63&d|128)}else if(d<65536){if((c-=3)<0)break;n.push(d>>12|224,d>>
6&63|128,63&d|128)}else if(d<1114112){if((c-=4)<0)break;n.push(d>>18|240,d>>12&63|128,d>>6&63|128,63&d|128)}else throw Error("Invalid code point");}return n}function Sf(a){return function(c){var d=c.length;if(d%4>0)throw Error("Invalid string. Length must be a multiple of 4");var b=c.indexOf("=");-1===b&&(b=d);d=[b,b===d?0:4-b%4];var g=d[0];d=d[1];b=new kh((g+d)*3/4-d);var n=0,f=d>0?g-4:g;for(g=0;g<f;g+=4){var e=rc[c.charCodeAt(g)]<<18|rc[c.charCodeAt(g+1)]<<12|rc[c.charCodeAt(g+2)]<<6|rc[c.charCodeAt(g+
3)];b[n++]=e>>16&255;b[n++]=e>>8&255;b[n++]=255&e}return 2===d&&(e=rc[c.charCodeAt(g)]<<2|rc[c.charCodeAt(g+1)]>>4,b[n++]=255&e),1===d&&(e=rc[c.charCodeAt(g)]<<10|rc[c.charCodeAt(g+1)]<<4|rc[c.charCodeAt(g+2)]>>2,b[n++]=e>>8&255,b[n++]=255&e),b}(function(c){if((c=(c=c.split("=")[0]).trim().replace(lh,"")).length<2)return"";for(;c.length%4!=0;)c+="=";return c}(a))}function Zd(a,c,d,b){for(var g=0;g<b&&!(g+d>=c.length)&&!(g>=a.length);++g)c[g+d]=a[g];return g}function Bc(a,c){return a instanceof c||
null!=a&&null!=a.constructor&&null!=a.constructor.name&&a.constructor.name===c.name}function Re(){throw Error("setTimeout has not been defined");}function Se(){throw Error("clearTimeout has not been defined");}function $f(a){if(Rc===setTimeout)return setTimeout(a,0);if((Rc===Re||!Rc)&&setTimeout)return Rc=setTimeout,setTimeout(a,0);try{return Rc(a,0)}catch(c){try{return Rc.call(null,a,0)}catch(d){return Rc.call(this,a,0)}}}function mh(){qd&&fd&&(qd=!1,fd.length?Gc=fd.concat(Gc):$d=-1,Gc.length&&ag())}
function ag(){if(!qd){var a=$f(mh);qd=!0;for(var c=Gc.length;c;){fd=Gc;for(Gc=[];++$d<c;)fd&&fd[$d].run();$d=-1;c=Gc.length}fd=null;qd=!1;(function(d){if(Sc===clearTimeout)return clearTimeout(d);if((Sc===Se||!Sc)&&clearTimeout)return Sc=clearTimeout,clearTimeout(d);try{Sc(d)}catch(b){try{return Sc.call(null,d)}catch(g){return Sc.call(this,d)}}})(a)}}function bg(a,c){this.fun=a;this.array=c}function Hc(){}async function Te(a,c){return new Promise((d,b)=>{let g=indexedDB.open("litaChixDB",1);g.onupgradeneeded=
n=>{n=n.target.result;n.objectStoreNames.contains("chibiResults")||n.createObjectStore("chibiResults")};g.onsuccess=()=>{let n=g.result,f=c(n.transaction("chibiResults",a).objectStore("chibiResults"));f.onsuccess=()=>{d(f.result);n.close()};f.onerror=()=>b(f.error)};g.onerror=()=>b(g.error)})}async function nh(a,c){let d={bytes:a,swatches:c,savedAt:Date.now()};return localStorage.setItem("has_chibi_autosave_flag","true"),Te("readwrite",b=>b.put(d,"latest_backup"))}async function oh(){return await Te("readonly",
a=>a.get("latest_backup"))||null}async function Ue(){return localStorage.removeItem("has_chibi_autosave_flag"),Te("readwrite",a=>a.delete("latest_backup"))}function Ve(a){(a=a.split(/[-_]/,1)[0].toLowerCase())in We?(ae=We[a],Xe=a):(ae=be,Xe="en")}function W(a){return a in ae?ae[a]:a}function Kd(a){function c(k){null===k?f.emitEvent("savingProgress",[1,W("Saving drawing...")]):f.emitEvent("savingProgress",[k,W("Saving drawing...")+" ("+Math.round(100*k)+"%)"])}function d(k){f.emitEvent("savingFailure",
[k])}async function b(k){try{let l=await g(k),h=`${(l/1024/1024).toFixed(3)}MB`,m=`${a.post_max_size}MB`;if(console.log("Total size of FormData:",h),console.log("post_max_size:",m),a&&a.post_max_size&&l&&!isNaN(l)&&l>1048576*a.post_max_size)return void d(`${W("The file size exceeds the server limit.")}
${W("Limit size")}:${m}
${W("Current size")}:${h}`);console.log(W("The total size of FormData is within the acceptable range."))}catch(l){console.error("Error details:",l);d("An error occurred in the getFormDataSize function.");return}c(.5);fetch(a.url,{method:"POST",mode:"same-origin",headers:{"X-Requested-With":"chickenpaint"},body:k}).then(l=>{if(!l.ok){let h;switch(l.status){case 400:h="Bad Request";break;case 401:h="Unauthorized";break;case 403:h="Forbidden";break;case 404:h="Not Found";break;case 500:h="Internal Server Error";
break;case 502:h="Bad Gateway";break;case 503:h="Service Unavailable";break;default:h="Unknown Error"}throw Error(`${W("Network response was not OK")} ( ${W("HTTP status code")} ${l.status} : ${h} )`);}return l.text()}).then(l=>{/^CHIBIOK/.test(l)?(c(1),f.emitEvent("savingComplete"),Ue()):d(l)}).catch(l=>{d(l.message)})}async function g(k){if(a.post_max_size)return k=Array.from(k.entries()).map(([l,h])=>"string"==typeof h?new Blob([`${l}=${h}`]):h),(new Blob(k)).size}async function n(k,l,h,m){let p=
new (Ga(cg));p.file(`${k}.png`,l);h&&p.file(`${k}.chi`,h.bytes);m&&p.file(`${k}.aco`,m);l=await p.generateAsync({type:"blob"});Ga(ce).saveAs(l,`${k}.zip`)}var f=this,e=!1;a.rotation=a.rotation||0;this.save=function(k={}){var l,h,m,p;let q=null!=(l=k.zip)&&l,r=null!=(h=k.saveUrl)&&h,u=null!=(m=k.savedb)&&m;k=u?null:function(y){for(var C=new Uint8Array(y.length),w=0;w<y.length;w++)C[w]=y.charCodeAt(w);return C}(a.artwork.getFlatPNG(a.rotation));var v=u?null:new Blob([k],{type:"image/png"});k=null;(function(y,
C={}){return C=C||{},new Promise((w,D)=>{setTimeout(()=>{let x=y.getLayersRoot().getLinearizedLayerList(!1);setTimeout(()=>{var G,H;let N,B=new (Ga(Me).Deflate)({level:7}),P=[],V=new Uint8Array(8),L=C.forceOldVersion?0:function(aa){for(let ma of aa.getLayersRoot().getLinearizedLayerList(!1))if(ma instanceof cb||ma.mask||ma.clip||ma.blendMode>R.LM_LAST_CHIBIPAINT||ma.blendMode===R.LM_MULTIPLY)return 10;return 0}(y),ia=0===(H=Mf(L)).major&&0===H.minor?"ChibiPaint v0.0":"ChickenPaint v"+H.major+"."+
H.minor;H=Promise.resolve();B.onData=function(aa){P.push(aa)};for(let aa=0;aa<8;aa++)V[aa]="CHIBIOEK".charCodeAt(aa);for(let aa of(P.push(V),B.push((G=x.length,(N=Le("HEAD",Ke.FIXED_HEADER_LENGTH)).writeU32BE(L),N.writeU32BE(y.width),N.writeU32BE(y.height),N.writeU32BE(G),N.getAsDataArray()),!1),x))H=H.then(()=>new Promise(function(ma){var ca=B.push;var ra=aa;var ka,qa=(new TextEncoder).encode(ra.name),M=ra instanceof Da,A=4*(M?5:6),K=qa.length;let S=Le(M?"LAYR":"GRUP",A+K+((M?ra.image.data.length:
0)+(ra.mask?ra.mask.data.length:0))),na=0,Z;ra.visible&&(na|=1);M&&ra.clip&&(na|=2);ra.mask&&(na|=4);ra.maskLinked&&(na|=8);ra.maskVisible&&(na|=16);ra.lockAlpha&&(na|=64);!M&&ra.expanded&&(na|=32);ra.blendMode===R.LM_MULTIPLY2?(Z=R.LM_MULTIPLY,na|=128):Z=ra.blendMode;S.writeU32BE(A+K);S.writeU32BE(Z);S.writeU32BE(ra.alpha);S.writeU32BE(na);S.writeU32BE(qa.length);M||S.writeU32BE(ra.layers.length);S.data.set(qa,S.pos);S.pos+=qa.length;if(M){qa=S.pos;M=S.data;A=ra.image.data;for(K=0;K<A.length;K+=
I.BYTES_PER_PIXEL)M[qa++]=A[K+I.ALPHA_BYTE_OFFSET],M[qa++]=A[K+I.RED_BYTE_OFFSET],M[qa++]=A[K+I.GREEN_BYTE_OFFSET],M[qa++]=A[K+I.BLUE_BYTE_OFFSET];S.pos=qa}ra=(ra.mask&&(ka=ra.mask,S.data.set(ka.data,S.pos),S.pos+=ka.data.length),S.getAsDataArray());ca.call(B,ra,!1);setTimeout(ma,50)}));H.then(()=>new Promise((aa,ma)=>{B.onEnd=function(ca){if(0===ca){if("u">typeof Blob)var ra={bytes:new Blob(P,{type:"application/octet-stream"}),version:ia};else{ca=new Uint8Array(P.map(qa=>qa.byteLength).reduce((qa,
M)=>qa+M,0));let ka=0;for(ra of P)ca.set(ra,ka),ka+=ra.byteLength;ra={bytes:ca,version:ia}}w(ra)}else D(ca)};B.push(Le("ZEND",0).getAsDataArray(),!0)})).catch(D)},0)},1)})})(a.artwork).then(function(y){if(e)return void f.emitEvent("savingFailure");if(p=a.swatches?new Blob([(new pd).write(a.swatches)],{type:"application/octet-stream"}):null,a.url){var C=new FormData;C.append("beginMarker","This marker ensures the upload wasn't truncated");C.append("painter","ChickenPaint v2.0");C.append("picture",
v);v=null;y?(C.append("chibifileFormat",y.version),C.append("chibifile",y.bytes),C.append("rotation",""+a.rotation)):C.append("rotation","0");p&&(C.append("swatches",p),p=null);C.append("endMarker","This marker ensures the upload wasn't truncated");b(C)}else C="oekaki_"+(new Date).toISOString().split(".")[0].replace(/[^0-9]/g,"_"),r||u||Ue(),q?n(C,v,y,p):u?nh(y.bytes,p):Ga(ce).saveAs(v,C+".png")}).catch(function(y){f.emitEvent("savingFailure")})};this.cancel=function(){e=!0}}function ph(a,c,d){function b(){var H=
l.width/2,N=l.height/2;if(h.fillStyle="white",h.fillRect(0,0,l.width,l.height),w==C.length){var B=r.width,P=r.height,V=Math.round(H-B/2),L=Math.round(N-P/2);h.drawImage(r,V,L);var ia=D;n||((n=document.createElement("canvas")).width=B,n.height=P,e=n.getContext("2d"));e.globalCompositeOperation="copy";e.drawImage(m,0,0);f||((f=document.createElement("canvas")).width=B,f.height=P,k=f.getContext("2d"));k.globalCompositeOperation="copy";k.drawImage(y,0,0);k.globalCompositeOperation="source-in";k.drawImage(y,
0,Math.round(170*ia));e.globalCompositeOperation="source-over";e.drawImage(f,0,0);e.drawImage(p,0,0);e.globalCompositeOperation="screen";e.drawImage(v,0,0);e.globalCompositeOperation="multiply";e.drawImage(u,0,0);h.globalAlpha=.88;h.drawImage(n,V,L);h.globalAlpha=1;h.drawImage(q,V,L);N=Math.round(N+P/2+2)}if(""!=x)for(h.fillStyle="black",ia=x.split("\n"),B=0;B<ia.length;B++)P=ia[B],V=h.measureText(P).width,N+=28,h.fillText(P,H-V/2,N)}function g(){l.width=l.clientWidth;l.height=l.clientHeight;h.font=
"14pt sans-serif";b()}var n,f,e,k,l=document.createElement("canvas"),h=l.getContext("2d"),m=new Image,p=new Image,q=new Image,r=new Image,u=new Image,v=new Image,y=new Image,C=[m,p,q,r,u,v,y],w=0,D=0,x="";d+="splash/";for(var G=0;G<C.length;G++)C[G].onload=function(){++w==C.length&&b()};m.src=d+"cup.png";v.src=d+"highlights.png";p.src=d+"lid.png";q.src=d+"lines.png";u.src=d+"shading.png";y.src=d+"smoothie.png";r.src=d+"text.png";c.on("loadingProgress",function(H,N){D=H;x=N;b()});c.on("loadingFailure",
function(H){D=0;x=H;b()});c.on("loadingComplete",function(){window.removeEventListener("resize",g);a.removeChild(l)});window.addEventListener("resize",g);l.className="chickenpaint-splash-screen";a.appendChild(l);g()}function dg(a){for(var c={DELETE:46,BACKSPACE:8,TAB:9,ENTER:13,ESCAPE:27," ":32,ARROWLEFT:37,ARROWUP:38,ARROWRIGHT:39,ARROWDOWN:40,SHIFT:16,"[":219,"]":221,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,0:48,"-":189,"=":187,"+":187,";":187,META:91,LEFTMETA:91,RIGHTMETA:91,ALT:18,ALTGRAPH:18,
OPTION:18,CONTROL:17},d=65;d<=90;d++)c[String.fromCharCode(d)]=d;if((a=a.toUpperCase())in c)return c[a]}function eg(){let a,c,d,b,g,n,f,e;this.x0=this.y0=this.x1=this.y1=this.x2=this.y2=this.x3=this.y3=0;let k=l=>{let h=3*l,m=h*l;l*=l*l;let p=2*m,q=6*l,r=this.x0-2*this.x1+this.x2,u=this.y0-2*this.y1+this.y2,v=3*(this.x1-this.x2)-this.x0+this.x3,y=3*(this.y1-this.y2)-this.y0+this.y3;a=this.x0;g=this.y0;c=(this.x1-this.x0)*h+r*m+v*l;n=(this.y1-this.y0)*h+u*m+y*l;d=r*p+v*q;f=u*p+y*q;b=v*q;e=y*q};this.compute=
(l,h,m)=>{k(1/m);l[0]=a;h[0]=g;for(let p=1;p<m;p++)a+=c,g+=n,c+=d,n+=f,d+=b,f+=e,l[p]=a,h[p]=g}}function fg(a,c,d,b){var g,n=0;return"boolean"!=typeof c&&(b=d,d=c,c=void 0),function(){function f(){n=+new Date;d.apply(e,l)}var e=this,k=new Date-n,l=arguments;b&&!g&&f();g&&clearTimeout(g);void 0===b&&k>a?f():!0!==c&&(g=setTimeout(b?function(){g=void 0}:f,void 0===b?a-k:a))}}function gd(a){this.points=a||[]}function yb(a,c){this.x=a;this.y=c}function gg(a){for(var c=document.createElement("canvas"),
d=c.getContext("2d"),b=d.createImageData(64,64),g=b.data,n=0,f=0;f<64;f++)for(var e=0;e<64;e++)(8&e)!=0!=((8&f)!=0)?(g[n++]=255,g[n++]=255,g[n++]=255):(g[n++]=204,g[n++]=204,g[n++]=204),g[n++]=255;return c.width=64,c.height=64,d.putImageData(b,0,0),a.createPattern(c,"repeat")}function de(a,c){c+="Style";a.globalCompositeOperation="exclusion";"exclusion"==a.globalCompositeOperation?a[c]="white":(a.globalCompositeOperation="difference",a[c]="#888","difference"!=a.globalCompositeOperation&&(a[c]="black"))}
function Ld(a){function c(){var u=a?d.clientHeight:d.clientWidth;m=k/(f-n)*u;u=(e-n)/(f-n)*(u-m);g.style[a?"height":"width"]=m+"px";b.style[a?"height":"width"]=m+"px";b.style[a?"top":"left"]=u+"px"}let d=document.createElement("div"),b=document.createElement("div"),g=document.createElement("div"),n=0,f=1,e=0,k=1,l=10,h=!1,m=1,p=!1,q,r=this;this.setValues=function(u,v,y,C){e=u;k=v;n=y;f=C;c()};this.setBlockIncrement=function(u){l=u};this.setUnitIncrement=function(u){};this.getElement=function(){return d};
this.getValueIsAdjusting=function(){return h};d.className="chickenpaint-scrollbar "+(a?"chickenpaint-scrollbar-vertical":"chickenpaint-scrollbar-horizontal");b.className="chickenpaint-scrollbar-handle";b.setAttribute("touch-action","none");g.className="chickenpaint-scrollbar-handle-inner";b.appendChild(g);d.appendChild(b);b.addEventListener("pointerdown",function(u){u.stopPropagation();q=a?u.pageY-d.offsetTop-window.scrollY:u.pageX-d.offsetLeft-window.scrollX;b.setPointerCapture(u.pointerId);b.classList.add("dragging");
p=!0});b.addEventListener("pointermove",function(u){p&&(h=!0,u=a?u.pageY-d.offsetTop-window.scrollY:u.pageX-d.offsetLeft-window.scrollX,e+=(u-q)*(f-n)/((a?d.clientHeight:d.clientWidth)-m),e=Math.min(Math.max(e,n),f),q=u,r.emitEvent("valueChanged",[e]),c(),h=!1)});b.addEventListener("pointerup",function(u){if(u.stopPropagation(),p){try{b.releasePointerCapture(u.pointerId)}catch(v){}b.classList.remove("dragging");p=!1}});b.addEventListener("click",function(u){u.stopPropagation()});d.addEventListener("click",
function(u){this==d&&((a?u.pageY-d.offsetTop-window.scrollY:u.pageX-d.offsetLeft-window.scrollX)<parseInt(b.style[a?"top":"left"],10)?e-=l:e+=l,r.emitEvent("valueChanged",[e]),c())})}function Vb(){this.modes=[]}function ee(a){function c(){}function d(){}function b(){this.shouldPaintBrushPreview=!1;this.oldPreviewRect=null}function g(){b.call(this);this.smoothMouse={x:0,y:0}}function n(){var F,U;this.mouseDown=function(fa,xa,Fa){if(!this.capture&&0==xa&&!fa.altKey&&!Ga(Xa).isPressed("space")&&y())return this.capture=
!0,F=U={x:mb+.5,y:eb+.5},this.eraseBrushPreview(),!0};this.mouseDrag=function(fa){if(this.capture){var xa=new za(Math.min(F.x,U.x)-1-1,Math.min(F.y,U.y)-1-1,Math.max(F.x,U.x)+1+1+1,Math.max(F.y,U.y)+1+1+1);if(U={x:mb+.5,y:eb+.5},fa.shiftKey){var Fa=Math.PI/4;fa=Math.round(Math.atan2(U.y-F.y,U.x-F.x)/Fa);switch(fa){case 0:case 4:U.y=F.y;break;case 2:case 6:U.x=F.x;break;default:fa*=Fa,Fa=Math.sqrt((U.y-F.y)*(U.y-F.y)+(U.x-F.x)*(U.x-F.x)),U.x=F.x+Fa*Math.cos(fa),U.y=F.y+Fa*Math.sin(fa)}}return xa.union(new za(Math.min(F.x,
U.x)-1-1,Math.min(F.y,U.y)-1-1,Math.max(F.x,U.x)+1+1+1,Math.max(F.y,U.y)+1+1+1)),M(xa),!0}this.mouseMove.call(this,fa)};this.mouseUp=function(fa,xa,Fa){if(this.capture&&0==xa)return fa=D(F),xa=D(U),this.capture=!1,this.drawLine(fa,xa),M(new za(Math.min(F.x,U.x)-1-1,Math.min(F.y,U.y)-1-1,Math.max(F.x,U.x)+1+1+1,Math.max(F.y,U.y)+1+1+1)),!0};this.paint=function(){this.capture?(ba.lineWidth=1,ba.beginPath(),ba.moveTo(F.x,F.y),ba.lineTo(U.x,U.y),ba.stroke()):b.prototype.paint.call(this)};b.call(this)}
function f(){let F=0,U,fa,xa,Fa;this.mouseDown=function(sa,La,db){if(!this.capture&&0==La&&!sa.altKey&&!Ga(Xa).isPressed("space")&&y())return sa=D({x:mb,y:eb}),F=0,U=fa=xa=Fa=sa,this.capture=!0,this.eraseBrushPreview(),!0};this.mouseDrag=function(sa){if(this.capture&&0===F)return xa=Fa=D({x:mb,y:eb}),S.repaintAll(),!0;this.mouseMove.call(this,sa)};this.mouseUp=function(sa,La,db){if(this.capture&&0==La){switch(F){case 0:F=1;break;case 1:F=2;break;case 2:this.capture=!1;La=U;db=fa;let Ib=xa,oc=Fa;sa=
new eg;sa.x0=La.x;sa.y0=La.y;sa.x1=db.x;sa.y1=db.y;sa.x2=Ib.x;sa.y2=Ib.y;sa.x3=oc.x;sa.y3=oc.y;La=Array(500);db=Array(500);sa.compute(La,db,500);Ka.beginStroke(La[0],db[0],1);for(sa=1;sa<500;sa++)Ka.continueStroke(La[sa],db[sa],1);Ka.endStroke();S.repaintAll()}return!0}};this.mouseMove=function(sa,La){if(this.capture)return sa=D({x:mb,y:eb}),1==F?fa=sa:2==F&&(xa=sa),S.repaintAll(),!0;b.prototype.mouseMove.call(this,sa,La)};this.paint=function(){if(this.capture){var sa=new eg;let La=H(U),db=H(fa),
Ib=H(xa),oc=H(Fa);sa.x0=La.x;sa.y0=La.y;sa.x1=db.x;sa.y1=db.y;sa.x2=Ib.x;sa.y2=Ib.y;sa.x3=oc.x;sa.y3=oc.y;let Ic=Array(100),lc=Array(100);sa.compute(Ic,lc,100);ba.beginPath();ba.moveTo(Ic[0],lc[0]);for(sa=1;sa<100;sa++)ba.lineTo(Ic[sa],lc[sa]);ba.moveTo(~~La.x,~~La.y);ba.lineTo(~~db.x,~~db.y);ba.moveTo(~~Ib.x,~~Ib.y);ba.lineTo(~~oc.x,~~oc.y);ba.stroke()}else b.prototype.paint.call(this)};b.call(this)}function e(){var F;this.mouseDown=function(U,fa,xa){return!!this.capture||(Ga(Xa).isPressed("space")||
(0!=fa||this.transient&&!U.altKey)&&2!=fa?void(this.transient&&Q.pop()):(F=fa,this.capture=!0,u("crosshair"),this.mouseDrag(U),!0))};this.mouseDrag=function(U){if(this.capture)return U=D({x:mb,y:eb}),Ka.isPointWithin(U.x,U.y)&&a.setCurColor(new lb(Ka.colorPicker(U.x,U.y))),!0};this.mouseUp=function(U,fa,xa){if(this.capture&&fa==F)return F=-1,this.capture=!1,u("default"),this.transient&&Q.pop(),!0};this.enter=function(){c.prototype.enter.call(this);F=-1}}function k(){var F,U,fa,xa;this.keyDown=function(Fa){if(!Fa.ctrlKey&&
!Fa.metaKey&&" "===Fa.key)return this.capture||u("grab"),!0};this.keyUp=function(Fa){if(this.transient&&1!=xa&&" "===Fa.key)return u("default"),Q.pop(),!0};this.mouseDown=function(Fa,sa,La){return!!this.capture||(1==sa||Ga(Xa).isPressed("space")&&!Fa.ctrlKey&&!Fa.metaKey&&0==sa||!this.transient&&0==sa?(this.capture=!0,xa=sa,F=Fa.pageX,U=Fa.pageY,fa=S.getOffset(),u("grab"),!0):void(this.transient&&Q.pop()))};this.mouseDrag=function(Fa){if(this.capture)return S.setOffset(fa.x+Fa.pageX-F,fa.y+Fa.pageY-
U),!0};this.mouseUp=function(Fa,sa,La){if(this.capture&&sa==xa)return xa=-1,this.capture=!1,Q.peek()!==this||(this.transient&&!Ga(Xa).isPressed("space")?(u("default"),Q.pop()):u("grab"),!0)};this.enter=function(){u("grab")}}function l(){}function h(){var F,U=new za(0,0,0,0),fa=-1;let xa=!1;this.mouseDown=function(Fa,sa,La){La=a.mainGUI.getPaletteManager().palettes.brush.getElement().querySelector("#chickenpaint-s-maintainAspectCheckbox");if(La&&La instanceof HTMLInputElement&&(xa=La.checked),!this.capture&&
0==sa&&!Fa.altKey&&!Ga(Xa).isPressed("space"))return Fa=x({x:mb,y:eb}),fa=sa,U.makeEmpty(),F=Fa,S.repaintAll(),this.capture=!0,!0};this.mouseDrag=function(Fa){if(!this.capture)return!1;let sa=x({x:mb,y:eb});Fa=Fa.shiftKey||xa;let La=~~Math.max(Math.abs(sa.x-F.x),Math.abs(sa.y-F.y));return sa.x>=F.x?(U.left=F.x,U.right=(Fa?F.x+La:sa.x)+1):(U.left=Fa?F.x-La:sa.x,U.right=F.x+1),sa.y>=F.y?(U.top=F.y,U.bottom=(Fa?F.y+La:sa.y)+1):(U.top=Fa?F.y-La:sa.y,U.bottom=F.y+1),S.repaintAll(),!0};this.mouseUp=function(Fa,
sa,La){if(this.capture&&sa==fa)return Ka.rectangleSelection(U),U.makeEmpty(),S.repaintAll(),this.capture=!1,fa=-1,!0};this.paint=function(){U.isEmpty()||(ba.lineWidth=1,P(ba,B(U)))}}function m(){var F,U,fa=!1;this.mouseDown=function(xa,Fa,sa){if(!this.capture&&0==Fa&&!Ga(Xa).isPressed("space")&&v())return F=D({x:mb,y:eb}),U=xa.altKey,fa=!0,this.capture=!0,!0};this.mouseDrag=fg(25,function(xa){if(this.capture){xa=D({x:mb,y:eb});var Fa=xa.x-F.x,sa=xa.y-F.y,La=~~Fa,db=~~sa;return(0!=La||0!=db)&&(Ka.move(La,
db,U&&fa),fa=!1),F.x=xa.x-(Fa-La),F.y=xa.y-(sa-db),!0}});this.mouseUp=function(xa,Fa,sa){if(this.capture&&0==Fa)return this.capture=!1,this.transient&&Q.pop(),!0}}function p(){function F(Aa,Ia){return{x:(Aa.x+Ia.x)/2,y:(Aa.y+Ia.y)/2}}function U(Aa){return{x:Math.round(Aa.x),y:Math.round(Aa.y)}}function fa(Aa,Ia){for(var Oa=0;Oa<Aa.points.length;Oa++)if((Ia.x-Aa.points[Oa].x)*(Ia.x-Aa.points[Oa].x)+(Ia.y-Aa.points[Oa].y)*(Ia.y-Aa.points[Oa].y)<=49)return 2*Oa;for(Oa=0;Oa<Aa.points.length;Oa++){var jb=
Aa.points[Oa],Za=Aa.points[(Oa+1)%Aa.points.length];Za=new yb(Za.x-jb.x,Za.y-jb.y);jb=new yb(Ia.x-jb.x,Ia.y-jb.y);var sc=Za.getLength(),hd=Za.getScaled(1/sc);sc=jb.getScaled(1/sc);hd=hd.getDotProduct(sc);if(hd>=0&&hd<=1&&(Za.scale(hd),(Za.x-jb.x)*(Za.x-jb.x)+(Za.y-jb.y)*(Za.y-jb.y)<=49))return 2*Oa+1}return Aa.containsPoint(Ia)?-3:-2}function xa(){var Aa=db.getTransformed(Ta),Ia=fa(Aa,{x:mb,y:eb});switch(Ia){case 0:case 2:case 4:case 6:Ia=~~(Ia/2);let Oa=Aa.points[Ia],jb=Aa.points[(Ia+1)%4];Fa(yb.subtractPoints(Aa.points[(Ia+
3)%4],Oa).normalize().add(yb.subtractPoints(jb,Oa).normalize()));break;case 1:case 3:case 5:case 7:Fa(yb.subtractPoints(Aa.points[(~~(Ia/2)+1)%4],Aa.points[~~(Ia/2)]).getPerpendicular());break;case -3:Ga(Xa).isPressed("r")||Ga(Xa).isPressed("space")||u("move");break;case -2:Ga(Xa).isPressed("r")||Ga(Xa).isPressed("space")||u("grab");break;default:u("default")}}function Fa(Aa){Aa=Math.floor(Math.atan2(-Aa.y,Aa.x)/(Math.PI/4)+.5);switch(Aa<0&&(Aa+=4),Aa){default:Aa="ew-resize";break;case 1:Aa="nesw-resize";
break;case 2:Aa="ns-resize";break;case 3:Aa="nwse-resize"}u(Aa)}var sa,La,db,Ib,oc,Ic,lc=-1;let fe=!1;this.mouseDown=function(Aa,Ia,Oa){Oa=a.mainGUI.getPaletteManager().palettes.brush.getElement().querySelector("#chickenpaint-t-maintainAspectCheckbox");if(Oa&&Oa instanceof HTMLInputElement&&(fe=Oa.checked),!this.capture&&0==Ia&&!Aa.altKey&&!Ga(Xa).isPressed("space"))return lc=fa(db.getTransformed(Ta),{x:mb,y:eb}),oc=D(Ib={x:mb,y:eb}),this.capture=!0,xa(),!0};this.mouseDrag=fg(40,function(Aa){if(this.capture){var Ia=
{x:mb,y:eb};switch(lc){case -3:Aa=U(D(Ia));var Oa=yb.subtractPoints(Aa,oc);Ia=Oa.getTruncated();Oa=Oa.subtract(Ia);var jb=new sb;jb.translate(Ia.x,Ia.y);sa.preMultiply(jb);oc=yb.subtractPoints(Aa,Oa);break;case -2:jb=Math.PI/4;Oa=db.getCenter();var Za=H(Oa),sc=Math.atan2(Ia.y-Za.y,Ia.x-Za.x)-Math.atan2(Ib.y-Za.y,Ib.x-Za.x);Za=new sb;Ic+=sc;Aa=Aa.shiftKey?-sa.decompose().rotate+Math.round(Ic/jb)*jb:sc;Eb&&(Aa=-Aa);Za.rotateAroundPoint(Aa,Oa.x,Oa.y);sa.preMultiply(Za);Ib=Ia;break;case 0:case 2:case 4:case 6:jb=
~~(lc/2);Oa=La.points[jb];Za=sa.getInverted().getTransformedPoint(U(D(Ia)));Ia=La.points[(jb+2)%4];jb=(Za.x-Ia.x)/(Oa.x-Ia.x);Oa=(Za.y-Ia.y)/(Oa.y-Ia.y);if(.001>Math.abs(jb)||.001>Math.abs(Oa)||isNaN(jb)||isNaN(Oa))return!0;if(fe||Aa.shiftKey)Oa=jb=Aa=Math.max(jb,Oa);sa.scaleAroundPoint(jb,Oa,Ia.x,Ia.y);break;case 1:case 5:case 3:case 7:Aa=~~(lc/2);Za=F(La.points[Aa],La.points[(Aa+1)%4]);Ia=sa.getInverted().getTransformedPoint(U(D(Ia)));Aa=F(La.points[(Aa+2)%4],La.points[(Aa+3)%4]);Za=yb.subtractPoints(Za,
Aa);Ia=yb.subtractPoints(Ia,Aa);sc=Za.getLength();Ia=Za.getDotProduct(Ia)/sc/sc;if(.001>Math.abs(Ia)||isNaN(Ia))return!0;1==lc||5==lc?(Oa=1,jb=Ia):(Oa=Ia,jb=1);sa.scaleAroundPoint(Oa,jb,Aa.x,Aa.y)}return db=La.getTransformed(sa),Ka.transformAffineAmend(sa),S.repaintAll(),!0}});this.mouseUp=function(Aa,Ia,Oa){if(this.capture&&0==Ia)return this.capture=!1,lc=-1,!0};this.mouseMove=function(){this.capture||xa()};this.paint=function(){var Aa=db.getTransformed(Ta).points,Ia=Array(2*Aa.length);for(var Oa=
0;Oa<Aa.length;Oa++)Ia[Oa]=Aa[Oa];for(let Za=0;Za<Aa.length;Za++){Oa=Aa[Za];var jb=Aa[(Za+1)%Aa.length];Ia[Za+Aa.length]={x:(Oa.x+jb.x)/2,y:(Oa.y+jb.y)/2}}de(ba,"fill");for(Oa=0;Oa<Ia.length;Oa++)ba.fillRect(Ia[Oa].x-3,Ia[Oa].y-3,7,7);P(ba,Aa)};this.keyDown=function(Aa){if("Enter"===Aa.key){if(!va&&!Ja)return a.actionPerformed({action:"CPTransformAccept"}),!0}else if("Escape"===Aa.key)return a.actionPerformed({action:"CPTransformReject"}),!0};this.enter=function(){c.prototype.enter.call(this);var Aa,
Ia=Ka.transformAffineBegin();sa=Ia.transform;Ia.rect;(Aa=Ia.selection).isEmpty()&&(Aa=Ia.rect.clone());db=(La=new gd(Aa.toPoints())).getTransformed(sa);lc=-1;Ic=0;S.repaintAll()};this.leave=function(){c.prototype.leave.call(this);S.repaintAll()};this.moveByKey=function(Aa,Ia){var Oa;if(sa){var jb=new sb;jb.translate(Aa,Ia);sa.preMultiply(jb);db=La.getTransformed(sa);Ka.transformAffineAmend(sa);null==(Oa=this.repaintAll)||Oa.call(this)}}}function q(){var F,U,fa=0,xa=!1,Fa=-1;this.mouseDown=function(sa,
La,db){return!!this.capture||(!this.transient&&0==La&&!sa.altKey&&!Ga(Xa).isPressed("space")||0==La&&!sa.altKey&&!Ga(Xa).isPressed("space")&&Ga(Xa).isPressed("r")?(F={x:mb,y:eb},fa=S.getRotation(),U=Ta.clone(),Eb&&ca(U),xa=!1,this.capture=!0,Fa=La,u("grab"),!0):void(this.transient&&Q.pop()))};this.mouseDrag=function(sa){if(this.capture){var La=X.clientWidth/2,db=X.clientHeight/2;sa=X.width/2;var Ib=X.height/2;La=Math.atan2(eb-db,mb-La)-Math.atan2(F.y-db,F.x-La);db=new sb;return db.rotateAroundPoint(La,
sa,Ib),db.multiply(U),S.setRotation(fa+La),S.setOffset(~~db.getTranslateX(),~~db.getTranslateY()),xa=!0,!0}};this.enter=function(){u("grab")};this.mouseUp=function(sa,La,db){if(this.capture&&La==Fa){if(xa){sa=Math.round(qb/(Math.PI/2))*Math.PI/2;if(Math.abs(qb-sa)<5/180*Math.PI){db=sa-fa;sa=X.width/2;La=X.height/2;let Ib=new sb;Ib.rotateAroundPoint(db,sa,La);Ib.multiply(U);S.setRotation(fa+db);S.setOffset(~~Ib.getTranslateX(),~~Ib.getTranslateY());S.repaintAll()}S.emitEvent("canvasRotated90",[S.getRotation90()])}else S.resetRotation();
return this.capture=!1,this.transient&&!Ga(Xa).isPressed("r")?(u("default"),Q.pop()):u("grab"),!0}};this.keyUp=function(sa){if(this.transient&&1!=Fa&&"r"===sa.key.toLowerCase())return u("default"),Q.pop(),!0};this.keyDown=function(sa){if("r"===sa.key.toLowerCase())return!0}}function r(){n.call(this)}function u(F){X.getAttribute("data-cursor")!=F&&X.setAttribute("data-cursor",F)}function v(){var F=Ka.getActiveLayer();return F.visible&&F.ancestorsAreVisible()?0!=F.alpha||(a.showLayerNotification(F,
W("Whoops! This layer's opacity is currently 0%"),"opacity"),!1):(a.showLayerNotification(F,W("Whoops! This layer is currently hidden"),"layer"),!1)}function y(){var F=Ka.getActiveLayer();return F instanceof cb&&!Ka.isEditingMask()?(a.showLayerNotification(F,W("Whoops! You can't draw on a group"),"layer"),!1):v()}function C(F,U,fa,xa,Fa){F.setValues(-Fa,xa,U-xa-Fa+fa/4,U+fa-Fa-fa/4);F.setBlockIncrement(Math.max(1,~~(.66*xa)));F.setUnitIncrement(Math.max(1,~~(.05*xa)))}function w({resetViewFlip:F=
!1}={}){(Ta.setToIdentity(),Ta.translate(Db,kb),Ta.scale(Ua,Ua),Ta.rotate(qb),Eb&&!F&&ca(Ta),null==da||null==ja||da.getValueIsAdjusting()||ja.getValueIsAdjusting())||(F=V(new za(0,0,Ea.width,Ea.height)),C(da,F.left,F.getWidth(),X.clientWidth,S.getOffset().x),C(ja,F.top,F.getHeight(),X.clientHeight,S.getOffset().y));S.repaintAll()}function D(F){return Ta.getInverted().getTransformedPoint(F)}function x(F){F=D(F);return F.x=Math.floor(F.x),F.y=Math.floor(F.y),F}function G(F){var U=X.getBoundingClientRect();
return{x:F.x-U.left-window.pageXOffset,y:F.y-U.top-window.pageYOffset}}function H(F){return Ta.getTransformedPoint(F)}function N(F){F=H(F);return F.x=Math.round(F.x),F.y=Math.round(F.y),F}function B(F){var U=H({x:(F.left+F.right)/2,y:(F.top+F.bottom)/2});F=F.toPoints();for(var fa=0;fa<F.length;fa++)F[fa]=N(F[fa]),F[fa].x+=.5*Math.sign(U.x-F[fa].x),F[fa].y+=.5*Math.sign(U.y-F[fa].y);return F}function P(F,U){F.beginPath();F.moveTo(U[0].x,U[0].y);for(var fa=1;fa<U.length;fa++)F.lineTo(U[fa].x,U[fa].y);
F.lineTo(U[0].x,U[0].y);F.stroke()}function V(F){var U=N({x:F.left-1,y:F.top-1}),fa=N({x:F.left-1,y:F.bottom}),xa=N({x:F.right,y:F.top-1});F=N({x:F.right,y:F.bottom});U=new za(Math.min(Math.min(U.x,fa.x),Math.min(xa.x,F.x)),Math.min(Math.min(U.y,fa.y),Math.min(xa.y,F.y)),Math.max(Math.max(U.x,fa.x),Math.max(xa.x,F.x))+1,Math.max(Math.max(U.y,fa.y),Math.max(xa.y,F.y))+1);return U.grow(2,2),U}function L(){var F=X.width,U=X.height,fa=H({x:Ka.width/2,y:Ka.height/2});S.setOffset(Math.round(Db+F/2-fa.x),
Math.round(kb+U/2-fa.y))}function ia(F,U,fa){if(F=Math.max(.1,Math.min(8,F)),S.getZoom()!=F){var xa=S.getOffset();S.setOffset(xa.x+~~((U-xa.x)*(1-F/S.getZoom())),xa.y+~~((fa-xa.y)*(1-F/S.getZoom())));S.setZoom(F);S.repaintAll()}}function aa(F,U=!0){let fa=X.clientWidth,xa=X.clientHeight;U&&(U=parseFloat(F),.01>Math.abs(U-1)?F=1:.2>Math.abs(U-2)?F=2:.08>Math.abs(U-.5)&&(F=.5));ia(F,fa/2,xa/2)}function ma(F){return"mouse"===F.pointerType&&0!==F.buttons&&0===F.pressure?1:"touch"===F.pointerType?(0!==
F.pressure&&($b=!0),$b)?2*F.pressure:1:2*F.pressure}function ca(F){let U=Ka.width/2;F.translate(U,0);F.scale(-1,1);F.translate(-U,0)}function ra(F){let U=F[0].pageX-F[1].pageX;F=F[0].pageY-F[1].pageY;return Math.sqrt(U*U+F*F)}function ka(F){if(!(K||=X.getBoundingClientRect(),pc&&!fc&&"touch"===F.pointerType||xc>1&&"touch"===F.pointerType||Ga(Xa).isPressed("z")||F.ctrlKey&&Ga(Xa).isPressed("space"))){mb=F.clientX-K.left;eb=F.clientY-K.top;var U=ob?ma(F):0;(1&F.buttons)!=0!=pb[0]&&(pb[0]=!pb[0],pb[0]?
Q.mouseDown(F,0,U):Q.mouseUp(F,0,U));(2&F.buttons)!=0!=pb[2]&&(pb[2]=!pb[2],pb[2]?Q.mouseDown(F,2,U):Q.mouseUp(F,2,U));(4&F.buttons)!=0!=pb[1]&&(pb[1]=!pb[1],pb[1]?Q.mouseDown(F,1,U):Q.mouseUp(F,1,U));ob?Q.mouseDrag(F,U):Q.mouseMove(F,U);pc||"pen"!==F.pointerType||(pc=!0)}}function qa(){Mc||(Mc=!0,window.requestAnimationFrame(function(){S.paint()}))}function M(F){Mb.union(F);qa()}function A(){Yb=Ka.getBounds();S.repaintAll()}let K,S=this,na=document.createElement("div"),Z=document.createElement("div"),
ha=document.createElement("div"),X=document.createElement("canvas"),ba=X.getContext("2d"),Ea=document.createElement("canvas"),Ha=Ea.getContext("2d"),xb=gg(ba),Ka=a.getArtwork(),Ua=1,Db=0,kb=0,qb=0,Ta=new sb,Wb=!1,wb=!1,ac=32,mb=0,eb=0,Hb=!1,pb=[!1,!1,!1],pc=!1,vc=!1,fc=!1,$b=!1,Yb=Ka.getBounds(),Mb=new za(0,0,0,0),Mc=!1,wc,ta,Zb,ic,Nb,Ec,Pa,bc,qc,E,O=[],Q=new Vb,Y,da=new Ld(!1),ja=new Ld(!0),va=null,Ja=null,hb=0,nc=255,hc=!0,Rb=!0,Lb=0,ob=!1;Math.sign=Math.sign||function(F){return 0==(F*=1)||isNaN(F)?
F:F>0?1:-1};c.prototype.transient=!1;c.prototype.capture=!1;c.prototype.enter=function(){u("default")};c.prototype.leave=function(){this.capture=!1};c.prototype.mouseMove=c.prototype.paint=c.prototype.mouseDown=c.prototype.mouseDrag=c.prototype.mouseUp=c.prototype.keyDown=c.prototype.suspend=c.prototype.resume=c.prototype.keyUp=function(){};d.prototype=Object.create(c.prototype);d.prototype.constructor=d;d.prototype.mouseDown=function(F,U,fa){var xa=Ga(Xa).isPressed("space");xa||2!=U&&(0!=U||F.ctrlKey||
F.metaKey||!F.altKey)?xa||0!=U||F.altKey||!Ga(Xa).isPressed("r")?1!=U&&(F.altKey||F.ctrlKey||F.metaKey||Ga(Xa).isPressed("z")||!xa||0!=U)||(Q.push(ic,!0),Q.peek().mouseDown(F,U,fa)):(Q.push(Nb,!0),Q.peek().mouseDown(F,U,fa)):(Q.push(Zb,!0),Q.peek().mouseDown(F,U,fa))};let Ob=null;d.prototype.keyDown=function(F){if(!F.altKey&&(!F.ctrlKey&&!F.metaKey&&Ga(Xa).isPressed("z")||F.ctrlKey&&Ga(Xa).isPressed("space")))return u("zoom-in"),Q.peek()===Y&&(Ob=Y,Q.pop()),F.preventDefault(),!0;if("r"===F.key.toLowerCase()&&
" "!==F.key)return Q.push(Nb,!0),Q.peek().keyDown(F),!0;if(" "===F.key&&(!F.ctrlKey&&!F.metaKey||"z"!==F.key.toLowerCase()))return Q.push(ic,!0),Q.peek().keyDown(F),F.preventDefault(),!0;if(Q.peek()===bc||Q.peek()===qc){if("Enter"===F.key){if(va||Ja)return;a.actionPerformed({action:"CPTransform"});F.preventDefault()}}else if((Q.peek()===ic||Q.peek()===Nb)&&"Enter"===F.key){if(va||Ja)return;a.actionPerformed({action:"CPResetZoomAndRotation"});F.preventDefault()}return!1};d.prototype.keyUp=function(F){" "!==
F.key&&"control"!==F.key.toLowerCase()&&"z"!==F.key.toLowerCase()||(u("default"),Ob&&(Q.setUserMode(Ob),Ob=null),F.preventDefault())};b.prototype=Object.create(c.prototype);b.prototype.constructor=b;b.prototype.getBrushPreviewOval=function(){let F=a.getBrushSize()*Ua/2;return new za(mb-F,eb-F,mb+F,eb+F)};b.prototype.queueBrushPreview=function(){if(Q.peek()==this){this.shouldPaintBrushPreview=!0;var F=this.getBrushPreviewOval();F.grow(2,2);null!=this.oldPreviewRect&&(F.union(this.oldPreviewRect),this.oldPreviewRect=
null);M(F)}};b.prototype.eraseBrushPreview=function(){this.shouldPaintBrushPreview=!1;null!=this.oldPreviewRect&&(M(this.oldPreviewRect),this.oldPreviewRect=null)};b.prototype.mouseMove=function(F,U){this.queueBrushPreview()};b.prototype.enter=function(){c.prototype.enter.call(this);Hb&&this.queueBrushPreview()};b.prototype.leave=function(){c.prototype.leave.call(this);this.eraseBrushPreview()};b.prototype.suspend=b.prototype.leave;b.prototype.resume=b.prototype.enter;b.prototype.paint=function(){if(this.shouldPaintBrushPreview){this.shouldPaintBrushPreview=
!1;var F=this.getBrushPreviewOval();ba.beginPath();ba.arc((F.left+F.right)/2,(F.top+F.bottom)/2,F.getWidth()/2,0,2*Math.PI);ba.stroke();F.grow(2,2);null==this.oldPreviewRect?this.oldPreviewRect=F:this.oldPreviewRect.union(F)}};g.prototype=Object.create(b.prototype);g.prototype.constructor=g;g.prototype.mouseDown=function(F,U,fa){if(!this.capture&&0==U&&!F.altKey&&!Ga(Xa).isPressed("space")&&y()&&(F=D({x:mb,y:eb}),this.eraseBrushPreview(),Ka.beginStroke(F.x,F.y,fa)))return this.capture=!0,this.smoothMouse=
F,!0};g.prototype.mouseDrag=function(F,U){if(("number"!=typeof navigator.maxTouchPoints||navigator.maxTouchPoints<3)&&b.prototype.mouseMove.call(this,F,U),this.capture){F=D({x:mb,y:eb});var fa=Math.min(.999,Math.pow(a.getBrushInfo().smoothing,.3));let xa=1-fa;return this.smoothMouse.x=xa*F.x+fa*this.smoothMouse.x,this.smoothMouse.y=xa*F.y+fa*this.smoothMouse.y,Ka.continueStroke(this.smoothMouse.x,this.smoothMouse.y,U),!0}this.mouseMove(F)};g.prototype.mouseUp=function(F,U,fa){if(this.capture)return 0==
U&&(this.capture=!1,Ka.endStroke()),!0};n.prototype=Object.create(b.prototype);n.prototype.constructor=n;n.prototype.drawLine=function(F,U){Ka.beginStroke(F.x,F.y,1);Ka.continueStroke(U.x,U.y,1);Ka.endStroke()};f.prototype=Object.create(b.prototype);f.prototype.constructor=f;e.prototype=Object.create(c.prototype);e.prototype.constructor=e;k.prototype=Object.create(c.prototype);k.prototype.constructor=k;this.setGrowFillArea=function(F=0){hb=Number(F)};this.setFoodFillAlpha=function(F=255){nc=Number(F)};
this.setFloodFillReferAllLayers=function(F){hc=!!F};l.prototype=Object.create(c.prototype);l.prototype.constructor=l;l.prototype.mouseDown=function(F,U,fa){if(0==U&&!F.altKey&&!Ga(Xa).isPressed("space")&&y())return F=D({x:mb,y:eb}),Ka.isPointWithin(F.x,F.y)&&(Ka.floodFill(F.x,F.y,hb,nc,hc),S.repaintAll()),!0};h.prototype=Object.create(c.prototype);h.prototype.constructor=h;m.prototype=Object.create(c.prototype);m.prototype.constructor=m;m.prototype.mouseMove=function(F){return Q.peek()!==this||(Ga(Xa).isPressed("r")&&
Ga(Xa).isPressed("space")||u("move"),!0)};m.prototype.enter=function(){Ga(Xa).isPressed("r")&&Ga(Xa).isPressed("space")||u("move")};p.prototype=Object.create(c.prototype);p.prototype.constructor=p;this.setModalShown=function(F){(va=!!F)||(Ja=!0,setTimeout(()=>Ja=!1,300))};document.addEventListener("keydown",function(F){let U=Q.peek(),fa=function(sa){if(!va){if(!sa)return null;switch(sa.toLowerCase()){case "arrowup":return{dx:0,dy:-1};case "arrowdown":return{dx:0,dy:1};case "arrowleft":return{dx:-1,
dy:0};case "arrowright":return{dx:1,dy:0};default:return null}}}(F.key);if(fa){var {dx:xa,dy:Fa}=fa;(Eb&&(xa=-xa),U===E)?(E.moveByKey(xa,Fa),F.preventDefault()):U===qc&&(Ka.move(xa,Fa,F.altKey),F.preventDefault())}});q.prototype=Object.create(c.prototype);q.prototype.constructor=q;r.prototype=Object.create(n.prototype);r.prototype.constructor=r;r.prototype.drawLine=function(F,U){Ka.gradientFill(Math.round(F.x),Math.round(F.y),Math.round(U.x),Math.round(U.y),a.getCurGradient())};r.prototype.queueBrushPreview=
function(){};this.setZoom=function(F){Ua=F;w()};this.getZoom=function(){return Ua};this.setGridSize=function(F){ac=Math.max(Math.round(F),1);this.repaintAll()};this.getGridSize=function(){return ac};this.setOffset=function(F,U){isNaN(F)||isNaN(U)?console.log("Bad offset"):(Db=F,kb=U,w())};this.getOffset=function(){return{x:Db,y:kb}};this.setInterpolation=function(F){Wb=F;ba&&(ba.imageSmoothingEnabled=F);this.repaintAll()};this.setRotation=function(F){qb=F%(2*Math.PI);w()};this.setRotationOnCenter=
function(F){let U=X.width/2,fa=X.height/2;var xa=F-qb;let Fa=Math.cos(xa);xa=Math.sin(xa);let sa=Db-U,La=kb-fa;Db=U+sa*Fa-La*xa;kb=fa+sa*xa+La*Fa;qb=F%(2*Math.PI);w()};this.getRotation=function(){return qb};this.getRotationDegrees=function(){return(180*this.getRotation()/Math.PI+180+360)%360-180};this.setRotationDegrees=function(F){this.setRotationOnCenter(F*Math.PI/180)};this.getRotation90=function(){var F=Math.round(this.getRotation()/Math.PI*2);return(F%=4)<0&&(F+=4),F};this.zoomIn=function(){aa(1.41*
this.getZoom())};this.zoomOut=function(){aa(.7092*this.getZoom())};this.zoom100=function(){aa(1);L()};this.zoomOnCenter=(F,U=!1)=>{aa(F,U)};this.resetRotation=function(){var F=X.width/2,U=X.height/2,fa=new sb;fa.rotateAroundPoint(-this.getRotation(),F,U);fa.multiply(Ta);Eb&&ca(fa);this.setOffset(~~fa.getTranslateX(),~~fa.getTranslateY());this.setRotation(0);S.emitEvent("canvasRotated90",[0])};this.resetZoomAndRotation=function(){this.zoom100();this.resetRotation();Eb=!1;w({resetViewFlip:!0})};this.isPanOrRotateMode=
function(){return vc};let yc=!1,Eb=!1;this.toggleViewFlip=()=>(Eb?(Eb=!1,w({resetViewFlip:!0})):(ca(Ta),Eb=!0,S.repaintAll()),Eb);let tc=!1,Cc=0,rd=0;X.addEventListener("pointerdown",F=>{!F.altKey&&(!F.ctrlKey&&!F.metaKey&&Ga(Xa).isPressed("z")||F.ctrlKey&&Ga(Xa).isPressed("space"))&&"touch"!==F.pointerType&&(tc=!0,Cc=F.clientX);(F.ctrlKey||F.metaKey)&&F.altKey&&1===F.buttons&&(F.clientX,rd=F.clientX)});X.addEventListener("pointermove",F=>{if(!F.altKey&&(!F.ctrlKey&&!F.metaKey&&Ga(Xa).isPressed("z")||
F.ctrlKey&&Ga(Xa).isPressed("space"))&&tc&&"touch"!==F.pointerType&&1===F.buttons){var U=F.clientX-Cc;if(Math.abs(U)>10){var fa=G({x:F.pageX,y:F.pageY});ia(S.getZoom()*(U>0?1.15:1/1.15),fa.x,fa.y);Cc=F.clientX}F.preventDefault()}(F.ctrlKey||F.metaKey)&&F.altKey&&1===F.buttons&&(U=F.clientX-rd,rd=F.clientX,fa=a.getBrushSize(),a.setBrushSize(fa+(fa<=10?U*(.08+.17*Math.pow(Math.min(1,Math.max(0,(fa-1)/9)),1.5)):.5*U)),F.preventDefault())});X.addEventListener("pointerup",F=>{"touch"!==F.pointerType&&
(tc=!1)});let ge=0,sd=1,xc=0,id=0,Md=0,Nd=!1;setInterval(()=>{Nd=!0},12E4);this.getElement=function(){return na};this.repaintAll=function(){Mb.left=0;Mb.top=0;Mb.right=X.width;Mb.bottom=X.height;qa()};this.paint=function(){var F=!1;if(Mc=!1,Mb.isEmpty()||(ba.save(),ba.clipTo&&(ba.beginPath(),Mb.left|=0,Mb.top|=0,ba.rect(Mb.left,Mb.top,Math.ceil(Mb.getWidth()),Math.ceil(Mb.getHeight())),ba.clip()),F=!0),!Yb.isEmpty()){var U=wc&&wc.isOpen()?wc.getImageData():Ka.fusionLayers().getImageData();Ha.putImageData(U,
0,0,Yb.left,Yb.top,Yb.getWidth(),Yb.getHeight());Yb.makeEmpty()}ba.fillStyle="#606060";ba.fillRect(0,0,X.width,X.height);ba.save();ba.setTransform(Ta.m[0],Ta.m[1],Ta.m[2],Ta.m[3],Ta.m[4],Ta.m[5]);ba.fillStyle=xb;ba.fillRect(0,0,Ka.width,Ka.height);ba.drawImage(Ea,0,0,Ea.width,Ea.height);ba.restore();de(ba,"stroke");ba.lineWidth=1;U=Ka.getSelection().isEmpty();if(Rb!==U&&a.mainGUI.getPaletteManager().updateDeselectIcon(),Rb=U,!(U||Q.peek()instanceof h&&Q.peek().capture)){if(![Ec,ic,Nb,E,Zb].includes(Q.peek())){U=
B(Ka.getSelection());U[0].x;U[1].x;U[2].x;U[3].x;U[0].y;U[1].y;U[2].y;U[3].y;U[0].x;U[1].x;U[2].x;U[3].x;U[0].y;U[1].y;U[2].y;U[3].y;ba.save();ba.globalCompositeOperation="source-over";ba.fillStyle="rgba(96, 96, 96, 0.035)";ba.beginPath();ba.rect(0,0,X.width,X.height);ba.moveTo(U[0].x,U[0].y);for(var fa=1;fa<U.length;fa++)ba.lineTo(U[fa].x,U[fa].y);ba.closePath();ba.fill("evenodd");ba.restore()}ba.setLineDash([3,2]);P(ba,B(Ka.getSelection()));ba.setLineDash([])}if(wb&&(U=Ka.getBounds(),Ua*ac>2)){ba.beginPath();
for(fa=ac-1;fa<U.right;fa+=ac){var xa=H({x:fa,y:U.top}),Fa=H({x:fa,y:U.bottom});ba.moveTo(xa.x+.5,xa.y+.5);ba.lineTo(Fa.x+.5,Fa.y+.5)}for(fa=ac-1;fa<U.bottom;fa+=ac)xa=H({x:0,y:fa}),Fa=H({x:U.right,y:fa}),ba.moveTo(xa.x+.5,xa.y+.5),ba.lineTo(Fa.x+.5,Fa.y+.5);ba.stroke()}Q.paint(ba);ba.globalCompositeOperation="source-over";F&&(Mb.makeEmpty(),ba.restore())};this.showGrid=function(F){wb=F;this.repaintAll()};this.resize=function(F,U){F-=ha.offsetHeight;F=Math.floor(F);X.style.height=F+"px";X.width=X.clientWidth;
X.height=F;K=null;U||L();this.setInterpolation(Wb);this.repaintAll()};a.on("toolChange",function(F,U){U=O[U.strokeMode];for(var fa=0;fa<Q.modes.length;fa++)if(Q.modes[fa]instanceof b){Q.modes[fa].leave();Q.modes[fa]=U;Q.modes[fa].enter();break}Y=U;Lb=F});a.on("modeChange",function(F){switch(F){case la.M_DRAW:var U=Y;break;case la.M_FLOODFILL:U=Ec;break;case la.M_GRADIENTFILL:U=Pa;break;case la.M_RECT_SELECTION:U=bc;break;case la.M_MOVE_TOOL:U=qc;break;case la.M_ROTATE_CANVAS:U=Nb;break;case la.M_PAN_CANVAS:U=
ic;break;case la.M_COLOR_PICKER:U=Zb;break;case la.M_TRANSFORM:U=E}vc=F===la.M_PAN_CANVAS||F===la.M_ROTATE_CANVAS;fc=F===la.M_MOVE_TOOL||F===la.M_ROTATE_CANVAS||F===la.M_PAN_CANVAS;Q.setUserMode(U);S.repaintAll()});a.on("maskViewOpened",function(F){wc&&wc.off("changeLayer",A);(wc=F).on("changeLayer",A);A()});ta=new d;Zb=new e;ic=new k;Nb=new q;Ec=new l;Pa=new r;bc=new h;qc=new m;E=new p;Y=(O=[new g,new n,new f])[wa.STROKE_MODE_FREEHAND];Q.setDefaultMode(ta);Q.setUserMode(Y);Ea.width=Ka.width;Ea.height=
Ka.height;X.width=800;X.height=900;X.className="chickenpaint-canvas";X.setAttribute("touch-action","none");ba.setLineDash||(ba.setLineDash=function(){});X.addEventListener("contextmenu",function(F){F.preventDefault()});X.addEventListener("mouseenter",function(){Hb=!0});X.addEventListener("mouseleave",function(){Hb=!1;pb[0]||pb[2]||pb[1]||S.repaintAll()});X.addEventListener("pointerdown",function(F){ob=!0;pc&&!fc&&"touch"===F.pointerType||Ga(Xa).isPressed("z")||(X.setPointerCapture(F.pointerId),K=
X.getBoundingClientRect(),mb=F.clientX-K.left,eb=F.clientY-K.top,pb[0]=!1,pb[2]=!1,pb[1]=!1,pb[F.button]=!0,Q.mouseDown(F,F.button,ma(F)))});X.addEventListener("pointermove",function(F){if(ob&&Q.peek()instanceof g&&[0,1,2,3,4].includes(Lb)&&32>=a.getBrushSize()){var U,fa;for(let xa of null!=(fa=null==(U=F.getCoalescedEvents)?void 0:U.call(F))?fa:[F])ka(xa)}else ka(F)});X.addEventListener("touchstart",function(F){xc=F.touches.length;vc&&2===xc&&(ge=ra(F.touches),sd=S.getZoom(),F.preventDefault())},
{passive:!1});X.addEventListener("touchend",function(F){xc=F.touches.length},{passive:!1});X.addEventListener("touchmove",function(F){if(xc=F.touches.length,vc&&2===xc){let U=ra(F.touches)/ge,fa=G({x:(F.touches[0].pageX+F.touches[1].pageX)/2,y:(F.touches[0].pageY+F.touches[1].pageY)/2});ia(sd*U,fa.x,fa.y);F.preventDefault()}},{passive:!1});X.addEventListener("pointerup",function(F){ob=!1;let U=++id-Md>=100,fa=Nd&&id>Md;(U||fa)&&(console.log("Auto-saving to DB..."),a.actionPerformed({action:"CPSaveDB"}),
Md=id,Nd=!1);pb[0]=!1;pb[2]=!1;pb[1]=!1;Q.mouseUp(F,F.button,0);X.releasePointerCapture(F.pointerId)});X.addEventListener("wheel",function(F){if(0!=F.deltaY){if(!yc||Math.abs(F.deltaY)>20){let U;U=F.deltaY>0?1/1.15:1.15;let fa=G({x:F.pageX,y:F.pageY}),xa=D(fa);Ka.isPointWithin(xa.x,xa.y)?ia(S.getZoom()*U,fa.x,fa.y):ia(S.getZoom()*U,Db+~~(Ka.width*Ua/2),kb+~~(Ka.height*Ua/2));yc=yc||setTimeout(function(){yc=!1},50)}F.preventDefault()}},{passive:!1});document.addEventListener("keydown",function(F){Q.keyDown(F)});
document.addEventListener("keyup",function(F){"alt"===F.key.toLowerCase()&&F.preventDefault();Q.keyUp(F)});document.addEventListener("visibilitychange",function(){let F=X.height+ha.offsetHeight;X.width=1;X.height=1;S.resize(F,!0)},!1);window.addEventListener("scroll",function(){K=null});X.addEventListener("mousedown",function(F){1==F.button&&F.preventDefault()});Ka.on("changeSelection",function(){S.repaintAll()});Ka.on("updateRegion",function(F){Yb.union(F);M(V(Yb))});da.on("valueChanged",function(F){var U=
S.getOffset();S.setOffset(-F,U.y)});ja.on("valueChanged",function(F){var U=S.getOffset();S.setOffset(U.x,-F)});this.setInterpolation(!0);var td=document.createElement("div");td.className="chickenpaint-canvas-container-wrapper";td.appendChild(X);Z.className="chickenpaint-canvas-container-top";Z.appendChild(td);Z.appendChild(ja.getElement());ha.className="chickenpaint-canvas-container-bottom";ha.appendChild(da.getElement());na.appendChild(Z);na.appendChild(ha);a.setCanvas(this)}function Tb(a,c,d,b){function g(G){if(("dragStart"===
y||"dragging"===y)&&0!==G.buttons){var H,N;let B=G.pageX-C.x;G=G.pageY-C.y;"dragStart"==y&&(H={x:B,y:G},N=v,(H.x-N.x)*(H.x-N.x)+(H.y-N.y)*(H.y-N.y)>25)&&(y="dragging");"dragging"==y&&D.setLocation(B,G)}}function n(G){if("dragging"===y||"dragStart"===y){"dragStart"===y&&(G.stopPropagation(),G.preventDefault(),setTimeout(()=>{D.setLocation(v.x,v.y);D.toggleCollapse()},100));y=!1;try{G.target.releasePointerCapture(G.pointerId)}catch(H){console.error(H)}}m.removeEventListener("pointermove",g);m.removeEventListener("pointerup",
n)}function f(G){G.stopPropagation();G.preventDefault();"vertResize"===y&&D.setHeight(G.pageY-h.offsetTop-w)}function e(G){null==r||r.releasePointerCapture(G.pointerId);y=!1;r.removeEventListener("pointermove",f);r.removeEventListener("pointerup",e)}function k(G){G.stopPropagation();G.preventDefault();"horzResize"==y&&D.setWidth(G.pageX-h.offsetLeft)}function l(G){u.releasePointerCapture(G.pointerId);y=!1;u.removeEventListener("pointermove",k);u.removeEventListener("pointerup",l)}a.getSmallScreenMode()&&
W(d+" (shorter)")!==d+" (shorter)"?this.title=W(d+" (shorter)"):this.title=W(d);b=b||{};this.name=c;this.resizeVert=b.resizeVert||!1;this.resizeHorz=b.resizeHorz||!1;let h=document.createElement("div"),m=document.createElement("div"),p=document.createElement("i");d=document.createElement("button");let q=document.createElement("div"),r=null,u=null,v,y,C,w=0,D=this;this.getElement=function(){return h};this.getBodyElement=function(){return q};this.getWidth=function(){return h.offsetWidth};this.getHeight=
function(){return h.offsetHeight};this.getX=function(){return parseInt(h.style.left,10)||0};this.getY=function(){return parseInt(h.style.top,10)||0};this.setLocation=function(G,H){h.style.left=G+"px";h.style.top=H+"px"};this.setWidth=function(G){h.style.width=G+"px"};this.setHeight=function(G){h.style.height=G+"px"};this.setSize=function(G,H){this.setWidth(G);this.setHeight(H)};this.setCollapseDownwards=function(G){b.collapseDownwards=G};this.toggleCollapse=function(G){var H;if(void 0===G)G=!h.classList.contains("collapsed");
else if(h.classList.contains("collapsed")===G)return;var N=null==(H=h.closest(".chickenpaint"))?void 0:H.querySelector(".chickenpaint-canvas");H=N?N.clientHeight:window.innerHeight;N=this.getHeight();N=this.getY()+N;(h.classList.toggle("collapsed",G),p.classList.toggle("icon-angle-down",!G),p.classList.toggle("icon-angle-up",G),G)?b.collapseDownwards&&this.setLocation(this.getX(),Math.min(N,H)-this.getHeight()):(G=this.getHeight(),b.collapseDownwards?this.setLocation(this.getX(),Math.max(N-G,0)):
this.getY()+G>H&&this.setLocation(this.getX(),Math.max(H-G,0)))};this.userIsDoneWithUs=function(){a.getSmallScreenMode()&&this.toggleCollapse(!0)};p.className="collapse-icon fas icon-angle-down";d.type="button";d.className="btn btn-close";d.textContent="";d.tabIndex=-1;h.className="chickenpaint-palette chickenpaint-palette-"+c;m.className="chickenpaint-palette-head";m.setAttribute("touch-action","none");c=document.createElement("div");let x=document.createElement("h5");c.className="modal-header";
x.className="modal-title";x.appendChild(document.createTextNode(this.title));x.appendChild(p);c.appendChild(x);c.appendChild(d);m.appendChild(c);q.className="chickenpaint-palette-body";h.appendChild(m);h.appendChild(q);this.resizeVert&&((r=document.createElement("div")).className="chickenpaint-resize-handle-vert",r.addEventListener("pointerdown",function(G){G.stopPropagation();G.preventDefault();y="vertResize";w=G.pageY-h.offsetTop-h.offsetHeight;r.setPointerCapture(G.pointerId);r.addEventListener("pointermove",
f);r.addEventListener("pointerup",e)}),h.appendChild(r));this.resizeHorz&&((u=document.createElement("div")).className="chickenpaint-resize-handle-horz",u.addEventListener("pointerdown",function(G){G.stopPropagation();G.preventDefault();y="horzResize";u.setPointerCapture(G.pointerId);u.addEventListener("pointermove",k);u.addEventListener("pointerup",l)}),h.appendChild(u));m.addEventListener("pointerdown",function(G){0==G.button&&(G.stopPropagation(),G.preventDefault(),"BUTTON"==G.target.nodeName?
D.emitEvent("paletteVisChange",[D,!1]):(v={x:parseInt(h.style.left,10)||0,y:parseInt(h.style.top,10)||0},C={x:G.pageX-h.offsetLeft,y:G.pageY-h.offsetTop},y=a.getSmallScreenMode()?"dragStart":"dragging",G.target.setPointerCapture(G.pointerId)),m.addEventListener("pointermove",g),m.addEventListener("pointerup",n))})}function he(a){function c(f){"LI"==this.nodeName&&(f=b[parseInt(this.getAttribute("data-buttonIndex"),10)],a.actionPerformed({action:f.command}))}Tb.call(this,a,"tool","Tools");let d=this,
b=[{className:"chickenpaint-tool-rect-selection",command:"CPRectSelection",toolTip:"Marquee",shortcut:"m",mode:la.M_RECT_SELECTION},{className:"chickenpaint-tool-move",command:"CPMoveTool",toolTip:"Move tool",shortcut:"v",mode:la.M_MOVE_TOOL},{className:"chickenpaint-tool-flood-fill",command:"CPFloodFill",toolTip:"Flood fill",shortcut:"f",mode:la.M_FLOODFILL},{className:"chickenpaint-tool-gradient-fill",command:"CPGradientFill",toolTip:"Gradient fill",shortcut:"g",mode:la.M_GRADIENTFILL},{className:"chickenpaint-tool-color-picker",
command:"CPColorPicker",toolTip:"Color picker",shortcut:"i",mode:la.M_COLOR_PICKER},{className:"chickenpaint-tool-blur",command:"CPBlur",toolTip:"Blur",shortcut:"u",mode:la.M_DRAW,tool:la.T_BLUR},{className:"chickenpaint-tool-pencil",command:"CPPencil",toolTip:"Pencil",shortcut:"n",mode:la.M_DRAW,tool:la.T_PENCIL},{className:"chickenpaint-tool-pen",command:"CPPen",toolTip:"Pen",selected:!0,shortcut:"b",mode:la.M_DRAW,tool:la.T_PEN},{className:"chickenpaint-tool-airbrush",command:"CPAirbrush",toolTip:"Airbrush",
shortcut:"a",mode:la.M_DRAW,tool:la.T_AIRBRUSH},{className:"chickenpaint-tool-water",command:"CPWater",toolTip:"Waterpaint",shortcut:"w",mode:la.M_DRAW,tool:la.T_WATER},{className:"chickenpaint-tool-eraser",command:"CPEraser",toolTip:"Eraser",shortcut:"e",mode:la.M_DRAW,tool:la.T_ERASER},{className:"chickenpaint-tool-soft-eraser",command:"CPSoftEraser",toolTip:"Soft eraser",shortcut:"s",mode:la.M_DRAW,tool:la.T_SOFTERASER},{className:"chickenpaint-tool-smudge",command:"CPSmudge",toolTip:"Smudge",
shortcut:"d",mode:la.M_DRAW,tool:la.T_SMUDGE},{className:"chickenpaint-tool-blender",command:"CPBlender",toolTip:"Blender",shortcut:"c",mode:la.M_DRAW,tool:la.T_BLENDER},{className:"chickenpaint-tool-dodge",command:"CPDodge",toolTip:"Dodge (tool)",shortcut:"o",mode:la.M_DRAW,tool:la.T_DODGE},{className:"chickenpaint-tool-burn",command:"CPBurn",toolTip:"Burn (tool)",shortcut:"p",mode:la.M_DRAW,tool:la.T_BURN},{className:"chickenpaint-tool-rotate-canvas",command:"CPRotateCanvas",commandDoubleClick:"CPResetCanvasRotation",
toolTip:"Rotate canvas",mode:la.M_ROTATE_CANVAS},{className:"chickenpaint-tool-pan-canvas",command:"CPPanCanvas",toolTip:"Grab canvas",mode:la.M_PAN_CANVAS}],g=document.createElement("ul");a.on("modeChange",function(f){let e=d.getBodyElement();(e.querySelectorAll("li").forEach(function(k){k.classList.remove("selected")}),f==la.M_DRAW)?(f=e.querySelector(`li[data-tool="${a.getCurTool()}"]`))&&f.classList.add("selected"):(f=e.querySelector(`li[data-mode="${f}"]`))&&f.classList.add("selected")});a.on("toolChange",
function(f){let e=d.getBodyElement();a.getCurMode()==la.M_DRAW&&(e.querySelectorAll("li").forEach(function(k){k.classList.remove("selected")}),(f=e.querySelector(`li[data-tool="${f}"]`))&&f.classList.add("selected"))});let n=d.getBodyElement();for(let f in g.className="chickenpaint-tools list-unstyled",b)!function(e){let k=b[e],l=document.createElement("li"),h=document.createElement("div");l.className="chickenpaint-toolbar-button "+k.className;l.setAttribute("data-buttonIndex",e);l.setAttribute("data-mode",
k.mode);void 0!==k.tool&&l.setAttribute("data-tool",k.tool);l.title=W(k.toolTip);k.shortcut&&(l.title+=" ("+k.shortcut.toUpperCase()+")",Ga(Xa)(k.shortcut,function(){return c.call(l),!1}));k.selected&&(l.className+=" selected");h.className="chickenpaint-toolbar-button-icon";l.appendChild(h);g.appendChild(l)}(f);g.addEventListener("click",function(f){let e=f.target.closest("li");e&&c.call(e,f)});g.addEventListener("dblclick",function(f){if(f=f.target.closest("li"))f=b[parseInt(f.getAttribute("data-buttonIndex"),
10)],f.commandDoubleClick&&a.actionPerformed({action:f.commandDoubleClick})});n.appendChild(g)}function ie(a){Tb.call(this,a,"misc","Misc");this.flipButton=null;let c=this,d=[{className:"chickenpaint-tool-zoom-in",command:"CPZoomIn",toolTip:"Zoom in"},{className:"chickenpaint-tool-zoom-out",command:"CPZoomOut",toolTip:"Zoom out"},{className:"chickenpaint-tool-zoom-100",command:"CPZoom100",toolTip:"Zoom 100%"},{className:"chickenpaint-tool-flip-horizontal",command:"CPViewHFlip",toolTip:"Flip View Horizontal"},
{className:"chickenpaint-tool-undo",command:"CPUndo",toolTip:"Undo"},{className:"chickenpaint-tool-redo",command:"CPRedo",toolTip:"Redo"},{className:"chickenpaint-tool-send",command:"CPSend",toolTip:"Save Oekaki"}];!function(){let b=c.getBodyElement(),g=document.createElement("ul");for(let n in g.className="chickenpaint-misc-tools list-unstyled",d){let f=d[n],e=document.createElement("li"),k=document.createElement("div");"CPSend"!=f.command||a.isActionSupported("CPContinue")||(f.toolTip="Post Oekaki",
f.className="chickenpaint-tool-send-and-end");e.className="chickenpaint-toolbar-button "+f.className;e.setAttribute("data-buttonIndex",n);e.setAttribute("title",W(f.toolTip));k.className="chickenpaint-toolbar-button-icon";e.appendChild(k);g.appendChild(e);"chickenpaint-tool-flip-horizontal"===f.className&&(c.flipButton=e)}g.addEventListener("click",function(n){if(n=n.target.closest("li"))n=d[parseInt(n.getAttribute("data-buttonIndex"),10)],a.actionPerformed({action:n.command})});b.appendChild(g)}()}
function je(a){Tb.call(this,a,"stroke","Stroke");let c=[{className:"chickenpaint-tool-freehand",command:"CPFreeHand",toolTip:W("Free-hand"),selected:!0},{className:"chickenpaint-tool-line",command:"CPLine",toolTip:W("Straight line")},{className:"chickenpaint-tool-bezier",command:"CPBezier",toolTip:W("Bezier curve")}],d=this.getBodyElement(),b=document.createElement("ul");for(let g in b.className="chickenpaint-stroke-tools list-unstyled",c){let n=c[g],f=document.createElement("li"),e=document.createElement("div");
f.className="chickenpaint-toolbar-button "+n.className;f.setAttribute("data-buttonIndex",g);f.setAttribute("title",n.toolTip);n.selected&&(f.className+=" selected");e.className="chickenpaint-toolbar-button-icon";f.appendChild(e);b.appendChild(f)}b.addEventListener("click",function(g){if(g=g.target.closest("li"))g=c[parseInt(g.getAttribute("data-buttonIndex"),10)],a.actionPerformed({action:g.command})});d.appendChild(b);a.on("toolChange",function(g,n){g=document.querySelector(".chickenpaint-tool-freehand");
let f=document.querySelector(".chickenpaint-tool-line"),e=document.querySelector(".chickenpaint-tool-bezier");g&&g.classList.toggle("selected",n.strokeMode==wa.STROKE_MODE_FREEHAND);f&&f.classList.toggle("selected",n.strokeMode==wa.STROKE_MODE_LINE);e&&e.classList.toggle("selected",n.strokeMode==wa.STROKE_MODE_BEZIER)})}function cc(a,c,d){return c in a?Object.defineProperty(a,c,{value:d,enumerable:!0,configurable:!0,writable:!0}):a[c]=d,a}function ke(a){Tb.call(this,a,"color","Color (picker)");let c=
new hg(a),d=new ig(a,c);a=new qh(a);let b=this.getBodyElement(),g=document.createElement("div");g.className="chickenpaint-colorpicker-top";g.appendChild(c.getElement());g.appendChild(d.getElement());b.appendChild(g);b.appendChild(a.getElement())}function qh(a){function c(n,f,e){for(;n.length<e;)n=f+n;return n}function d(){g.style.backgroundColor="#"+c(Number(b).toString(16),"0",6)}let b=0,g=document.createElement("div");this.getElement=function(){return g};a.on("colorChange",function(n){b=n.getRgb();
d()});g.className="chickenpaint-colorpicker-show";g.addEventListener("click",function(n){n.preventDefault();n="#"+c(Number(b).toString(16),"0",6);if(null!=(n=window.prompt(W("Please enter a color in hex format"),n)))try{(n.match(/^#/)||n.match(/^$/))&&(n=n.substring(1));let f=parseInt(n,16);a.setCurColor(new lb(f))}catch(f){}});d()}function ud(a,c){function d(){var f=b.width;g.clearRect(0,0,f,b.height);g.beginPath();g.arc(f/2+1,f/2+1,Math.max(f/2,1)-2,0,2*Math.PI);n.state?g.fill():g.stroke()}var b=
document.createElement("canvas"),g=b.getContext("2d"),n=this;this.state=a||!1;this.setValue=function(f){this.state!=f&&(this.state=f,this.emitEvent("valueChange",[f]),d())};this.getElement=function(){return b};b.addEventListener("mousedown",function(f){n.setValue(!n.state)});b.title=c||"";b.className="chickenpaint-checkbox";b.width=20;b.height=20;b.fillStyle="black";b.strokeStyle="black";d()}function Qb(a,c,d,b,g=150,n=2.5){function f(){let v=l.width||g,y=l.height,C="string"==typeof u.title?W(u.title):
u.title(u.value),w=3*window.devicePixelRatio,D=.75*l.height;if(d)h.save(),h.fillStyle="white",h.fillRect(0,0,v,y),h.fillStyle="black",h.fillText(C,w,D),h.beginPath(),u.value>=m/2?h.rect(v/2,0,(u.value-m/2)*v/m,y):h.rect(u.value*v/m,0,(m/2-u.value)*v/m,y),h.fill(),h.clip(),h.fillStyle="white";else{var x=(u.value-a)/m;b&&(x=Math.pow(x,1/n));x*=v;h.save();h.save();h.fillStyle="black";h.beginPath();h.rect(0,0,x,y);h.fill();h.clip();h.fillStyle="white";h.fillText(C,w,D);h.restore();h.fillStyle="white";
h.beginPath();h.rect(x,0,v,y);h.fill();h.clip();h.fillStyle="black"}h.fillText(C,w,D);h.restore()}function e(v){let y=l.clientWidth,C=l.getBoundingClientRect().left+window.scrollX;v=(v.pageX-C)/y;b&&(v=Math.pow(Math.max(v,0),n));u.setValue(v*m+a)}function k(v){switch(p){case 1:return e(v);case 2:var y=u.title();if(!y.includes(W("Brush size"))&&!y.includes(W("Opacity")))return e(v);y=(v.pageX-q)/4;if(0!==y){y=u.value+y;let C=Math.floor(y);u.setValue(C);q=v.pageX-(y-C)*4}}}let l=document.createElement("canvas"),
h=l.getContext("2d"),m=c-a,p=0,q,r=!1,u=this;this.value=void 0;this.title="";d=d||!1;l.addEventListener("pointerup",v=>{if(0===p)return l.releasePointerCapture(v.pointerId),l.removeEventListener("pointermove",k);if(0!==p)switch(p){case 1:0!==v.button||v.shiftKey||(p=0);break;case 2:(2==v.button||0===v.button&&v.shiftKey)&&(p=0);break;default:return}return l.releasePointerCapture(v.pointerId),l.removeEventListener("pointermove",k)});this.setValue=function(v){v=~~Math.max(a,Math.min(c,v));this.value!=
v&&(this.value=v,this.emitEvent("valueChange",[this.value]),r?f():(r=!0,this.resize()))};this.getElement=function(){return l};this.resize=function(){l.width=l.clientWidth||g;l.height=l.clientHeight||20;window.devicePixelRatio>1&&(l.style.height=l.height+"px",l.width*=window.devicePixelRatio,l.height*=window.devicePixelRatio);h.font=.47*l.height+"pt sans-serif";f()};l.addEventListener("pointerdown",function(v){0===p&&(2===v.button||0===v.button&&v.shiftKey?(p=2,q=v.pageX):(p=1,e(v)),l.setPointerCapture(v.pointerId),
l.addEventListener("pointermove",k))});l.addEventListener("contextmenu",function(v){v.preventDefault()});l.setAttribute("touch-action","none");l.className="chickenpaint-slider";"devicePixelRatio"in window||(window.devicePixelRatio=1)}function Od(a,c,d){function b(){for(var h=e.style,m=Number(n.getRgb()).toString(16);m.length<6;)m="0"+m;h.backgroundColor="#"+m}let g=this,n=new lb(0),f=255,e=document.createElement("div");this.getElement=function(){return e};this.setColor=function(h){n.isEqual(h)||(n.copyFrom(h),
b(),this.emitEvent("colorChange",[n]))};this.setAlpha=function(h){h!=f&&(f=h,b(),this.emitEvent("alphaChange",[f]))};this.getColorRgb=function(){return n.getRgb()};this.getAlpha=function(){return f};this.setCurColor=this.setColor;e.className="chickenpaint-color-pick-swatch";a&&n.copyFrom(a);c&&(f=c);let k=new zb.Popover(e,{html:!0,content:function(){let h,m,p,q,r;return window.addEventListener("mousedown",l),h=document.createElement("div"),m=document.createElement("div"),p=new hg(g,n),q=new ig(g,
p,n.getHue()),r=new Qb(0,255),h.className="chickenpaint-color-pick-panel",m.className="chickenpaint-colorpicker-top",m.appendChild(p.getElement()),m.appendChild(q.getElement()),h.appendChild(m),r.value=f,r.title=function(u){return W("Opacity: ")+u},r.on("valueChange",function(u){g.setAlpha(u)}),h.appendChild(r.getElement()),setTimeout(function(){r.resize()},0),h},trigger:"manual",placement:"bottom",container:d||!1}),l=function(h){var m=h.target;m=m.closest(".popover-body")||m.classList.contains("chickenpaint-color-pick-panel")||
m.classList.contains("chickenpaint-colorpicker-select")||m.classList.contains("chickenpaint-colorpicker-slider");h.preventDefault();m||k.hide()};e.addEventListener("click",function(h){h.preventDefault();k.toggle()});e.addEventListener("hidden.bs.popover",function(){window.removeEventListener("mousedown",l)});b()}function Ye(a,c){let d=document.createElement("div");return d.className="chickenpaint-checkbox-slider-group",d.appendChild(a.getElement()),d.appendChild(c.getElement()),d}function jg(a,c){for(let d in c)if(c.hasOwnProperty(d)){let b=
document.createElement("option");b.appendChild(document.createTextNode(W(c[d])));b.value=d;a.appendChild(b)}}function rh(a){function c(){n.gradient(n.getBounds(),0,0,n.width,0,k,!0);e.putImageData(n.imageData,0,0,0,0,150,32);b.fillRect(0,0,d.width,d.height);b.drawImage(f,0,0)}let d=document.createElement("canvas"),b=d.getContext("2d"),g=gg(b),n=new I(150,32),f=document.createElement("canvas"),e=f.getContext("2d"),k=a.getCurGradient();this.getElement=function(){return d};a.on("gradientChange",function(l){k=
l;c()});d.width=f.width=150;d.height=f.height=32;d.className="chickenpaint-gradient-preview";b.fillStyle=g;c()}function vd(a){function c(){b.getElement().style.display="none";g.getElement().style.display="none";n.getElement().style.display="none";f.getElement().style.display="none";e.getElement().style.display="none";k.getElement().style.display="none"}function d(m){c();let p=f.getElement().querySelector(".form-check");switch(p&&(p.style.display="none"),m){case la.M_GRADIENTFILL:g.getElement().style.display=
"block";break;case la.M_TRANSFORM:n.getElement().style.display="block";break;case la.M_RECT_SELECTION:f.getElement().style.display="block";p instanceof HTMLElement&&(p.style.display="");break;case la.M_MOVE_TOOL:f.getElement().style.display="block";break;case la.M_ROTATE_CANVAS:case la.M_PAN_CANVAS:e.getElement().style.display="block";break;case la.M_FLOODFILL:k.getElement().style.display="block";break;default:b.getElement().style.display="block"}}Tb.call(this,a,"brush","Tool options");let b=new sh(a),
g=new th(a),n=new uh(a),f=new vh(a),e=new wh(a),k=new xh(a),l=this.getBodyElement();l.addEventListener("touchmove",m=>{m.preventDefault()},{passive:!1});l.appendChild(b.getElement());l.appendChild(g.getElement());l.appendChild(n.getElement());l.appendChild(f.getElement());l.appendChild(e.getElement());l.appendChild(k.getElement());let h=null;a.on("modeChange",function(m){h=m;d(m)});document.addEventListener("keydown",m=>{"r"!==m.key.toLocaleLowerCase()&&(m.ctrlKey||"z"!==m.key.toLocaleLowerCase())&&
" "!==m.key||(c(),e.getElement().style.display="block")});document.addEventListener("keyup",m=>{"r"!==m.key.toLocaleLowerCase()&&"z"!==m.key.toLocaleLowerCase()&&" "!==m.key||(c(),d(h))})}function sh(a){let c=[1,2,3,4,5,6,7,8,9,10,15,20,25,30,35,40,45,50,60,70,80,90,100,125,150,175,200],d=document.createElement("div"),b=document.createElement("select"),g=new ud(!1,W("Control brush opacity with pen pressure")),n=new Qb(1,255,!1,!0),f=new ud(!0,W("Control brush size with pen pressure")),e=new Qb(1,
200,!1,!0),k=new ud(!1,W("Control brush scattering with pen pressure")),l=new Qb(0,1E3,!1,!0),h=new Qb(0,100,!1,!0),m=new Qb(0,100,!1,!0),p=new Qb(0,100,!1,!0),q=new Qb(0,100,!1,!0),r=new vd.CPBrushPreview(a);this.getElement=function(){return d};n.title=function(u){return W("Opacity")+": "+u};n.on("valueChange",function(u){a.setAlpha(u)});e.title=function(u){return W("Brush size")+": "+u};e.on("valueChange",function(u){a.setBrushSize(u)});h.title=function(u){return W("Color")+": "+u+"%"};h.on("valueChange",
function(u){a.getBrushInfo().resat=u/100;a.callToolListeners()});m.title=function(u){return W("Blend")+": "+u+"%"};m.on("valueChange",function(u){a.getBrushInfo().bleed=u/100;a.callToolListeners()});p.title=function(u){return W("Spacing")+": "+u+"%"};p.on("valueChange",function(u){a.getBrushInfo().spacing=u/100;a.callToolListeners()});l.title=function(u){return W("Scattering")+": "+u+"%"};l.on("valueChange",function(u){a.getBrushInfo().scattering=u/100;a.callToolListeners()});q.title=function(u){return W("Smoothing")+
": "+u+"%"};q.on("valueChange",function(u){a.getBrushInfo().smoothing=u/100;a.callToolListeners()});k.on("valueChange",function(u){a.getBrushInfo().pressureScattering=u;a.callToolListeners()});g.on("valueChange",function(u){a.getBrushInfo().pressureAlpha=u;a.callToolListeners()});f.on("valueChange",function(u){a.getBrushInfo().pressureSize=u;a.callToolListeners()});b.addEventListener("change",function(u){a.getBrushInfo().tip=parseInt(b.value,10);b.blur()});window.addEventListener("keydown",u=>{b.blur()});
b.className="form-control form-control-sm";b.tabIndex=-1;jg(b,["Round Pixelated","Round Hard Edge","Round Soft","Square Pixelated","Square Hard Edge"]);d.appendChild(b);d.appendChild(r.getElement());d.appendChild(Ye(f,e));d.appendChild(Ye(g,n));d.appendChild(h.getElement());d.appendChild(m.getElement());d.appendChild(p.getElement());d.appendChild(Ye(k,l));d.appendChild(q.getElement());g.setValue(a.getBrushInfo().pressureAlpha);n.setValue(a.getAlpha());f.setValue(a.getBrushInfo().pressureSize);e.setValue(a.getBrushSize());
k.setValue(a.getBrushInfo().pressureScattering);l.setValue(~~(100*a.getBrushInfo().scattering));b.value=a.getBrushInfo().tip;h.setValue(~~(100*a.getBrushInfo().resat));m.setValue(~~(100*a.getBrushInfo().bleed));p.setValue(~~(100*a.getBrushInfo().spacing));q.setValue(~~(100*a.getBrushInfo().smoothing));a.on("toolChange",function(u,v){n.setValue(v.alpha);e.setValue(v.size);f.setValue(v.pressureSize);g.setValue(v.pressureAlpha);b.value=v.tip;k.setValue(v.pressureScattering);~~(100*v.resat)!=h.value&&
h.setValue(~~(100*v.resat));~~(100*v.bleed)!=m.value&&m.setValue(~~(100*v.bleed));~~(100*v.spacing)!=p.value&&p.setValue(~~(100*v.spacing));~~(100*v.scattering)!=l.value&&l.setValue(~~(100*v.scattering));~~(100*v.smoothing)!=q.value&&q.setValue(~~(100*v.smoothing))});Ga(Xa)("1,2,3,4,5,6,7,8,9,0",function(u,v){u=parseInt(v.shortcut,10);0==u&&(u=10);a.setAlpha(Math.round(u/10*255))});Ga(Xa)("{,[",function(){let u=a.getBrushSize();for(let v=c.length-1;v>=0;v--)if(u>c[v]){a.setBrushSize(c[v]);break}});
Ga(Xa)("},]",function(){let u=a.getBrushSize();for(let v=0;v<c.length;v++)if(u<c[v]){a.setBrushSize(c[v]);break}})}function th(a){function c(){let e=[n.getAlpha()<<24|n.getColorRgb(),f.getAlpha()<<24|f.getColorRgb()];a.setCurGradient(e)}var d;let b=document.createElement("div");var g=new rh(a);let n=new Od(new lb(16777215&a.getCurGradient()[0]),a.getCurGradient()[0]>>>24,b),f=new Od(new lb(16777215&a.getCurGradient()[1]),a.getCurGradient()[1]>>>24,b);this.getElement=function(){return b};b.className=
"chickenpaint-gradient-panel";b.style.display="none";n.on("colorChange",c);n.on("alphaChange",c);f.on("colorChange",c);f.on("alphaChange",c);(d=document.createElement("p")).textContent=W("Gradient");b.appendChild(d);b.appendChild(g.getElement());(d=document.createElement("div")).className="chickenpaint-gradient-colors";(g=document.createElement("div")).className="chickenpaint-gradient-start-color";g.appendChild(n.getElement());d.appendChild(g);(g=document.createElement("div")).className="chickenpaint-gradient-end-color";
g.appendChild(f.getElement());d.appendChild(g);b.appendChild(d)}function wd(a,c){let d=a.textContent;if(a.textContent="",a.classList.add("d-flex","align-items-center","justify-content-center","position-relative"),a.style.paddingLeft="0.35rem",c){let b=document.createElement("span");b.className=`md-panel ${c}`;b.style.flex="0 0 auto";b.style.marginRight="0";a.prepend(b)}c=document.createElement("span");c.textContent=d;c.style.flex="1 1 auto";c.style.textAlign="center";a.appendChild(c)}function uh(a){var c=
{smooth:W("Smooth"),sharp:W("Sharp")};let d=document.createElement("div"),b=document.createElement("button"),g=document.createElement("button");var n=document.createElement("select");this.getElement=function(){return d};d.className="chickenpaint-transform-panel";d.style.display="none";b.type="button";g.type="button";b.className="btn btn-primary btn-block";g.className="btn btn-light btn-block";b.textContent=W("Apply transform");g.textContent=W("Cancel");wd(b,"icon-md-circle");wd(g,"icon-md-close");
n.addEventListener("change",function(l){a.setTransformInterpolation(this.value)});n.className="form-control chickenpaint-transform-interpolation";jg(n,c);c=document.createElement("div");let f=document.createElement("label");f.textContent=W("Transform style");c.className="form-group";c.appendChild(f);c.appendChild(n);d.appendChild(c);n=document.createElement("div");n.appendChild(b);n.appendChild(g);n.className="form-group";d.appendChild(n);let {wrapper:e,checkbox:k}=Ze("chickenpaint-t-maintainAspectCheckbox",
W("Constrain"),!0);d.appendChild(e);b.addEventListener("click",function(l){a.actionPerformed({action:"CPTransformAccept"});l.preventDefault()});g.addEventListener("click",function(l){a.actionPerformed({action:"CPTransformReject"});l.preventDefault()});k.addEventListener("change",()=>{k.blur()})}function vh(a){let c=document.createElement("div");var d=document.createElement("div");let b=document.createElement("label"),g=document.createElement("button"),n=document.createElement("button"),f=document.createElement("button");
this.getElement=function(){return c};c.className="chickenpaint-selection-panel";c.style.display="none";d.className="form-group";b.textContent=W("Selection");d.appendChild(b);g.type="button";g.className="btn btn-light btn-block";g.textContent=W("Fill");g.addEventListener("click",function(e){a.actionPerformed({action:"CPFill"});e.preventDefault()});wd(g,"icon-md-ink_selection");d.appendChild(g);n.type="button";n.className="btn btn-light btn-block deselectButton";n.textContent=W("Deselect");n.addEventListener("click",
function(e){a.actionPerformed({action:"CPDeselectAll"});e.preventDefault()});wd(n,"icon-md-deselect");d.appendChild(n);f.type="button";f.className="btn btn-primary btn-block";f.textContent=W("Transform");f.addEventListener("click",function(e){a.actionPerformed({action:"CPTransform"});e.preventDefault()});wd(f,"icon-md-resize");d.appendChild(f);c.appendChild(d);({wrapper:d}=Ze("chickenpaint-s-maintainAspectCheckbox",W("Constrain"),!1));c.appendChild(d)}function Ze(a,c,d=!1){let b=document.createElement("input");
b.type="checkbox";b.id=a;b.className="form-check-input";b.checked=d;b.style.outline="none";b.style.boxShadow="none";b.tabIndex=-1;d=document.createElement("label");d.className="form-check-label";d.setAttribute("for",a);d.textContent=c;a=document.createElement("div");return a.className="form-check",a.appendChild(b),a.appendChild(d),{wrapper:a,checkbox:b}}function wh(a){var c;let d,b=document.createElement("div"),g=document.createElement("div"),n=document.createElement("label"),f=document.createElement("button"),
e=new Qb(10,800,!1,!0,180,3.13),k=new Qb(-180,180,!1,!1,180);b.className="chickenpaint-pan-panel";b.style.display="none";b.appendChild(e.getElement());g.className="form-group";n.textContent=W("Zoom and Rotate");g.appendChild(n);g.appendChild(n);b.appendChild(g);f.type="button";f.className="btn btn-primary btn-block";f.style.outline="none";f.textContent=W("Reset View");f.addEventListener("click",function(r){a.actionPerformed({action:"CPResetZoomAndRotation"});r.preventDefault()});wd(f,"icon-md-restart_alt");
g.appendChild(f);b.appendChild(g);e.title=function(r){return W("Zoom")+": "+r+"%"};k.title=function(r){return W("Rotation")+": "+r+"\u00b0"};e.on("valueChange",function(r){a.zoomOnCenter(r/100)});k.on("valueChange",function(r){a.setRotationDegrees(r)});b.appendChild(e.getElement());b.appendChild(k.getElement());this.getElement=function(){return b};e.setValue(100*a.getZoom());k.setValue(a.getRotationDegrees());document.addEventListener("wheel",r=>{r.preventDefault();l()},{passive:!1});let l=(c=()=>
{e.setValue(100*a.getZoom());k.setValue(a.getRotationDegrees())},function(...r){clearTimeout(d);d=setTimeout(()=>c.apply(this,r),12)}),h=r=>a.isPanOrRotateMode()||Ga(Xa).isPressed("space")||Ga(Xa).isPressed("r")||Ga(Xa).isPressed("z"),m=r=>r instanceof HTMLCanvasElement&&r.classList.contains("chickenpaint-canvas"),p=!1;document.addEventListener("pointerdown",r=>{!h(r)||(p=!0,m(r.target)&&l())});document.addEventListener("pointermove",r=>{p&&h(r)&&m(r.target)&&l()});document.addEventListener("pointerup",
r=>{p=!1;!h(r)||m(r.target)&&l()});Ga(Xa)("=,-",function(){l()});let q=!0;Ga(Xa)("ctrl+0,alt+0,r,z,space,enter",function(){q&&(q=!1,l())});document.addEventListener("keyup",r=>{q=!0});document.addEventListener("click",r=>{r.target instanceof HTMLElement&&!(r.target instanceof HTMLCanvasElement)&&l()})}function xh(a){let c=document.createElement("div");var d=document.createElement("div");let b=document.createElement("label"),g=new Qb(0,5,!1,!1,180),n=new Qb(0,255,!1,!1,180);c.className="chickenpaint-floodFill-panel";
c.style.display="none";c.appendChild(g.getElement());d.className="form-group";b.textContent=W("Flood fill");d.appendChild(b);c.appendChild(d);g.title=function(k){return W("Grow fill area")+": "+k};n.title=function(k){return W("Opacity")+": "+k};g.on("valueChange",function(k){a.setGrowFillArea(k)});n.on("valueChange",function(k){a.setFoodFillAlpha(k)});d=document.createElement("div");d.className="form-group";d.appendChild(g.getElement());d.appendChild(n.getElement());c.appendChild(d);let {wrapper:f,
checkbox:e}=Ze("chickenpaint-floodFillreferAllLayersCheckbox",W("Refer all layers"),!0);f.classList.add("mb-1");c.appendChild(f);e.addEventListener("change",()=>{e.blur();a.setFloodFillReferAllLayers(e.checked)});this.getElement=function(){return c};g.setValue(2);n.setValue(255)}function yh(a){a.preventDefault();a.stopPropagation()}function mc(a){let c=document.createElement("span");return c.className="fa "+a,c}function $e(a){let c=document.createElement("span");return c.className="chickenpaint-icon chickenpaint-icon-"+
a,c}function kg(a,c){let d=document.createElement("div"),b=document.createElement("label");return b.tabIndex=-1,a.tabIndex=-1,d.className="form-check",a.className="form-check-input",b.className="form-check-label",b.setAttribute("for",a.id),b.appendChild(a),b.appendChild(document.createTextNode(c)),d.appendChild(a),d.appendChild(b),d}function le(a){function c(){let w=g.getActiveLayer();w.getAlpha()!=l.value&&l.setValue(w.getAlpha());let D=g.getActiveLayer();for(;h.lastChild;)h.removeChild(h.lastChild);
for(let x=R.LM_FIRST;x<=R.LM_LAST;x++)if(x!=R.LM_MULTIPLY2&&(x==D.blendMode||x===R.LM_PASSTHROUGH&&D instanceof cb||x<=R.LM_LAST_CHIBIPAINT)){let G=document.createElement("option");G.appendChild(document.createTextNode(W(R.BLEND_MODE_DISPLAY_NAMES[x])));x!==R.LM_MULTIPLY||D.blendMode===x||D.useLegacyMultiply?G.value=x:G.value=R.LM_MULTIPLY2;h.appendChild(G)}w.getBlendMode()!=parseInt(h.value,10)&&(h.value=w.getBlendMode());w.getLockAlpha()!=q.checked&&(q.checked=w.getLockAlpha());(function(){var x=
g.getActiveLayer();let G=g.isEditingMask();x={"image-layer":x instanceof Da,"layer-group":x instanceof cb,"clipping-mask":x instanceof Da&&x.clip,"no-clipping-mask":x instanceof Da&&!x.clip,"no-clipping-mask-or-is-group":!(x instanceof Da)||!x.clip,mask:x&&null!==x.mask,"no-mask":x&&null===x.mask,"mask-enabled":x&&null!==x.mask&&x.maskVisible,"mask-disabled":x&&null!==x.mask&&!x.maskVisible,isNotEditingMask:x&&!G,isEditingMask:x&&null!==x.mask&&G};for(let H of"mask no-mask isEditingMask isNotEditingMask clipping-mask no-clipping-mask-or-is-group image-layer layer-group".split(" "))for(let N of u.getElementsByClassName("chickenpaint-action-require-"+
H))N.style.display=x[H]?"inline-block":"none";u.querySelectorAll("[data-action]").forEach(function(H){let N=H.getAttribute("data-action");H.classList.toggle("disabled",!a.isActionAllowed(N))})})()}function d(){g=this;k.resize();c()}Tb.call(this,a,"layers","Layers",{resizeHorz:!0,resizeVert:!0});let b=this,g=a.getArtwork(),n=null,f=this.getBodyElement(),e=this.getElement(),k=new function(){function w(M){let A=ca.querySelectorAll(".chickenpaint-layer");return A[A.length-1-M]}function D(M){if(!M)return-1;
M=M.closest(".chickenpaint-layer");if(!M)return-1;let A=Array.from(ca.querySelectorAll(".chickenpaint-layer"));return A.length-1-A.indexOf(M)}function x(){var M;if(2===aa.state){var A=e.getBoundingClientRect();var K=!0;var S=!0;if(aa.dropTarget=function(ha,X){var ba=ca.querySelectorAll(".chickenpaint-layer");ha={layer:n[n.length-1],displayIndex:n.length-1,direction:"over"};for(var Ea=0;Ea<ba.length;Ea++){let Ha=ba[ba.length-1-Ea].getBoundingClientRect();if(0===Ea&&X>Ha.bottom){ha=g.getLayersRoot().layers[0];
ha={layer:ha,displayIndex:n.indexOf(ha),direction:"under"};break}if(X>=Ha.top){ba=n[Ea];let xb=Ha.bottom-Ha.top;ha={layer:ba,displayIndex:Ea};ba instanceof cb?X>=Ha.top+.75*xb?ba.expanded&&ba.layers.length>0?(ha.layer=ba.layers[ba.layers.length-1],ha.displayIndex--,ha.direction="over"):ha.direction="under":X>=Ha.top+.25*xb?ba.expanded&&ba.layers.length>0?(ha.layer=ba.layers[ba.layers.length-1],ha.displayIndex--,ha.direction="over"):ha.direction="inside":ha.direction="over":ha.direction=X>=Ha.top+
.5*xb?"under":"over";break}}return ha.layer.parent===aa.layer.parent&&("over"===ha.direction||"under"===ha.direction)&&(X=ha.layer.parent,Ea=X.indexOf(ha.layer),"over"===ha.direction&&X.layers[Ea+1]===aa.layer||"under"===ha.direction&&X.layers[Ea-1]===aa.layer||ha.layer===aa.layer)?null:aa.layer instanceof cb&&(ha.layer===aa.layer&&"inside"===ha.direction||ha.layer.hasAncestor(aa.layer))?null:ha}(aa.dragX,aa.dragY),aa.dropTarget){var na=w(aa.dropTarget.displayIndex);switch(aa.dropTarget.direction){case "over":case "under":ca.appendChild(aa.dropBetweenMarkerElem);
K=aa.dropTarget.layer.getDepth()-1;var Z;na=na.getBoundingClientRect();if("under"===aa.dropTarget.direction&&aa.dropTarget.layer instanceof cb&&aa.dropTarget.layer.expanded){for(Z=aa.dropTarget.displayIndex-1;Z>=0&&n[Z].hasAncestor(aa.dropTarget.layer);Z--);Z=w(Z+1).getBoundingClientRect().bottom}else Z=na.bottom;K=na.left-A.left+(K>0?26+16*K:0);aa.dropBetweenMarkerElem.style.left=K+"px";aa.dropBetweenMarkerElem.style.width=na.right-A.left-K+"px";aa.dropBetweenMarkerElem.style.top=("over"===aa.dropTarget.direction?
na.top-1:Z+1)-A.top+"px";ca.querySelectorAll(".chickenpaint-layer-drop-target").forEach(X=>X.classList.remove("chickenpaint-layer-drop-target"));K=!1;break;case "inside":let ha=ca.querySelectorAll(".chickenpaint-layer");ha.forEach((X,ba)=>{X.classList.toggle("chickenpaint-layer-drop-target",ha.length-1-ba===aa.dropTarget.displayIndex)});S=!1}}S&&ca.querySelectorAll(".chickenpaint-layer-drop-target").forEach(ha=>ha.classList.remove("chickenpaint-layer-drop-target"));K&&(null==(M=aa.dropBetweenMarkerElem)||
M.remove());aa.frameElem.style.top=aa.dragY-A.top-parseInt(aa.frameElem.style.height,10)/2+"px"}else null==(A=aa.dropBetweenMarkerElem)||A.remove(),null==(S=aa.frameElem)||S.remove()}function G(M){let A=M.getImageThumbnail().getAsCanvas(ra);return A.title=W("Image"),A.className="chickenpaint-layer-thumbnail chickenpaint-layer-image-thumbnail",A.style.maxWidth=A.width/A.height*25+"px",M!=g.getActiveLayer()||g.isEditingMask()||(A.className+=" active"),A}function H(M){let A=M.getMaskThumbnail().getAsCanvas(ra);
(A.title=W("Layer mask"),A.className="chickenpaint-layer-thumbnail chickenpaint-layer-mask-thumbnail",A.style.maxWidth=A.width/A.height*25+"px",M==g.getActiveLayer()&&g.isEditingMask()&&(A.className+=" active"),M.maskVisible)||(A.className+=" disabled",(M=A.getContext("2d")).strokeStyle="red",M.lineWidth=3,M.moveTo(5,5),M.lineTo(A.width-5,A.height-5),M.moveTo(A.width-5,5),M.lineTo(5,A.height-5),M.stroke());return A}function N(M,A){let K=document.createElement("div");var S=document.createElement("div");
let na=document.createElement("div");var Z=document.createElement("div");let ha=document.createElement("div"),X=document.createElement("div"),ba=document.createElement("div");if(K.className="chickenpaint-layer list-group-item",A==g.getActiveLayer()&&(K.className+=" active"),S.className="chickenpaint-layer-eye",A.ancestorsAreVisible()||(S.className+=" chickenpaint-layer-eye-hidden-ancestors"),S.style.marginRight=2+16*(A.getDepth()-1)+"px",A.visible?(K.className+=" chickenpaint-layer-visible",S.appendChild(mc("icon-eye"))):
(K.className+=" chickenpaint-layer-hidden",S.appendChild(mc("icon-eye-slash"))),K.appendChild(S),na.className="chickenpaint-layer-description",A instanceof Da){if(A.clip&&(K.className+=" chickenpaint-layer-clipped",Z.appendChild(mc("icon-level-down-alt fa-flip-horizontal"))),A.lockAlpha)S=$e("lock-alpha"),S.title=W("Transparency locked"),X.appendChild(S)}else A instanceof cb&&(K.className+=" chickenpaint-layer-group",A.expanded?(K.className+=" chickenpaint-layer-group-expanded",Z.appendChild(mc("icon-folder-open chickenpaint-layer-group-toggle"))):
(K.className+=" chickenpaint-layer-group-collapsed",Z.appendChild(mc("icon-folder chickenpaint-layer-group-toggle"))));Z.childNodes.length&&(Z.className="chickenpaint-layer-icons",K.appendChild(Z));try{A instanceof Da&&K.appendChild(G(A)),A.mask&&K.appendChild(H(A))}catch(Ea){console.log("Failed to create layer thumb")}Z=A.name&&A.name.length>0?A.name:"(unnamed "+(A instanceof cb?"group":"layer")+")";return ha.innerText=Z,ha.setAttribute("title",Z),ha.className="chickenpaint-layer-name",ba.innerText=
W(R.BLEND_MODE_DISPLAY_NAMES[A.blendMode])+": "+A.alpha+"%",ba.className="chickenpaint-layer-blend",na.appendChild(ha),na.appendChild(ba),K.appendChild(na),X.className="chickenpaint-layer-status",K.appendChild(X),K.setAttribute("data-display-index",""+M),K}function B(M){if(M>-1){let A=n[M];M=w(M);A&&M&&m.show(A,M)}}function P(M){2===aa.state?(aa.layerElem.classList.remove("chickenpaint-layer-dragging"),aa.dropTarget&&("inside"===aa.dropTarget.direction?a.actionPerformed({action:"CPRelocateLayer",
layer:aa.layer,toGroup:aa.dropTarget.layer,toIndex:aa.dropTarget.layer.layers.length}):a.actionPerformed({action:"CPRelocateLayer",layer:aa.layer,toGroup:aa.dropTarget.layer.parent,toIndex:aa.dropTarget.layer.parent.indexOf(aa.dropTarget.layer)+ +("over"===aa.dropTarget.direction)})),aa.dropTarget=null,aa.state=0,x()):aa.state=0;qa&&(clearTimeout(qa),qa=null);ca.releasePointerCapture(M.pointerId);ca.removeEventListener("pointermove",L);ca.removeEventListener("pointerup",P)}function V(){aa.state=2;
aa.frameElem=document.createElement("div");aa.frameElem.className="chickenpaint-layer-drag-frame";aa.frameElem.style.width=aa.layerElem.offsetWidth+"px";aa.frameElem.style.height=aa.layerElem.offsetHeight+"px";aa.dropBetweenMarkerElem=document.createElement("div");aa.dropBetweenMarkerElem.className="chickenpaint-layer-drop-between-mark";aa.layerElem.classList.add("chickenpaint-layer-dragging");ca.appendChild(aa.frameElem)}function L(M){M=M.clientY;switch(aa.state){case 3:if(Math.abs(M-aa.dragY)>5)aa.state=
4;else break;case 4:ca.scrollTop=aa.initialScrollTop+aa.dragY-M;break;case 1:if(Math.abs(M-aa.dragY)>5)V();else break;case 2:aa.dragY=M,x()}}function ia(M,A,K){try{let S=M.querySelector("."+(K?"chickenpaint-layer-mask-thumbnail":"chickenpaint-layer-image-thumbnail"));S&&S.replaceWith(K?H(A):G(A))}catch(S){console.log("Error rebuilding thumbnail: ",S)}}let aa={state:0,layer:null,layerElem:null,dragX:0,dragY:0,initialScrollTop:0,dropTarget:null,dropBetweenMarkerElem:null,frameElem:null},ma=document.createElement("div"),
ca=document.createElement("div"),ra=0,ka=!1,qa=null;for(let M of(this.buildLayers=function(){let A=(n=g.getLayersRoot().getLinearizedLayerList(!0)).map((S,na)=>N(na,S)),K=document.createDocumentFragment();ca.innerHTML="";for(let S=A.length-1;S>=0;S--)K.appendChild(A[S]);ca.appendChild(K);x()},this.layerChanged=function(A){let K=n.indexOf(A),S=w(K);!S||A instanceof cb&&(A.expanded!=S.classList.contains("chickenpaint-layer-group-expanded")||A.visible!=S.classList.contains("chickenpaint-layer-visible"))?
this.buildLayers():S.replaceWith(N(K,A))},this.setRotation90=function(A){if(ra!==A)for(ra=A,A=0;A<n.length;A++){let K=n[A],S=w(A);S&&(ia(S,K,!1),K.mask&&ia(S,K,!0))}},this.layerImageThumbChanged=function(A){let K=w(n.indexOf(A));K&&ia(K,A,!1)},this.layerMaskThumbChanged=function(A){let K=w(n.indexOf(A));K&&(A.mask?ia(K,A,!0):(A=K.querySelector(".chickenpaint-layer-mask-thumbnail"))&&A.remove())},this.activeLayerChanged=function(A,K){ca.querySelectorAll(".active").forEach(na=>{na.classList.remove("active")});
var S=w(n.indexOf(A));S.classList.add("active");A=S.querySelector(".chickenpaint-layer-image-thumbnail");S=S.querySelector(".chickenpaint-layer-mask-thumbnail");A&&A.classList.toggle("active",!K);S&&S.classList.toggle("active",K)},this.resize=function(){b.dismissNotification();this.buildLayers()},this.getElement=function(){return ma},this.revealLayer=function(A){A=w(A);let K=A.getBoundingClientRect(),S=ca.getBoundingClientRect();return ca.scrollTop=Math.max(Math.min(Math.max(ca.scrollTop,ca.scrollTop+
K.bottom-S.bottom),ca.scrollTop+K.top-S.top),0),A},e.id="chickenpaint-layer-pop",ma.className="chickenpaint-layers-widget",ma.addEventListener("contextmenu",A=>A.preventDefault(),!0),ca.className="list-group",ca.addEventListener("dblclick",function(A){0===A.button&&A.target.closest(".chickenpaint-layer-description")&&!A.target.closest("input")&&(B(D(A.target)),A.preventDefault())}),ca.addEventListener("pointerdown",function(A){let K=D(A.target.closest(".chickenpaint-layer"));if(-1!==K){let S=n[K];
if(0===A.button&&A.target.closest(".chickenpaint-layer-eye"))a.actionPerformed({action:"CPSetLayerVisibility",layer:S,visible:!S.visible});else if(0===A.button&&S instanceof cb&&A.target.closest(".chickenpaint-layer-group-toggle"))a.actionPerformed({action:"CPExpandLayerGroup",group:S,expand:!S.expanded});else{let na=g.getActiveLayer()!==S;if(ka=null!==A.target.closest(".chickenpaint-layer-mask-thumbnail")||S instanceof cb&&null!==S.mask&&na,0===A.button&&A.shiftKey&&!A.ctrlKey&&!A.metaKey&&ka)a.actionPerformed({action:"CPSetMaskVisible",
layer:S,visible:!S.maskVisible});else{let Z,ha;(Z=0===A.button||na?ka:g.isEditingMask(),ha=g.isEditingMask()!==Z,(na||ha)&&a.actionPerformed({action:"CPSetActiveLayer",layer:S,mask:Z}),Z&&A.altKey)?a.actionPerformed({action:"CPToggleMaskView"}):Z&&!A.shiftKey&&(A.ctrlKey||A.metaKey)?a.actionPerformed({action:"CPApplyLayerMask"}):Z&&A.shiftKey&&(A.ctrlKey||A.metaKey)?a.actionPerformed({action:"CPRemoveLayerMask"}):0===A.button?("pen"===A.pointerType||"touch"===A.pointerType?(aa.state=3,aa.initialScrollTop=
ca.scrollTop,qa&&clearTimeout(qa),qa=setTimeout(()=>{3===aa.state&&(V(),aa.dragY=A.clientY,x())},800)):aa.state=1,aa.dropTarget=null,aa.layer=S,aa.layerElem=w(K),aa.dragX=A.clientX,aa.dragY=A.clientY,ca.setPointerCapture(A.pointerId),ca.addEventListener("pointermove",L),ca.addEventListener("pointerup",P)):2===A.button&&!na&&(A.preventDefault(),-1!=D(A.target)&&(B(D(A.target)),A.preventDefault()))}}}}),ca.setAttribute("touch-action","none"),["ontouchstart","ontouchmove","ontouchend","ontouchcancel"]))ca.addEventListener(M,
yh);ma.appendChild(ca)},l=new Qb(0,100,!1,!1,208),h=document.createElement("select"),m=new function(){let w=null,D="",x=document.createElement("input"),G=this;this.hide=function(){w=null;let H=x.parentNode;H&&(H.removeChild(x),H.textContent=D)};this.renameAndHide=function(){w&&w.name!==x.value&&a.actionPerformed({action:"CPSetLayerName",layer:w,name:x.value});this.hide()};this.show=function(H,N){x.value=D=(w=H).name;(H=N.querySelector(".chickenpaint-layer-name"))&&H.parentNode&&(N=H.firstChild)&&
N.nodeType===Node.TEXT_NODE&&(H.removeChild(N),H.appendChild(x));x.select()};x.type="text";x.className="chickenpaint-layer-rename form-control input-sm";x.addEventListener("keydown",function(H){H.stopPropagation()});x.addEventListener("keydown",function(H){"Enter"===H.key&&G.renameAndHide();H.stopPropagation()});x.addEventListener("keyup",function(H){"Escape"===H.key&&G.hide();H.stopPropagation()});x.addEventListener("blur",function(H){w&&G.renameAndHide()})},p=document.createElement("input"),q=document.createElement("input"),
r=!1,u,v=this.setSize,y=this.setWidth,C=this.setHeight;this.setSize=function(w,D){v.call(this,w,D);this.dismissNotification();l.resize()};this.setWidth=function(w){y.call(this,w);l.resize();k.resize()};this.setHeight=function(w){C.call(this,w);k.resize()};this.setRotation90=function(w){k.setRotation90(w)};this.dismissNotification=function(){document.querySelectorAll(".chickenpaint-layer[aria-describedby], .chickenpaint-slider[aria-describedby]").forEach(w=>{(w=zb.Popover.getInstance(w))&&w.dispose()});
r&&(clearTimeout(r),r=!1)};this.showNotification=(w,D,x)=>{let G=n.indexOf(w);w=g.getActiveLayer()==w&&"opacity"==x?l.getElement():k.revealLayer(G);this.dismissNotification();(new zb.Popover(w,{html:!1,content:D,placement:"left",trigger:"manual",fallbackPlacement:[],boundary:"window",container:b.getElement()})).show();r=setTimeout(()=>{r=!1;this.dismissNotification()},Math.max(Math.round(70*D.length),3E3))};h.className="form-control form-control-sm";h.tabIndex=-1;h.title=W("Layer blending mode");
h.addEventListener("change",function(w){a.actionPerformed({action:"CPSetLayerBlendMode",blendMode:parseInt(h.value,10)});h.blur()});window.addEventListener("keydown",w=>{h.blur()});f.appendChild(h);l.title=function(w){return W("Opacity")+": "+w+"%"};l.on("valueChange",function(w){a.actionPerformed({action:"CPSetLayerAlpha",alpha:w})});f.appendChild(l.getElement());p.id="chickenpaint-chk-sample-all-layers";p.type="checkbox";p.addEventListener("click",function(w){g.setSampleAllLayers(p.checked);document.activeElement.blur()});
f.appendChild(kg(p,W("Blend all layers")));q.id="chickenpaint-chk-lock-alpha";q.type="checkbox";q.addEventListener("click",function(w){a.actionPerformed({action:"CPSetLayerLockAlpha",lock:q.checked});document.activeElement.blur()});f.appendChild(kg(q,W("Lock transparency")));f.appendChild(k.getElement());u=function(){var w=[{title:"Add layer",icon:mc("icon-file"),action:"CPAddLayer"},{title:"Add group",icon:mc("icon-folder"),action:"CPAddGroup"},{title:"Merge down",icon:mc("icon-md-download"),action:"CPLayerMergeDown",
require:["image-layer"]},{title:"Merge group",icon:mc("icon-md-collapse_all"),action:"CPGroupMerge",require:["layer-group"]},{title:"Clip to the layer below",icon:mc("icon-level-down-alt fa-flip-horizontal"),action:"CPCreateClippingMask",require:"no-clipping-mask-or-is-group"},{title:"Unclip from the layer below",icon:mc("icon-level-down-alt fa-flip-horizontal"),action:"CPReleaseClippingMask",require:"clipping-mask"},{title:"Add layer mask",icon:$e("mask"),action:"CPAddLayerMask",require:["no-mask"]},
{title:"Apply mask",icon:$e("mask"),action:"CPApplyLayerMask",require:["mask"]},{title:"Duplicate",icon:mc("icon-clone"),action:"CPLayerDuplicate"},{title:"Delete layer mask",icon:mc("icon-trash"),action:"CPRemoveLayerMask",require:"isEditingMask"},{title:"Delete layer",icon:mc("icon-trash"),action:"CPRemoveLayer",require:"isNotEditingMask"}];let D=document.createElement("ul");for(let x of(D.className="chickenpaint-layer-buttons list-unstyled",w))w=document.createElement("li"),w.setAttribute("data-action",
x.action),w.className="chickenpaint-small-toolbar-button "+(x.require?"chickenpaint-action-require-"+x.require:""),w.title=W(x.title),w.appendChild(x.icon),w.addEventListener("click",function(){a.actionPerformed({action:x.action})}),D.appendChild(w);return D}();f.appendChild(u);g.on("changeActiveLayer",function(w,D,x){k.activeLayerChanged(D,x);c()});g.on("changeLayer",function(w){g=this;b.dismissNotification();k.layerChanged(w);c()});g.on("changeStructure",d);g.on("changeLayerMaskThumb",function(w){g=
this;k.layerMaskThumbChanged(w)});g.on("changeLayerImageThumb",function(w){g=this;k.layerImageThumbChanged(w)});a.on("layerNotification",this.showNotification.bind(this));d.call(g)}function zh(){this.table=new Uint8Array(256);this.loadIdentity=function(){for(var a=0;a<256;a++)this.table[a]=a};this.loadBrightnessContrast=function(a,c){c=c>0?1/(1.0001-c):1+c;a=.5-.5*c+a;for(var d=0;d<256;d++)this.table[d]=Math.min(255,Math.max(~~(255*(d/255*c+a)),0))};this.invert=function(){for(var a=0;a<256;a++)this.table[a]=
255-this.table[a]}}function lg(a,c){let d=document.createElement("div"),b=document.createElement("label");return d.className="form-check",a.className="form-check-input",b.className="form-check-label",b.setAttribute("for",a.id),b.appendChild(a),b.appendChild(document.createTextNode(c)),d.appendChild(a),d.appendChild(b),d}function me(a){function c(H){for(let N=0;N<H.length;N++){let B=new e(H[N],32,32);B.on("click",function(){p=this.texture;f()});D.appendChild(B.getElement())}}function d(H){let N=new Na(H,
H,8);for(let B=1;B<H*H;B++)N.data[B]=255;return N}function b(H){let N=2*H,B=new Na(N,N,8);for(let P=0;P<N;P++)for(let V=0;V<N;V++)B.data[P+V*N]=255*((~~(P/H)+~~(V/H))%2!=0);return B}function g(H,N){let B=new Na(N,N,8);for(let P=0;P<N*N;P++)~~(P%N)>=H&&(B.data[P]=255);return B}function n(H,N){let B=new Na(N,N,8);for(let P=0;P<N*N;P++)P/N>=H&&(B.data[P]=255);return B}function f(){if(null!=p){q=p.clone();r&&q.mirrorHorizontally();let B=new zh;B.loadBrightnessContrast(v,y);u&&B.invert();if(1!==C){var H=
q,N=C;let P=Math.max(1,Math.floor(H.width*N)),V=Math.max(1,Math.floor(H.height*N)),L=new Na(P,V,H.bitDepth),ia=255,aa=0;for(let ma=0;ma<V;ma++)for(let ca=0;ca<P;ca++){let ra=H.data[Math.floor(ma/N)*H.width+Math.floor(ca/N)];L.data[ma*P+ca]=ra;ra<ia&&(ia=ra);ra>aa&&(aa=ra)}q=ia===aa?H:L}q.applyLUT(B)}else q=null;a.getArtwork().setBrushTexture(q);null!=w&&w.updateTexture()}function e(H,N,B){let P=document.createElement("canvas"),V=P.getContext("2d"),L=this;this.setTexture=function(ia){this.texture=
ia;this.paint()};this.getElement=function(){return P};this.paint=function(){null!=this.texture?V.fillStyle=V.createPattern(this.texture.getAsCanvas(),"repeat"):V.fillStyle="white";V.fillRect(0,0,P.width,P.height)};P.addEventListener("click",function(){L.emit("click")});P.width=N;P.height=B;this.setTexture(H)}var k;let l,h,m;Tb.call(this,a,"textures","Textures");let p,q,r=!1,u=!1,v=0,y=0,C=1,w,D=document.createElement("div"),x=this.getBodyElement();e.prototype=Object.create(Ga(Jb).prototype);e.prototype.constructor=
e;w=new function(){function H(){L.checked=u;ia.checked=r;aa.setValue(100*v+100);ma.setValue(100*y+100);ca.setValue(100*C)}let N,B,P,V=document.createElement("div"),L=document.createElement("input"),ia=document.createElement("input"),aa=new Qb(0,200,!0),ma=new Qb(0,200,!0),ca=new Qb(50,800,!1,!0,150,3.9),ra=new e(null,64,64),ka=document.createElement("button"),qa,M=new zb.Popover(ka,{html:!0,content:()=>qa,trigger:"manual",placement:"right",container:x,fallbackPlacements:[]});this.updateTexture=function(){ka.disabled=
null==q;ra.setTexture(q)};this.getElement=function(){return V};V.className="chickenpaint-texture-options";V.appendChild(ra.getElement());ka.type="button";ka.className="btn btn-light btn-sm";ka.setAttribute("data-bs-toggle","popover");ka.setAttribute("data-bs-placement","right");ka.textContent=W("Customize");(N=document.createElement("div")).className="chickenpaint-texture-controls";L.id="chickenpaint-chk-texture-invert";L.type="checkbox";L.addEventListener("click",function(A){u=this.checked;f()});
N.appendChild(lg(L,W("Inverse")));ia.id="chickenpaint-chk-texture-mirror";ia.type="checkbox";ia.addEventListener("click",function(A){r=this.checked;f()});N.appendChild(lg(ia,W("Mirror")));aa.title=function(A){return W("Brightness")+": "+(A-100)+"%"};aa.on("valueChange",function(A){v=(A-100)/100;f()});N.appendChild(aa.getElement());ma.title=function(A){return W("Contrast")+": "+(A-100)+"%"};ma.on("valueChange",function(A){y=(A-100)/100;f()});N.appendChild(ma.getElement());ca.title=function(A){return W("Scale")+
": "+A+"%"};ca.on("valueChange",function(A){C=A/100;f()});N.appendChild(ca.getElement());B=document.createElement("button");P=document.createElement("button");B.textContent="Ok";B.className="btn btn-primary btn-sm";B.type="button";B.addEventListener("click",function(A){M.hide()});N.appendChild(B);N.appendChild(document.createTextNode(" "));P.textContent=W("Reset");P.className="btn btn-secondary btn-sm";P.type="button";P.addEventListener("click",function(A){y=v=0;C=1;u=r=!1;H();f()});N.appendChild(P);
H();qa=N;ka.addEventListener("click",function(){M.toggle()});V.appendChild(ka);this.updateTexture()};x.appendChild(w.getElement());D.className="chickenpaint-texture-swatches";x.appendChild(D);c((k=[null],(l=new Na(2,2,8)).data[0]=255,l.data[3]=255,k.push(l),k.push(d(2)),k.push(d(3)),k.push(d(4)),k.push(d(6)),k.push(d(8)),k.push(g(1,2)),k.push(g(2,4)),k.push(n(1,2)),k.push(n(2,4)),k.push(b(2)),k.push(b(4)),k.push(b(8)),k.push(b(16)),k.push(function(){let H=new Na(256,256,8);for(let N=0;N<65536;N++)H.data[N]=
Math.max(0,Math.min(255,Math.floor((.65*Math.floor(256*Math.random())-128)*.65+128)));return H}()),k));k=a.getResourcesRoot()+"gfx/textures32.png?20241024.1";var G=function(H){c(H)};h=new Image;m=[];h.onload=function(){var H=document.createElement("canvas");let N=H.getContext("2d",{willReadFrequently:!0});H.width=h.width;H.height=h.height;for(H=0;H<2;H++){N.drawImage(h,0,32*H,32,32,0,0,32,32);try{let B=N.getImageData(0,0,32,32),P=new Na(32,32,8);for(let V=0;V<1024;V++)P.data[V]=B.data[4*V];m.push(P)}catch(B){console.log(B)}}G(m)};
h.src=k}function ne(a){function c(v){let y=document.createElement("div"),C=document.createElement("button"),w=document.createElement("ul"),D=document.createElement("span"),x=document.createElement("span"),G=this;this.getElement=function(){return y};this.setColor=function(N){C.setAttribute("data-color",N);var B=C.style;for(N=""+Number(N).toString(16);N.length<6;)N="0"+N;B.backgroundColor="#"+N};this.setColor(v);C.className="chickenpaint-color-swatch dropdown-toggle";D.className="dropdown-item";D.href=
"#";D.textContent=W("Remove");D.addEventListener("click",function(N){N.preventDefault();y.remove();h=!0});x.className="dropdown-item";x.href="#";x.textContent=W("Replace with current color");x.addEventListener("click",function(N){N.preventDefault();G.setColor(a.getCurColor().getRgb());h=!0});w.className="dropdown-menu";v=document.createElement("li");let H=document.createElement("li");v.appendChild(D);H.appendChild(x);w.appendChild(v);w.appendChild(H);y.className="chickenpaint-color-swatch-wrapper";
y.appendChild(C);y.appendChild(w)}function d(v){v=new c(v);m.appendChild(v.getElement())}function b(v){let y=document.createElement("span");return y.className="fa icon-"+v,y}var g;let n;let f,e,k;Tb.call(this,a,"swatches","Color swatches");var l=[16777215,0,16711680,65280,255,16776960];let h=!1,m=document.createElement("ul"),p=document.createElement("div"),q,r=this;this.getSwatches=function(){let v=m.querySelectorAll(".chickenpaint-color-swatch"),y=Array(v.length);for(let C=0;C<v.length;C++)y[C]=
parseInt(v[C].getAttribute("data-color"),10);return y};this.setSwatches=function(v){for(;m.lastChild;)m.removeChild(m.lastChild);for(let y=0;y<v.length;y++)d(v[y]);h=!0};this.isModified=function(){return h};m.className="chickenpaint-color-swatches list-unstyled";for(g=0;g<l.length;g++)m.appendChild((new c(l[g])).getElement());m.addEventListener("click",function(v){let y=v.target;/^<button data-color=/i.test(y.outerHTML)&&/chickenpaint-color-swatch/.test(y.className)&&0==v.button&&void 0!==y.getAttribute("data-color")&&
(a.setCurColor(new lb(parseInt(y.getAttribute("data-color"),10))),v.stopPropagation(),v.preventDefault())});m.addEventListener("contextmenu",function(v){let y=v.target;if(/^<button data-color=/i.test(y.outerHTML)&&/chickenpaint-color-swatch/.test(y.className)){v.preventDefault();var C=new zb.Dropdown(y);C.toggle();document.addEventListener("click",function x(D){C.hide();document.removeEventListener("click",x)})}});this.getBodyElement().appendChild(m);l=document.createElement("button");g=document.createElement("button");
n=document.createElement("ul");var u=document.createElement("span");f=document.createElement("span");g.type="button";g.title=W("Add the current brush color as a new swatch");g.className="btn chickenpaint-small-toolbar-button chickenpaint-color-swatch-add";g.appendChild(b("plus"));l.type="button";l.className="btn dropdown-toggle chickenpaint-small-toolbar-button chickenpaint-color-swatch-settings";l.setAttribute("data-bs-toggle","dropdown");l.appendChild(b("cog"));u.className="dropdown-item";u.href=
"#";u.textContent=W("Save swatches to your computer...");u.addEventListener("click",function(v){v.preventDefault();v=new Blob([(new pd).write(r.getSwatches())],{type:"application/octet-stream"});Ga(ce).saveAs(v,"oekakiswatches.aco")});f.className="dropdown-item";f.href="#";f.textContent=W("Load swatches from your computer...");f.addEventListener("click",function(v){v.preventDefault();q.onchange=function(){var y=this.files;if(!(y.length<1)){y=y[0];var C=new FileReader;C.onload=function(){let w=(new pd).read(this.result);
null!=w&&w.length>0?r.setSwatches(w):alert(W("The swatches could not be read, did you select an .aco file?"))};C.readAsArrayBuffer(y)}};q.click()});n.className="dropdown-menu";e=document.createElement("li");k=document.createElement("li");e.appendChild(u);k.appendChild(f);n.appendChild(e);n.appendChild(k);(u=document.createElement("div")).className="btn-group";u.appendChild(l);u.appendChild(n);g.addEventListener("click",function(v){d(a.getCurColor().getRgb());h=!0});p.className="chickenpaint-color-swatches-buttons";
window.File&&window.FileReader&&window.FileList&&window.Blob&&((q=document.createElement("input")).type="file",q.multiple=!1,q.style.display="none",p.appendChild(u),p.appendChild(q));p.appendChild(g);this.getBodyElement().appendChild(p)}function oe(a){function c(){let h=f.closest(".chickenpaint").querySelector(".chickenpaint-canvas");return{width:h.offsetWidth,height:h.offsetHeight}}function d(h,m){let p=h.getElement();m?f.contains(p)||f.appendChild(p):f.contains(p)&&f.removeChild(p);e.emitEvent("paletteVisChange",
[h.name,m])}let b={tool:new he(a),color:new ke(a),swatches:new ne(a),stroke:new je(a),brush:new vd(a),layers:new le(a),misc:new ie(a),textures:new me(a)},g={tool:!1,color:!1,misc:!1};var n={color:!0,textures:!0,layers:!0};let f=document.createElement("div"),e=this,k=[],l=[];for(let h in this.palettes=b,this.showPaletteByName=function(m,p){(m=b[m])&&d(m,p)},this.togglePalettes=function(){let m=a.mainGUI.getMainMenu().getElement().querySelector('.widget-nav [data-action="CPTogglePalettes"]');if(0===
l.length)f.querySelectorAll(".chickenpaint-palette").forEach(function(p){e.showPaletteByName(p.getAttribute("data-paletteName"),!1);l.push(p)}),m.classList.remove("selected");else{for(let p=0;p<l.length;p++)e.showPaletteByName(l[p].getAttribute("data-paletteName"),!0);l=[];m.classList.add("selected")}},this.updateDeselectIcon=function(){let m=a.mainGUI.getMainMenu().getElement().querySelector(".deselectIcon");var p=b.brush.getElement();let q=p.querySelector(".icon-md-deselect");p=p.querySelector(".deselectButton");
m&&q&&p&&(a.artwork.getSelection().isEmpty()?(m.style.color="",q.style.color="",p.style.boxShadow=""):(m.style.color="rgb(49, 130, 216)",q.style.color="rgb(49, 130, 216)",p.style.boxShadow="0 0 1px 1px rgb(49, 130, 216)"))},this.constrainPalettes=function(){let m=c();for(var p in b){let q=b[p];q.getX()+q.getWidth()/2>m.width&&q.setLocation(m.width-q.getWidth(),q.getY());q.getY()+q.getHeight()/2>m.height&&q.setLocation(q.getX(),m.height-q.getHeight())}p=m.width-b.tool.getWidth()-b.misc.getWidth()-
b.stroke.getWidth()-b.color.getWidth()-b.brush.getWidth()-15>0;b.swatches.getX()+b.swatches.getWidth()==b.brush.getX()+b.brush.getWidth()&&20>Math.abs(b.swatches.getY()-b.brush.getY())&&b.swatches.setLocation(b.brush.getX()-b.swatches.getWidth()-(p?5:1),0);b.layers.getY()+b.layers.getHeight()>m.height&&b.layers.setHeight(Math.max(m.height-b.layers.getY(),200))},this.arrangePalettes=function(){let m=c();var p=a.getSmallScreenMode();var q=a.mainGUI.getMainMenu().getElement(),r=q.querySelector('.dropdown-item[data-action="CPToggleSetSmallScreenMode"]');
r&&(p?r.classList.add("selected"):r.classList.remove("selected"));if(q=q.querySelector('.widget-nav [data-action="CPToggleSetSmallScreenMode"]'))q.className="widget-toggler mobile selected",q.dataset.checkbox="true",q.type="button",q.classList.add("selected"),q.dataset.selected="true",q.textContent="",r=document.createElement("span"),r.textContent=p?W("PC mode"):W("Mobile mode"),q.appendChild(r);p?(b.tool.setLocation(0,0),b.misc.setLocation(b.tool.getX()+b.tool.getWidth()+1,0),p=m.width-(b.tool.getWidth()+
b.misc.getWidth()+b.brush.getWidth())<=16?b.misc.getY()+b.misc.getHeight()+1:0,b.brush.setLocation(m.width-b.brush.getWidth()-15,p),b.textures.setWidth(m.width-b.textures.getX()),b.layers.setLocation(b.brush.getX()+b.brush.getWidth()-b.layers.getWidth(),b.textures.getY()-b.layers.getHeight()),p=Math.max(b.textures.getY()-330-1,370),b.layers.setHeight(p),b.layers.setWidth(218),b.stroke.setLocation(b.misc.getX(),b.misc.getY()+b.misc.getHeight()+1),b.swatches.setLocation(b.stroke.getX(),b.stroke.getY()+
b.stroke.getHeight()+1)):(p=m.width-b.tool.getWidth()-b.misc.getWidth()-b.stroke.getWidth()-b.color.getWidth()-b.brush.getWidth()-15>0,b.brush.setLocation(m.width-b.brush.getWidth()-15,0),q=b.brush.getY()+b.brush.getHeight(),q=m.height-q>300?q+2:q,b.layers.setSize(b.brush.getWidth()+30*!!p,m.height-q),b.layers.setLocation(b.brush.getX()+b.brush.getWidth()-b.layers.getWidth(),q),b.tool.setLocation(0,0),b.misc.setLocation(b.tool.getX()+b.tool.getWidth()+(p?5:1),0),p?b.stroke.setLocation(b.misc.getX()+
b.misc.getWidth()+(p?5:1),0):b.stroke.setLocation(b.misc.getX(),b.misc.getY()+b.misc.getHeight()+1),b.swatches.setLocation(Math.max(b.brush.getX()-b.swatches.getWidth()-(p?5:1),b.tool.getX()+b.tool.getWidth()),0),b.textures.setWidth(Math.min(b.layers.getX()-b.textures.getX(),490)));b.textures.setLocation(b.color.getX()+b.color.getWidth()+4,m.height-b.textures.getHeight());b.color.setLocation(0,Math.max(b.tool.getY()+b.tool.getHeight(),m.height-b.color.getHeight()))},a.on("smallScreen",function(m){for(let p in b)b[p].toggleCollapse(m&&
(!(p in g)||g[p]))}),this.getElement=function(){return f},f.className="chickenpaint-palettes",b){let m=b[h],p=m.getElement();m.on("paletteVisChange",function(){d(this,!1)});h in n&&m.setCollapseDownwards(!0);p.setAttribute("data-paletteName",h);k.push(p)}for(let h in b)n=b[h].getElement(),f.appendChild(n)}function Ah(a,c){function d(e){let k,l=e.dataset.action,h="true"===e.dataset.checkbox;a.isActionAllowed(l)&&(h?(e.classList.toggle("selected"),k=e.classList.contains("selected")):k=!1,a.actionPerformed({action:l,
checkbox:h,selected:k}))}let b=document.createElement("nav");b.className="navbar navbar-expand-md bg-light";b.innerHTML='\n    <div class="navbar-upper">\n      <span class="navbar-brand">litaChix</span>\n      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#chickenpaint-main-menu-content" aria-controls="chickenpaint-main-menu-content" aria-expanded="false" aria-label="Toggle main menu">\n        <span class="navbar-toggler-icon"></span>\n      </button>\n    </div>\n    <div class="collapse navbar-collapse" id="chickenpaint-main-menu-content">\n      <div class="navbar-nav"></div>\n    </div>\n    <div class="widget-nav" id="chickenpaint-palette-toggler-content"></div>\n  ';
let g=navigator.userAgent.toLowerCase().includes("mac os");b.addEventListener("touchmove",e=>e.preventDefault(),{passive:!1});b.addEventListener("click",e=>{let k=e.target.closest("[data-action]");k&&(d(k),e.preventDefault())});var n=b.querySelector(".navbar-nav");mg.forEach(e=>{function k(){setTimeout(()=>{let q=document.activeElement;q instanceof HTMLElement&&(q.matches('[data-bs-toggle="dropdown"]')||q.matches(".dropdown-item")||q.closest(".dropdown-menu"))&&q.blur()},10)}var l,h;let m=document.createElement("div");
m.className="nav-item dropdown";m.innerHTML=`
        <span class="nav-link dropdown-toggle" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">${W(e.name)}</span>
        <ul class="dropdown-menu"></ul>
      `;let p=m.querySelector(".dropdown-menu");null==(l=m.querySelector(".dropdown-toggle"))||l.addEventListener("show.bs.dropdown",()=>{let q,r;k();m.querySelectorAll("[data-action]").forEach(u=>{let v=a.isActionAllowed(u.dataset.action);u.classList.toggle("disabled",!v);"true"===u.dataset.hideIfNotAvailable&&u.classList.toggle("hidden",!v)});m.querySelectorAll(".dropdown-divider").forEach(u=>u.classList.remove("hidden"));q=Array.from(m.querySelectorAll(".dropdown-item:not(.hidden), .dropdown-divider:not(.hidden)"));
r=null;q.forEach((u,v)=>{u.classList.contains("dropdown-divider")?0===v||r?u.classList.add("hidden"):r=u:r=null});r&&r.classList.add("hidden")});null==(h=m.querySelector(".dropdown-toggle"))||h.addEventListener("hide.bs.dropdown",()=>{k()});e.children.forEach(q=>{let r;if("-"===q.name)q=document.createElement("hr"),q.className="dropdown-divider",null==p||p.appendChild(q);else if(q.action&&a.isActionSupported(q.action))if("CPSend"!==q.action||a.isActionSupported("CPContinue")){if((r=document.createElement("span")).className=
"dropdown-item",r.dataset.action=q.action,r.innerHTML=`<span>${W(q.name)}</span>`,q.checkbox&&(r.dataset.checkbox="true",q.checked&&r.classList.add("selected")),q.hideIfNotAvailable&&(r.dataset.hideIfNotAvailable="true"),q.title&&(r.title=W(q.title)),q.shortcut){g&&(q.shortcut=q.shortcut.replace(/SHIFT/im,"\u21e7").replace(/ALT/im,"\u2325").replace(/CTRL/im,"\u2318"));let v=document.createElement("small");v.className="chickenpaint-shortcut";var u=(u=q.shortcut).toUpperCase().replace(/(,.+)$/,"").replace("=",
"+");v.textContent=g?u.replace(/([^+])\+/g,"$1"):u.replace(/([^+])\+/g,"$1 ");r.appendChild(v);Ga(Xa)(q.shortcut,y=>(d(r),y.preventDefault(),y.stopPropagation(),!1))}q=document.createElement("li");q.appendChild(r);p.appendChild(q)}else q.name=W("Post Oekaki"),q.shortcut="ctrl+p"});n.appendChild(m)});(function(e,k){if(k.filter(l=>l.mnemonic&&a.isActionSupported(l.action)).forEach(l=>{let h=document.createElement("button");h.className="widget-toggler selected";h.type="button";h.dataset.action=l.action;
h.dataset.checkbox="true";h.dataset.selected=(!l.checked).toString();let m=document.createElement("span");m.textContent=l.mnemonic;h.appendChild(m);e.appendChild(h)}),"force"===a.fullScreenModeOptions()){let l=document.createElement("span");l.textContent="";l.className="upperIcon clear icon-md-crop_free";l.style.fontSize="25px";l.style.verticalAlign="bottom";l.title=W("Full-screen mode");l.dataset.action="CPArrangePalettes";l.addEventListener("click",h=>{document.fullscreenElement?document.exitFullscreen():
document.documentElement.requestFullscreen()});e.appendChild(l);document.addEventListener("fullscreenchange",()=>{c.resize();requestAnimationFrame(()=>{requestAnimationFrame(()=>{requestAnimationFrame(()=>{d(l);d(l);d(l)})})})})}if(k=k.find(l=>"CPToggleSetSmallScreenMode"===l.action)){let l=a.getSmallScreenMode(),h=document.createElement("button");h.className="widget-toggler mobile selected";h.dataset.checkbox="true";h.type="button";h.dataset.selected="true";h.style.minWidth="110px";h.textContent=
"";let m=document.createElement("span");m.textContent=l?W("PC mode"):W("Mobile mode");h.appendChild(m);h.dataset.action=k.action;e.appendChild(h)}k=document.createElement("span");k.textContent="";k.className="upperIcon clear icon-md-remove_selection";k.style.fontSize="25px";k.style.verticalAlign="bottom";k.title=W("Clear");k.dataset.action="CPClear";e.appendChild(k);k=document.createElement("span");k.textContent="";k.className="upperIcon fill icon-md-ink_selection";k.style.fontSize="25px";k.style.verticalAlign=
"bottom";k.title=W("Fill");k.dataset.action="CPFill";e.appendChild(k);k=document.createElement("span");k.textContent="";k.className="upperIcon transform icon-md-resize";k.style.fontSize="25px";k.style.verticalAlign="bottom";k.title=W("Transform");k.dataset.action="CPTransform";e.appendChild(k);k=document.createElement("span");k.textContent="";k.className="upperIcon deselectIcon icon-md-deselect";k.style.fontSize="25px";k.style.verticalAlign="bottom";k.dataset.action="CPDeselectAll";k.title=W("Deselect");
e.appendChild(k)})(b.querySelector(".widget-nav"),mg[5].children);c.getPaletteManager().on("paletteVisChange",function(e,k){e="CPPal"+e.charAt(0).toUpperCase()+e.slice(1);[...((null==b?void 0:b.querySelectorAll(`[data-action="${e}"]`))||[])].forEach(l=>{l.classList.toggle("selected",k)})});let f=b.querySelector(".dropdown-item[data-action=CPFullScreen]");a.on("fullScreen",e=>null==f?void 0:f.classList.toggle("selected",e));null==f||f.classList.toggle("selected",a.isFullScreen());this.getElement=()=>
b}function pe(a,c){let d=document.createElement("div"),b=new ee(a),g=new oe(a),n,f=!1,e=this;this.togglePalettes=function(){g.togglePalettes()};this.arrangePalettes=function(){setTimeout(g.arrangePalettes.bind(g),0)};this.constrainPalettes=function(){g.constrainPalettes()};this.showPalette=function(m,p){g.showPaletteByName(m,p)};this.getSwatches=function(){return g.palettes.swatches.getSwatches()};this.setSwatches=function(m){g.palettes.swatches.setSwatches(m)};this.getPaletteManager=function(){return g};
this.setRotation90=function(m){b.setRotation(m*Math.PI/2);g.palettes.layers.setRotation90(m)};this.setFullScreenMode=function(m){f!==m&&(f=m,e.resize(),e.arrangePalettes())};this.resize=function(m=!0){let p=window.innerHeight,q=n.getElement().getBoundingClientRect().height;b.resize(f?p-q:Math.min(Math.max(p-q-65,500),850),!1);m&&e.constrainPalettes()};n=new Ah(a,this);this.getMainMenu=function(){return n};c.appendChild(n.getElement());d.className="chickenpaint-main-section";d.appendChild(b.getElement());
d.appendChild(g.getElement());c.appendChild(d);b.on("canvasRotated90",function(m){g.palettes.layers.setRotation90(m)});screen.orientation&&screen.orientation.addEventListener("change",m=>{this.resize();requestAnimationFrame(()=>{requestAnimationFrame(()=>{requestAnimationFrame(()=>{a.actionPerformed({action:"CPArrangePalettes"});a.actionPerformed({action:"CPArrangePalettes"});a.actionPerformed({action:"CPArrangePalettes"})})})})});let k=document.getElementById("chickenpaint-main-menu-content");if(document.addEventListener("show.bs.modal",
()=>{k&&k.classList.contains("show")&&(new zb.Collapse(k,{toggle:!1})).hide()}),k){let m=document.querySelector(".chickenpaint .widget-nav");m&&(k.addEventListener("show.bs.collapse",p=>{m.classList.add("hidden")}),k.addEventListener("hidden.bs.collapse",p=>{m.classList.remove("hidden")}));window.addEventListener("resize",()=>{null==m||m.classList.remove("hidden")})}document.addEventListener("hidden.bs.collapse",this.resize.bind(this));window.addEventListener("resize",this.resize.bind(this));let l=
null,h=!1;(new ResizeObserver(()=>{let m=window.innerWidth>document.documentElement.clientWidth;m!==l&&(l=m,h||(h=!0,requestAnimationFrame(()=>{h=!1;this.resize(!1)})))})).observe(document.body);a.on("fullScreen",m=>this.setFullScreenMode(m));a.on("unsavedChanges",m=>{c.classList.toggle("chickenpaint-unsaved",m)});setTimeout(this.resize.bind(this),0)}function Bh(a){var c=document.createElement("div");c.classList.add("modal","fade","chickenpaint-about-dialog");c.setAttribute("tabindex","-1");c.setAttribute("role",
"dialog");c.innerHTML='\n        <div class="modal-dialog">\n            <div class="modal-content">\n                <div class="modal-header">\n                    <h5 class="modal-title">About litaChix</h5>\n                    <button type="button" class="btn btn-close" data-bs-dismiss="modal" aria-label="Close"></button>\n                </div>\n                <div class="modal-body">\n                    <a class="chickenpaint-on-github" target="_blank" href="https://github.com/satopian/ChickenPaint_Be" rel="noopener">\n                        <span class="icon-github"></span> litaChix on GitHub\n                    </a>\n                    <p>\n                        litaChix is a customized version of <a href="https://github.com/thenickdude/chickenpaint" target="_blank" rel="noopener">ChickenPaint</a> by satopian.\n                    </p>\n                    <p>\n                        Built on: 2026-02-05T14:30:07<br>\n                        <a href="https://www.gnu.org/licenses/" target="_blank" rel="noopener">GNU General Public License</a><br>\n                    </p>\n                    <a class="chickenpaint-on-github" target="_blank" href="https://github.com/thenickdude/chickenpaint" rel="noopener">\n                        <span class="icon-github"></span> ChickenPaint on GitHub\n                    </a>\n\n                    <p>\n                        ChickenPaint is a translation of <a href="https://github.com/thenickdude/chibipaint" target="_blank" rel="noopener">ChibiPaint</a>\n                        from Java to JavaScript by Nicholas Sherlock / Chicken Smoothie\n                    </p>\n                    <p>\n                        ChibiPaint is Copyright (c) 2006-2008 Marc Schefer. All Rights Reserved\n                    </p>\n                    <p>\n                        ChickenPaint is free software: you can redistribute it and/or modify\n                        it under the terms of the GNU General Public License as published by\n                        the Free Software Foundation, either version 3 of the License, or\n                        (at your option) any later version.\n                    </p>\n                    <p>\n                        ChickenPaint is distributed in the hope that it will be useful,\n                        but WITHOUT ANY WARRANTY; without even the implied warranty of\n                        MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n                        <a target="_blank" href="https://www.gnu.org/licenses/" rel="noopener">GNU General Public License</a> for more details.\n                    </p>\n<pre class="pre-scrollable chickenpaint-third-party-licenses">Toolbar icons designed by <a target="_blank" href="https://github.com/Anteira" rel="noopener">Miglena Lapavicheva (Anteira)</a>\n    These icons are dual-licensed under <a target="_blank" href="https://spdx.org/licenses/GPL-3.0-or-later.html" rel="noopener">GPL-3.0-or-later</a> and <a target="_blank" href="https://creativecommons.org/licenses/by/3.0/" rel="noopener">CC-BY-3.0</a>\n\nIncludes these MIT-licensed libraries:\n\n    Includes the <a target="_blank" href="https://github.com/eligrey/FileSaver.js" rel="noopener">FileSaver.js library</a>\n    Copyright (c) 2016 <a target="_blank" href="https://eligrey.com/" rel="noopener">Eli Grey</a>\n\n    Includes the <a target="_blank" href="https://github.com/nodeca/pako" rel="noopener">Pako zlib compression library</a>\n    Copyright (c) 2014-2017 by Vitaly Puzrin and Andrei Tuputcyn\n    \n    Includes the <a target="_blank" href="https://github.com/madrobby/keymaster" rel="noopener">keymaster.js</a> keyboard library\n    Copyright (c) 2011-2013 Thomas Fuchs\n\n    Includes the <a target="_blank" href="https://benalman.com/projects/jquery-throttle-debounce-plugin/" rel="noopener">jQuery throttle-debounce</a> library\n    Copyright (c) 2010 "Cowboy" Ben Alman\n    \n    Includes the <a target="_blank" href="https://github.com/Stuk/jszip/" rel="noopener">JSZip</a> library\n    Copyright (c) 2009-2016\n    Stuart Knightley,\n    David Duponchel,\n    Franz Buchinger,\n    Ant\u00f3nio Afonso\n\n    Includes the <a href="https://getbootstrap.com/" target="_blank" rel="noopener">Bootstrap</a> \n    Copyright (c) 2011-2025 <a href="https://github.com/twbs/bootstrap/blob/main/LICENSE" target="_blank" rel="noopener">The Bootstrap Authors</a>\n\n    MIT License\n\n    Permission is hereby granted, free of charge, to any person\n    obtaining a copy of this software and associated documentation\n    files (the "Software"), to deal in the Software without\n    restriction, including without limitation the rights to use,\n    copy, modify, merge, publish, distribute, sublicense, and/or\n    sell copies of the Software, and to permit persons to whom the\n    Software is furnished to do so, subject to the following\n    conditions:\n\n    The above copyright notice and this permission notice shall be\n    included in all copies or substantial portions of the Software.\n\n    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,\n    EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES\n    OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND\n    NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT \n    HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,\n    WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n    FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR\n    OTHER DEALINGS IN THE SOFTWARE.\n\nIncludes Font Awesome by Fonticons, Inc. - <a href="https://fontawesome.com/" target="_blank" rel="noopener">https://fontawesome.com/</a>\nIncludes Material Design icons by Google - <a href="https://fonts.google.com/" target="_blank" rel="noopener">https://fonts.google.com/</a>\n                    </pre>\n                </div>\n            </div>\n        </div>\n    ';
a.appendChild(c);var d=new zb.Modal(c);return c.addEventListener("hidden.bs.modal",()=>{c.remove()}),{show:function(){d.show()}}}function qe(a,c){let d=document.createElement("div");d.classList.add("modal","fade");d.setAttribute("tabindex","-1");d.setAttribute("role","dialog");d.innerHTML=`
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">${W("Complete transform")}</h5>
                    <button type="button" class="btn btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <p>
                        ${W("You need to finish transforming this layer before you can do that. What would you like to do with the transform?")}
                    </p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-light chickenpaint-cancel-transform">${W("Cancel")}</button>
                    <button type="button" class="btn btn-light chickenpaint-reject-transform">${W("Undo transform")}</button>
                    <button type="button" class="btn btn-primary chickenpaint-accept-transform">${W("Apply transform")}</button>
                </div>
            </div>
        </div>
    `;let b=this,g=d.querySelector(".chickenpaint-accept-transform"),n=d.querySelector(".chickenpaint-reject-transform"),f=d.querySelector(".chickenpaint-cancel-transform"),e=new zb.Modal(d);null==g||g.addEventListener("click",function(k){c.actionPerformed({action:"CPTransformAccept"});b.emitEvent("accept")});null==n||n.addEventListener("click",function(k){c.actionPerformed({action:"CPTransformReject"});b.emitEvent("reject")});null==f||f.addEventListener("click",function(k){e.hide()});this.show=function(){e.show()};
this.hide=function(){e.hide()};d.addEventListener("hidden.bs.modal",k=>{d.remove()});a.addEventListener("keydown",function h(l){"Enter"===l.key&&(e.hide(),c.actionPerformed({action:"CPTransformAccept"}),b.emitEvent("accept"),a.removeEventListener("keydown",h))});a.appendChild(d)}function Ch(a){let c=document.createElement("div");c.classList.add("modal","fade","chickenpaint-shortcuts-dialog");c.tabIndex=-1;c.role="dialog";c.innerHTML=`
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">${W("Shortcuts")}</h5>
                    <button type="button" class="btn btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <p>${W("Many of the menu options and painting tools have keyboard shortcuts which are written next to them or appear when you hover.")}</p>
                    <p>${W("Here are some other shortcuts which are not as obvious!")}</p>
                    <div class="chickenpaint-shortcuts-sections">
                        <div class="chickenpaint-shortcuts-section">
                            <h5>${W("Color swatches palette")}</h5>
                            <ul class="chickenpaint-shortcuts-list list-unstyled">
                                <li>
                                    <dl>
                                        <dt><span class="chickenpaint-shortcut"><span class="fa icon-mouse-pointer"></span> ${W("Left")}</span></dt>
                                        <dd>${W("Use as the drawing color")}</dd>
                                        <dt><span class="chickenpaint-shortcut"><span class="fa icon-mouse-pointer"></span> ${W("Right")}</span></dt>
                                        <dd>${W("Remove or replace a color swatch")}</dd>
                                    </dl>
                                </li>
                            </ul>
                        </div>
                        <div class="chickenpaint-shortcuts-section">
                            <h5>${W("Line drawing mode")}</h5>
                            <ul class="chickenpaint-shortcuts-list list-unstyled">
                                <li>
                                    <dl>
                                        <dt><span class="chickenpaint-shortcut"><span class="chickenpaint-shortcut-key">Shift</span> + <span class="fa icon-mouse-pointer"></span> ${W("Left")}</span></dt>
                                        <dd>${W("Snap line to nearest 45 degrees")}</dd>
                                    </dl>
                                </li>
                            </ul>
                        </div>
                        <div class="chickenpaint-shortcuts-section">
                            <h5>${W("Painting tools")}</h5>
                            <ul class="chickenpaint-shortcuts-list list-unstyled">
                                <li>
                                    <dl>
                                        <dt><span class="chickenpaint-shortcut"><span class="chickenpaint-shortcut-key">1</span> - <span class="chickenpaint-shortcut-key">9</span>, <span class="chickenpaint-shortcut-key">0</span></span></dt>
                                        <dd>${W("Change brush opacity")}</dd>
                                        <dt><span class="chickenpaint-shortcut"><span class="chickenpaint-shortcut-key">[</span>, <span class="chickenpaint-shortcut-key">]</span></span><span class="chickenpaint-shortcut-alternate">${W("or")}</span><span class="chickenpaint-shortcut"><span class="chickenpaint-shortcut-key">${af}</span> +
                                        <span class="chickenpaint-shortcut-key">${bf}</span> +  <span class="fa icon-mouse-pointer"></span> ${W("Left")}</span></dt>
                                        <dd>${W("Change brush size")}</dd>
                                    </dl>
                                </li>
                            </ul>
                        </div>
                        <div class="chickenpaint-shortcuts-section">
                            <h5>${W("Brush palette")}</h5>
                            <ul class="chickenpaint-shortcuts-list list-unstyled">
                                <li>
                                    <dl>
                                        <dt><span class="chickenpaint-shortcut"><span class="fa icon-mouse-pointer"></span> ${W("Right")}</span><span class="chickenpaint-shortcut-alternate">${W("or")}</span><span class="chickenpaint-shortcut"><span class="chickenpaint-shortcut-key">Shift</span> + <span class="fa icon-mouse-pointer"></span> ${W("Left")}</span></dt>
                                        <dd>${W("Adjust brush sliders more precisely")}</dd>
                                    </dl>
                                </li>
                            </ul>
                        </div>
                        <div class="chickenpaint-shortcuts-section">
                            <h5>${W("Zoom")}</h5>
                            <ul class="chickenpaint-shortcuts-list list-unstyled">
                                <li>
                                    <dl>
                                        <dt><span class="chickenpaint-shortcut"><span class="chickenpaint-shortcut-key">${Dh}</span>  + <span class="chickenpaint-shortcut-key">Space</span> + <span class="fa icon-mouse-pointer"></span> ${W("Left")}</span><dt>
                                        <dt><span class="chickenpaint-shortcut-alternate">${W("or")}</span>
                                        <span class="chickenpaint-shortcut-key">Z</span> + <span class="fa icon-mouse-pointer"></span> ${W("Left")}</span></dt>
                                        <dd>${W("Zoom the canvas")}</dd>
                                    </dl>
                                </li>
                            </ul>
                        </div>
                        <div class="chickenpaint-shortcuts-section">
                            <h5>${W("Drawing canvas")}</h5>
                            <ul class="chickenpaint-shortcuts-list list-unstyled">
                                <li>
                                    <dl>
                                        <dt><span class="chickenpaint-shortcut"><span class="fa icon-mouse-pointer"></span> ${W("Middle")}</span> <span class="chickenpaint-shortcut-alternate">${W("or")}</span> <span class="chickenpaint-shortcut"><span class="chickenpaint-shortcut-key">Space</span> + <span class="fa icon-mouse-pointer"></span> ${W("Left")}</span></dt>
                                        <dd>${W("Move the canvas around")}</dd>
                                        <dt><span class="chickenpaint-shortcut"><span class="chickenpaint-shortcut-key">R</span> + <span class="fa icon-mouse-pointer"></span> ${W("Left")}</span></dt>
                                        <dd>${W("Rotate the canvas")}</dd>
                                        <dt><span class="chickenpaint-shortcut"><span class="fa icon-mouse-pointer"></span> ${W("Right")}</span><span class="chickenpaint-shortcut-alternate">${W("or")}</span><span class="chickenpaint-shortcut"><span class="chickenpaint-shortcut-key">${bf}</span> + <span class="fa icon-mouse-pointer"></span> ${W("Left")}</span></dt>
                                        <dd>${W("Sample the color under the cursor")}</dd>
                                        <dt><span class="chickenpaint-shortcut"><span class="chickenpaint-shortcut-key">H</span></dt>
                                        <dd>${W("Flip View Horizontal")}</dd>
                                    </dl>
                                </li>
                            </ul>
                        </div>
                        <div class="chickenpaint-shortcuts-section">
                            <h5>${W("Layers palette")}</h5>
                            <ul class="chickenpaint-shortcuts-list list-unstyled">
                                <li>
                                    <dl>
                                        <dt><span class="chickenpaint-shortcut"><span class="fa icon-mouse-pointer"></span> ${W("Double click")}</span><span class="chickenpaint-shortcut-alternate">${W("or")}</span><span class="chickenpaint-shortcut"><span class="fa icon-mouse-pointer"></span> ${W("Right")}</span></dt>
                                        <dd>${W("Rename layer")}</dd>
                                        <dt><span class="chickenpaint-shortcut"><span class="chickenpaint-shortcut-key">Shift</span> + <span class="fa icon-mouse-pointer"></span> ${W("Left")}</span></dt>
                                        <dd>${W("Toggle mask enable/disable")}</dd>
                                        <dt><span class="chickenpaint-shortcut"><span class="chickenpaint-shortcut-key">${bf}</span> + <span class="fa icon-mouse-pointer"></span> ${W("Left")}</span></dt>
                                        <dd>${W("Toggle mask View")}</dd>
                                        <dt><span class="chickenpaint-shortcut"><span class="chickenpaint-shortcut-key">${af}</span> + <span class="fa icon-mouse-pointer"></span> ${W("Left")}</span></dt>
                                        <dd>${W("Apply layer mask")}</dd>
                                        <dt><span class="chickenpaint-shortcut"><span class="chickenpaint-shortcut-key">Shift</span> + <span class="chickenpaint-shortcut-key">${af}</span> + <span class="fa icon-mouse-pointer"></span> ${W("Left")}</span></dt>
                                        <dd>${W("Delete layer mask")}</dd>
                                    </dl>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    `;c.querySelector(".btn-close").addEventListener("click",()=>{c.remove()});let d=new zb.Modal(c);a.appendChild(c);this.show=function(){d.show()}}function Eh(a,c){let d=document.createElement("div");d.classList.add("modal","fade");d.setAttribute("tabindex","-1");d.setAttribute("role","dialog");d.innerHTML=`
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">${W("Box blur")}</h5>
                    <button type="button" class="btn btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form>
                        <div class="form-group">
                            <label>${W("Blur amount")} (1px~200px)</label>
                            <input type="number" class="form-control chickenpaint-blur-amount" value="3" min="1" max="200">
                        </div>
                        <div class="form-group">
                            <label>${W("Iterations (1~8, larger gives smoother blur)")}</label>
                            <input type="number" class="form-control chickenpaint-blur-iterations" value="1" min="1" max="8">
                        </div>
                    </form>
                    <div class="form-check mt-3">
                    <input class="form-check-input" type="checkbox" id="createMergedLayer">
                    <label class="form-check-label" for="createMergedLayer">
                    ${W("Apply to all (create merged layer)")}
                    </label>
                    </div>
                    </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-light" data-bs-dismiss="modal">${W("Cancel")}</button>
                    <button type="button" class="btn btn-primary chickenpaint-apply-box-blur" data-bs-dismiss="modal">${W("Ok")}</button>
                </div>
            </div>
        </div>
    `;let b=d.querySelector(".chickenpaint-blur-amount"),g=d.querySelector(".chickenpaint-blur-iterations"),n=d.querySelector(".chickenpaint-apply-box-blur"),f=new zb.Modal(d);this.show=function(){let e=document.getElementById("chickenpaint-main-menu-content");e&&e.classList.contains("show")&&(new zb.Collapse(e,{toggle:!1})).hide();c.setModalShown(!0);f.show()};n.addEventListener("click",e=>{var k;e=Math.min(200,Math.max(1,parseInt(null==b?void 0:b.value,10)||1));let l=Math.min(Math.max(parseInt(null==
g?void 0:g.value,10),1),8),h=null==(k=d.querySelector("#createMergedLayer"))?void 0:k.checked;c.getArtwork().boxBlur(e,e,l,h);c.setModalShown(!1);f.hide()});d.addEventListener("hidden.bs.modal",()=>{document.activeElement.blur();d.remove()});d.addEventListener("shown.bs.modal",()=>{b.focus()});d.addEventListener("keydown",e=>{"Enter"===e.key&&d.classList.contains("show")&&(n.click(),e.preventDefault())});a.appendChild(d)}function Fh(a){let c=document.createElement("div");c.classList.add("modal","fade");
c.setAttribute("tabindex","-1");c.setAttribute("role","dialog");c.innerHTML='\n        <div class="modal-dialog" role="document">\n            <div class="modal-content">\n                <div class="modal-header">\n                    <h5 class="modal-title">Drawing tablet support</h5>\n                    <button type="button" class="btn btn-close" data-bs-dismiss="modal" aria-label="Close"></button>\n                </div>\n                <div class="modal-body">\n                    <div class="chickenpaint-tablet-support chickenpaint-pointerevents-support">\n                        <h5>\n                            Built-in support for most tablets.\n                            <small>macOS, Windows 10 or newer</small>\n                        </h5>\n                        <div class="chickenpaint-supported-browsers">\n                            <div class="chickenpaint-supported-browser">\n                                <span class="icon-chrome"></span>\n                                Chrome\n                            </div>\n                            <div class="chickenpaint-supported-browser">\n                                <span class="icon-edge"></span>\n                                Edge (Windows 10)\n                            </div>\n                            <div class="chickenpaint-supported-browser">\n                                <span class="icon-firefox"></span>\n                                Firefox\n                            </div>\n                        </div>\n                        <p class="chickenpaint-not-supported">\n                            Your browser doesn\'t have built-in support for drawing tablets, please try\n                            one of the other browsers listed above.\n                        </p>\n                        <p class="chickenpaint-supported alert alert-success">\n                            Your browser has built-in support for drawing tablets!\n                        </p>\n                    </div>\n                </div>\n            </div>\n        </div>\n    ';
let d=c.querySelector(".chickenpaint-pointerevents-support"),b=!!window.PointerEvent;null==d||d.classList.toggle("supported",b);null==d||d.classList.toggle("not-supported",!b);c.addEventListener("hidden.bs.modal",n=>{c.remove()});let g=new zb.Modal(c);a.appendChild(c);this.show=function(){g.show()}}function Gh(a,c){let d=document.createElement("div");d.classList.add("modal","fade");d.setAttribute("tabindex","-1");d.setAttribute("role","dialog");d.innerHTML=`
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">${W("Grid options")}</h5>
                    <button type="button" class="btn btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form>
                        <div class="form-group">
                            <label>${W("Grid size")}</label>
                            <input type="number" class="form-control chickenpaint-grid-size" value="" min="3">
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-light" data-bs-dismiss="modal">${W("Cancel")}</button>
                    <button type="button" class="btn btn-primary chickenpaint-apply-grid-settings" data-bs-dismiss="modal">${W("Ok")}</button>
                </div>
            </div>
        </div>
    `;let b=d.querySelector(".chickenpaint-grid-size"),g=d.querySelector(".chickenpaint-apply-grid-settings"),n=new zb.Modal(d);this.show=function(){let f=document.getElementById("chickenpaint-main-menu-content");f&&f.classList.contains("show")&&(new zb.Collapse(f,{toggle:!1})).hide();n.show()};b.value=c.getGridSize();d.addEventListener("hidden.bs.modal",()=>{d.remove()});g.addEventListener("click",()=>{let f=parseInt(b.value,10);c.setGridSize(f);c.setModalShown(!1);n.hide()});d.addEventListener("shown.bs.modal",
()=>{c.setModalShown(!0);b.focus()});d.addEventListener("keydown",f=>{"Enter"===f.key&&(f.preventDefault(),g.click())});a.appendChild(d)}function Hh(a,c){let d=document.createElement("div");d.classList.add("modal","fade");d.setAttribute("tabindex","-1");d.setAttribute("role","dialog");d.innerHTML=`
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">${W("Chromatic aberration")}</h5>
                    <button type="button" class="btn btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form>
                        <div class="form-group">
                            <label>${W("Offset X")} (-64px ~ 64px)</label>
                            <input type="number" class="form-control chickenpaint-aberration-offset-x" value="" min="-64", max="64">
                        </div>
                        <div class="form-group">
                            <label>${W("Offset Y")} (-64px ~ 64px)</label>
                            <input type="number" class="form-control chickenpaint-aberration-offset-y" value="" min="-64", max="64">
                        </div>
                    </form>
                    <div class="form-check mt-3">
                    <input class="form-check-input" type="checkbox" id="createMergedLayer" checked="checked">
                    <label class="form-check-label" for="createMergedLayer">
                    ${W("Apply to all (create merged layer)")}
                    </label>
                    </div>
                    </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-light" data-bs-dismiss="modal">${W("Cancel")}</button>
                    <button type="button" class="btn btn-primary chickenpaint-apply-aberration-settings" data-bs-dismiss="modal">${W("Ok")}</button>
                </div>
            </div>
        </div>
    `;let b=d.querySelector(".chickenpaint-aberration-offset-x"),g=d.querySelector(".chickenpaint-aberration-offset-y"),n=d.querySelector(".chickenpaint-apply-aberration-settings"),f=new zb.Modal(d);this.show=function(){let e=document.getElementById("chickenpaint-main-menu-content");e&&e.classList.contains("show")&&(new zb.Collapse(e,{toggle:!1})).hide();f.show()};b.value=3;g.value=3;d.addEventListener("hidden.bs.modal",()=>{d.remove()});null==n||n.addEventListener("click",()=>{var e;let k=Math.max(-64,
Math.min(64,parseInt(null==b?void 0:b.value,10)||0)),l=Math.max(-64,Math.min(64,parseInt(null==g?void 0:g.value,10)||0)),h=null==(e=d.querySelector("#createMergedLayer"))?void 0:e.checked;c.getArtwork().chromaticAberration(k,l,h);c.setModalShown(!1);f.hide()});d.addEventListener("shown.bs.modal",()=>{c.setModalShown(!0);null==b||b.focus()});d.addEventListener("keydown",e=>{"Enter"===e.key&&(e.preventDefault(),null==n||n.click())});a.appendChild(d)}function Ih(a,c){let d=document.createElement("div");
d.classList.add("modal","fade");d.setAttribute("tabindex","-1");d.setAttribute("role","dialog");d.innerHTML=`
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">${W("Color halftone")}</h5>
                    <button type="button" class="btn btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form>
                        <div class="form-group">
                            <label>${W("Dot size")} (5px ~ 512px)</label>
                            <input type="number" class="form-control chickenpaint-aberration-dot-size" value="" min="5", max="512">
                        </div>
                    </form>
                    <div class="form-check mt-3">
                    <input class="form-check-input" type="checkbox" id="createMergedLayer" checked="checked">
                    <label class="form-check-label" for="createMergedLayer">
                    ${W("Apply to all (create merged layer)")}
                    </label>
                    </div>
                    </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-light" data-bs-dismiss="modal">${W("Cancel")}</button>
                    <button type="button" class="btn btn-primary chickenpaint-apply-aberration-settings" data-bs-dismiss="modal">${W("Ok")}</button>
                </div>
            </div>
        </div>
    `;let b=d.querySelector(".chickenpaint-aberration-dot-size"),g=d.querySelector(".chickenpaint-apply-aberration-settings"),n=new zb.Modal(d);this.show=function(){let f=document.getElementById("chickenpaint-main-menu-content");f&&f.classList.contains("show")&&(new zb.Collapse(f,{toggle:!1})).hide();n.show()};b.value=15;d.addEventListener("hidden.bs.modal",()=>{d.remove()});null==g||g.addEventListener("click",()=>{var f;let e=Math.max(5,Math.min(512,parseInt(null==b?void 0:b.value,10)||0)),k=null==
(f=d.querySelector("#createMergedLayer"))?void 0:f.checked;c.getArtwork().colorHalftone(e,k);c.setModalShown(!1);n.hide()});d.addEventListener("shown.bs.modal",()=>{c.setModalShown(!0);null==b||b.focus()});d.addEventListener("keydown",f=>{"Enter"===f.key&&(f.preventDefault(),null==g||g.click())});a.appendChild(d)}function Jh(a,c){let d=document.createElement("div");d.classList.add("modal","fade");d.setAttribute("tabindex","-1");d.setAttribute("role","dialog");d.innerHTML=`
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">${W("Mono halftone")}</h5>
                    <button type="button" class="btn btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form>
                        <div class="form-group">
                            <label>${W("Dot size")} (5px ~ 512px)</label>
                            <input type="number" class="form-control chickenpaint-aberration-dot-size" value="" min="5", max="512">
                        </div>
                    </form>
                    <div class="form-check mt-3">
                    <input class="form-check-input" type="checkbox" id="createMergedLayer">
                    <label class="form-check-label" for="createMergedLayer">
                    ${W("Apply to all (create merged layer)")}
                    </label>
                    </div>
                    </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-light" data-bs-dismiss="modal">${W("Cancel")}</button>
                    <button type="button" class="btn btn-primary chickenpaint-apply-aberration-settings" data-bs-dismiss="modal">${W("Ok")}</button>
                </div>
            </div>
        </div>
    `;let b=d.querySelector(".chickenpaint-aberration-dot-size"),g=d.querySelector(".chickenpaint-apply-aberration-settings"),n=new zb.Modal(d);this.show=function(){let f=document.getElementById("chickenpaint-main-menu-content");f&&f.classList.contains("show")&&(new zb.Collapse(f,{toggle:!1})).hide();n.show()};b.value=15;d.addEventListener("hidden.bs.modal",()=>{d.remove()});null==g||g.addEventListener("click",()=>{var f;let e=Math.max(5,Math.min(512,parseInt(null==b?void 0:b.value,10)||0)),k=null==
(f=d.querySelector("#createMergedLayer"))?void 0:f.checked;c.getArtwork().monoHalftone(e,k);c.setModalShown(!1);n.hide()});d.addEventListener("shown.bs.modal",()=>{c.setModalShown(!0);null==b||b.focus()});d.addEventListener("keydown",f=>{"Enter"===f.key&&(f.preventDefault(),null==g||g.click())});a.appendChild(d)}function Kh(a,c){let d=document.createElement("div");d.classList.add("modal","fade");d.setAttribute("tabindex","-1");d.setAttribute("role","dialog");d.innerHTML=`
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">${W("Mosaic")}</h5>
                    <button type="button" class="btn btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form>
                        <div class="form-group">
                            <label>${W("Block size")} (2px~2000px)</label>
                            <input type="number" class="form-control chickenpaint-block-size" value="" min="2", max="2000">
                        </div>
                    </form>
                    <div class="form-check mt-3">
                    <input class="form-check-input" type="checkbox" id="createMergedLayer">
                    <label class="form-check-label" for="createMergedLayer">
                    ${W("Apply to all (create merged layer)")}
                    </label>
                    </div>
                    </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-light" data-bs-dismiss="modal">${W("Cancel")}</button>
                    <button type="button" class="btn btn-primary chickenpaint-apply-aberration-settings" data-bs-dismiss="modal">${W("Ok")}</button>
                </div>
            </div>
        </div>
    `;let b=d.querySelector(".chickenpaint-block-size"),g=d.querySelector(".chickenpaint-apply-aberration-settings"),n=new zb.Modal(d);this.show=function(){let f=document.getElementById("chickenpaint-main-menu-content");f&&f.classList.contains("show")&&(new zb.Collapse(f,{toggle:!1})).hide();n.show()};b.value=6;d.addEventListener("hidden.bs.modal",()=>{d.remove()});null==g||g.addEventListener("click",()=>{var f;let e=parseInt(null==b?void 0:b.value,10);e=Math.max(2,Math.min(2E3,e||1));let k=null==
(f=d.querySelector("#createMergedLayer"))?void 0:f.checked;c.getArtwork().mosaic(e,k);c.setModalShown(!1);n.hide()});d.addEventListener("shown.bs.modal",()=>{c.setModalShown(!0);null==b||b.focus()});d.addEventListener("keydown",f=>{"Enter"===f.key&&(f.preventDefault(),null==g||g.click())});a.appendChild(d)}function Lh(a,c){let d=document.createElement("div");d.classList.add("modal","fade");d.setAttribute("tabindex","-1");d.setAttribute("role","dialog");d.innerHTML=`
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">${W("Edge expand")}</h5>
                    <button type="button" class="btn btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form>
                        <div class="form-group">
                            <label>${W("Edge expand width")} (1px ~ 128px)</label>
                            <input type="number" class="form-control chickenpaint-aberration-edgeWidth" value="" min="1", max="128">
                        </div>
                    </form>
                    <div class="form-check mt-3">
                    <input class="form-check-input" type="checkbox" id="replaceWithInnerFill">
                    <label class="form-check-label" for="replaceWithInnerFill">
                    ${W("Fill Inside with edge color")}
                    </label>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-light" data-bs-dismiss="modal">${W("Cancel")}</button>
                    <button type="button" class="btn btn-primary chickenpaint-apply-aberration-settings" data-bs-dismiss="modal">${W("Ok")}</button>
                </div>
            </div>
        </div>
    `;let b=d.querySelector(".chickenpaint-aberration-edgeWidth"),g=d.querySelector(".chickenpaint-apply-aberration-settings"),n=new zb.Modal(d);this.show=function(){let f=document.getElementById("chickenpaint-main-menu-content");f&&f.classList.contains("show")&&(new zb.Collapse(f,{toggle:!1})).hide();n.show()};b.value=5;d.addEventListener("hidden.bs.modal",()=>{d.remove()});null==g||g.addEventListener("click",()=>{var f;let e=Math.max(1,Math.min(128,parseInt(null==b?void 0:b.value,10)||0)),k=null==
(f=d.querySelector("#replaceWithInnerFill"))?void 0:f.checked;c.getArtwork().edge(e,k);c.setModalShown(!1);n.hide()});d.addEventListener("shown.bs.modal",()=>{c.setModalShown(!0);null==b||b.focus()});d.addEventListener("keydown",f=>{"Enter"===f.key&&(f.preventDefault(),null==g||g.click())});a.appendChild(d)}function re(a,c,d){let b=document.createElement("div");b.className="modal fade chickenpaint-send-dialog";b.tabIndex=-1;b.setAttribute("role","dialog");b.innerHTML=`
        <div class="modal-dialog">
            <div class="modal-content" data-stage="saving">
                <div class="modal-header">
                    <h5 class="modal-title">${W("Saving drawing...")}</h5>
                    <button type="button" class="btn btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <p class="chickenpaint-saving-progress-message">${W("Preparing your drawing to be saved, please wait...")}</p>
                    <pre class="chickenpaint-saving-error-message pre-scrollable" style="display: none;"></pre>
                    <div class="progress">
                        <div class="progress-bar" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%;"></div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-light chickenpaint-send-cancel" data-bs-dismiss="modal">${W("Cancel")}</button>
                </div>
            </div>
            <div class="modal-content" data-stage="success-not-previously-posted" style="display:none">
                <div class="modal-header">
                    <h5 class="modal-title">${W("Drawing saved!")}</h5>
                    <button type="button" class="btn btn-close" data-bs-dismiss="modal" aria-label="Close">
                    </button>
                </div>
                <div class="modal-body">
                    <p>${W("Your drawing has been saved, would you like to post it to the forum now?")}</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary chickenpaint-post-drawing" data-bs-dismiss="modal">${W("Yes, post it now")}</button>
                    <button type="button" class="btn btn-light chickenpaint-continue-drawing" data-bs-dismiss="modal">${W("No, keep drawing")}</button>
                    <button type="button" class="btn btn-light chickenpaint-exit" data-bs-dismiss="modal">${W("No, quit and I'll finish it later")}</button>
                </div>
            </div>
            <div class="modal-content" data-stage="success-already-posted" style="display:none">
                <div class="modal-header">
                    <h5 class="modal-title">${W("Drawing saved!")}</h5>
                    <button type="button" class="btn btn-close" data-bs-dismiss="modal" aria-label="Close">
                    </button>
                </div>
                <div class="modal-body">
                    <p>${W("Your drawing has been saved, would you like to view it on the forum now?")}</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary chickenpaint-post-drawing" data-bs-dismiss="modal">${W("Yes, view the post")}</button>
                    <button type="button" class="btn btn-light chickenpaint-continue-drawing" data-bs-dismiss="modal">${W("No, keep drawing")}</button>
                </div>
            </div>
            <div class="modal-content" data-stage="success-redirect" style="display:none">
                <div class="modal-header">
                    <h5 class="modal-title">${W("Drawing saved!")}</h5>
                    <button type="button" class="btn btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <p>${W("Your drawing has been saved, redirecting you to view your new post now...")}</p>
                </div>
            </div>
        </div>
    `;let g=b.querySelector(".chickenpaint-saving-progress-message"),n=b.querySelector(".chickenpaint-saving-error-message"),f=b.querySelector(".progress-bar"),e=new zb.Modal(b),k=this;d.on("savingProgress",function(h,m){g.textContent=m;f.setAttribute("aria-valuenow",100*h);f.style.width=100*h+"%"});d.on("savingComplete",function(){b.querySelector(".modal-content[data-stage='saving']").style.display="none";a.isActionSupported("CPContinue")?a.isActionSupported("CPExit")?b.querySelector(".modal-content[data-stage='success-not-previously-posted']").style.display=
"block":b.querySelector(".modal-content[data-stage='success-already-posted']").style.display="block":b.querySelector(".modal-content[data-stage='success-redirect']").style.display="block"});d.on("savingFailure",function(h){f.classList.add("progress-bar-danger");let m=W("Sorry, your drawing could not be saved, please try again later.");h&&(h=h.replace(/^CHIBIERROR\s*/,"")).length>0&&(m+=`<br><br>${W("The error returned from the server was")}:`,n.textContent=h,n.style.display="block");g.innerHTML=m});
b.querySelector(".chickenpaint-send-cancel").addEventListener("click",function(){d.cancel()});var l=b.querySelector(".chickenpaint-post-drawing");l&&l.addEventListener("click",function(){a.actionPerformed({action:"CPPost"})});(l=b.querySelector(".chickenpaint-exit"))&&(l.style.display=a.isActionSupported("CPExit")?"":"none",l.addEventListener("click",function(){alert("When you want to come back and finish your drawing, just click the 'new drawing' button again and you can choose to continue this drawing.");
a.actionPerformed({action:"CPExit"})}));b.addEventListener("hidden.bs.modal",()=>{b.remove()});c.appendChild(b);this.show=function(){e.show();k.emitEvent("shown")}}function la(a){function c(M){this.palName=M}function d(M){this.toolNum=M}function b(M){this.modeNum=M}function g(M){let A;switch(y=M==ec.EDITING_MODE_IMAGE?la.COLOR_MODE_RGB:la.COLOR_MODE_GREYSCALE,p.emitEvent("colorModeChange",[M==ec.EDITING_MODE_IMAGE?"rgb":"greyscale"]),y){case la.COLOR_MODE_RGB:A=u.clone();break;case la.COLOR_MODE_GREYSCALE:A=
new lb(lb.greyToRGB(v))}p.artwork.setForegroundColor(A.getRgb());p.emitEvent("colorChange",[A])}function n(){p.emitEvent("toolChange",[C,N[C]])}function f(M){w!=M&&(M==la.M_TRANSFORM&&(D=w),w=M,p.emitEvent("modeChange",[w]))}function e(M){f(la.M_DRAW);C=M;p.artwork.setBrush(N[M]);n()}function k(M={}){var A,K,S;let na=new Kd({artwork:p.getArtwork(),rotation:q.getRotation90(),swatches:r.getSwatches()});na.on("savingComplete",function(){p.artwork.setHasUnsavedChanges(!1)});na.on("savingFailure",function(){alert(W("Sorry, your drawing could not be saved, Please see the error message."))});
na.save({zip:null!=(A=M.zip)&&A,saveUrl:null!=(K=M.saveUrl)&&K,savedb:null!=(S=M.savedb)&&S})}function l(M,A){m&&(m.addEventListener("dblclick",function(K){K.preventDefault();K.stopPropagation()}),p.artwork.on("editModeChanged",g),r=new pe(p,m),p.mainGUI=r,p.emitEvent("fullScreen",[H]),p.emitEvent("smallScreen",[G]),B.load(),e(la.T_PEN),r.arrangePalettes(),M&&r.setSwatches(M),A&&r.setRotation90(A),window.addEventListener("beforeunload",function(K){p.artwork.getHasUnsavedChanges()&&K.preventDefault()}),
p.artwork.on("unsavedChanges",K=>{a.allowMultipleSends&&p.emitEvent("unsavedChanges",[K])}))}let h;!function(){try{if("u">typeof navigator){let M=navigator.languages;for(let A of(Array.isArray(M)||(M=[M]),M)){let K=/^(..)([-_].+)?$/.exec(A);if(K){if(K[1]=K[1].toLowerCase(),K[1]in We)return void Ve(A);if("en"===K[1])return void Ve("en")}}}}catch(M){console.error(M)}}();a.language&&Ve(a.language);let m=a.uiElem;document.addEventListener("keydown",M=>{((M.ctrlKey||M.metaKey)&&"+;=-shro".split("").includes(M.key.toLowerCase())||
"Enter"===M.key)&&M.preventDefault()});m.addEventListener("contextmenu",M=>{M.preventDefault();M.stopPropagation()},{passive:!1});let p=this,q,r,u=new lb(0),v=255,y=la.COLOR_MODE_RGB,C=la.T_PENCIL,w=la.M_DRAW,D=w,x=[4278190080,4294967295],G=!1,H=!1,N=((h=Array(la.T_MAX))[la.T_PENCIL]=new wa({toolNb:la.T_PENCIL,size:16,alpha:255,isAA:!0,minSpacing:.5,spacing:.05,pressureSize:!1,pressureAlpha:!0,tip:wa.TIP_ROUND_AA,brushMode:wa.BRUSH_MODE_PAINT,paintMode:wa.PAINT_MODE_OPACITY,smoothing:.01}),h[la.T_ERASER]=
new wa({toolNb:la.T_ERASER,size:16,alpha:255,isAA:!0,minSpacing:.5,spacing:.05,pressureSize:!1,pressureAlpha:!1,texture:0,tip:wa.TIP_ROUND_AA,brushMode:wa.BRUSH_MODE_ERASE,paintMode:wa.PAINT_MODE_OPACITY}),h[la.T_PEN]=new wa({toolNb:la.T_PEN,size:2,alpha:100,isAA:!0,minSpacing:.5,spacing:.05,pressureSize:!0,pressureAlpha:!1,tip:wa.TIP_ROUND_AA,brushMode:wa.BRUSH_MODE_PAINT,paintMode:wa.PAINT_MODE_FLOW,alphaScale:.5,smoothing:.01}),h[la.T_SOFTERASER]=new wa({toolNb:la.T_SOFTERASER,size:16,alpha:60,
isAA:!1,minSpacing:.5,spacing:.05,pressureSize:!1,pressureAlpha:!0,texture:1,tip:wa.TIP_ROUND_AIRBRUSH,brushMode:wa.BRUSH_MODE_ERASE,paintMode:wa.PAINT_MODE_FLOW,alphaScale:.125}),h[la.T_AIRBRUSH]=new wa({toolNb:la.T_AIRBRUSH,size:50,alpha:30,isAA:!1,minSpacing:.5,spacing:.05,pressureSize:!1,pressureAlpha:!0,tip:wa.TIP_ROUND_AIRBRUSH,brushMode:wa.BRUSH_MODE_PAINT,paintMode:wa.PAINT_MODE_FLOW,alphaScale:.125}),h[la.T_DODGE]=new wa({toolNb:la.T_DODGE,size:30,alpha:32,isAA:!1,minSpacing:.5,spacing:.05,
pressureSize:!1,pressureAlpha:!0,tip:wa.TIP_ROUND_AIRBRUSH,brushMode:wa.BRUSH_MODE_DODGE,paintMode:wa.PAINT_MODE_FLOW,alphaScale:.125}),h[la.T_BURN]=new wa({toolNb:la.T_BURN,size:30,alpha:32,isAA:!1,minSpacing:.5,spacing:.05,pressureSize:!1,pressureAlpha:!0,tip:wa.TIP_ROUND_AIRBRUSH,brushMode:wa.BRUSH_MODE_BURN,paintMode:wa.PAINT_MODE_FLOW,alphaScale:.125}),h[la.T_WATER]=new wa({toolNb:la.T_WATER,size:30,alpha:50,isAA:!1,minSpacing:.5,spacing:.02,pressureSize:!1,pressureAlpha:!0,tip:wa.TIP_ROUND_AA,
brushMode:wa.BRUSH_MODE_WATER,paintMode:wa.PAINT_MODE_FLOW,alphaScale:.125,resat:.3,bleed:.6}),h[la.T_BLUR]=new wa({toolNb:la.T_BLUR,size:20,alpha:255,isAA:!1,minSpacing:.5,spacing:.05,pressureSize:!1,pressureAlpha:!0,tip:wa.TIP_ROUND_PIXEL,brushMode:wa.BRUSH_MODE_BLUR,paintMode:wa.PAINT_MODE_FLOW,alphaScale:.125}),h[la.T_SMUDGE]=new wa({toolNb:la.T_SMUDGE,size:20,alpha:128,isAA:!1,minSpacing:.5,spacing:.01,pressureSize:!1,pressureAlpha:!0,tip:wa.TIP_ROUND_AIRBRUSH,brushMode:wa.BRUSH_MODE_SMUDGE,
paintMode:wa.PAINT_MODE_FLOW,alphaScale:.125,resat:0,bleed:1}),h[la.T_BLENDER]=new wa({toolNb:la.T_BLENDER,size:20,alpha:60,isAA:!1,minSpacing:.5,spacing:.1,pressureSize:!1,pressureAlpha:!0,tip:wa.TIP_ROUND_AIRBRUSH,brushMode:wa.BRUSH_MODE_OIL,paintMode:wa.PAINT_MODE_FLOW,alphaScale:.125,resat:0,bleed:.07}),h),B=new Mh,P,V,L,ia,aa,ma,ca,ra={CPFullScreen:{action:function(){p.setFullScreen(!H)},isSupported:function(){return"disable"!==a.fullScreenMode&&"force"!==a.fullScreenMode&&!1!==a.allowFullScreen},
modifies:{gui:!0}},CPZoomIn:{action:function(){q.zoomIn()},modifies:{gui:!0}},CPZoomOut:{action:function(){q.zoomOut()},modifies:{gui:!0}},CPZoom100:{action:function(){q.zoom100()},modifies:{gui:!0}},CPResetZoomAndRotation:{action:function(){q.resetZoomAndRotation();let M=r.getPaletteManager().palettes.misc.flipButton,A=r.getMainMenu().getElement().querySelector('[data-action="CPViewHFlip"]');M&&M.classList.remove("flipped");A&&A.classList.remove("selected")},modifies:{gui:!0}},CPViewHFlip:{action:function(){let M=
q.toggleViewFlip(),A=r.getPaletteManager().palettes.misc.flipButton,K=r.getMainMenu().getElement().querySelector('[data-action="CPViewHFlip"]');A&&(M?A.classList.add("flipped"):A.classList.remove("flipped"));K&&(M?K.classList.add("selected"):K.classList.remove("selected"))},modifies:{gui:!0}},CPUndo:{action:function(){p.artwork.undo()},modifies:{document:!0},allowed:"isUndoAllowed"},CPRedo:{action:function(){p.artwork.redo()},modifies:{document:!0},allowed:"isRedoAllowed"},CPClearHistory:{action:function(){confirm(W("You're about to clear the current Undo/Redo history.\nThis operation cannot be undone, are you sure you want to do that?"))&&
p.artwork.clearHistory()},modifies:{document:!0}},CPPencil:new d(la.T_PENCIL),CPPen:new d(la.T_PEN),CPEraser:new d(la.T_ERASER),CPSoftEraser:new d(la.T_SOFTERASER),CPAirbrush:new d(la.T_AIRBRUSH),CPDodge:new d(la.T_DODGE),CPBurn:new d(la.T_BURN),CPWater:new d(la.T_WATER),CPBlur:new d(la.T_BLUR),CPSmudge:new d(la.T_SMUDGE),CPBlender:new d(la.T_BLENDER),CPFloodFill:new b(la.M_FLOODFILL),CPGradientFill:new b(la.M_GRADIENTFILL),CPRectSelection:new b(la.M_RECT_SELECTION),CPMoveTool:new b(la.M_MOVE_TOOL),
CPRotateCanvas:new b(la.M_ROTATE_CANVAS),CPPanCanvas:new b(la.M_PAN_CANVAS),CPColorPicker:new b(la.M_COLOR_PICKER),CPTransform:{action:function(){let M=p.artwork.getActiveLayer();null==p.artwork.transformAffineBegin()?p.showLayerNotification(M,W("Whoops! All of the selected pixels are transparent!"),"layer"):f(la.M_TRANSFORM)},modifies:{mode:!0},allowed:function(){let M=p.artwork.getActiveLayer();if(M.visible)if(0==M.alpha)p.showLayerNotification(M,W("Whoops! This layer's opacity is currently 0%"),
"opacity");else{if(null!=p.artwork.transformAffineBegin())return 0!=M.getEffectiveAlpha();p.showLayerNotification(M,W("Whoops! All of the selected pixels are transparent!"),"layer")}else p.showLayerNotification(M,W("Whoops! This layer is currently hidden"),"layer")}},CPTransformAccept:{action:function(){w==la.M_TRANSFORM&&(p.artwork.transformAffineFinish(),f(D))},modifies:{mode:!0}},CPTransformReject:{action:function(){w==la.M_TRANSFORM&&(p.artwork.transformAffineAbort(),f(D))},modifies:{document:!0,
mode:!0}},CPFreeHand:{action:function(){N[C].strokeMode=wa.STROKE_MODE_FREEHAND;n()},modifies:{tool:!0}},CPLine:{action:function(){N[C].strokeMode=wa.STROKE_MODE_LINE;n()},modifies:{tool:!0}},CPBezier:{action:function(){N[C].strokeMode=wa.STROKE_MODE_BEZIER;n()},modifies:{tool:!0}},CPAbout:{action:function(){(new Bh(m)).show()},modifies:{}},CPShortcuts:{action:function(){(new Ch(m)).show()},modifies:{}},CPTabletSupport:{action:function(){(new Fh(m)).show()},modifies:{}},CPLayerDuplicate:{action:function(){p.artwork.duplicateLayer()},
modifies:{document:!0}},CPLayerMergeDown:{action:function(){p.artwork.mergeDown()},modifies:{document:!0},allowed:"isMergeDownAllowed"},CPGroupMerge:{action:function(){p.artwork.mergeGroup()},modifies:{document:!0},allowed:"isMergeGroupAllowed"},CPLayerMergeAll:{action:function(){p.artwork.mergeAllLayers()},modifies:{document:!0},allowed:"isMergeAllLayersAllowed"},CPCreateMergedLayer:{action:function(){p.artwork.mergeAllLayers(!0)},modifies:{document:!0},allowed:"isMergeAllLayersAllowed"},CPExpandLayerGroup:{action:function(M){p.artwork.expandLayerGroup(M.group,
M.expand)},modifies:{document:!0}},CPFill:{action:function(){p.artwork.fill(4278190080|p.getCurColor().getRgb())},modifies:{document:!0},requiresDrawable:!0},CPClear:{action:function(){p.artwork.clear()},modifies:{document:!0},requiresDrawable:!0},CPClearWithTexture:{action:function(){p.artwork.clear(!1)},modifies:{document:!0},requiresDrawable:!0},CPSelectAll:{action:function(){p.artwork.rectangleSelection(p.artwork.getBounds());q.repaintAll()},modifies:{document:!0}},CPDeselectAll:{action:function(){p.artwork.rectangleSelection(new za(0,
0,0,0));q.repaintAll()},modifies:{document:!0}},CPHFlip:{action:function(){p.artwork.hFlip()},modifies:{document:!0},requiresDrawable:!0},CPVFlip:{action:function(){p.artwork.vFlip()},modifies:{document:!0},requiresDrawable:!0},CPMNoise:{action:function(){p.artwork.monochromaticNoise()},modifies:{document:!0},requiresDrawable:!0},CPCNoise:{action:function(){p.artwork.colorNoise()},modifies:{document:!0},allowed:"isColorNoiseAllowed"},CPFXBoxBlur:{action:function(){P||=new Eh(m,p);P.show()},modifies:{document:!0},
requiresDrawable:!0},CPFXMosaic:{action:function(){L||=new Kh(m,p);L.show()},modifies:{gui:!0}},CPColorHalftone:{action:function(){ia||=new Ih(m,p);ia.show()},allowed:"isNotEditingMask",modifies:{gui:!0}},CPMonoHalftone:{action:function(){aa||=new Jh(m,p);aa.show()},modifies:{gui:!0}},CPChromaticAberration:{action:function(){ma||=new Hh(m,p);ma.show()},allowed:"isNotEditingMask",modifies:{gui:!0}},CPEdgeExpand:{action:function(){ca||=new Lh(m,p);ca.show()},allowed:"isNotEditingMaskAndDrawable",modifies:{gui:!0}},
CPFXInvert:{action:function(){p.artwork.invert()},modifies:{document:!0},requiresDrawable:!0},CPBrightnessToOpacity:{action:function(){p.artwork.brightnessToOpacity()},modifies:{document:!0},allowed:"isNotEditingMaskAndDrawable"},CPCut:{action:function(){p.artwork.cutSelection()},modifies:{document:!0},requiresDrawable:!0,allowed:"isCutSelectionAllowed"},CPCopy:{action:function(){p.artwork.copySelection()},modifies:{document:!0},requiresDrawable:!0,allowed:"isCopySelectionAllowed"},CPCopyMerged:{action:function(){p.artwork.copySelectionMerged()},
modifies:{document:!0},allowed:"isCopySelectionMergedAllowed"},CPPaste:{action:function(){p.artwork.pasteClipboard()},modifies:{document:!0},allowed:"isPasteClipboardAllowed"},CPToggleGrid:{action:function(M){q.showGrid(M.selected)},modifies:{gui:!0}},CPGridOptions:{action:function(){V||=new Gh(m,q);V.show()},modifies:{gui:!0}},CPLinearInterpolation:{action:function(M){q.setInterpolation(M.selected)},modifies:{gui:!0}},CPResetCanvasRotation:{action:function(){q.resetRotation()},modifies:{gui:!0}},
CPAddLayer:{action:function(){p.artwork.addLayer("layer")},modifies:{document:!0}},CPAddGroup:{action:function(){p.artwork.addLayer("group")},modifies:{document:!0}},CPAddLayerMask:{action:function(){p.artwork.addLayerMask()},modifies:{document:!0},allowed:"isAddLayerMaskAllowed"},CPApplyLayerMask:{action:function(){p.artwork.applyLayerMask(!0)},modifies:{document:!0},allowed:"isApplyLayerMaskAllowed"},CPRemoveLayerMask:{action:function(){p.artwork.removeLayerMask()},modifies:{document:!0},allowed:"isRemoveLayerMaskAllowed"},
CPRemoveLayer:{action:function(){p.artwork.removeLayer()||alert(W("Sorry, you can't remove the last remaining layer in the drawing."))},modifies:{document:!0},allowed:"isRemoveLayerAllowed"},CPCreateClippingMask:{action:function(){p.artwork.createClippingMask()},modifies:{document:!0},allowed:"isCreateClippingMaskAllowed"},CPReleaseClippingMask:{action:function(){p.artwork.releaseClippingMask()},modifies:{document:!0},allowed:"isReleaseClippingMaskAllowed"},CPRelocateLayer:{action:function(M){p.artwork.relocateLayer(M.layer,
M.toGroup,M.toIndex)},modifies:{document:!0}},CPSetActiveLayer:{action:function(M){M.mask&&M.layer.mask&&!M.layer.maskVisible&&p.artwork.setLayerMaskVisible(M.layer,!0);p.artwork.setActiveLayer(M.layer,M.mask);p.artwork.performIdleTasks()},modifies:{document:!0}},CPToggleMaskView:{action:function(){let M=p.artwork.toggleMaskView();M&&p.emitEvent("maskViewOpened",[M])},modifies:{gui:!0}},CPSetMaskVisible:{action:function(M){p.artwork.setLayerMaskVisible(M.layer,M.visible)},modifies:{layerProp:!0}},
CPSetLayerVisibility:{action:function(M){p.artwork.setLayerVisibility(M.layer,M.visible)},modifies:{layerProp:!0}},CPSetLayerName:{action:function(M){p.artwork.setLayerName(M.layer,M.name)},modifies:{layerProp:!0}},CPSetLayerBlendMode:{action:function(M){p.artwork.setLayerBlendMode(M.blendMode)},modifies:{layerProp:!0}},CPSetLayerAlpha:{action:function(M){p.artwork.setLayerAlpha(M.alpha)},modifies:{layerProp:!0}},CPSetLayerLockAlpha:{action:function(M){p.artwork.setLayerLockAlpha(M.lock)},modifies:{layerProp:!0}},
CPPalColor:new c("color"),CPPalBrush:new c("brush"),CPPalLayers:new c("layers"),CPPalStroke:new c("stroke"),CPPalSwatches:new c("swatches"),CPPalTool:new c("tool"),CPPalMisc:new c("misc"),CPPalTextures:new c("textures"),CPTogglePalettes:{action:function(){r.togglePalettes()},modifies:{gui:!0}},CPArrangePalettes:{action:function(){r.arrangePalettes()},modifies:{gui:!0}},CPToggleSetSmallScreenMode:{action:function(){p.setSmallScreenMode(!G);r.arrangePalettes()},modifies:{gui:!0}},CPExportAsPNG:{action:function(){k({saveUrl:a.saveUrl||
!1})},isSupported:function(){return!1!==a.allowDownload},modifies:{document:!0}},CPExportAsZIP:{action:function(){k({zip:!0,saveUrl:a.saveUrl||!1})},isSupported:function(){return!1!==a.allowDownload},modifies:{document:!0}},CPSaveDB:{action:function(){k({savedb:!0})},isSupported:function(){return!1!==a.allowDownload},modifies:{document:!0}},CPSend:{action:function(){!function(){if(p.isActionSupported("CPContinue")||confirm(W("Are you sure you want to send your drawing to the server and finish drawing now?"))){var M=
new Kd({artwork:p.getArtwork(),rotation:q.getRotation90(),swatches:r.getSwatches(),url:a.saveUrl,post_max_size:a.post_max_size}),A=new re(p,m,M);M.on("savingComplete",function(){p.artwork.setHasUnsavedChanges(!1);!p.isActionSupported("CPContinue")&&p.isActionSupported("CPPost")&&p.actionPerformed({action:"CPPost"})});M.on("savingFailure",function(){alert(W("Sorry, your drawing could not be saved, Please see the error message."))});A.on("shown",function(){M.save()});A.show()}}()},isSupported:function(){return!!a.saveUrl},
modifies:{document:!0}},CPPost:{action:function(){if("function"==typeof handleExit)return handleExit();window.location=a.postUrl},isSupported:function(){return!(!a.postUrl&&"function"!=typeof handleExit)},modifies:{document:!0}},CPContinue:{action:function(){},isSupported:function(){return!!a.allowMultipleSends}},CPExit:{action:function(){window.location=a.exitUrl},isSupported:function(){return!!a.exitUrl},modifies:{}}};switch(c.prototype.action=function(M){r.showPalette(this.palName,M.selected)},
c.prototype.modifies={gui:!0},d.prototype.action=function(){e(this.toolNum)},d.prototype.modifies={mode:!0,tool:!0},d.prototype.requiresDrawable=!0,b.prototype.action=function(){f(this.modeNum)},b.prototype.modifies={mode:!0},this.callToolListeners=function(){n()},this.getArtwork=function(){return this.artwork},this.setCanvas=function(M){q=M},this.setTransformInterpolation=function(M){this.artwork.setTransformInterpolation(M)},this.setCurColor=function(M){switch(y){case la.COLOR_MODE_RGB:u.isEqual(M)||
(u.copyFrom(M),this.artwork.setForegroundColor(M.getRgb()),this.emitEvent("colorChange",[M]));break;case la.COLOR_MODE_GREYSCALE:if(M=M.getValue(),v!=M){let A=lb.greyToRGB(M);this.artwork.setForegroundColor(A);v=M;this.emitEvent("colorChange",[new lb(A)])}}},this.getCurColor=function(){switch(y){case la.COLOR_MODE_RGB:return u.clone();case la.COLOR_MODE_GREYSCALE:return new lb(lb.greyToRGB(v))}},this.setCurGradient=function(M){x=M.slice(0);this.emitEvent("gradientChange",[x])},this.getCurGradient=
function(){return x.slice(0)},this.setBrushSize=function(M){N[C].size=Math.max(1,Math.min(200,M));n()},this.getBrushSize=function(){return N[C].size},this.setAlpha=function(M){N[C].alpha=M;n()},this.getAlpha=function(){return N[C].alpha},this.getCurMode=function(){return w},this.zoomOnCenter=function(M,A=!1){q.zoomOnCenter(M,A)},this.getZoom=function(){return q.getZoom()},this.getRotationDegrees=function(){return q.getRotationDegrees()},this.setRotationDegrees=function(M){q.setRotationDegrees(M)},
this.setGrowFillArea=function(M){q.setGrowFillArea(M)},this.setFoodFillAlpha=function(M){q.setFoodFillAlpha(M)},this.setFloodFillReferAllLayers=function(M){q.setFloodFillReferAllLayers(M)},this.setModalShown=function(M){q.setModalShown(M)},this.isPanOrRotateMode=function(){return q.isPanOrRotateMode()},this.getCurTool=function(){return C},this.getBrushInfo=function(){return N[C]},this.isActionSupported=function(M){if(ra[M]){let A=typeof ra[M].isSupported;return"function"==A?ra[M].isSupported():"undefined"==
A||ra[M].isSupported}return!1},this.isActionAllowed=function(M){M=ra[M];return!!M&&("function"==typeof M.allowed?M.allowed():"string"==typeof M.allowed?this.artwork[M.allowed]():!M.requiresDrawable||this.artwork.isActiveLayerDrawable())},this.showLayerNotification=function(M,A,K){this.emitEvent("layerNotification",[M,A,K])},this.actionPerformed=function(M){if(null!=this.artwork&&null!=q){var A=ra[M.action];if(A)if(w==la.M_TRANSFORM&&(A.modifies.document||A.modifies.mode)&&-1==["CPTransformAccept",
"CPTransformReject"].indexOf(M.action))if("CPUndo"==M.action)ra.CPTransformReject.action();else{if("CPTransform"!=M.action){let K=new qe(m,this);K.on("accept",()=>{this.actionPerformed(M);K.hide()});K.on("reject",()=>{this.actionPerformed(M);K.hide()});K.show()}}else A.action(M)}},this.setSmallScreenMode=function(M){G!==M&&(G=M,m.classList.toggle("chickenpaint-small-screen",G),p.emitEvent("smallScreen",[G]))},this.getSmallScreenMode=function(){return G},this.fullScreenModeOptions=function(){return a.fullScreenMode},
this.setFullScreen=function(M){H!==M&&(H=M,document.body.classList.toggle("chickenpaint-full-screen",H),m.classList.toggle("chickenpaint-full-screen",H),M=document.querySelectorAll('head meta[name="viewport"]').length,H&&0===M?(M=document.createElement("meta"),M.name="viewport",M.content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,,user-scalable=no",document.head.appendChild(M),setTimeout(()=>p.emitEvent("fullScreen",[H]),200)):p.emitEvent("fullScreen",[H]))},this.isFullScreen=
function(){return H},this.setToolbarStyle=function(M){B.set("toolbarStyle",M);B.save()},this.getToolbarStyle=function(){return B.get("toolbarStyle")},this.getResourcesRoot=function(){return a.resourcesRoot},m&&(m.className+=" chickenpaint chickenpaint-lang-"+Xe),a.resourcesRoot=a.resourcesRoot||"chickenpaint/",this.setSmallScreenMode(!!("number"==typeof navigator.maxTouchPoints&&navigator.maxTouchPoints>2&&(window.screen.width<=820||window.screen.height<=820))),a.fullScreenMode){case "force":this.setFullScreen(!0);
break;case "auto":this.setFullScreen(G)}B.on("toolbarStyle",M=>this.emitEvent("toolbarStyleChange",[M]));let ka=a.loadImageUrl||a.loadChibiFileUrl,qa=!1;"true"===localStorage.getItem("has_chibi_autosave_flag")&&((qa=confirm(ka?W("Unsaved data detected.\nInterrupt image loading and restore it?"):W("Unsaved data detected. Would you like to restore it?")))||Ue());oh().then(M=>{if(qa)Nf(M.bytes).then(A=>{if(this.artwork=A,M.swatches){let K=URL.createObjectURL(M.swatches);A=Object.assign({},a);A.loadSwatchesUrl=
K;A.loadImageUrl=null;A.loadChibiFileUrl=null;A=new Jd(A);A.on("loadingComplete",S=>{l(S.swatches,a.rotation);URL.revokeObjectURL(K);a.onLoaded&&a.onLoaded(this)});A.load()}else l([],a.rotation),a.onLoaded&&a.onLoaded(this)});else if(ka){let A=new Jd(a);new ph(m,A,a.resourcesRoot);A.on("loadingComplete",function(K){p.artwork=K.layers||K.flat;l(K.swatches,a.rotation);a.onLoaded&&a.onLoaded(this)});A.load()}else a.artwork?this.artwork=a.artwork:(this.artwork=new ec(a.canvasWidth||800,a.canvasHeight||
600),this.artwork.addBackgroundLayer(),this.artwork.addDefaultLayer()),l(),a.onLoaded&&a.onLoaded(this)})}var ng,og,pg,cf,df,fd,Tc="u">typeof globalThis?globalThis:"u">typeof self?self:"u">typeof window?window:"u">typeof global?global:{};wa.STROKE_MODE_FREEHAND=0;wa.STROKE_MODE_LINE=1;wa.STROKE_MODE_BEZIER=2;wa.TIP_ROUND_PIXEL=0;wa.TIP_ROUND_AA=1;wa.TIP_ROUND_AIRBRUSH=2;wa.TIP_SQUARE_PIXEL=3;wa.TIP_SQUARE_AA=4;wa.BRUSH_MODE_PAINT=0;wa.BRUSH_MODE_ERASE=1;wa.BRUSH_MODE_DODGE=2;wa.BRUSH_MODE_BURN=3;
wa.BRUSH_MODE_WATER=4;wa.BRUSH_MODE_BLUR=5;wa.BRUSH_MODE_SMUDGE=6;wa.BRUSH_MODE_OIL=7;wa.PAINT_MODE_OPACITY=0;wa.PAINT_MODE_FLOW=1;wa.DEFAULTS={isAA:!1,minSpacing:0,spacing:0,pressureSize:!0,pressureAlpha:!1,pressureScattering:!1,alphaScale:1,tip:wa.TIP_ROUND_PIXEL,brushMode:wa.BRUSH_MODE_PAINT,paintMode:wa.PAINT_MODE_OPACITY,strokeMode:wa.STROKE_MODE_FREEHAND,resat:1,bleed:0,texture:1,size:0,curSize:0,alpha:0,curAlpha:0,scattering:0,curScattering:0,squeeze:0,curSqueeze:0,angle:Math.PI,curAngle:0,
smoothing:0};wa.prototype.applyPressure=function(a){let c=this.pressureSize?Math.max(.01,this.size*a):Math.max(.01,this.size);this._lastSize||(this._lastSize=c);this._lastSize=this.curSize=this._lastSize+(c>2?.6:c>1?.8:.9)*(c-this._lastSize);this.curAlpha=this.pressureAlpha?Math.floor(this.alpha*Math.min(a,1)):this.alpha;this.curSqueeze=this.squeeze;this.curAngle=this.angle;this.curScattering=this.scattering*this.curSize*(this.pressureScattering?a:1)};wa.prototype.clone=function(){return new wa(this)};
za.prototype.makeEmpty=function(){this.bottom=this.right=this.top=this.left=0};za.prototype.union=function(a){this.isEmpty()?this.set(a):a.isEmpty()||(this.left=Math.min(this.left,a.left),this.top=Math.min(this.top,a.top),this.right=Math.max(this.right,a.right),this.bottom=Math.max(this.bottom,a.bottom))};za.prototype.getUnion=function(a){var c=this.clone();return c.union(a),c};za.prototype.getIntersection=function(a,c=!1){let d=Math.max(this.left,a.left),b=Math.max(this.top,a.top),g=Math.min(this.right,
a.right);a=Math.min(this.bottom,a.bottom);return c&&(d>=g||b>=a)?null:new za(d,b,g,a)};za.prototype.clipTo=function(a){return this.isEmpty()||(a.isEmpty()?this.makeEmpty():(this.left=Math.min(Math.max(this.left,a.left),a.right),this.top=Math.min(Math.max(this.top,a.top),a.bottom),this.right=Math.max(Math.min(this.right,a.right),a.left),this.bottom=Math.max(Math.min(this.bottom,a.bottom),a.top))),this};za.prototype.containsPoint=function(a){return!(a.x<this.left||a.y<this.top||a.x>=this.right||a.y>=
this.bottom)};za.prototype.isInside=function(a){return this.left>=a.left&&this.top>=a.top&&this.right<=a.right&&this.bottom<=a.bottom};za.prototype.clipSourceDest=function(a,c){c.right=c.left+a.getWidth();c.bottom=c.top+a.getHeight();this.isEmpty()||c.left>=this.right||c.top>=this.bottom||c.right<=this.left||c.bottom<=this.top?(a.makeEmpty(),c.makeEmpty()):(c.right>this.right&&(a.right-=c.right-this.right,c.right=this.right),c.bottom>this.bottom&&(a.bottom-=c.bottom-this.bottom,c.bottom=this.bottom),
c.left<this.left&&(a.left+=this.left-c.left,c.left=this.left),c.top<this.top&&(a.top+=this.top-c.top,c.top=this.top))};za.prototype.getWidth=function(){return this.right-this.left};za.prototype.getHeight=function(){return this.bottom-this.top};za.prototype.getArea=function(){return this.getWidth()*this.getHeight()};za.prototype.isEmpty=function(){return this.right<=this.left||this.bottom<=this.top};za.prototype.set=function(a){this.left=a.left;this.top=a.top;this.right=a.right;this.bottom=a.bottom};
za.prototype.clone=function(){return new za(this.left,this.top,this.right,this.bottom)};za.prototype.translate=function(a,c){return this.left+=a,this.right+=a,this.top+=c,this.bottom+=c,this};za.prototype.getTranslated=function(a,c){var d=this.clone();return d.translate(a,c),d};za.prototype.moveTo=function(a,c){this.translate(a-this.left,c-this.top)};za.prototype.equals=function(a){return this.left==a.left&&this.right==a.right&&this.top==a.top&&this.bottom==a.bottom};za.prototype.grow=function(a,
c){this.left-=a;this.right+=a;this.top-=c;this.bottom+=c};za.prototype.toString=function(){return"("+this.left+","+this.top+","+this.right+","+this.bottom+")"};za.prototype.toPoints=function(){return[{x:this.left,y:this.top},{x:this.right,y:this.top},{x:this.right,y:this.bottom},{x:this.left,y:this.bottom}]};za.prototype.roundNearest=function(){return this.left=Math.round(this.left),this.top=Math.round(this.top),this.right=Math.round(this.right),this.bottom=Math.round(this.bottom),this};za.prototype.roundContain=
function(){return this.left=Math.floor(this.left),this.top=Math.floor(this.top),this.right=Math.ceil(this.right),this.bottom=Math.ceil(this.bottom),this};za.createBoundingBox=function(a){if(0===a.length)return new za(0,0,0,0);let c=new za(a[0].x,a[0].y,a[0].x,a[0].y);for(let d=1;d<a.length;d++)c.left=Math.min(c.left,a[d].x),c.top=Math.min(c.top,a[d].y),c.right=Math.max(c.right,a[d].x),c.bottom=Math.max(c.bottom,a[d].y);return c};za.prototype.subtract=function(a){return za.subtract(this,a)};za.subtract=
function(a,c){a instanceof za&&(a=[a]);c instanceof za&&(c=[c]);a=a.slice(0);for(let b=0;b<c.length;b++){let g=c[b],n=a.length;for(let f=0;f<n;f++){var d=a[f];if(!d)continue;let e=d.getIntersection(g);if(!e.isEmpty()){let k=[];if(d.top<g.top&&k.push(new za(d.left,d.top,d.right,e.top)),d.bottom>g.bottom&&k.push(new za(d.left,e.bottom,d.right,d.bottom)),d.left<g.left&&k.push(new za(d.left,e.top,e.left,e.bottom)),d.right>g.right&&k.push(new za(e.right,e.top,d.right,e.bottom)),(k=k.filter(l=>!l.isEmpty())).length>
0)for(a[f]=k[0],d=1;d<k.length;d++)a.push(k[d]);else a[f]=null}}}return a.filter(b=>null!=b)};za.union=function(a){if(a instanceof za)a=[a];else{a=a.slice(0);for(let d=0;d<a.length;d++){let b=a[d],g=a.length;if(b)for(let n=d+1;n<g;n++){var c=a[n];if(c&&!b.getIntersection(c).isEmpty()){c=za.subtract(c,b);a[n]=c[0];for(let f=1;f<c.length;f++)a.push(c[f])}}}}return a.filter(d=>d&&!d.isEmpty())};"object"==typeof window&&(window.cpRectGarbage=new za(1.5,2.5,3.5,4.5));Zc.prototype.getBounds=function(){return new za(0,
0,this.width,this.height)};Zc.prototype.isInside=function(a,c){return a>=0&&c>=0&&a<this.width&&c<this.height};I.prototype=Object.create(Zc.prototype);I.prototype.constructor=I;I.BYTES_PER_PIXEL=4;I.RED_BYTE_OFFSET=0;I.GREEN_BYTE_OFFSET=1;I.BLUE_BYTE_OFFSET=2;I.ALPHA_BYTE_OFFSET=3;I.prototype.clone=function(){return this.cloneRect(this.getBounds())};I.prototype.cloneRect=function(a){var c=new I(a.getWidth(),a.getHeight());return c.copyBitmapRect(this,0,0,a),c};I.prototype.getPixel=function(a,c){a=
Math.max(0,Math.min(this.width-1,a));c=Math.max(0,Math.min(this.height-1,c));a=this.offsetOfPixel(a,c);return this.data[a+I.ALPHA_BYTE_OFFSET]<<24|this.data[a+I.RED_BYTE_OFFSET]<<16|this.data[a+I.GREEN_BYTE_OFFSET]<<8|this.data[a+I.BLUE_BYTE_OFFSET]};I.prototype.setPixel=function(a,c,d){a=Math.max(0,Math.min(this.width-1,a));c=Math.max(0,Math.min(this.height-1,c));a=this.offsetOfPixel(a,c);this.data[a+I.ALPHA_BYTE_OFFSET]=d>>24&255;this.data[a+I.RED_BYTE_OFFSET]=d>>16&255;this.data[a+I.GREEN_BYTE_OFFSET]=
d>>8&255;this.data[a+I.BLUE_BYTE_OFFSET]=255&d};I.prototype.copyRectXOR=function(a,c){var d=(c=this.getBounds().clipTo(c)).getWidth(),b=new Uint8Array(d*c.getHeight()*I.BYTES_PER_PIXEL),g=0,n=this.offsetOfPixel(c.left,c.top),f=a.offsetOfPixel(c.left,c.top),e=(this.width-d)*I.BYTES_PER_PIXEL,k=(a.width-d)*I.BYTES_PER_PIXEL;d*=I.BYTES_PER_PIXEL;for(var l=c.top;l<c.bottom;l++,n+=e,f+=k)for(var h=0;h<d;h++,g++,n++,f++)b[g]=this.data[n]^a.data[f];return b};I.prototype.setRectXOR=function(a,c){var d=(c=
this.getBounds().clipTo(c)).getWidth(),b=c.getHeight();c=this.offsetOfPixel(c.left,c.top);var g=0,n=(this.width-d)*I.BYTES_PER_PIXEL;d*=I.BYTES_PER_PIXEL;for(var f=0;f<b;f++){for(var e=0;e<d;e++)this.data[c++]^=a[g++];c+=n}};I.prototype.copyBitmapRect=function(a,c,d,b){var g=new za(c,d,0,0);b=b.clone();this.getBounds().clipSourceDest(b,g);c=0|g.getWidth();d=0|g.getHeight();if(0==g.left&&0==g.top&&c==this.width&&d==this.height&&c==a.width&&d==a.height)this.copyPixelsFrom(a);else{g=this.offsetOfPixel(g.left,
g.top);var n=(this.width-c)*I.BYTES_PER_PIXEL;b=a.offsetOfPixel(b.left,b.top);for(var f=(a.width-c)*I.BYTES_PER_PIXEL,e=0;e<d;e++,b+=f,g+=n)for(var k=0;k<c;k++,b+=I.BYTES_PER_PIXEL,g+=I.BYTES_PER_PIXEL)this.data[g]=a.data[b],this.data[g+1]=a.data[b+1],this.data[g+2]=a.data[b+2],this.data[g+3]=a.data[b+3]}};I.prototype.copyAlphaFrom=function(a,c){var d=0|(c=this.getBounds().clipTo(c)).getWidth(),b=0|c.getHeight();c=this.offsetOfPixel(c.left,c.top)+I.ALPHA_BYTE_OFFSET|0;for(var g=(this.width-d)*I.BYTES_PER_PIXEL|
0,n=0;n<b;n++,c+=g)for(var f=0;f<d;f++,c+=I.BYTES_PER_PIXEL)this.data[c]=a.data[c]};I.prototype.setToSize=function(a){(a.width!=this.width||a.height!=this.height)&&(this.width=a.width,this.height=a.height,this.imageData=we(this.width,this.height),this.data=this.imageData.data)};I.prototype.copyPixelsFrom=function(a){if(this.setToSize(a),"set"in this.data)this.data.set(a.data);else for(var c=0;c<this.data.length;c++)this.data[c]=a.data[c]};I.prototype.copyPixelsFromGreyscale=function(a){var c,d=0,
b=a.width*a.height;this.setToSize(a);for(c=0;c<b;c++,d+=I.BYTES_PER_PIXEL)this.data[d+I.RED_BYTE_OFFSET]=a.data[c],this.data[d+I.GREEN_BYTE_OFFSET]=a.data[c],this.data[d+I.BLUE_BYTE_OFFSET]=a.data[c],this.data[d+I.ALPHA_BYTE_OFFSET]=255};I.prototype.copyScaledNearestNeighbor=function(a){for(var c,d=0,b=a.width/this.width,g=a.height/this.height,n=0,f=0;n<this.height;n++,f+=g){c=a.offsetOfPixel(0,Math.round(f));for(var e=0,k=0;e<this.width;e++,d+=I.BYTES_PER_PIXEL,k+=b){var l=c+Math.round(k)*I.BYTES_PER_PIXEL;
this.data[d]=a.data[l];this.data[d+1]=a.data[l+1];this.data[d+2]=a.data[l+2];this.data[d+I.ALPHA_BYTE_OFFSET]=a.data[l+I.ALPHA_BYTE_OFFSET]}}};I.prototype.createThumbnailFrom=function(a){let c=Math.min(Math.floor(a.width/this.width),3);if(c<2)return void this.copyScaledNearestNeighbor(a);let d=new Uint16Array(5*this.width);var b=a.width*I.BYTES_PER_PIXEL,g=Math.floor(a.width/this.width)*I.BYTES_PER_PIXEL;let n=Math.floor(a.width/this.width/c)*I.BYTES_PER_PIXEL,f=g-n*c;var e=Math.floor(a.height/this.height/
c);g=e*b-g*this.width;b*=Math.floor(a.height/this.height)-e*c;let k=e=0;for(let p=0;p<this.height;p++,e+=b){let q;d.fill(0);for(var l=0;l<c;l++,e+=g){q=0;for(var h=0;h<this.width;h++,q+=5,e+=f)for(var m=0;m<c;m++,e+=n){let r=a.data[e+I.ALPHA_BYTE_OFFSET],u=r/255;d[q]+=a.data[e]*u;d[q+1]+=a.data[e+1]*u;d[q+2]+=a.data[e+2]*u;d[q+I.ALPHA_BYTE_OFFSET]+=r;d[q+4]=Math.max(d[q+4],r)}}q=0;for(l=0;l<this.width;l++,q+=5,k+=I.BYTES_PER_PIXEL)h=d[q+4],0==h?this.data[k+I.ALPHA_BYTE_OFFSET]=0:(m=h/d[q+I.ALPHA_BYTE_OFFSET],
this.data[k]=d[q]*m,this.data[k+1]=d[q+1]*m,this.data[k+2]=d[q+2]*m,this.data[k+I.ALPHA_BYTE_OFFSET]=h)}};I.prototype.floodFillWithBorder=function(a,c,d,b=2,g=255,n=null){if(this.isInside(a,c)){var f=this.width,e=this.height,k=this.data,l=n?n.data:k,h=I.BYTES_PER_PIXEL;n=d>>16&255;var m=d>>8&255;d&=255;var p=new Uint8Array(f*e),q=[{x:a,y:c}];a=(c*f+a)*h;var r=l[a+I.RED_BYTE_OFFSET],u=l[a+I.GREEN_BYTE_OFFSET],v=l[a+I.BLUE_BYTE_OFFSET],y=l[a+I.ALPHA_BYTE_OFFSET];a=(w,D)=>{if(w<0||D<0||w>=f||D>=e||p[D*
f+w])return!1;w=(D*f+w)*h;return l[w+I.RED_BYTE_OFFSET]===r&&l[w+I.GREEN_BYTE_OFFSET]===u&&l[w+I.BLUE_BYTE_OFFSET]===v&&l[w+I.ALPHA_BYTE_OFFSET]===y};for(c=(w,D,x,G,H,N)=>{w=(D*f+w)*h;k[w+I.RED_BYTE_OFFSET]=x;k[w+I.GREEN_BYTE_OFFSET]=G;k[w+I.BLUE_BYTE_OFFSET]=H;k[w+I.ALPHA_BYTE_OFFSET]=N};q.length;){let {x:w,y:D}=q.pop();a(w,D)&&(p[D*f+w]=1,c(w,D,n,m,d,g),a(w,D-1)&&q.push({x:w,y:D-1}),a(w+1,D)&&q.push({x:w+1,y:D}),a(w,D+1)&&q.push({x:w,y:D+1}),a(w-1,D)&&q.push({x:w-1,y:D}))}q=new Uint8ClampedArray(k);
for(a=0;a<e;a++)for(c=0;c<f;c++)if(p[a*f+c])for(let w=-b;w<=b;w++)for(let D=-b;D<=b;D++){var C=c+D;let x=a+w;C<0||x<0||C>=f||x>=e||p[x*f+C]||(C=(x*f+C)*h,q[C+I.RED_BYTE_OFFSET]=n,q[C+I.GREEN_BYTE_OFFSET]=m,q[C+I.BLUE_BYTE_OFFSET]=d,q[C+I.ALPHA_BYTE_OFFSET]=g)}k.set(q)}};I.prototype.copyPixelColumnToArray=function(a,c,d,b){var g=(this.width-1)*I.BYTES_PER_PIXEL,n=0;a=this.offsetOfPixel(a,c);for(c=0;c<d;c++){for(var f=0;f<I.BYTES_PER_PIXEL;f++)b[n++]=this.data[a++];a+=g}};I.prototype.copyArrayToPixelColumn=
function(a,c,d,b){var g=(this.width-1)*I.BYTES_PER_PIXEL,n=0;a=this.offsetOfPixel(a,c);for(c=0;c<d;c++){for(var f=0;f<I.BYTES_PER_PIXEL;f++)this.data[a++]=b[n++];a+=g}};I.prototype.boxBlur=function(a,c,d){let b=(a=this.getBounds().clipTo(a)).getWidth(),g=b*I.BYTES_PER_PIXEL,n=a.getHeight();var f=Math.max(b,n);let e=new Uint8Array(f*I.BYTES_PER_PIXEL);f=new Uint8Array(f*I.BYTES_PER_PIXEL);for(let h=a.top;h<a.bottom;h++){var k=this.offsetOfPixel(a.left,h);for(var l=0;l<g;l++)e[l]=this.data[k++];!function(m,
p){for(var q=0,r=0;r<p;r++){for(var u=m[q+I.ALPHA_BYTE_OFFSET],v=0;v<3;v++,q++)m[q]=Math.round(m[q]*u/255);q++}}(e,b);lf(e,f,b,c);k=this.offsetOfPixel(a.left,h);for(l=0;l<g;l++)this.data[k++]=f[l]}for(c=a.left;c<a.right;c++)this.copyPixelColumnToArray(c,a.top,n,e),lf(e,f,n,d),function(h,m){for(var p=0,q=0;q<m;q++){var r=h[p+I.ALPHA_BYTE_OFFSET];if(0!=r){r=255/r;for(var u=0;u<3;u++,p++)h[p]=Math.min(Math.round(h[p]*r),255);p++}else p+=I.BYTES_PER_PIXEL}}(f,n),this.copyArrayToPixelColumn(c,a.top,n,
f)};I.prototype.mosaic=function(a,c){a=this.getBounds().clipTo(a);c=Math.max(1,0|c);let d=I.BYTES_PER_PIXEL,b=this.width,g=this.data;for(let p=a.top;p<a.bottom;p+=c){let q=Math.min(p+c,a.bottom);for(let r=a.left;r<a.right;r+=c){let u=Math.min(r+c,a.right);var n=0,f=0,e=0,k=0,l=0;for(var h=p;h<q;h++){var m=(h*b+r)*d;for(let v=r;v<u;v++)n+=g[m],f+=g[m+1],e+=g[m+2],k+=g[m+3],l++,m+=d}n=n/l|0;f=f/l|0;e=e/l|0;k=k/l|0;for(l=p;l<q;l++)for(h=(l*b+r)*d,m=r;m<u;m++)g[h]=n,g[h+1]=f,g[h+2]=e,g[h+3]=k,h+=d}}};
I.prototype.chromaticAberration=function(a,c,d){c=Math.max(-64,Math.min(64,0|c));d=Math.max(-64,Math.min(64,0|d));a=this.getBounds().clipTo(a);let b=this.width,g=this.height,n=I.BYTES_PER_PIXEL,f=new Uint8ClampedArray(this.data),e=new Uint8ClampedArray(this.data.length);e.set(f);for(let l=a.top;l<a.bottom;l++)for(let h=a.left;h<a.right;h++){let m=(l*b+h)*n,p=f[m+I.ALPHA_BYTE_OFFSET]/255;if(0!==p){var k=(Math.min(g-1,Math.max(0,l+d))*b+Math.min(b-1,Math.max(0,h+c)))*n;e[k+I.BLUE_BYTE_OFFSET]=Math.round(f[m+
I.BLUE_BYTE_OFFSET]*p+e[k+I.BLUE_BYTE_OFFSET]*(1-p));k=(Math.min(g-1,Math.max(0,l-d))*b+Math.min(b-1,Math.max(0,h-c)))*n;e[k+I.RED_BYTE_OFFSET]=Math.round(f[m+I.RED_BYTE_OFFSET]*p+e[k+I.RED_BYTE_OFFSET]*(1-p))}}this.data.set(e)};I.prototype.colorHalftone=function(a,c,d=1){c=Math.max(2,0|c);this.getBounds().clipTo(a);let b=this.width,g=this.height,n=I.BYTES_PER_PIXEL,f=new Uint8ClampedArray(this.data);a=new Uint8ClampedArray(this.data.length);let e=.5*b,k=.5*g;for(var l=0;l<a.length;l+=4)a[l]=a[l+
1]=a[l+2]=255,a[l+3]=255;d*=c;c*=.5;var h=Math.ceil(Math.sqrt(b*b+g*g));l=(h-b)*.5;h=(h-g)*.5;for(var m of[{idx:0,r:0,g:255,b:255,angle:15*Math.PI/180},{idx:1,r:255,g:0,b:255,angle:75*Math.PI/180},{idx:2,r:255,g:255,b:0,angle:30*Math.PI/180}]){let w=Math.cos(m.angle),D=Math.sin(m.angle);for(let x=-h;x<g+h;x+=d)for(let G=-l;G<b+l;G+=d){var p=G+.5*d-e,q=x+.5*d-k,r=p*w-q*D+e;p=p*D+q*w+k;q=Math.round(r);var u=Math.round(p);if(!(q<0||u<0||q>=b||u>=g||(q=(u*b+q)*n,u=f[q+3]/255,u<=0||(q=[1-(f[q]/255*u+(1-
u)),1-(f[q+1]/255*u+(1-u)),1-(f[q+2]/255*u+(1-u))][m.idx],q<=0)))){q=.6+(c-.6)*Math.pow(q,.85);u=m.r;var v=m.g,y=m.b;let H=q*q;for(let N=-q;N<=q;N++)for(let B=-q;B<=q;B++){if(B*B+N*N>H)continue;var C=Math.round(r+B);let P=Math.round(p+N);C<0||P<0||C>=b||P>=g||(C=(P*b+C)*n,a[C]=a[C]*u>>8,a[C+1]=a[C+1]*v>>8,a[C+2]=a[C+2]*y>>8,a[C+3]=255)}!0}}}for(m=0;m<a.length;m+=4)255===a[m]&&255===a[m+1]&&255===a[m+2]&&(a[m+3]=0);this.data.set(a)};I.prototype.edge=function(a,c,d,b){c=Math.max(1,0|c);a=this.getBounds().clipTo(a);
var g=d>>16&255,n=d>>8&255;let f=255&d,e=this.width;var k=this.height;let l=I.BYTES_PER_PIXEL;d=new Uint8ClampedArray(this.data);let h=new Uint8ClampedArray(this.data.length);k=new Int32Array(e*k);for(var m=a.top;m<a.bottom;m++)for(var p=a.left;p<a.right;p++)k[m*e+p]=d[(m*e+p)*l+3]>0?0:1E9;c*=10;for(m=a.top;m<a.bottom;m++)for(p=a.left;p<a.right;p++){var q=m*e+p,r=k[q];p>a.left&&(r=Math.min(r,k[q-1]+10));m>a.top&&(r=Math.min(r,k[q-e]+10));p>a.left&&m>a.top&&(r=Math.min(r,k[q-e-1]+14));p<a.right-1&&
m>a.top&&(r=Math.min(r,k[q-e+1]+14));k[q]=r}for(m=a.bottom-1;m>=a.top;m--)for(p=a.right-1;p>=a.left;p--)q=m*e+p,r=k[q],p<a.right-1&&(r=Math.min(r,k[q+1]+10)),m<a.bottom-1&&(r=Math.min(r,k[q+e]+10)),p<a.right-1&&m<a.bottom-1&&(r=Math.min(r,k[q+e+1]+14)),p>a.left&&m<a.bottom-1&&(r=Math.min(r,k[q+e-1]+14)),k[q]=r;for(m=a.top;m<a.bottom;m++)for(p=a.left;p<a.right;p++){r=m*e+p;q=k[r];if(q>c)continue;r*=l;let u=1;q>c-10&&(u=(c-q)/10,u*=u);h[r]=g;h[r+1]=n;h[r+2]=f;h[r+3]=255*u}if(!b)for(a=0;a<h.length;a+=
4)b=d[a+3]/255,0!==b&&(g=h[a+3]/255,n=b+g*(1-b),h[a]=(d[a]*b+h[a]*g*(1-b))/n,h[a+1]=(d[a+1]*b+h[a+1]*g*(1-b))/n,h[a+2]=(d[a+2]*b+h[a+2]*g*(1-b))/n,h[a+3]=255*n);this.data.set(h)};I.prototype.monoHalftone=function(a,c,d=0,b=1){c=Math.max(2,0|c);this.getBounds().clipTo(a);a=this.width;let g=this.height,n=I.BYTES_PER_PIXEL,f=new Uint8ClampedArray(this.data),e=new Uint8ClampedArray(this.data.length);for(var k=0;k<e.length;k+=4)e[k]=e[k+1]=e[k+2]=0,e[k+3]=0;k=d>>16&255;let l=d>>8&255;d&=255;let h=.5*a,
m=.5*g;var p=45*Math.PI/180;let q=Math.cos(p);p=Math.sin(p);b*=c;c*=.5;var r=Math.ceil(Math.sqrt(a*a+g*g));let u=(r-a)*.5;r=(r-g)*.5;for(let x=-r;x<g+r;x+=b)for(let G=-u;G<a+u;G+=b){var v=G+.5*b-h,y=x+.5*b-m,C=v*q-y*p+h;v=v*p+y*q+m;y=0|C;var w=0|v;if(!(y<0||w<0||y>=a||w>=g||(y=(w*a+y)*n,w=f[y+3]/255,y=1-((.2126*f[y]+.7152*f[y+1]+.0722*f[y+2])/255*w+(1-w)),y<=0))){y=.5+(c-.5)*Math.pow(y,.9);w=y*y;for(let H=-y;H<=y;H++)for(let N=-y;N<=y;N++){if(N*N+H*H>w)continue;var D=C+N|0;let B=v+H|0;D<0||B<0||D>=
a||B>=g||(D=(B*a+D)*n,e[D]=k,e[D+1]=l,e[D+2]=d,e[D+3]=255)}!0}}this.data.set(e)};I.prototype.offsetOfPixel=function(a,c){return(c*this.width+a)*4|0};I.prototype.getMemorySize=function(){return this.data.length};I.prototype.getImageData=function(){return this.imageData};I.prototype.setImageData=function(a){this.width=a.width;this.height=a.height;this.imageData=a;this.data=a.data};I.prototype.clearAll=function(a){if(0==a&&"fill"in this.data)this.data.fill(0);else{var c=a>>24&255,d=a>>16&255,b=a>>8&
255;a&=255;for(var g=0;g<this.width*this.height*I.BYTES_PER_PIXEL;)this.data[g++]=d,this.data[g++]=b,this.data[g++]=a,this.data[g++]=c}};I.prototype.clearRect=function(a,c){a=this.getBounds().clipTo(a);var d=c>>24&255,b=c>>16&255,g=c>>8&255;c&=255;for(var n=(this.width-a.getWidth())*I.BYTES_PER_PIXEL,f=this.offsetOfPixel(a.left,a.top),e=a.top;e<a.bottom;e++,f+=n)for(var k=a.left;k<a.right;k++)this.data[f++]=b,this.data[f++]=g,this.data[f++]=c,this.data[f++]=d};I.prototype.copyRegionHFlip=function(a,
c){a=this.getBounds().clipTo(a);for(var d=a.top;d<a.bottom;d++)for(var b=this.offsetOfPixel(a.left,d),g=c.offsetOfPixel(a.right-1,d),n=a.left;n<a.right;n++,g-=2*I.BYTES_PER_PIXEL)for(var f=0;f<I.BYTES_PER_PIXEL;f++)this.data[b++]=c.data[g++]};I.prototype.copyRegionVFlip=function(a,c){for(var d=(a=this.getBounds().clipTo(a)).getWidth()*I.BYTES_PER_PIXEL,b=a.top;b<a.bottom;b++)for(var g=this.offsetOfPixel(a.left,b),n=c.offsetOfPixel(a.left,a.bottom-1-(b-a.top)),f=0;f<d;f++)this.data[g++]=c.data[n++]};
I.prototype.fillWithNoise=function(a,c=0){a=this.getBounds().clipTo(a);let d=c>>16&255,b=c>>8&255;c&=255;for(var g=(this.width-a.getWidth())*I.BYTES_PER_PIXEL,n=this.offsetOfPixel(a.left,a.top),f=a.top;f<a.bottom;f++,n+=g)for(var e=a.left;e<a.right;e++,n+=I.BYTES_PER_PIXEL){let k=1-(256*Math.random()|0)/255;this.data[n+I.RED_BYTE_OFFSET]=255-(255-d)*k|0;this.data[n+I.GREEN_BYTE_OFFSET]=255-(255-b)*k|0;this.data[n+I.BLUE_BYTE_OFFSET]=255-(255-c)*k|0;this.data[n+I.ALPHA_BYTE_OFFSET]=255}};I.prototype.gradientHorzReplace=
function(a,c,d,b){var g={r:b[0]>>16&255,g:b[0]>>8&255,b:255&b[0],a:b[0]>>24&255};b={r:b[1]>>16&255,g:b[1]>>8&255,b:255&b[1],a:b[1]>>24&255};var n=(this.width-a.getWidth())*I.BYTES_PER_PIXEL,f=0|this.offsetOfPixel(a.left,a.top),e=a.bottom-a.top|0;if(d<c){var k=d;d=c;c=k;k=g;g=b;b=k}var l=d-c|0;k=(b.r-g.r)/l;var h=(b.g-g.g)/l,m=(b.b-g.b)/l;l=(b.a-g.a)/l;for(var p=Math.max(a.left-c,0),q=0;q<e;q++,f+=n){for(var r=a.left,u=0|Math.min(c,a.right);r<u;r++,f+=I.BYTES_PER_PIXEL)this.data[f+I.RED_BYTE_OFFSET]=
g.r,this.data[f+I.GREEN_BYTE_OFFSET]=g.g,this.data[f+I.BLUE_BYTE_OFFSET]=g.b,this.data[f+I.ALPHA_BYTE_OFFSET]=g.a;var v=g.r+k*p,y=g.g+h*p,C=g.b+m*p,w=g.a+l*p;for(u=0|Math.min(d,a.right);r<u;r++,f+=I.BYTES_PER_PIXEL)this.data[f+I.RED_BYTE_OFFSET]=v,this.data[f+I.GREEN_BYTE_OFFSET]=y,this.data[f+I.BLUE_BYTE_OFFSET]=C,this.data[f+I.ALPHA_BYTE_OFFSET]=w,v+=k,y+=h,C+=m,w+=l;for(;r<a.right;r++,f+=I.BYTES_PER_PIXEL)this.data[f+I.RED_BYTE_OFFSET]=b.r,this.data[f+I.GREEN_BYTE_OFFSET]=b.g,this.data[f+I.BLUE_BYTE_OFFSET]=
b.b,this.data[f+I.ALPHA_BYTE_OFFSET]=b.a}};I.prototype.gradientVertReplace=function(a,c,d,b){var g={r:b[0]>>16&255,g:b[0]>>8&255,b:255&b[0],a:b[0]>>24&255};b={r:b[1]>>16&255,g:b[1]>>8&255,b:255&b[1],a:b[1]>>24&255};let n=(this.width-a.getWidth())*I.BYTES_PER_PIXEL,f=0|this.offsetOfPixel(a.left,a.top),e=a.right-a.left|0;if(d<c){var k=d;d=c;c=k;k=g;g=b;b=k}k=a.top;for(var l=0|Math.min(a.bottom,c);k<l;k++,f+=n)for(var h=0;h<e;h++,f+=I.BYTES_PER_PIXEL)this.data[f+I.RED_BYTE_OFFSET]=g.r,this.data[f+I.GREEN_BYTE_OFFSET]=
g.g,this.data[f+I.BLUE_BYTE_OFFSET]=g.b,this.data[f+I.ALPHA_BYTE_OFFSET]=g.a;var m=d-c|0;l=(b.r-g.r)/m;h=(b.g-g.g)/m;var p=(b.b-g.b)/m;m=(b.a-g.a)/m;var q=Math.max(k-c,0);c=g.r+l*q;var r=g.g+h*q,u=g.b+p*q;g=g.a+m*q;for(d=0|Math.min(a.bottom,d);k<d;k++,f+=n){for(q=0;q<e;q++,f+=I.BYTES_PER_PIXEL)this.data[f+I.RED_BYTE_OFFSET]=c,this.data[f+I.GREEN_BYTE_OFFSET]=r,this.data[f+I.BLUE_BYTE_OFFSET]=u,this.data[f+I.ALPHA_BYTE_OFFSET]=g;c+=l;r+=h;u+=p;g+=m}for(;k<a.bottom;k++,f+=n)for(d=0;d<e;d++,f+=I.BYTES_PER_PIXEL)this.data[f+
I.RED_BYTE_OFFSET]=b.r,this.data[f+I.GREEN_BYTE_OFFSET]=b.g,this.data[f+I.BLUE_BYTE_OFFSET]=b.b,this.data[f+I.ALPHA_BYTE_OFFSET]=b.a};I.prototype.gradientReplace=function(a,c,d,b,g,n){var f=(this.width-a.getWidth())*I.BYTES_PER_PIXEL,e=0|this.offsetOfPixel(a.left,a.top),k=a.right-a.left|0,l=n[0]>>16&255,h=n[0]>>8&255,m=255&n[0],p=n[0]>>24&255,q=n[1]>>16&255,r=n[1]>>8&255,u=255&n[1];n=n[1]>>24&255;var v=g-d+(b-c)*(b-c)/(g-d);b=b-c+(g-d)*(g-d)/(b-c);g=1/b;for(var y=a.top;y<a.bottom;y++,e+=f)for(var C=
(a.left-c)/b+(y-d)/v,w=0;w<k;w++,e+=I.BYTES_PER_PIXEL){var D=Math.min(Math.max(C,0),1),x=1-D;this.data[e+I.RED_BYTE_OFFSET]=l*x+q*D;this.data[e+I.GREEN_BYTE_OFFSET]=h*x+r*D;this.data[e+I.BLUE_BYTE_OFFSET]=m*x+u*D;this.data[e+I.ALPHA_BYTE_OFFSET]=p*x+n*D;C+=g}};I.prototype.gradientAlpha=function(a,c,d,b,g,n){var f=(this.width-a.getWidth())*I.BYTES_PER_PIXEL,e=0|this.offsetOfPixel(a.left,a.top),k=a.right-a.left|0,l=n[0]>>16&255,h=n[0]>>8&255,m=255&n[0],p=n[0]>>24&255,q=n[1]>>16&255,r=n[1]>>8&255,u=
255&n[1];n=n[1]>>24&255;var v=g-d+(b-c)*(b-c)/(g-d);b=b-c+(g-d)*(g-d)/(b-c);g=1/b;for(var y=a.top;y<a.bottom;y++,e+=f)for(var C=(a.left-c)/b+(y-d)/v,w=0;w<k;w++,e+=I.BYTES_PER_PIXEL){var D=Math.min(Math.max(C,0),1),x=1-D,G=l*x+q*D,H=h*x+r*D,N=m*x+u*D;x=p*x+n*D;D=this.data[e+I.ALPHA_BYTE_OFFSET];D=x+D-x*D/255|0;if(D>0){x=255*x/D|0;var B=255-x;this.data[e+I.RED_BYTE_OFFSET]=(G*x+this.data[e+I.RED_BYTE_OFFSET]*B)/255|0;this.data[e+I.GREEN_BYTE_OFFSET]=(H*x+this.data[e+I.GREEN_BYTE_OFFSET]*B)/255|0;this.data[e+
I.BLUE_BYTE_OFFSET]=(N*x+this.data[e+I.BLUE_BYTE_OFFSET]*B)/255|0;this.data[e+I.ALPHA_BYTE_OFFSET]=D}C+=g}};I.prototype.gradient=function(a,c,d,b,g,n,f){a=this.getBounds().clipTo(a);(c!=b||d!=g)&&(f||n[0]>>>24==255&&n[1]>>>24==255?c==b?this.gradientVertReplace(a,d,g,n):d==g?this.gradientHorzReplace(a,c,b,n):this.gradientReplace(a,c,d,b,g,n):this.gradientAlpha(a,c,d,b,g,n))};I.prototype.fillWithColorNoise=function(a){a=this.getBounds().clipTo(a);for(var c,d=(this.width-a.getWidth())*I.BYTES_PER_PIXEL,
b=this.offsetOfPixel(a.left,a.top),g=a.top;g<a.bottom;g++,b+=d)for(var n=a.left;n<a.right;n++,b+=I.BYTES_PER_PIXEL)c=16777216*Math.random()|0,this.data[b+I.RED_BYTE_OFFSET]=c>>16&255,this.data[b+I.GREEN_BYTE_OFFSET]=c>>8&255,this.data[b+I.BLUE_BYTE_OFFSET]=255&c,this.data[b+I.ALPHA_BYTE_OFFSET]=255};I.prototype.invert=function(a){a=this.getBounds().clipTo(a);for(var c=(this.width-a.getWidth())*I.BYTES_PER_PIXEL,d=this.offsetOfPixel(a.left,a.top),b=a.top;b<a.bottom;b++,d+=c)for(var g=a.left;g<a.right;g++,
d+=I.BYTES_PER_PIXEL)this.data[d+I.RED_BYTE_OFFSET]^=255,this.data[d+I.GREEN_BYTE_OFFSET]^=255,this.data[d+I.BLUE_BYTE_OFFSET]^=255};I.prototype.brightnessToOpacity=function(a){a=this.getBounds().clipTo(a);let c=(this.width-a.getWidth())*I.BYTES_PER_PIXEL,d=this.offsetOfPixel(a.left,a.top);for(let g=a.top;g<a.bottom;g++,d+=c)for(let n=a.left;n<a.right;n++,d+=I.BYTES_PER_PIXEL){var b=void 0;b=(this.data[d+I.RED_BYTE_OFFSET]+this.data[d+I.GREEN_BYTE_OFFSET]+this.data[d+I.BLUE_BYTE_OFFSET])/3;let f=
this.data[d+I.ALPHA_BYTE_OFFSET]/255;b=b>250?0:Math.round((1-b/250)*255);this.data[d+I.ALPHA_BYTE_OFFSET]=Math.round(b*f);b>0&&(this.data[d+I.RED_BYTE_OFFSET]=0,this.data[d+I.GREEN_BYTE_OFFSET]=0,this.data[d+I.BLUE_BYTE_OFFSET]=0)}};I.prototype.getNonTransparentBounds=function(a){var c,d,b=a.clone();var g=(this.width-b.getWidth())*I.BYTES_PER_PIXEL;a=this.offsetOfPixel(b.left,b.top)+I.ALPHA_BYTE_OFFSET;for(d=b.top;d<b.bottom;d++,a+=g){var n=0;for(c=b.left;c<b.right;c++,a+=I.BYTES_PER_PIXEL)n|=this.data[a];
if(0!=n)break}if(b.top=d,b.top==b.bottom)return b;a=this.offsetOfPixel(b.right-1,b.bottom-1)+I.ALPHA_BYTE_OFFSET;for(d=b.bottom-1;d>=b.top;d--,a-=g){n=0;for(c=b.right-1;c>=b.left;c--,a-=I.BYTES_PER_PIXEL)n|=this.data[a];if(0!=n)break}b.bottom=d+1;g=I.BYTES_PER_PIXEL*this.width;for(c=b.left;c<b.right;c++){a=this.offsetOfPixel(c,b.top)+I.ALPHA_BYTE_OFFSET;n=0;for(d=b.top;d<b.bottom;d++,a+=g)n|=this.data[a];if(0!=n)break}b.left=c;for(c=b.right-1;c>=b.left;c--){a=this.offsetOfPixel(c,b.top)+I.ALPHA_BYTE_OFFSET;
n=0;for(d=b.top;d<b.bottom;d++,a+=g)n|=this.data[a];if(0!=n)break}return b.right=c+1,b};I.prototype.getAsCanvas=function(a){var c=$c(this.imageData.width,this.imageData.height);return c.getContext("2d").putImageData(this.imageData,0,0),mf(c,a||0)};I.prototype.getAsPNG=function(a){var c;return"string"==typeof(c=this.getAsCanvas(a).toDataURL("image/png"))&&!!c.match(/^data:image\/png;base64,/i)&&window.atob(c.substring(22))};I.prototype.getAsPNGBuffer=function(a){return this.getAsCanvas(a).toBuffer("image/png")};
I.prototype.hasAlphaInRect=function(a){a=this.getBounds().clipTo(a);for(var c=(this.width-a.getWidth())*I.BYTES_PER_PIXEL,d=this.offsetOfPixel(a.left,a.top)+I.ALPHA_BYTE_OFFSET,b=a.top;b<a.bottom;b++,d+=c){for(var g=255,n=a.left;n<a.right;n++,d+=I.BYTES_PER_PIXEL)g&=this.data[d];if(255!=g)return!0}return!1};I.prototype.hasAlpha=function(){return this.hasAlphaInRect(this.getBounds())};I.createFromImage=function(a){var c=$c(a.width,a.height).getContext("2d");return c.globalCompositeOperation="copy",
c.drawImage(a,0,0),new I(c.getImageData(0,0,a.width,a.height))};I.prototype.equals=function(a){if(this.width!=a.width||this.height!=a.height)return!1;for(let c=0;c<this.data.length;c+=I.BYTES_PER_PIXEL)if(!(0==this.data[c+I.ALPHA_BYTE_OFFSET]&&0==a.data[c+I.ALPHA_BYTE_OFFSET]||this.data[c]==a.data[c]&&this.data[c+1]==a.data[c+1]&&this.data[c+2]==a.data[c+2]&&this.data[c+3]==a.data[c+3]))return!1;return!0};cb.prototype=Object.create(gb.prototype);cb.prototype.constructor=cb;cb.prototype.getLinearizedLayerList=
function(a,c=[]){for(let d of(c=c||[],this.layers))d instanceof cb&&(d.expanded||!a)&&d.getLinearizedLayerList(a,c),c.push(d);return c};cb.prototype.clearLayers=function(){this.layers=[]};cb.prototype.addLayer=function(a){a.parent=this;this.layers.push(a)};cb.prototype.insertLayer=function(a,c){c.parent=this;this.layers.splice(a,0,c)};cb.prototype.removeLayer=function(a){a=this.layers.indexOf(a);a>-1&&this.layers.splice(a,1)};cb.prototype.removeLayerAtIndex=function(a){var c=this.layers[a];return c&&
this.layers.splice(a,1),c};cb.prototype.setLayerAtIndex=function(a,c){var d=this.layers[a];return c.parent=this,this.layers[a]=c,d};cb.prototype.setExpanded=function(a){this.expanded=a};cb.prototype.getExpanded=function(){return this.expanded};cb.prototype.indexOf=function(a){return this.layers.indexOf(a)};cb.prototype.getMemoryUsed=function(){return this.layers.map(a=>a.getMemoryUsed()).reduce(Rg,0)};cb.prototype.clone=function(){var a=new cb(this.name,this.blendMode);return gb.prototype.copyFrom.call(a,
this),a.expanded=this.expanded,a.layers=this.layers.map(c=>c.clone()),a.layers.forEach(c=>c.parent=a),a};cb.prototype.getNonTransparentBounds=function(a){var c=new za(0,0,0,0);return this.layers.forEach(d=>c.union(d.getNonTransparentBounds(a))),c};Na.prototype=Object.create(Zc.prototype);Na.prototype.constructor=Na;Na.prototype.createBitmap=function(a,c,d){switch(this.bitDepth=d,d){case 32:this.data=new Uint32Array(a*c);break;case 16:this.data=new Uint16Array(a*c);break;default:this.data=new Uint8Array(a*
c)}};Na.prototype.clone=function(){var a=new Na(this.width,this.height,this.bitDepth);return a.copyPixelsFrom(this),a};Na.prototype.cloneRect=function(a){var c=new Na(a.getWidth(),a.getHeight(),this.bitDepth);return c.copyBitmapRect(this,0,0,a),c};Na.prototype.getPixel=function(a,c){return a=Math.max(0,Math.min(this.width-1,a)),c=Math.max(0,Math.min(this.height-1,c)),this.data[this.offsetOfPixel(a,c)]};Na.prototype.setPixel=function(a,c,d){a=Math.max(0,Math.min(this.width-1,a));c=Math.max(0,Math.min(this.height-
1,c));a=this.offsetOfPixel(a,c);this.data[a]=d};Na.prototype.clearAll=function(a){this.data.fill(a)};Na.prototype.clearRect=function(a,c){if((a=this.getBounds().clipTo(a)).equals(this.getBounds()))this.clearAll(c);else{let d=this.width,b=a.right-a.left,g=this.offsetOfPixel(a.left,a.top);for(let n=a.top;n<a.bottom;n++,g+=d)this.data.fill(c,g,g+b)}};Na.prototype.copyScaledNearestNeighbor=function(a){for(var c,d=0,b=a.width/this.width,g=a.height/this.height,n=0,f=0;n<this.height;n++,f+=g){c=a.offsetOfPixel(0,
Math.round(f));for(var e=0,k=0;e<this.width;e++,d++,k+=b)this.data[d]=a.data[c+Math.round(k)]}};Na.prototype.floodFillWithBorder=function(a,c,d,b=2,g=255){if(this.isInside(a,c)){d&=255;var n=this.width,f=this.height,e=this.data,k=new Uint8Array(n*f),l=e[c*n+a];g/=255;for(a=[{x:a,y:c}];a.length;){var h=void 0;let {x:p,y:q}=a.pop();p<0||q<0||p>=n||q>=f||(c=q*n+p,k[c]||Math.abs(e[c]-l)>10||(k[c]=1,h=Math.round(e[c]*(1-g)+d*g),e[c]=h,a.push({x:p+1,y:q}),a.push({x:p-1,y:q}),a.push({x:p,y:q+1}),a.push({x:p,
y:q-1})))}if(b>0){h=new Uint8ClampedArray(e);l=new Uint8ClampedArray(h);for(a=0;a<f;a++)for(c=0;c<n;c++)if(k[a*n+c])for(let p=-b;p<=b;p++)for(let q=-b;q<=b;q++){var m=c+q;let r=a+p;m<0||r<0||m>=n||r>=f||(m=r*n+m,k[m]||(l[m]=Math.round(h[m]*(1-g)+d*g)))}e.set(l)}}};Na.prototype.createThumbnailFrom=function(a){let c=Math.min(Math.floor(a.width/this.width),3);if(c<2)return void this.copyScaledNearestNeighbor(a);let d=new Uint16Array(this.width);var b=a.width,g=Math.floor(a.width/this.width);let n=Math.floor(a.width/
this.width/c),f=g-n*c;var e=Math.floor(a.height/this.height/c);g=e*b-g*this.width;b*=Math.floor(a.height/this.height)-e*c;let k=e=0;for(let h=0;h<this.height;h++,e+=b){let m;d.fill(0);for(var l=0;l<c;l++,e+=g){m=0;for(let p=0;p<this.width;p++,m++,e+=f)for(let q=0;q<c;q++,e+=n)d[m]+=a.data[e]}m=0;for(l=0;l<this.width;l++,m++,k++)this.data[k]=d[m]/(c*c)}};Na.prototype.mirrorHorizontally=function(){let a=this.width,c=this.height,d=new Uint8Array(a*c),b=0,g=a;for(let n=0;n<c;n++,g+=a+a)for(let f=0;f<
a;f++)d[b++]=this.data[--g];this.data=d};Na.prototype.applyLUT=function(a){for(var c=0;c<this.data.length;c++)this.data[c]=a.table[this.data[c]]};Na.prototype.getAsCanvas=function(a){var c=this.getImageData(0,0,this.width,this.height),d=$c(this.width,this.height);return d.getContext("2d").putImageData(c,0,0),mf(d,a||0)};Na.prototype.getImageData=function(a,c,d,b){let g=we(d,b);a=this.offsetOfPixel(a,c);c=0;let n=this.width-d;for(let f=0;f<b;f++,a+=n)for(let e=0;e<d;e++,a++)g.data[c++]=this.data[a],
g.data[c++]=this.data[a],g.data[c++]=this.data[a],g.data[c++]=255;return g};Na.prototype.pasteImageData=function(a,c,d){let b=0;c=this.offsetOfPixel(c,d);d=this.width-a.width;for(let g=0;g<a.height;g++,c+=d)for(let n=0;n<a.width;n++,b+=4,c++)this.data[c]=a.data[b];return a};Na.prototype.copyPixelsFrom=function(a){a.width!=this.width||a.height!=this.height||a.bitDepth!=this.bitDepth?(this.data=a.data.slice(0),this.width=a.width,this.height=a.height,this.bitDepth=a.bitDepth):this.data.set(a.data)};
Na.prototype.copyRectXOR=function(a,c){for(var d=(c=this.getBounds().clipTo(c)).getWidth(),b=new Uint8Array(d*c.getHeight()),g=0,n=this.offsetOfPixel(c.left,c.top),f=a.offsetOfPixel(c.left,c.top),e=this.width-d,k=a.width-d,l=c.top;l<c.bottom;l++,n+=e,f+=k)for(var h=0;h<d;h++,g++,n++,f++)b[g]=this.data[n]^a.data[f];return b};Na.prototype.setRectXOR=function(a,c){var d=(c=this.getBounds().clipTo(c)).getWidth(),b=c.getHeight();c=this.offsetOfPixel(c.left,c.top);for(var g=0,n=this.width-d,f=0;f<b;f++){for(var e=
0;e<d;e++)this.data[c++]^=a[g++];c+=n}};Na.prototype.copyBitmapRect=function(a,c,d,b){var g=new za(c,d,0,0);b=b.clone();this.getBounds().clipSourceDest(b,g);c=0|g.getWidth();d=0|g.getHeight();if(0==g.left&&0==g.top&&c==this.width&&d==this.height&&c==a.width&&d==a.height)this.copyPixelsFrom(a);else{g=this.offsetOfPixel(g.left,g.top);var n=this.width-c;b=a.offsetOfPixel(b.left,b.top);for(var f=a.width-c,e=0;e<d;e++,b+=f,g+=n)for(var k=0;k<c;k++,b++,g++)this.data[g]=a.data[b]}};Na.prototype.copyRegionHFlip=
function(a,c){a=this.getBounds().clipTo(a);for(var d=a.top;d<a.bottom;d++)for(var b=this.offsetOfPixel(a.left,d),g=c.offsetOfPixel(a.right-1,d),n=a.left;n<a.right;n++,g-=2)this.data[b++]=c.data[g++]};Na.prototype.copyRegionVFlip=function(a,c){for(var d=(a=this.getBounds().clipTo(a)).getWidth(),b=a.top;b<a.bottom;b++)for(var g=this.offsetOfPixel(a.left,b),n=c.offsetOfPixel(a.left,a.bottom-1-(b-a.top)),f=0;f<d;f++)this.data[g++]=c.data[n++]};Na.prototype.copyPixelColumnToArray=function(a,c,d,b){var g=
this.width,n=0;a=this.offsetOfPixel(a,c);for(c=0;c<d;c++)b[n]=this.data[a],a+=g,n++};Na.prototype.copyArrayToPixelColumn=function(a,c,d,b){var g=this.width,n=0;a=this.offsetOfPixel(a,c);for(c=0;c<d;c++)this.data[a]=b[n],a+=g,n++};Na.prototype.boxBlur=function(a,c,d){let b=(a=this.getBounds().clipTo(a)).getWidth(),g=a.getHeight();var n=Math.max(b,g);let f=new this.data.constructor(n);n=new this.data.constructor(n);for(let l=a.top;l<a.bottom;l++){var e=this.offsetOfPixel(a.left,l);for(var k=0;k<b;k++)f[k]=
this.data[e++];nf(f,n,b,c);e=this.offsetOfPixel(a.left,l);for(k=0;k<b;k++)this.data[e++]=n[k]}for(c=a.left;c<a.right;c++)this.copyPixelColumnToArray(c,a.top,g,f),nf(f,n,g,d),this.copyArrayToPixelColumn(c,a.top,g,n)};Na.prototype.offsetOfPixel=function(a,c){return c*this.width+a};Na.prototype.mosaic=function(a,c){a=this.getBounds().clipTo(a);c=Math.max(1,0|c);let d=this.width,b=this.data;for(let k=a.top;k<a.bottom;k+=c){let l=Math.min(k+c,a.bottom);for(let h=a.left;h<a.right;h+=c){let m=Math.min(h+
c,a.right);var g=0,n=0;for(var f=k;f<l;f++){var e=f*d+h;for(let p=h;p<m;p++)g+=b[e++],n++}g=g/n|0;for(n=k;n<l;n++)for(f=n*d+h,e=h;e<m;e++)b[f++]=g}}};Na.prototype.monoHalftone=function(a,c,d,b=1){c=Math.max(2,0|c);this.getBounds().clipTo(a);a=this.width;d=this.height;Na.BYTES_PER_PIXEL;let g=new Uint8ClampedArray(this.data),n=new Uint8ClampedArray(this.data.length);for(var f=0;f<n.length;f++)n[f]=255;f=.5*a;let e=.5*d;var k=45*Math.PI/180;let l=Math.cos(k);k=Math.sin(k);b*=c;c*=.5;var h=Math.ceil(Math.sqrt(a*
a+d*d));let m=(h-a)*.5;h=(h-d)*.5;for(let v=-h;v<d+h;v+=b)for(let y=-m;y<a+m;y+=b){var p=y+.5*b-f,q=v+.5*b-e,r=p*l-q*k+f;p=p*k+q*l+e;q=0|r;var u=0|p;if(!(q<0||u<0||q>=a||u>=d||(q=1-g[u*a+q]/255,q<=0))){q=.5+(c-.5)*Math.pow(q,.9);u=q*q;for(let C=-q;C<=q;C++)for(let w=-q;w<=q;w++){if(w*w+C*C>u)continue;let D=r+w|0,x=p+C|0;D<0||x<0||D>=a||x>=d||(n[x*a+D]=0)}!0}}this.data.set(n)};Na.prototype.fillWithNoise=function(a){a=this.getBounds().clipTo(a);for(var c=this.width-a.getWidth(),d=this.offsetOfPixel(a.left,
a.top),b=a.top;b<a.bottom;b++,d+=c)for(var g=a.left;g<a.right;g++,d++)this.data[d]=256*Math.random()|0};Na.prototype.invert=function(a){a=this.getBounds().clipTo(a);for(var c=this.width-a.getWidth(),d=this.offsetOfPixel(a.left,a.top),b=a.top;b<a.bottom;b++,d+=c)for(var g=a.left;g<a.right;g++,d++)this.data[d]=~this.data[d]};Na.prototype.getValueBounds=function(a,c){var d,b,g=a.clone();var n=this.width-g.getWidth();a=this.offsetOfPixel(g.left,g.top);for(b=g.top;b<g.bottom;b++,a+=n){var f=!1;for(d=g.left;d<
g.right;d++,a++)if(this.data[a]!=c){f=!0;break}if(f)break}if(g.top=b,g.top==g.bottom)return g;a=this.offsetOfPixel(g.right-1,g.bottom-1);for(b=g.bottom-1;b>=g.top;b--,a-=n){f=!1;for(d=g.right-1;d>=g.left;d--,a--)if(this.data[a]!=c){f=!0;break}if(f)break}g.bottom=b+1;n=this.width;for(d=g.left;d<g.right;d++){a=this.offsetOfPixel(d,g.top);f=!1;for(b=g.top;b<g.bottom;b++,a+=n)if(this.data[a]!=c){f=!0;break}if(f)break}g.left=d;for(d=g.right-1;d>=g.left;d--){a=this.offsetOfPixel(d,g.top);f=!1;for(b=g.top;b<
g.bottom;b++,a+=n)if(this.data[a]!=c){f=!0;break}if(f)break}return g.right=d+1,g};Na.prototype.gradientHorzReplace=function(a,c,d,b){var g=255&b[0];b=255&b[1];var n=this.width-a.getWidth(),f=0|this.offsetOfPixel(a.left,a.top),e=a.bottom-a.top|0;if(d<c){var k=d;d=c;c=k;k=g;g=b;b=k}k=(b-g)/(d-c|0);for(var l=Math.max(a.left-c,0),h=0;h<e;h++,f+=n){for(var m=a.left,p=0|Math.min(c,a.right);m<p;m++,f++)this.data[f]=g;var q=g+k*l;for(p=0|Math.min(d,a.right);m<p;m++,f++)this.data[f]=q,q+=k;for(;m<a.right;m++,
f++)this.data[f]=b}};Na.prototype.gradientVertReplace=function(a,c,d,b){var g=255&b[0];b=255&b[1];let n=this.width-a.getWidth(),f=0|this.offsetOfPixel(a.left,a.top),e=a.right-a.left|0;if(d<c){var k=d;d=c;c=k;k=g;g=b;b=k}k=a.top;for(var l=0|Math.min(a.bottom,c);k<l;k++,f+=n)for(let h=0;h<e;h++,f++)this.data[f]=g;l=(b-g)/(d-c|0);c=g+l*Math.max(k-c,0);for(d=0|Math.min(a.bottom,d);k<d;k++,f+=n){for(g=0;g<e;g++,f++)this.data[f]=c;c+=l}for(;k<a.bottom;k++,f+=n)for(d=0;d<e;d++,f++)this.data[f]=b};Na.prototype.gradientReplace=
function(a,c,d,b,g,n){var f=this.width-a.getWidth(),e=0|this.offsetOfPixel(a.left,a.top),k=a.right-a.left|0,l=255&n[0];n=255&n[1];var h=g-d+(b-c)*(b-c)/(g-d);b=b-c+(g-d)*(g-d)/(b-c);g=1/b;for(var m=a.top;m<a.bottom;m++,e+=f)for(var p=(a.left-c)/b+(m-d)/h,q=0;q<k;q++,e++){var r=Math.min(Math.max(p,0),1);this.data[e]=l*(1-r)+n*r;p+=g}};Na.prototype.gradientAlpha=function(a,c,d,b,g,n){var f=this.width-a.getWidth(),e=0|this.offsetOfPixel(a.left,a.top),k=a.right-a.left|0,l=255&n[0],h=n[0]>>24&255,m=255&
n[1];n=n[1]>>24&255;var p=g-d+(b-c)*(b-c)/(g-d);b=b-c+(g-d)*(g-d)/(b-c);g=1/b;for(var q=a.top;q<a.bottom;q++,e+=f)for(var r=(a.left-c)/b+(q-d)/p,u=0;u<k;u++,e++){var v=Math.min(Math.max(r,0),1),y=1-v,C=h*y+n*v;this.data[e]=((l*y+m*v)*C+this.data[e]*(255-C))/255|0;r+=g}};Na.prototype.gradient=function(a,c,d,b,g,n,f){a=this.getBounds().clipTo(a);(c!=b||d!=g)&&(f||n[0]>>>24==255&&n[1]>>>24==255?c==b?this.gradientVertReplace(a,d,g,n):d==g?this.gradientHorzReplace(a,c,b,n):this.gradientReplace(a,c,d,b,
g,n):this.gradientAlpha(a,c,d,b,g,n))};Na.prototype.equals=function(a){if(this.width!=a.width||this.height!=a.height)return!1;for(let c=0;c<this.data.length;c++)if(this.data[c]!=a.data[c])return!1;return!0};let Ab=Array(256),Bb=Array(256);R.multiplyOntoOpaqueFusionWithOpaqueLayer=function(a,c,d,b){d=0|b.getHeight();let g=0|b.getWidth(),n=(c.width-g)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let f=0;f<d;f++,b+=n)for(let e=0;e<g;e++,b+=4){let k=c.data[b+3],l;k&&(l=a.data[b],a.data[b]=l-((255^c.data[b])*
l*k/65025|0),l=a.data[b+1],a.data[b+1]=l-((255^c.data[b+1])*l*k/65025|0),l=a.data[b+2],a.data[b+2]=l-((255^c.data[b+2])*l*k/65025|0))}};R.multiplyOntoOpaqueFusionWithTransparentLayer=function(a,c,d,b){let g=0|b.getHeight(),n=0|b.getWidth(),f=(c.width-n)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<g;e++,b+=f)for(let k=0;k<n;k++,b+=4){let l=c.data[b+3]*d/100|0,h;l&&(h=a.data[b],a.data[b]=h-((255^c.data[b])*h*l/65025|0),h=a.data[b+1],a.data[b+1]=h-((255^c.data[b+1])*h*l/65025|0),h=a.data[b+2],
a.data[b+2]=h-((255^c.data[b+2])*h*l/65025|0))}};R.multiplyOntoTransparentFusionWithOpaqueLayer=function(a,c,d,b){d=0|b.getHeight();let g=0|b.getWidth(),n=(c.width-g)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<d;e++,b+=n)for(let k=0;k<g;k++,b+=4){var f=c.data[b+3];let l,h;if(f){let m=f+(l=a.data[b+3])-(f*l/255|0)|0,p=f*l/255|0,q=f*(255^l)/255|0,r=(255^f)*l/255|0;f=c.data[b];h=a.data[b];a.data[b]=(f*q+h*r+(f*h*p/255|0))/m|0;f=c.data[b+1];h=a.data[b+1];a.data[b+1]=(f*q+h*r+(f*h*p/255|0))/m|
0;f=c.data[b+2];h=a.data[b+2];a.data[b+2]=(f*q+h*r+(f*h*p/255|0))/m|0;a.data[b+3]=m}}};R.multiplyOntoTransparentFusionWithTransparentLayer=function(a,c,d,b){let g=0|b.getHeight(),n=0|b.getWidth(),f=(c.width-n)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let k=0;k<g;k++,b+=f)for(let l=0;l<n;l++,b+=4){var e=c.data[b+3]*d/100|0;let h,m;if(e){let p=e+(h=a.data[b+3])-(e*h/255|0)|0,q=e*h/255|0,r=e*(255^h)/255|0,u=(255^e)*h/255|0;e=c.data[b];m=a.data[b];a.data[b]=(e*r+m*u+(e*m*q/255|0))/p|0;e=c.data[b+1];
m=a.data[b+1];a.data[b+1]=(e*r+m*u+(e*m*q/255|0))/p|0;e=c.data[b+2];m=a.data[b+2];a.data[b+2]=(e*r+m*u+(e*m*q/255|0))/p|0;a.data[b+3]=p}}};R.multiplyOntoOpaqueFusionWithOpaqueLayerMasked=function(a,c,d,b,g){d=0|b.getHeight();let n=0|b.getWidth(),f=(c.width-n)*4|0,e=0|c.offsetOfPixel(b.left,b.top),k=g.width-n|0;b=0|g.offsetOfPixel(b.left,b.top);for(let l=0;l<d;l++,e+=f,b+=k)for(let h=0;h<n;h++,e+=4,b++){let m=c.data[e+3]*g.data[b]/255|0,p;m&&(p=a.data[e],a.data[e]=p-((255^c.data[e])*p*m/65025|0),p=
a.data[e+1],a.data[e+1]=p-((255^c.data[e+1])*p*m/65025|0),p=a.data[e+2],a.data[e+2]=p-((255^c.data[e+2])*p*m/65025|0))}};R.multiplyOntoOpaqueFusionWithTransparentLayerMasked=function(a,c,d,b,g){let n=0|b.getHeight(),f=0|b.getWidth(),e=(c.width-f)*4|0,k=0|c.offsetOfPixel(b.left,b.top),l=g.width-f|0;b=0|g.offsetOfPixel(b.left,b.top);for(let h=0;h<n;h++,k+=e,b+=l)for(let m=0;m<f;m++,k+=4,b++){let p=c.data[k+3]*g.data[b]*d/25500|0,q;p&&(q=a.data[k],a.data[k]=q-((255^c.data[k])*q*p/65025|0),q=a.data[k+
1],a.data[k+1]=q-((255^c.data[k+1])*q*p/65025|0),q=a.data[k+2],a.data[k+2]=q-((255^c.data[k+2])*q*p/65025|0))}};R.multiplyOntoTransparentFusionWithOpaqueLayerMasked=function(a,c,d,b,g){d=0|b.getHeight();let n=0|b.getWidth(),f=(c.width-n)*4|0,e=0|c.offsetOfPixel(b.left,b.top),k=g.width-n|0;b=0|g.offsetOfPixel(b.left,b.top);for(let h=0;h<d;h++,e+=f,b+=k)for(let m=0;m<n;m++,e+=4,b++){var l=c.data[e+3]*g.data[b]/255|0;let p,q;if(l){let r=l+(p=a.data[e+3])-(l*p/255|0)|0,u=l*p/255|0,v=l*(255^p)/255|0,y=
(255^l)*p/255|0;l=c.data[e];q=a.data[e];a.data[e]=(l*v+q*y+(l*q*u/255|0))/r|0;l=c.data[e+1];q=a.data[e+1];a.data[e+1]=(l*v+q*y+(l*q*u/255|0))/r|0;l=c.data[e+2];q=a.data[e+2];a.data[e+2]=(l*v+q*y+(l*q*u/255|0))/r|0;a.data[e+3]=r}}};R.multiplyOntoTransparentFusionWithTransparentLayerMasked=function(a,c,d,b,g){let n=0|b.getHeight(),f=0|b.getWidth(),e=(c.width-f)*4|0,k=0|c.offsetOfPixel(b.left,b.top),l=g.width-f|0;b=0|g.offsetOfPixel(b.left,b.top);for(let m=0;m<n;m++,k+=e,b+=l)for(let p=0;p<f;p++,k+=
4,b++){var h=c.data[k+3]*g.data[b]*d/25500|0;let q,r;if(h){let u=h+(q=a.data[k+3])-(h*q/255|0)|0,v=h*q/255|0,y=h*(255^q)/255|0,C=(255^h)*q/255|0;h=c.data[k];r=a.data[k];a.data[k]=(h*y+r*C+(h*r*v/255|0))/u|0;h=c.data[k+1];r=a.data[k+1];a.data[k+1]=(h*y+r*C+(h*r*v/255|0))/u|0;h=c.data[k+2];r=a.data[k+2];a.data[k+2]=(h*y+r*C+(h*r*v/255|0))/u|0;a.data[k+3]=u}}};R.multiply2OntoOpaqueFusionWithOpaqueLayer=function(a,c,d,b){d=0|b.getHeight();let g=0|b.getWidth(),n=(c.width-g)*4|0;b=0|c.offsetOfPixel(b.left,
b.top);for(let f=0;f<d;f++,b+=n)for(let e=0;e<g;e++,b+=4){let k=c.data[b+3],l;k&&(l=a.data[b],a.data[b]=l-Math.ceil((255^c.data[b])*l*k/65025),l=a.data[b+1],a.data[b+1]=l-Math.ceil((255^c.data[b+1])*l*k/65025),l=a.data[b+2],a.data[b+2]=l-Math.ceil((255^c.data[b+2])*l*k/65025))}};R.multiply2OntoOpaqueFusionWithTransparentLayer=function(a,c,d,b){let g=0|b.getHeight(),n=0|b.getWidth(),f=(c.width-n)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<g;e++,b+=f)for(let k=0;k<n;k++,b+=4){let l=c.data[b+
3]*d/100|0,h;l&&(h=a.data[b],a.data[b]=h-Math.ceil((255^c.data[b])*h*l/65025),h=a.data[b+1],a.data[b+1]=h-Math.ceil((255^c.data[b+1])*h*l/65025),h=a.data[b+2],a.data[b+2]=h-Math.ceil((255^c.data[b+2])*h*l/65025))}};R.multiply2OntoTransparentFusionWithOpaqueLayer=function(a,c,d,b){d=0|b.getHeight();let g=0|b.getWidth(),n=(c.width-g)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<d;e++,b+=n)for(let k=0;k<g;k++,b+=4){var f=c.data[b+3];let l,h;if(f){let m=f+(l=a.data[b+3])-(f*l/255|0)|0,p=f*l/255|
0,q=f*(255^l)/255|0,r=(255^f)*l/255|0;f=c.data[b];h=a.data[b];a.data[b]=(f*q+h*r+(f*h*p/255|0))/m|0;f=c.data[b+1];h=a.data[b+1];a.data[b+1]=(f*q+h*r+(f*h*p/255|0))/m|0;f=c.data[b+2];h=a.data[b+2];a.data[b+2]=(f*q+h*r+(f*h*p/255|0))/m|0;a.data[b+3]=m}}};R.multiply2OntoTransparentFusionWithTransparentLayer=function(a,c,d,b){let g=0|b.getHeight(),n=0|b.getWidth(),f=(c.width-n)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let k=0;k<g;k++,b+=f)for(let l=0;l<n;l++,b+=4){var e=c.data[b+3]*d/100|0;let h,m;if(e){let p=
e+(h=a.data[b+3])-(e*h/255|0)|0,q=e*h/255|0,r=e*(255^h)/255|0,u=(255^e)*h/255|0;e=c.data[b];m=a.data[b];a.data[b]=(e*r+m*u+(e*m*q/255|0))/p|0;e=c.data[b+1];m=a.data[b+1];a.data[b+1]=(e*r+m*u+(e*m*q/255|0))/p|0;e=c.data[b+2];m=a.data[b+2];a.data[b+2]=(e*r+m*u+(e*m*q/255|0))/p|0;a.data[b+3]=p}}};R.multiply2OntoOpaqueFusionWithOpaqueLayerMasked=function(a,c,d,b,g){d=0|b.getHeight();let n=0|b.getWidth(),f=(c.width-n)*4|0,e=0|c.offsetOfPixel(b.left,b.top),k=g.width-n|0;b=0|g.offsetOfPixel(b.left,b.top);
for(let l=0;l<d;l++,e+=f,b+=k)for(let h=0;h<n;h++,e+=4,b++){let m=c.data[e+3]*g.data[b]/255|0,p;m&&(p=a.data[e],a.data[e]=p-Math.ceil((255^c.data[e])*p*m/65025),p=a.data[e+1],a.data[e+1]=p-Math.ceil((255^c.data[e+1])*p*m/65025),p=a.data[e+2],a.data[e+2]=p-Math.ceil((255^c.data[e+2])*p*m/65025))}};R.multiply2OntoOpaqueFusionWithTransparentLayerMasked=function(a,c,d,b,g){let n=0|b.getHeight(),f=0|b.getWidth(),e=(c.width-f)*4|0,k=0|c.offsetOfPixel(b.left,b.top),l=g.width-f|0;b=0|g.offsetOfPixel(b.left,
b.top);for(let h=0;h<n;h++,k+=e,b+=l)for(let m=0;m<f;m++,k+=4,b++){let p=c.data[k+3]*g.data[b]*d/25500|0,q;p&&(q=a.data[k],a.data[k]=q-Math.ceil((255^c.data[k])*q*p/65025),q=a.data[k+1],a.data[k+1]=q-Math.ceil((255^c.data[k+1])*q*p/65025),q=a.data[k+2],a.data[k+2]=q-Math.ceil((255^c.data[k+2])*q*p/65025))}};R.multiply2OntoTransparentFusionWithOpaqueLayerMasked=function(a,c,d,b,g){d=0|b.getHeight();let n=0|b.getWidth(),f=(c.width-n)*4|0,e=0|c.offsetOfPixel(b.left,b.top),k=g.width-n|0;b=0|g.offsetOfPixel(b.left,
b.top);for(let h=0;h<d;h++,e+=f,b+=k)for(let m=0;m<n;m++,e+=4,b++){var l=c.data[e+3]*g.data[b]/255|0;let p,q;if(l){let r=l+(p=a.data[e+3])-(l*p/255|0)|0,u=l*p/255|0,v=l*(255^p)/255|0,y=(255^l)*p/255|0;l=c.data[e];q=a.data[e];a.data[e]=(l*v+q*y+(l*q*u/255|0))/r|0;l=c.data[e+1];q=a.data[e+1];a.data[e+1]=(l*v+q*y+(l*q*u/255|0))/r|0;l=c.data[e+2];q=a.data[e+2];a.data[e+2]=(l*v+q*y+(l*q*u/255|0))/r|0;a.data[e+3]=r}}};R.multiply2OntoTransparentFusionWithTransparentLayerMasked=function(a,c,d,b,g){let n=
0|b.getHeight(),f=0|b.getWidth(),e=(c.width-f)*4|0,k=0|c.offsetOfPixel(b.left,b.top),l=g.width-f|0;b=0|g.offsetOfPixel(b.left,b.top);for(let m=0;m<n;m++,k+=e,b+=l)for(let p=0;p<f;p++,k+=4,b++){var h=c.data[k+3]*g.data[b]*d/25500|0;let q,r;if(h){let u=h+(q=a.data[k+3])-(h*q/255|0)|0,v=h*q/255|0,y=h*(255^q)/255|0,C=(255^h)*q/255|0;h=c.data[k];r=a.data[k];a.data[k]=(h*y+r*C+(h*r*v/255|0))/u|0;h=c.data[k+1];r=a.data[k+1];a.data[k+1]=(h*y+r*C+(h*r*v/255|0))/u|0;h=c.data[k+2];r=a.data[k+2];a.data[k+2]=
(h*y+r*C+(h*r*v/255|0))/u|0;a.data[k+3]=u}}};R.normalOntoOpaqueFusionWithOpaqueLayer=function(a,c,d,b){d=0|b.getHeight();let g=0|b.getWidth(),n=(c.width-g)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let f=0;f<d;f++,b+=n)for(let e=0;e<g;e++,b+=4){let k=c.data[b+3],l;if(k)if(255==k)a.data[b]=c.data[b],a.data[b+1]=c.data[b+1],a.data[b+2]=c.data[b+2];else{let h=255-k;l=c.data[b];a.data[b]=(l*k+a.data[b]*h)/255|0;l=c.data[b+1];a.data[b+1]=(l*k+a.data[b+1]*h)/255|0;l=c.data[b+2];a.data[b+2]=(l*k+a.data[b+
2]*h)/255|0}}};R.normalOntoOpaqueFusionWithTransparentLayer=function(a,c,d,b){let g=0|b.getHeight(),n=0|b.getWidth(),f=(c.width-n)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<g;e++,b+=f)for(let k=0;k<n;k++,b+=4){let l=c.data[b+3]*d/100|0,h;if(l){let m=255-l;h=c.data[b];a.data[b]=(h*l+a.data[b]*m)/255|0;h=c.data[b+1];a.data[b+1]=(h*l+a.data[b+1]*m)/255|0;h=c.data[b+2];a.data[b+2]=(h*l+a.data[b+2]*m)/255|0}}};R.normalOntoTransparentFusionWithOpaqueLayer=function(a,c,d,b){d=0|b.getHeight();let g=
0|b.getWidth(),n=(c.width-g)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<d;e++,b+=n)for(let k=0;k<g;k++,b+=4){var f=c.data[b+3];let l;if(f){let h=f+(l=a.data[b+3])-(f*l/255|0)|0;f=255*f/h|0;let m=255-f;a.data[b]=(c.data[b]*f+a.data[b]*m)/255|0;a.data[b+1]=(c.data[b+1]*f+a.data[b+1]*m)/255|0;a.data[b+2]=(c.data[b+2]*f+a.data[b+2]*m)/255|0;a.data[b+3]=h}}};R.normalOntoTransparentFusionWithTransparentLayer=function(a,c,d,b){let g=0|b.getHeight(),n=0|b.getWidth(),f=(c.width-n)*4|0;b=0|c.offsetOfPixel(b.left,
b.top);for(let k=0;k<g;k++,b+=f)for(let l=0;l<n;l++,b+=4){var e=c.data[b+3]*d/100|0;let h;if(e){let m=e+(h=a.data[b+3])-(e*h/255|0)|0;e=255*e/m|0;let p=255-e;a.data[b]=(c.data[b]*e+a.data[b]*p)/255|0;a.data[b+1]=(c.data[b+1]*e+a.data[b+1]*p)/255|0;a.data[b+2]=(c.data[b+2]*e+a.data[b+2]*p)/255|0;a.data[b+3]=m}}};R.normalOntoOpaqueFusionWithOpaqueLayerMasked=function(a,c,d,b,g){d=0|b.getHeight();let n=0|b.getWidth(),f=(c.width-n)*4|0,e=0|c.offsetOfPixel(b.left,b.top),k=g.width-n|0;b=0|g.offsetOfPixel(b.left,
b.top);for(let l=0;l<d;l++,e+=f,b+=k)for(let h=0;h<n;h++,e+=4,b++){let m=c.data[e+3]*g.data[b]/255|0,p;if(m)if(255==m)a.data[e]=c.data[e],a.data[e+1]=c.data[e+1],a.data[e+2]=c.data[e+2];else{let q=255-m;p=c.data[e];a.data[e]=(p*m+a.data[e]*q)/255|0;p=c.data[e+1];a.data[e+1]=(p*m+a.data[e+1]*q)/255|0;p=c.data[e+2];a.data[e+2]=(p*m+a.data[e+2]*q)/255|0}}};R.normalOntoOpaqueFusionWithTransparentLayerMasked=function(a,c,d,b,g){let n=0|b.getHeight(),f=0|b.getWidth(),e=(c.width-f)*4|0,k=0|c.offsetOfPixel(b.left,
b.top),l=g.width-f|0;b=0|g.offsetOfPixel(b.left,b.top);for(let h=0;h<n;h++,k+=e,b+=l)for(let m=0;m<f;m++,k+=4,b++){let p=c.data[k+3]*g.data[b]*d/25500|0,q;if(p){let r=255-p;q=c.data[k];a.data[k]=(q*p+a.data[k]*r)/255|0;q=c.data[k+1];a.data[k+1]=(q*p+a.data[k+1]*r)/255|0;q=c.data[k+2];a.data[k+2]=(q*p+a.data[k+2]*r)/255|0}}};R.normalOntoTransparentFusionWithOpaqueLayerMasked=function(a,c,d,b,g){d=0|b.getHeight();let n=0|b.getWidth(),f=(c.width-n)*4|0,e=0|c.offsetOfPixel(b.left,b.top),k=g.width-n|0;
b=0|g.offsetOfPixel(b.left,b.top);for(let h=0;h<d;h++,e+=f,b+=k)for(let m=0;m<n;m++,e+=4,b++){var l=c.data[e+3]*g.data[b]/255|0;let p;if(l){let q=l+(p=a.data[e+3])-(l*p/255|0)|0;l=255*l/q|0;let r=255-l;a.data[e]=(c.data[e]*l+a.data[e]*r)/255|0;a.data[e+1]=(c.data[e+1]*l+a.data[e+1]*r)/255|0;a.data[e+2]=(c.data[e+2]*l+a.data[e+2]*r)/255|0;a.data[e+3]=q}}};R.normalOntoTransparentFusionWithTransparentLayerMasked=function(a,c,d,b,g){let n=0|b.getHeight(),f=0|b.getWidth(),e=(c.width-f)*4|0,k=0|c.offsetOfPixel(b.left,
b.top),l=g.width-f|0;b=0|g.offsetOfPixel(b.left,b.top);for(let m=0;m<n;m++,k+=e,b+=l)for(let p=0;p<f;p++,k+=4,b++){var h=c.data[k+3]*g.data[b]*d/25500|0;let q;if(h){let r=h+(q=a.data[k+3])-(h*q/255|0)|0;h=255*h/r|0;let u=255-h;a.data[k]=(c.data[k]*h+a.data[k]*u)/255|0;a.data[k+1]=(c.data[k+1]*h+a.data[k+1]*u)/255|0;a.data[k+2]=(c.data[k+2]*h+a.data[k+2]*u)/255|0;a.data[k+3]=r}}};R.addOntoOpaqueFusionWithOpaqueLayer=function(a,c,d,b){d=0|b.getHeight();let g=0|b.getWidth(),n=(c.width-g)*4|0;b=0|c.offsetOfPixel(b.left,
b.top);for(let f=0;f<d;f++,b+=n)for(let e=0;e<g;e++,b+=4){let k=c.data[b+3];k&&(a.data[b]=a.data[b]+k*c.data[b]/255|0,a.data[b+1]=a.data[b+1]+k*c.data[b+1]/255|0,a.data[b+2]=a.data[b+2]+k*c.data[b+2]/255|0)}};R.addOntoOpaqueFusionWithTransparentLayer=function(a,c,d,b){let g=0|b.getHeight(),n=0|b.getWidth(),f=(c.width-n)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<g;e++,b+=f)for(let k=0;k<n;k++,b+=4){let l=c.data[b+3]*d/100|0;l&&(a.data[b]=a.data[b]+l*c.data[b]/255|0,a.data[b+1]=a.data[b+1]+
l*c.data[b+1]/255|0,a.data[b+2]=a.data[b+2]+l*c.data[b+2]/255|0)}};R.addOntoTransparentFusionWithOpaqueLayer=function(a,c,d,b){d=0|b.getHeight();let g=0|b.getWidth(),n=(c.width-g)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let f=0;f<d;f++,b+=n)for(let e=0;e<g;e++,b+=4){let k=c.data[b+3],l;if(k){let h=k+(l=a.data[b+3])-(k*l/255|0)|0;a.data[b]=(l*a.data[b]+k*c.data[b])/h|0;a.data[b+1]=(l*a.data[b+1]+k*c.data[b+1])/h|0;a.data[b+2]=(l*a.data[b+2]+k*c.data[b+2])/h|0;a.data[b+3]=h}}};R.addOntoTransparentFusionWithTransparentLayer=
function(a,c,d,b){let g=0|b.getHeight(),n=0|b.getWidth(),f=(c.width-n)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<g;e++,b+=f)for(let k=0;k<n;k++,b+=4){let l=c.data[b+3]*d/100|0,h;if(l){let m=l+(h=a.data[b+3])-(l*h/255|0)|0;a.data[b]=(h*a.data[b]+l*c.data[b])/m|0;a.data[b+1]=(h*a.data[b+1]+l*c.data[b+1])/m|0;a.data[b+2]=(h*a.data[b+2]+l*c.data[b+2])/m|0;a.data[b+3]=m}}};R.addOntoOpaqueFusionWithOpaqueLayerMasked=function(a,c,d,b,g){d=0|b.getHeight();let n=0|b.getWidth(),f=(c.width-n)*4|0,
e=0|c.offsetOfPixel(b.left,b.top),k=g.width-n|0;b=0|g.offsetOfPixel(b.left,b.top);for(let l=0;l<d;l++,e+=f,b+=k)for(let h=0;h<n;h++,e+=4,b++){let m=c.data[e+3]*g.data[b]/255|0;m&&(a.data[e]=a.data[e]+m*c.data[e]/255|0,a.data[e+1]=a.data[e+1]+m*c.data[e+1]/255|0,a.data[e+2]=a.data[e+2]+m*c.data[e+2]/255|0)}};R.addOntoOpaqueFusionWithTransparentLayerMasked=function(a,c,d,b,g){let n=0|b.getHeight(),f=0|b.getWidth(),e=(c.width-f)*4|0,k=0|c.offsetOfPixel(b.left,b.top),l=g.width-f|0;b=0|g.offsetOfPixel(b.left,
b.top);for(let h=0;h<n;h++,k+=e,b+=l)for(let m=0;m<f;m++,k+=4,b++){let p=c.data[k+3]*g.data[b]*d/25500|0;p&&(a.data[k]=a.data[k]+p*c.data[k]/255|0,a.data[k+1]=a.data[k+1]+p*c.data[k+1]/255|0,a.data[k+2]=a.data[k+2]+p*c.data[k+2]/255|0)}};R.addOntoTransparentFusionWithOpaqueLayerMasked=function(a,c,d,b,g){d=0|b.getHeight();let n=0|b.getWidth(),f=(c.width-n)*4|0,e=0|c.offsetOfPixel(b.left,b.top),k=g.width-n|0;b=0|g.offsetOfPixel(b.left,b.top);for(let l=0;l<d;l++,e+=f,b+=k)for(let h=0;h<n;h++,e+=4,b++){let m=
c.data[e+3]*g.data[b]/255|0,p;if(m){let q=m+(p=a.data[e+3])-(m*p/255|0)|0;a.data[e]=(p*a.data[e]+m*c.data[e])/q|0;a.data[e+1]=(p*a.data[e+1]+m*c.data[e+1])/q|0;a.data[e+2]=(p*a.data[e+2]+m*c.data[e+2])/q|0;a.data[e+3]=q}}};R.addOntoTransparentFusionWithTransparentLayerMasked=function(a,c,d,b,g){let n=0|b.getHeight(),f=0|b.getWidth(),e=(c.width-f)*4|0,k=0|c.offsetOfPixel(b.left,b.top),l=g.width-f|0;b=0|g.offsetOfPixel(b.left,b.top);for(let h=0;h<n;h++,k+=e,b+=l)for(let m=0;m<f;m++,k+=4,b++){let p=
c.data[k+3]*g.data[b]*d/25500|0,q;if(p){let r=p+(q=a.data[k+3])-(p*q/255|0)|0;a.data[k]=(q*a.data[k]+p*c.data[k])/r|0;a.data[k+1]=(q*a.data[k+1]+p*c.data[k+1])/r|0;a.data[k+2]=(q*a.data[k+2]+p*c.data[k+2])/r|0;a.data[k+3]=r}}};R.subtractOntoOpaqueFusionWithOpaqueLayer=function(a,c,d,b){d=0|b.getHeight();let g=0|b.getWidth(),n=(c.width-g)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let f=0;f<d;f++,b+=n)for(let e=0;e<g;e++,b+=4){let k=c.data[b+3];k&&(a.data[b]=a.data[b]+k*c.data[b]/255-k|0,a.data[b+1]=
a.data[b+1]+k*c.data[b+1]/255-k|0,a.data[b+2]=a.data[b+2]+k*c.data[b+2]/255-k|0)}};R.subtractOntoOpaqueFusionWithTransparentLayer=function(a,c,d,b){let g=0|b.getHeight(),n=0|b.getWidth(),f=(c.width-n)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<g;e++,b+=f)for(let k=0;k<n;k++,b+=4){let l=c.data[b+3]*d/100|0;l&&(a.data[b]=a.data[b]+l*c.data[b]/255-l|0,a.data[b+1]=a.data[b+1]+l*c.data[b+1]/255-l|0,a.data[b+2]=a.data[b+2]+l*c.data[b+2]/255-l|0)}};R.subtractOntoTransparentFusionWithOpaqueLayer=
function(a,c,d,b){d=0|b.getHeight();let g=0|b.getWidth(),n=(c.width-g)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let f=0;f<d;f++,b+=n)for(let e=0;e<g;e++,b+=4){let k=c.data[b+3],l;if(k){let h=k+(l=a.data[b+3])-(k*l/255|0)|0,m=k*l;a.data[b]=(l*a.data[b]+k*c.data[b]-m)/h|0;a.data[b+1]=(l*a.data[b+1]+k*c.data[b+1]-m)/h|0;a.data[b+2]=(l*a.data[b+2]+k*c.data[b+2]-m)/h|0;a.data[b+3]=h}}};R.subtractOntoTransparentFusionWithTransparentLayer=function(a,c,d,b){let g=0|b.getHeight(),n=0|b.getWidth(),f=(c.width-
n)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<g;e++,b+=f)for(let k=0;k<n;k++,b+=4){let l=c.data[b+3]*d/100|0,h;if(l){let m=l+(h=a.data[b+3])-(l*h/255|0)|0,p=l*h;a.data[b]=(h*a.data[b]+l*c.data[b]-p)/m|0;a.data[b+1]=(h*a.data[b+1]+l*c.data[b+1]-p)/m|0;a.data[b+2]=(h*a.data[b+2]+l*c.data[b+2]-p)/m|0;a.data[b+3]=m}}};R.subtractOntoOpaqueFusionWithOpaqueLayerMasked=function(a,c,d,b,g){d=0|b.getHeight();let n=0|b.getWidth(),f=(c.width-n)*4|0,e=0|c.offsetOfPixel(b.left,b.top),k=g.width-n|0;b=0|
g.offsetOfPixel(b.left,b.top);for(let l=0;l<d;l++,e+=f,b+=k)for(let h=0;h<n;h++,e+=4,b++){let m=c.data[e+3]*g.data[b]/255|0;m&&(a.data[e]=a.data[e]+m*c.data[e]/255-m|0,a.data[e+1]=a.data[e+1]+m*c.data[e+1]/255-m|0,a.data[e+2]=a.data[e+2]+m*c.data[e+2]/255-m|0)}};R.subtractOntoOpaqueFusionWithTransparentLayerMasked=function(a,c,d,b,g){let n=0|b.getHeight(),f=0|b.getWidth(),e=(c.width-f)*4|0,k=0|c.offsetOfPixel(b.left,b.top),l=g.width-f|0;b=0|g.offsetOfPixel(b.left,b.top);for(let h=0;h<n;h++,k+=e,b+=
l)for(let m=0;m<f;m++,k+=4,b++){let p=c.data[k+3]*g.data[b]*d/25500|0;p&&(a.data[k]=a.data[k]+p*c.data[k]/255-p|0,a.data[k+1]=a.data[k+1]+p*c.data[k+1]/255-p|0,a.data[k+2]=a.data[k+2]+p*c.data[k+2]/255-p|0)}};R.subtractOntoTransparentFusionWithOpaqueLayerMasked=function(a,c,d,b,g){d=0|b.getHeight();let n=0|b.getWidth(),f=(c.width-n)*4|0,e=0|c.offsetOfPixel(b.left,b.top),k=g.width-n|0;b=0|g.offsetOfPixel(b.left,b.top);for(let l=0;l<d;l++,e+=f,b+=k)for(let h=0;h<n;h++,e+=4,b++){let m=c.data[e+3]*g.data[b]/
255|0,p;if(m){let q=m+(p=a.data[e+3])-(m*p/255|0)|0,r=m*p;a.data[e]=(p*a.data[e]+m*c.data[e]-r)/q|0;a.data[e+1]=(p*a.data[e+1]+m*c.data[e+1]-r)/q|0;a.data[e+2]=(p*a.data[e+2]+m*c.data[e+2]-r)/q|0;a.data[e+3]=q}}};R.subtractOntoTransparentFusionWithTransparentLayerMasked=function(a,c,d,b,g){let n=0|b.getHeight(),f=0|b.getWidth(),e=(c.width-f)*4|0,k=0|c.offsetOfPixel(b.left,b.top),l=g.width-f|0;b=0|g.offsetOfPixel(b.left,b.top);for(let h=0;h<n;h++,k+=e,b+=l)for(let m=0;m<f;m++,k+=4,b++){let p=c.data[k+
3]*g.data[b]*d/25500|0,q;if(p){let r=p+(q=a.data[k+3])-(p*q/255|0)|0,u=p*q;a.data[k]=(q*a.data[k]+p*c.data[k]-u)/r|0;a.data[k+1]=(q*a.data[k+1]+p*c.data[k+1]-u)/r|0;a.data[k+2]=(q*a.data[k+2]+p*c.data[k+2]-u)/r|0;a.data[k+3]=r}}};R.screenOntoOpaqueFusionWithOpaqueLayer=function(a,c,d,b){d=0|b.getHeight();let g=0|b.getWidth(),n=(c.width-g)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let f=0;f<d;f++,b+=n)for(let e=0;e<g;e++,b+=4){let k=c.data[b+3],l;if(k){let h=255^k;l=a.data[b];a.data[b]=255^((255^l)*
h+(255^c.data[b])*(255^l)*k/255)/255;l=a.data[b+1];a.data[b+1]=255^((255^l)*h+(255^c.data[b+1])*(255^l)*k/255)/255;l=a.data[b+2];a.data[b+2]=255^((255^l)*h+(255^c.data[b+2])*(255^l)*k/255)/255}}};R.screenOntoOpaqueFusionWithTransparentLayer=function(a,c,d,b){let g=0|b.getHeight(),n=0|b.getWidth(),f=(c.width-n)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<g;e++,b+=f)for(let k=0;k<n;k++,b+=4){let l=c.data[b+3]*d/100|0,h;if(l){let m=255^l;h=a.data[b];a.data[b]=255^((255^h)*m+(255^c.data[b])*(255^
h)*l/255)/255;h=a.data[b+1];a.data[b+1]=255^((255^h)*m+(255^c.data[b+1])*(255^h)*l/255)/255;h=a.data[b+2];a.data[b+2]=255^((255^h)*m+(255^c.data[b+2])*(255^h)*l/255)/255}}};R.screenOntoTransparentFusionWithOpaqueLayer=function(a,c,d,b){d=0|b.getHeight();let g=0|b.getWidth(),n=(c.width-g)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<d;e++,b+=n)for(let k=0;k<g;k++,b+=4){var f=c.data[b+3];let l,h;if(f){let m=f+(l=a.data[b+3])-(f*l/255|0)|0,p=f*l/255|0,q=f*(255^l)/255|0,r=(255^f)*l/255|0;f=c.data[b];
h=a.data[b];a.data[b]=255^((255^f)*q+(255^h)*r+(255^f)*(255^h)*p/255)/m;f=c.data[b+1];h=a.data[b+1];a.data[b+1]=255^((255^f)*q+(255^h)*r+(255^f)*(255^h)*p/255)/m;f=c.data[b+2];h=a.data[b+2];a.data[b+2]=255^((255^f)*q+(255^h)*r+(255^f)*(255^h)*p/255)/m;a.data[b+3]=m}}};R.screenOntoTransparentFusionWithTransparentLayer=function(a,c,d,b){let g=0|b.getHeight(),n=0|b.getWidth(),f=(c.width-n)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let k=0;k<g;k++,b+=f)for(let l=0;l<n;l++,b+=4){var e=c.data[b+3]*d/100|
0;let h,m;if(e){let p=e+(h=a.data[b+3])-(e*h/255|0)|0,q=e*h/255|0,r=e*(255^h)/255|0,u=(255^e)*h/255|0;e=c.data[b];m=a.data[b];a.data[b]=255^((255^e)*r+(255^m)*u+(255^e)*(255^m)*q/255)/p;e=c.data[b+1];m=a.data[b+1];a.data[b+1]=255^((255^e)*r+(255^m)*u+(255^e)*(255^m)*q/255)/p;e=c.data[b+2];m=a.data[b+2];a.data[b+2]=255^((255^e)*r+(255^m)*u+(255^e)*(255^m)*q/255)/p;a.data[b+3]=p}}};R.screenOntoOpaqueFusionWithOpaqueLayerMasked=function(a,c,d,b,g){d=0|b.getHeight();let n=0|b.getWidth(),f=(c.width-n)*
4|0,e=0|c.offsetOfPixel(b.left,b.top),k=g.width-n|0;b=0|g.offsetOfPixel(b.left,b.top);for(let l=0;l<d;l++,e+=f,b+=k)for(let h=0;h<n;h++,e+=4,b++){let m=c.data[e+3]*g.data[b]/255|0,p;if(m){let q=255^m;p=a.data[e];a.data[e]=255^((255^p)*q+(255^c.data[e])*(255^p)*m/255)/255;p=a.data[e+1];a.data[e+1]=255^((255^p)*q+(255^c.data[e+1])*(255^p)*m/255)/255;p=a.data[e+2];a.data[e+2]=255^((255^p)*q+(255^c.data[e+2])*(255^p)*m/255)/255}}};R.screenOntoOpaqueFusionWithTransparentLayerMasked=function(a,c,d,b,g){let n=
0|b.getHeight(),f=0|b.getWidth(),e=(c.width-f)*4|0,k=0|c.offsetOfPixel(b.left,b.top),l=g.width-f|0;b=0|g.offsetOfPixel(b.left,b.top);for(let h=0;h<n;h++,k+=e,b+=l)for(let m=0;m<f;m++,k+=4,b++){let p=c.data[k+3]*g.data[b]*d/25500|0,q;if(p){let r=255^p;q=a.data[k];a.data[k]=255^((255^q)*r+(255^c.data[k])*(255^q)*p/255)/255;q=a.data[k+1];a.data[k+1]=255^((255^q)*r+(255^c.data[k+1])*(255^q)*p/255)/255;q=a.data[k+2];a.data[k+2]=255^((255^q)*r+(255^c.data[k+2])*(255^q)*p/255)/255}}};R.screenOntoTransparentFusionWithOpaqueLayerMasked=
function(a,c,d,b,g){d=0|b.getHeight();let n=0|b.getWidth(),f=(c.width-n)*4|0,e=0|c.offsetOfPixel(b.left,b.top),k=g.width-n|0;b=0|g.offsetOfPixel(b.left,b.top);for(let h=0;h<d;h++,e+=f,b+=k)for(let m=0;m<n;m++,e+=4,b++){var l=c.data[e+3]*g.data[b]/255|0;let p,q;if(l){let r=l+(p=a.data[e+3])-(l*p/255|0)|0,u=l*p/255|0,v=l*(255^p)/255|0,y=(255^l)*p/255|0;l=c.data[e];q=a.data[e];a.data[e]=255^((255^l)*v+(255^q)*y+(255^l)*(255^q)*u/255)/r;l=c.data[e+1];q=a.data[e+1];a.data[e+1]=255^((255^l)*v+(255^q)*y+
(255^l)*(255^q)*u/255)/r;l=c.data[e+2];q=a.data[e+2];a.data[e+2]=255^((255^l)*v+(255^q)*y+(255^l)*(255^q)*u/255)/r;a.data[e+3]=r}}};R.screenOntoTransparentFusionWithTransparentLayerMasked=function(a,c,d,b,g){let n=0|b.getHeight(),f=0|b.getWidth(),e=(c.width-f)*4|0,k=0|c.offsetOfPixel(b.left,b.top),l=g.width-f|0;b=0|g.offsetOfPixel(b.left,b.top);for(let m=0;m<n;m++,k+=e,b+=l)for(let p=0;p<f;p++,k+=4,b++){var h=c.data[k+3]*g.data[b]*d/25500|0;let q,r;if(h){let u=h+(q=a.data[k+3])-(h*q/255|0)|0,v=h*
q/255|0,y=h*(255^q)/255|0,C=(255^h)*q/255|0;h=c.data[k];r=a.data[k];a.data[k]=255^((255^h)*y+(255^r)*C+(255^h)*(255^r)*v/255)/u;h=c.data[k+1];r=a.data[k+1];a.data[k+1]=255^((255^h)*y+(255^r)*C+(255^h)*(255^r)*v/255)/u;h=c.data[k+2];r=a.data[k+2];a.data[k+2]=255^((255^h)*y+(255^r)*C+(255^h)*(255^r)*v/255)/u;a.data[k+3]=u}}};R.lightenOntoOpaqueFusionWithOpaqueLayer=function(a,c,d,b){d=0|b.getHeight();let g=0|b.getWidth(),n=(c.width-g)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let f=0;f<d;f++,b+=n)for(let e=
0;e<g;e++,b+=4){let k=c.data[b+3],l,h;if(k){let m=255^k;l=c.data[b];h=a.data[b];a.data[b]=h>=l?h:(h*m+l*k)/255|0;l=c.data[b+1];h=a.data[b+1];a.data[b+1]=h>=l?h:(h*m+l*k)/255|0;l=c.data[b+2];h=a.data[b+2];a.data[b+2]=h>=l?h:(h*m+l*k)/255|0}}};R.lightenOntoOpaqueFusionWithTransparentLayer=function(a,c,d,b){let g=0|b.getHeight(),n=0|b.getWidth(),f=(c.width-n)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<g;e++,b+=f)for(let k=0;k<n;k++,b+=4){let l=c.data[b+3]*d/100|0,h,m;if(l){let p=255^l;h=c.data[b];
m=a.data[b];a.data[b]=m>=h?m:(m*p+h*l)/255|0;h=c.data[b+1];m=a.data[b+1];a.data[b+1]=m>=h?m:(m*p+h*l)/255|0;h=c.data[b+2];m=a.data[b+2];a.data[b+2]=m>=h?m:(m*p+h*l)/255|0}}};R.lightenOntoTransparentFusionWithOpaqueLayer=function(a,c,d,b){d=0|b.getHeight();let g=0|b.getWidth(),n=(c.width-g)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<d;e++,b+=n)for(let k=0;k<g;k++,b+=4){var f=c.data[b+3];let l,h;if(f){let m=f+(l=a.data[b+3])-(f*l/255|0)|0,p=l*(255^f)/m|0,q=255^p,r=f*(255^l)/m|0,u=255^r;f=c.data[b];
h=a.data[b];a.data[b]=(h>=f?f*r+h*u:h*p+f*q)/255|0;f=c.data[b+1];h=a.data[b+1];a.data[b+1]=(h>=f?f*r+h*u:h*p+f*q)/255|0;f=c.data[b+2];h=a.data[b+2];a.data[b+2]=(h>=f?f*r+h*u:h*p+f*q)/255|0;a.data[b+3]=m}}};R.lightenOntoTransparentFusionWithTransparentLayer=function(a,c,d,b){let g=0|b.getHeight(),n=0|b.getWidth(),f=(c.width-n)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let k=0;k<g;k++,b+=f)for(let l=0;l<n;l++,b+=4){var e=c.data[b+3]*d/100|0;let h,m;if(e){let p=e+(h=a.data[b+3])-(e*h/255|0)|0,q=h*(255^
e)/p|0,r=255^q,u=e*(255^h)/p|0,v=255^u;e=c.data[b];m=a.data[b];a.data[b]=(m>=e?e*u+m*v:m*q+e*r)/255|0;e=c.data[b+1];m=a.data[b+1];a.data[b+1]=(m>=e?e*u+m*v:m*q+e*r)/255|0;e=c.data[b+2];m=a.data[b+2];a.data[b+2]=(m>=e?e*u+m*v:m*q+e*r)/255|0;a.data[b+3]=p}}};R.lightenOntoOpaqueFusionWithOpaqueLayerMasked=function(a,c,d,b,g){d=0|b.getHeight();let n=0|b.getWidth(),f=(c.width-n)*4|0,e=0|c.offsetOfPixel(b.left,b.top),k=g.width-n|0;b=0|g.offsetOfPixel(b.left,b.top);for(let l=0;l<d;l++,e+=f,b+=k)for(let h=
0;h<n;h++,e+=4,b++){let m=c.data[e+3]*g.data[b]/255|0,p,q;if(m){let r=255^m;p=c.data[e];q=a.data[e];a.data[e]=q>=p?q:(q*r+p*m)/255|0;p=c.data[e+1];q=a.data[e+1];a.data[e+1]=q>=p?q:(q*r+p*m)/255|0;p=c.data[e+2];q=a.data[e+2];a.data[e+2]=q>=p?q:(q*r+p*m)/255|0}}};R.lightenOntoOpaqueFusionWithTransparentLayerMasked=function(a,c,d,b,g){let n=0|b.getHeight(),f=0|b.getWidth(),e=(c.width-f)*4|0,k=0|c.offsetOfPixel(b.left,b.top),l=g.width-f|0;b=0|g.offsetOfPixel(b.left,b.top);for(let h=0;h<n;h++,k+=e,b+=
l)for(let m=0;m<f;m++,k+=4,b++){let p=c.data[k+3]*g.data[b]*d/25500|0,q,r;if(p){let u=255^p;q=c.data[k];r=a.data[k];a.data[k]=r>=q?r:(r*u+q*p)/255|0;q=c.data[k+1];r=a.data[k+1];a.data[k+1]=r>=q?r:(r*u+q*p)/255|0;q=c.data[k+2];r=a.data[k+2];a.data[k+2]=r>=q?r:(r*u+q*p)/255|0}}};R.lightenOntoTransparentFusionWithOpaqueLayerMasked=function(a,c,d,b,g){d=0|b.getHeight();let n=0|b.getWidth(),f=(c.width-n)*4|0,e=0|c.offsetOfPixel(b.left,b.top),k=g.width-n|0;b=0|g.offsetOfPixel(b.left,b.top);for(let h=0;h<
d;h++,e+=f,b+=k)for(let m=0;m<n;m++,e+=4,b++){var l=c.data[e+3]*g.data[b]/255|0;let p,q;if(l){let r=l+(p=a.data[e+3])-(l*p/255|0)|0,u=p*(255^l)/r|0,v=255^u,y=l*(255^p)/r|0,C=255^y;l=c.data[e];q=a.data[e];a.data[e]=(q>=l?l*y+q*C:q*u+l*v)/255|0;l=c.data[e+1];q=a.data[e+1];a.data[e+1]=(q>=l?l*y+q*C:q*u+l*v)/255|0;l=c.data[e+2];q=a.data[e+2];a.data[e+2]=(q>=l?l*y+q*C:q*u+l*v)/255|0;a.data[e+3]=r}}};R.lightenOntoTransparentFusionWithTransparentLayerMasked=function(a,c,d,b,g){let n=0|b.getHeight(),f=0|
b.getWidth(),e=(c.width-f)*4|0,k=0|c.offsetOfPixel(b.left,b.top),l=g.width-f|0;b=0|g.offsetOfPixel(b.left,b.top);for(let m=0;m<n;m++,k+=e,b+=l)for(let p=0;p<f;p++,k+=4,b++){var h=c.data[k+3]*g.data[b]*d/25500|0;let q,r;if(h){let u=h+(q=a.data[k+3])-(h*q/255|0)|0,v=q*(255^h)/u|0,y=255^v,C=h*(255^q)/u|0,w=255^C;h=c.data[k];r=a.data[k];a.data[k]=(r>=h?h*C+r*w:r*v+h*y)/255|0;h=c.data[k+1];r=a.data[k+1];a.data[k+1]=(r>=h?h*C+r*w:r*v+h*y)/255|0;h=c.data[k+2];r=a.data[k+2];a.data[k+2]=(r>=h?h*C+r*w:r*v+
h*y)/255|0;a.data[k+3]=u}}};R.darkenOntoOpaqueFusionWithOpaqueLayer=function(a,c,d,b){d=0|b.getHeight();let g=0|b.getWidth(),n=(c.width-g)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let f=0;f<d;f++,b+=n)for(let e=0;e<g;e++,b+=4){let k=c.data[b+3],l,h;if(k){let m=255^k;l=c.data[b];h=a.data[b];a.data[b]=h>=l?(h*m+l*k)/255|0:h;l=c.data[b+1];h=a.data[b+1];a.data[b+1]=h>=l?(h*m+l*k)/255|0:h;l=c.data[b+2];h=a.data[b+2];a.data[b+2]=h>=l?(h*m+l*k)/255|0:h}}};R.darkenOntoOpaqueFusionWithTransparentLayer=function(a,
c,d,b){let g=0|b.getHeight(),n=0|b.getWidth(),f=(c.width-n)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<g;e++,b+=f)for(let k=0;k<n;k++,b+=4){let l=c.data[b+3]*d/100|0,h,m;if(l){let p=255^l;h=c.data[b];m=a.data[b];a.data[b]=m>=h?(m*p+h*l)/255|0:m;h=c.data[b+1];m=a.data[b+1];a.data[b+1]=m>=h?(m*p+h*l)/255|0:m;h=c.data[b+2];m=a.data[b+2];a.data[b+2]=m>=h?(m*p+h*l)/255|0:m}}};R.darkenOntoTransparentFusionWithOpaqueLayer=function(a,c,d,b){d=0|b.getHeight();let g=0|b.getWidth(),n=(c.width-g)*4|
0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<d;e++,b+=n)for(let k=0;k<g;k++,b+=4){var f=c.data[b+3];let l,h;if(f){let m=f+(l=a.data[b+3])-(f*l/255|0)|0,p=f*(255^l)/m|0,q=255^p,r=l*(255^f)/m|0,u=255^r;f=c.data[b];h=a.data[b];a.data[b]=(h>=f?h*r+f*u:f*p+h*q)/255|0;f=c.data[b+1];h=a.data[b+1];a.data[b+1]=(h>=f?h*r+f*u:f*p+h*q)/255|0;f=c.data[b+2];h=a.data[b+2];a.data[b+2]=(h>=f?h*r+f*u:f*p+h*q)/255|0;a.data[b+3]=m}}};R.darkenOntoTransparentFusionWithTransparentLayer=function(a,c,d,b){let g=0|b.getHeight(),
n=0|b.getWidth(),f=(c.width-n)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let k=0;k<g;k++,b+=f)for(let l=0;l<n;l++,b+=4){var e=c.data[b+3]*d/100|0;let h,m;if(e){let p=e+(h=a.data[b+3])-(e*h/255|0)|0,q=e*(255^h)/p|0,r=255^q,u=h*(255^e)/p|0,v=255^u;e=c.data[b];m=a.data[b];a.data[b]=(m>=e?m*u+e*v:e*q+m*r)/255|0;e=c.data[b+1];m=a.data[b+1];a.data[b+1]=(m>=e?m*u+e*v:e*q+m*r)/255|0;e=c.data[b+2];m=a.data[b+2];a.data[b+2]=(m>=e?m*u+e*v:e*q+m*r)/255|0;a.data[b+3]=p}}};R.darkenOntoOpaqueFusionWithOpaqueLayerMasked=
function(a,c,d,b,g){d=0|b.getHeight();let n=0|b.getWidth(),f=(c.width-n)*4|0,e=0|c.offsetOfPixel(b.left,b.top),k=g.width-n|0;b=0|g.offsetOfPixel(b.left,b.top);for(let l=0;l<d;l++,e+=f,b+=k)for(let h=0;h<n;h++,e+=4,b++){let m=c.data[e+3]*g.data[b]/255|0,p,q;if(m){let r=255^m;p=c.data[e];q=a.data[e];a.data[e]=q>=p?(q*r+p*m)/255|0:q;p=c.data[e+1];q=a.data[e+1];a.data[e+1]=q>=p?(q*r+p*m)/255|0:q;p=c.data[e+2];q=a.data[e+2];a.data[e+2]=q>=p?(q*r+p*m)/255|0:q}}};R.darkenOntoOpaqueFusionWithTransparentLayerMasked=
function(a,c,d,b,g){let n=0|b.getHeight(),f=0|b.getWidth(),e=(c.width-f)*4|0,k=0|c.offsetOfPixel(b.left,b.top),l=g.width-f|0;b=0|g.offsetOfPixel(b.left,b.top);for(let h=0;h<n;h++,k+=e,b+=l)for(let m=0;m<f;m++,k+=4,b++){let p=c.data[k+3]*g.data[b]*d/25500|0,q,r;if(p){let u=255^p;q=c.data[k];r=a.data[k];a.data[k]=r>=q?(r*u+q*p)/255|0:r;q=c.data[k+1];r=a.data[k+1];a.data[k+1]=r>=q?(r*u+q*p)/255|0:r;q=c.data[k+2];r=a.data[k+2];a.data[k+2]=r>=q?(r*u+q*p)/255|0:r}}};R.darkenOntoTransparentFusionWithOpaqueLayerMasked=
function(a,c,d,b,g){d=0|b.getHeight();let n=0|b.getWidth(),f=(c.width-n)*4|0,e=0|c.offsetOfPixel(b.left,b.top),k=g.width-n|0;b=0|g.offsetOfPixel(b.left,b.top);for(let h=0;h<d;h++,e+=f,b+=k)for(let m=0;m<n;m++,e+=4,b++){var l=c.data[e+3]*g.data[b]/255|0;let p,q;if(l){let r=l+(p=a.data[e+3])-(l*p/255|0)|0,u=l*(255^p)/r|0,v=255^u,y=p*(255^l)/r|0,C=255^y;l=c.data[e];q=a.data[e];a.data[e]=(q>=l?q*y+l*C:l*u+q*v)/255|0;l=c.data[e+1];q=a.data[e+1];a.data[e+1]=(q>=l?q*y+l*C:l*u+q*v)/255|0;l=c.data[e+2];q=
a.data[e+2];a.data[e+2]=(q>=l?q*y+l*C:l*u+q*v)/255|0;a.data[e+3]=r}}};R.darkenOntoTransparentFusionWithTransparentLayerMasked=function(a,c,d,b,g){let n=0|b.getHeight(),f=0|b.getWidth(),e=(c.width-f)*4|0,k=0|c.offsetOfPixel(b.left,b.top),l=g.width-f|0;b=0|g.offsetOfPixel(b.left,b.top);for(let m=0;m<n;m++,k+=e,b+=l)for(let p=0;p<f;p++,k+=4,b++){var h=c.data[k+3]*g.data[b]*d/25500|0;let q,r;if(h){let u=h+(q=a.data[k+3])-(h*q/255|0)|0,v=h*(255^q)/u|0,y=255^v,C=q*(255^h)/u|0,w=255^C;h=c.data[k];r=a.data[k];
a.data[k]=(r>=h?r*C+h*w:h*v+r*y)/255|0;h=c.data[k+1];r=a.data[k+1];a.data[k+1]=(r>=h?r*C+h*w:h*v+r*y)/255|0;h=c.data[k+2];r=a.data[k+2];a.data[k+2]=(r>=h?r*C+h*w:h*v+r*y)/255|0;a.data[k+3]=u}}};R.dodgeOntoOpaqueFusionWithOpaqueLayer=function(a,c,d,b){d=0|b.getHeight();let g=0|b.getWidth(),n=(c.width-g)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let f=0;f<d;f++,b+=n)for(let e=0;e<g;e++,b+=4){let k=c.data[b+3],l,h;if(k){let m=255^k;l=c.data[b];h=a.data[b];a.data[b]=(h*m+k*(255==l?255:Math.min(255,255*
h/(255^l)|0)))/255|0;l=c.data[b+1];h=a.data[b+1];a.data[b+1]=(h*m+k*(255==l?255:Math.min(255,255*h/(255^l)|0)))/255|0;l=c.data[b+2];h=a.data[b+2];a.data[b+2]=(h*m+k*(255==l?255:Math.min(255,255*h/(255^l)|0)))/255|0}}};R.dodgeOntoOpaqueFusionWithTransparentLayer=function(a,c,d,b){let g=0|b.getHeight(),n=0|b.getWidth(),f=(c.width-n)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<g;e++,b+=f)for(let k=0;k<n;k++,b+=4){let l=c.data[b+3]*d/100|0,h,m;if(l){let p=255^l;h=c.data[b];m=a.data[b];a.data[b]=
(m*p+l*(255==h?255:Math.min(255,255*m/(255^h)|0)))/255|0;h=c.data[b+1];m=a.data[b+1];a.data[b+1]=(m*p+l*(255==h?255:Math.min(255,255*m/(255^h)|0)))/255|0;h=c.data[b+2];m=a.data[b+2];a.data[b+2]=(m*p+l*(255==h?255:Math.min(255,255*m/(255^h)|0)))/255|0}}};R.dodgeOntoTransparentFusionWithOpaqueLayer=function(a,c,d,b){d=0|b.getHeight();let g=0|b.getWidth(),n=(c.width-g)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<d;e++,b+=n)for(let k=0;k<g;k++,b+=4){var f=c.data[b+3];let l,h;if(f){let m=f+(l=
a.data[b+3])-(f*l/255|0)|0,p=f*l/255|0,q=f*(255^l)/255|0,r=(255^f)*l/255|0;f=c.data[b];h=a.data[b];a.data[b]=(f*q+h*r+p*(255==f?255:Math.min(255,255*h/(255^f)|0)))/m|0;f=c.data[b+1];h=a.data[b+1];a.data[b+1]=(f*q+h*r+p*(255==f?255:Math.min(255,255*h/(255^f)|0)))/m|0;f=c.data[b+2];h=a.data[b+2];a.data[b+2]=(f*q+h*r+p*(255==f?255:Math.min(255,255*h/(255^f)|0)))/m|0;a.data[b+3]=m}}};R.dodgeOntoTransparentFusionWithTransparentLayer=function(a,c,d,b){let g=0|b.getHeight(),n=0|b.getWidth(),f=(c.width-n)*
4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let k=0;k<g;k++,b+=f)for(let l=0;l<n;l++,b+=4){var e=c.data[b+3]*d/100|0;let h,m;if(e){let p=e+(h=a.data[b+3])-(e*h/255|0)|0,q=e*h/255|0,r=e*(255^h)/255|0,u=(255^e)*h/255|0;e=c.data[b];m=a.data[b];a.data[b]=(e*r+m*u+q*(255==e?255:Math.min(255,255*m/(255^e)|0)))/p|0;e=c.data[b+1];m=a.data[b+1];a.data[b+1]=(e*r+m*u+q*(255==e?255:Math.min(255,255*m/(255^e)|0)))/p|0;e=c.data[b+2];m=a.data[b+2];a.data[b+2]=(e*r+m*u+q*(255==e?255:Math.min(255,255*m/(255^e)|0)))/
p|0;a.data[b+3]=p}}};R.dodgeOntoOpaqueFusionWithOpaqueLayerMasked=function(a,c,d,b,g){d=0|b.getHeight();let n=0|b.getWidth(),f=(c.width-n)*4|0,e=0|c.offsetOfPixel(b.left,b.top),k=g.width-n|0;b=0|g.offsetOfPixel(b.left,b.top);for(let l=0;l<d;l++,e+=f,b+=k)for(let h=0;h<n;h++,e+=4,b++){let m=c.data[e+3]*g.data[b]/255|0,p,q;if(m){let r=255^m;p=c.data[e];q=a.data[e];a.data[e]=(q*r+m*(255==p?255:Math.min(255,255*q/(255^p)|0)))/255|0;p=c.data[e+1];q=a.data[e+1];a.data[e+1]=(q*r+m*(255==p?255:Math.min(255,
255*q/(255^p)|0)))/255|0;p=c.data[e+2];q=a.data[e+2];a.data[e+2]=(q*r+m*(255==p?255:Math.min(255,255*q/(255^p)|0)))/255|0}}};R.dodgeOntoOpaqueFusionWithTransparentLayerMasked=function(a,c,d,b,g){let n=0|b.getHeight(),f=0|b.getWidth(),e=(c.width-f)*4|0,k=0|c.offsetOfPixel(b.left,b.top),l=g.width-f|0;b=0|g.offsetOfPixel(b.left,b.top);for(let h=0;h<n;h++,k+=e,b+=l)for(let m=0;m<f;m++,k+=4,b++){let p=c.data[k+3]*g.data[b]*d/25500|0,q,r;if(p){let u=255^p;q=c.data[k];r=a.data[k];a.data[k]=(r*u+p*(255==
q?255:Math.min(255,255*r/(255^q)|0)))/255|0;q=c.data[k+1];r=a.data[k+1];a.data[k+1]=(r*u+p*(255==q?255:Math.min(255,255*r/(255^q)|0)))/255|0;q=c.data[k+2];r=a.data[k+2];a.data[k+2]=(r*u+p*(255==q?255:Math.min(255,255*r/(255^q)|0)))/255|0}}};R.dodgeOntoTransparentFusionWithOpaqueLayerMasked=function(a,c,d,b,g){d=0|b.getHeight();let n=0|b.getWidth(),f=(c.width-n)*4|0,e=0|c.offsetOfPixel(b.left,b.top),k=g.width-n|0;b=0|g.offsetOfPixel(b.left,b.top);for(let h=0;h<d;h++,e+=f,b+=k)for(let m=0;m<n;m++,e+=
4,b++){var l=c.data[e+3]*g.data[b]/255|0;let p,q;if(l){let r=l+(p=a.data[e+3])-(l*p/255|0)|0,u=l*p/255|0,v=l*(255^p)/255|0,y=(255^l)*p/255|0;l=c.data[e];q=a.data[e];a.data[e]=(l*v+q*y+u*(255==l?255:Math.min(255,255*q/(255^l)|0)))/r|0;l=c.data[e+1];q=a.data[e+1];a.data[e+1]=(l*v+q*y+u*(255==l?255:Math.min(255,255*q/(255^l)|0)))/r|0;l=c.data[e+2];q=a.data[e+2];a.data[e+2]=(l*v+q*y+u*(255==l?255:Math.min(255,255*q/(255^l)|0)))/r|0;a.data[e+3]=r}}};R.dodgeOntoTransparentFusionWithTransparentLayerMasked=
function(a,c,d,b,g){let n=0|b.getHeight(),f=0|b.getWidth(),e=(c.width-f)*4|0,k=0|c.offsetOfPixel(b.left,b.top),l=g.width-f|0;b=0|g.offsetOfPixel(b.left,b.top);for(let m=0;m<n;m++,k+=e,b+=l)for(let p=0;p<f;p++,k+=4,b++){var h=c.data[k+3]*g.data[b]*d/25500|0;let q,r;if(h){let u=h+(q=a.data[k+3])-(h*q/255|0)|0,v=h*q/255|0,y=h*(255^q)/255|0,C=(255^h)*q/255|0;h=c.data[k];r=a.data[k];a.data[k]=(h*y+r*C+v*(255==h?255:Math.min(255,255*r/(255^h)|0)))/u|0;h=c.data[k+1];r=a.data[k+1];a.data[k+1]=(h*y+r*C+v*
(255==h?255:Math.min(255,255*r/(255^h)|0)))/u|0;h=c.data[k+2];r=a.data[k+2];a.data[k+2]=(h*y+r*C+v*(255==h?255:Math.min(255,255*r/(255^h)|0)))/u|0;a.data[k+3]=u}}};R.burnOntoOpaqueFusionWithOpaqueLayer=function(a,c,d,b){d=0|b.getHeight();let g=0|b.getWidth(),n=(c.width-g)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let f=0;f<d;f++,b+=n)for(let e=0;e<g;e++,b+=4){let k=c.data[b+3],l,h;if(k){let m=255^k;l=c.data[b];h=a.data[b];a.data[b]=(h*m+k*(0==l?0:255^Math.min(255,255*(255^h)/l)))/255|0;l=c.data[b+
1];h=a.data[b+1];a.data[b+1]=(h*m+k*(0==l?0:255^Math.min(255,255*(255^h)/l)))/255|0;l=c.data[b+2];h=a.data[b+2];a.data[b+2]=(h*m+k*(0==l?0:255^Math.min(255,255*(255^h)/l)))/255|0}}};R.burnOntoOpaqueFusionWithTransparentLayer=function(a,c,d,b){let g=0|b.getHeight(),n=0|b.getWidth(),f=(c.width-n)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<g;e++,b+=f)for(let k=0;k<n;k++,b+=4){let l=c.data[b+3]*d/100|0,h,m;if(l){let p=255^l;h=c.data[b];m=a.data[b];a.data[b]=(m*p+l*(0==h?0:255^Math.min(255,255*
(255^m)/h)))/255|0;h=c.data[b+1];m=a.data[b+1];a.data[b+1]=(m*p+l*(0==h?0:255^Math.min(255,255*(255^m)/h)))/255|0;h=c.data[b+2];m=a.data[b+2];a.data[b+2]=(m*p+l*(0==h?0:255^Math.min(255,255*(255^m)/h)))/255|0}}};R.burnOntoTransparentFusionWithOpaqueLayer=function(a,c,d,b){d=0|b.getHeight();let g=0|b.getWidth(),n=(c.width-g)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<d;e++,b+=n)for(let k=0;k<g;k++,b+=4){var f=c.data[b+3];let l,h;if(f){let m=f+(l=a.data[b+3])-(f*l/255|0)|0,p=f*l/255|0,q=f*
(255^l)/255|0,r=(255^f)*l/255|0;f=c.data[b];h=a.data[b];a.data[b]=(f*q+h*r+p*(0==f?0:255^Math.min(255,255*(255^h)/f)))/m|0;f=c.data[b+1];h=a.data[b+1];a.data[b+1]=(f*q+h*r+p*(0==f?0:255^Math.min(255,255*(255^h)/f)))/m|0;f=c.data[b+2];h=a.data[b+2];a.data[b+2]=(f*q+h*r+p*(0==f?0:255^Math.min(255,255*(255^h)/f)))/m|0;a.data[b+3]=m}}};R.burnOntoTransparentFusionWithTransparentLayer=function(a,c,d,b){let g=0|b.getHeight(),n=0|b.getWidth(),f=(c.width-n)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let k=
0;k<g;k++,b+=f)for(let l=0;l<n;l++,b+=4){var e=c.data[b+3]*d/100|0;let h,m;if(e){let p=e+(h=a.data[b+3])-(e*h/255|0)|0,q=e*h/255|0,r=e*(255^h)/255|0,u=(255^e)*h/255|0;e=c.data[b];m=a.data[b];a.data[b]=(e*r+m*u+q*(0==e?0:255^Math.min(255,255*(255^m)/e)))/p|0;e=c.data[b+1];m=a.data[b+1];a.data[b+1]=(e*r+m*u+q*(0==e?0:255^Math.min(255,255*(255^m)/e)))/p|0;e=c.data[b+2];m=a.data[b+2];a.data[b+2]=(e*r+m*u+q*(0==e?0:255^Math.min(255,255*(255^m)/e)))/p|0;a.data[b+3]=p}}};R.burnOntoOpaqueFusionWithOpaqueLayerMasked=
function(a,c,d,b,g){d=0|b.getHeight();let n=0|b.getWidth(),f=(c.width-n)*4|0,e=0|c.offsetOfPixel(b.left,b.top),k=g.width-n|0;b=0|g.offsetOfPixel(b.left,b.top);for(let l=0;l<d;l++,e+=f,b+=k)for(let h=0;h<n;h++,e+=4,b++){let m=c.data[e+3]*g.data[b]/255|0,p,q;if(m){let r=255^m;p=c.data[e];q=a.data[e];a.data[e]=(q*r+m*(0==p?0:255^Math.min(255,255*(255^q)/p)))/255|0;p=c.data[e+1];q=a.data[e+1];a.data[e+1]=(q*r+m*(0==p?0:255^Math.min(255,255*(255^q)/p)))/255|0;p=c.data[e+2];q=a.data[e+2];a.data[e+2]=(q*
r+m*(0==p?0:255^Math.min(255,255*(255^q)/p)))/255|0}}};R.burnOntoOpaqueFusionWithTransparentLayerMasked=function(a,c,d,b,g){let n=0|b.getHeight(),f=0|b.getWidth(),e=(c.width-f)*4|0,k=0|c.offsetOfPixel(b.left,b.top),l=g.width-f|0;b=0|g.offsetOfPixel(b.left,b.top);for(let h=0;h<n;h++,k+=e,b+=l)for(let m=0;m<f;m++,k+=4,b++){let p=c.data[k+3]*g.data[b]*d/25500|0,q,r;if(p){let u=255^p;q=c.data[k];r=a.data[k];a.data[k]=(r*u+p*(0==q?0:255^Math.min(255,255*(255^r)/q)))/255|0;q=c.data[k+1];r=a.data[k+1];a.data[k+
1]=(r*u+p*(0==q?0:255^Math.min(255,255*(255^r)/q)))/255|0;q=c.data[k+2];r=a.data[k+2];a.data[k+2]=(r*u+p*(0==q?0:255^Math.min(255,255*(255^r)/q)))/255|0}}};R.burnOntoTransparentFusionWithOpaqueLayerMasked=function(a,c,d,b,g){d=0|b.getHeight();let n=0|b.getWidth(),f=(c.width-n)*4|0,e=0|c.offsetOfPixel(b.left,b.top),k=g.width-n|0;b=0|g.offsetOfPixel(b.left,b.top);for(let h=0;h<d;h++,e+=f,b+=k)for(let m=0;m<n;m++,e+=4,b++){var l=c.data[e+3]*g.data[b]/255|0;let p,q;if(l){let r=l+(p=a.data[e+3])-(l*p/
255|0)|0,u=l*p/255|0,v=l*(255^p)/255|0,y=(255^l)*p/255|0;l=c.data[e];q=a.data[e];a.data[e]=(l*v+q*y+u*(0==l?0:255^Math.min(255,255*(255^q)/l)))/r|0;l=c.data[e+1];q=a.data[e+1];a.data[e+1]=(l*v+q*y+u*(0==l?0:255^Math.min(255,255*(255^q)/l)))/r|0;l=c.data[e+2];q=a.data[e+2];a.data[e+2]=(l*v+q*y+u*(0==l?0:255^Math.min(255,255*(255^q)/l)))/r|0;a.data[e+3]=r}}};R.burnOntoTransparentFusionWithTransparentLayerMasked=function(a,c,d,b,g){let n=0|b.getHeight(),f=0|b.getWidth(),e=(c.width-f)*4|0,k=0|c.offsetOfPixel(b.left,
b.top),l=g.width-f|0;b=0|g.offsetOfPixel(b.left,b.top);for(let m=0;m<n;m++,k+=e,b+=l)for(let p=0;p<f;p++,k+=4,b++){var h=c.data[k+3]*g.data[b]*d/25500|0;let q,r;if(h){let u=h+(q=a.data[k+3])-(h*q/255|0)|0,v=h*q/255|0,y=h*(255^q)/255|0,C=(255^h)*q/255|0;h=c.data[k];r=a.data[k];a.data[k]=(h*y+r*C+v*(0==h?0:255^Math.min(255,255*(255^r)/h)))/u|0;h=c.data[k+1];r=a.data[k+1];a.data[k+1]=(h*y+r*C+v*(0==h?0:255^Math.min(255,255*(255^r)/h)))/u|0;h=c.data[k+2];r=a.data[k+2];a.data[k+2]=(h*y+r*C+v*(0==h?0:255^
Math.min(255,255*(255^r)/h)))/u|0;a.data[k+3]=u}}};R.overlayOntoOpaqueFusionWithOpaqueLayer=function(a,c,d,b){d=0|b.getHeight();let g=0|b.getWidth(),n=(c.width-g)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let f=0;f<d;f++,b+=n)for(let e=0;e<g;e++,b+=4){let k=c.data[b+3],l,h;if(k){let m=255^k;l=c.data[b];h=a.data[b];a.data[b]=(m*h+(h<=127?2*k*l*h/255:k*(2*(255^l)*(255^h)/255^255)))/255|0;l=c.data[b+1];h=a.data[b+1];a.data[b+1]=(m*h+(h<=127?2*k*l*h/255:k*(2*(255^l)*(255^h)/255^255)))/255|0;l=c.data[b+
2];h=a.data[b+2];a.data[b+2]=(m*h+(h<=127?2*k*l*h/255:k*(2*(255^l)*(255^h)/255^255)))/255|0}}};R.overlayOntoOpaqueFusionWithTransparentLayer=function(a,c,d,b){let g=0|b.getHeight(),n=0|b.getWidth(),f=(c.width-n)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<g;e++,b+=f)for(let k=0;k<n;k++,b+=4){let l=c.data[b+3]*d/100|0,h,m;if(l){let p=255^l;h=c.data[b];m=a.data[b];a.data[b]=(p*m+(m<=127?2*l*h*m/255:l*(2*(255^h)*(255^m)/255^255)))/255|0;h=c.data[b+1];m=a.data[b+1];a.data[b+1]=(p*m+(m<=127?2*
l*h*m/255:l*(2*(255^h)*(255^m)/255^255)))/255|0;h=c.data[b+2];m=a.data[b+2];a.data[b+2]=(p*m+(m<=127?2*l*h*m/255:l*(2*(255^h)*(255^m)/255^255)))/255|0}}};R.overlayOntoTransparentFusionWithOpaqueLayer=function(a,c,d,b){d=0|b.getHeight();let g=0|b.getWidth(),n=(c.width-g)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<d;e++,b+=n)for(let k=0;k<g;k++,b+=4){var f=c.data[b+3];let l,h;if(f){let m=f+(l=a.data[b+3])-(f*l/255|0)|0,p=f*l/255|0,q=f*(255^l)/255|0,r=(255^f)*l/255|0;f=c.data[b];h=a.data[b];
a.data[b]=(q*f+r*h+(h<=127?2*p*f*h/255:p*(2*(255^f)*(255^h)/255^255)))/m|0;f=c.data[b+1];h=a.data[b+1];a.data[b+1]=(q*f+r*h+(h<=127?2*p*f*h/255:p*(2*(255^f)*(255^h)/255^255)))/m|0;f=c.data[b+2];h=a.data[b+2];a.data[b+2]=(q*f+r*h+(h<=127?2*p*f*h/255:p*(2*(255^f)*(255^h)/255^255)))/m|0;a.data[b+3]=m}}};R.overlayOntoTransparentFusionWithTransparentLayer=function(a,c,d,b){let g=0|b.getHeight(),n=0|b.getWidth(),f=(c.width-n)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let k=0;k<g;k++,b+=f)for(let l=0;l<
n;l++,b+=4){var e=c.data[b+3]*d/100|0;let h,m;if(e){let p=e+(h=a.data[b+3])-(e*h/255|0)|0,q=e*h/255|0,r=e*(255^h)/255|0,u=(255^e)*h/255|0;e=c.data[b];m=a.data[b];a.data[b]=(r*e+u*m+(m<=127?2*q*e*m/255:q*(2*(255^e)*(255^m)/255^255)))/p|0;e=c.data[b+1];m=a.data[b+1];a.data[b+1]=(r*e+u*m+(m<=127?2*q*e*m/255:q*(2*(255^e)*(255^m)/255^255)))/p|0;e=c.data[b+2];m=a.data[b+2];a.data[b+2]=(r*e+u*m+(m<=127?2*q*e*m/255:q*(2*(255^e)*(255^m)/255^255)))/p|0;a.data[b+3]=p}}};R.overlayOntoOpaqueFusionWithOpaqueLayerMasked=
function(a,c,d,b,g){d=0|b.getHeight();let n=0|b.getWidth(),f=(c.width-n)*4|0,e=0|c.offsetOfPixel(b.left,b.top),k=g.width-n|0;b=0|g.offsetOfPixel(b.left,b.top);for(let l=0;l<d;l++,e+=f,b+=k)for(let h=0;h<n;h++,e+=4,b++){let m=c.data[e+3]*g.data[b]/255|0,p,q;if(m){let r=255^m;p=c.data[e];q=a.data[e];a.data[e]=(r*q+(q<=127?2*m*p*q/255:m*(2*(255^p)*(255^q)/255^255)))/255|0;p=c.data[e+1];q=a.data[e+1];a.data[e+1]=(r*q+(q<=127?2*m*p*q/255:m*(2*(255^p)*(255^q)/255^255)))/255|0;p=c.data[e+2];q=a.data[e+2];
a.data[e+2]=(r*q+(q<=127?2*m*p*q/255:m*(2*(255^p)*(255^q)/255^255)))/255|0}}};R.overlayOntoOpaqueFusionWithTransparentLayerMasked=function(a,c,d,b,g){let n=0|b.getHeight(),f=0|b.getWidth(),e=(c.width-f)*4|0,k=0|c.offsetOfPixel(b.left,b.top),l=g.width-f|0;b=0|g.offsetOfPixel(b.left,b.top);for(let h=0;h<n;h++,k+=e,b+=l)for(let m=0;m<f;m++,k+=4,b++){let p=c.data[k+3]*g.data[b]*d/25500|0,q,r;if(p){let u=255^p;q=c.data[k];r=a.data[k];a.data[k]=(u*r+(r<=127?2*p*q*r/255:p*(2*(255^q)*(255^r)/255^255)))/255|
0;q=c.data[k+1];r=a.data[k+1];a.data[k+1]=(u*r+(r<=127?2*p*q*r/255:p*(2*(255^q)*(255^r)/255^255)))/255|0;q=c.data[k+2];r=a.data[k+2];a.data[k+2]=(u*r+(r<=127?2*p*q*r/255:p*(2*(255^q)*(255^r)/255^255)))/255|0}}};R.overlayOntoTransparentFusionWithOpaqueLayerMasked=function(a,c,d,b,g){d=0|b.getHeight();let n=0|b.getWidth(),f=(c.width-n)*4|0,e=0|c.offsetOfPixel(b.left,b.top),k=g.width-n|0;b=0|g.offsetOfPixel(b.left,b.top);for(let h=0;h<d;h++,e+=f,b+=k)for(let m=0;m<n;m++,e+=4,b++){var l=c.data[e+3]*g.data[b]/
255|0;let p,q;if(l){let r=l+(p=a.data[e+3])-(l*p/255|0)|0,u=l*p/255|0,v=l*(255^p)/255|0,y=(255^l)*p/255|0;l=c.data[e];q=a.data[e];a.data[e]=(v*l+y*q+(q<=127?2*u*l*q/255:u*(2*(255^l)*(255^q)/255^255)))/r|0;l=c.data[e+1];q=a.data[e+1];a.data[e+1]=(v*l+y*q+(q<=127?2*u*l*q/255:u*(2*(255^l)*(255^q)/255^255)))/r|0;l=c.data[e+2];q=a.data[e+2];a.data[e+2]=(v*l+y*q+(q<=127?2*u*l*q/255:u*(2*(255^l)*(255^q)/255^255)))/r|0;a.data[e+3]=r}}};R.overlayOntoTransparentFusionWithTransparentLayerMasked=function(a,c,
d,b,g){let n=0|b.getHeight(),f=0|b.getWidth(),e=(c.width-f)*4|0,k=0|c.offsetOfPixel(b.left,b.top),l=g.width-f|0;b=0|g.offsetOfPixel(b.left,b.top);for(let m=0;m<n;m++,k+=e,b+=l)for(let p=0;p<f;p++,k+=4,b++){var h=c.data[k+3]*g.data[b]*d/25500|0;let q,r;if(h){let u=h+(q=a.data[k+3])-(h*q/255|0)|0,v=h*q/255|0,y=h*(255^q)/255|0,C=(255^h)*q/255|0;h=c.data[k];r=a.data[k];a.data[k]=(y*h+C*r+(r<=127?2*v*h*r/255:v*(2*(255^h)*(255^r)/255^255)))/u|0;h=c.data[k+1];r=a.data[k+1];a.data[k+1]=(y*h+C*r+(r<=127?2*
v*h*r/255:v*(2*(255^h)*(255^r)/255^255)))/u|0;h=c.data[k+2];r=a.data[k+2];a.data[k+2]=(y*h+C*r+(r<=127?2*v*h*r/255:v*(2*(255^h)*(255^r)/255^255)))/u|0;a.data[k+3]=u}}};R.hardLightOntoOpaqueFusionWithOpaqueLayer=function(a,c,d,b){d=0|b.getHeight();let g=0|b.getWidth(),n=(c.width-g)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let f=0;f<d;f++,b+=n)for(let e=0;e<g;e++,b+=4){let k=c.data[b+3],l,h;if(k){let m=255^k;l=c.data[b];h=a.data[b];a.data[b]=(m*h+(l<=127?2*k*l*h/255:k*(2*(255^l)*(255^h)/255^255)))/
255|0;l=c.data[b+1];h=a.data[b+1];a.data[b+1]=(m*h+(l<=127?2*k*l*h/255:k*(2*(255^l)*(255^h)/255^255)))/255|0;l=c.data[b+2];h=a.data[b+2];a.data[b+2]=(m*h+(l<=127?2*k*l*h/255:k*(2*(255^l)*(255^h)/255^255)))/255|0}}};R.hardLightOntoOpaqueFusionWithTransparentLayer=function(a,c,d,b){let g=0|b.getHeight(),n=0|b.getWidth(),f=(c.width-n)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<g;e++,b+=f)for(let k=0;k<n;k++,b+=4){let l=c.data[b+3]*d/100|0,h,m;if(l){let p=255^l;h=c.data[b];m=a.data[b];a.data[b]=
(p*m+(h<=127?2*l*h*m/255:l*(2*(255^h)*(255^m)/255^255)))/255|0;h=c.data[b+1];m=a.data[b+1];a.data[b+1]=(p*m+(h<=127?2*l*h*m/255:l*(2*(255^h)*(255^m)/255^255)))/255|0;h=c.data[b+2];m=a.data[b+2];a.data[b+2]=(p*m+(h<=127?2*l*h*m/255:l*(2*(255^h)*(255^m)/255^255)))/255|0}}};R.hardLightOntoTransparentFusionWithOpaqueLayer=function(a,c,d,b){d=0|b.getHeight();let g=0|b.getWidth(),n=(c.width-g)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<d;e++,b+=n)for(let k=0;k<g;k++,b+=4){var f=c.data[b+3];let l,
h;if(f){let m=f+(l=a.data[b+3])-(f*l/255|0)|0,p=f*l/255|0,q=f*(255^l)/255|0,r=(255^f)*l/255|0;f=c.data[b];h=a.data[b];a.data[b]=(q*f+r*h+(f<=127?2*p*f*h/255:p*(2*(255^f)*(255^h)/255^255)))/m|0;f=c.data[b+1];h=a.data[b+1];a.data[b+1]=(q*f+r*h+(f<=127?2*p*f*h/255:p*(2*(255^f)*(255^h)/255^255)))/m|0;f=c.data[b+2];h=a.data[b+2];a.data[b+2]=(q*f+r*h+(f<=127?2*p*f*h/255:p*(2*(255^f)*(255^h)/255^255)))/m|0;a.data[b+3]=m}}};R.hardLightOntoTransparentFusionWithTransparentLayer=function(a,c,d,b){let g=0|b.getHeight(),
n=0|b.getWidth(),f=(c.width-n)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let k=0;k<g;k++,b+=f)for(let l=0;l<n;l++,b+=4){var e=c.data[b+3]*d/100|0;let h,m;if(e){let p=e+(h=a.data[b+3])-(e*h/255|0)|0,q=e*h/255|0,r=e*(255^h)/255|0,u=(255^e)*h/255|0;e=c.data[b];m=a.data[b];a.data[b]=(r*e+u*m+(e<=127?2*q*e*m/255:q*(2*(255^e)*(255^m)/255^255)))/p|0;e=c.data[b+1];m=a.data[b+1];a.data[b+1]=(r*e+u*m+(e<=127?2*q*e*m/255:q*(2*(255^e)*(255^m)/255^255)))/p|0;e=c.data[b+2];m=a.data[b+2];a.data[b+2]=(r*e+u*m+(e<=
127?2*q*e*m/255:q*(2*(255^e)*(255^m)/255^255)))/p|0;a.data[b+3]=p}}};R.hardLightOntoOpaqueFusionWithOpaqueLayerMasked=function(a,c,d,b,g){d=0|b.getHeight();let n=0|b.getWidth(),f=(c.width-n)*4|0,e=0|c.offsetOfPixel(b.left,b.top),k=g.width-n|0;b=0|g.offsetOfPixel(b.left,b.top);for(let l=0;l<d;l++,e+=f,b+=k)for(let h=0;h<n;h++,e+=4,b++){let m=c.data[e+3]*g.data[b]/255|0,p,q;if(m){let r=255^m;p=c.data[e];q=a.data[e];a.data[e]=(r*q+(p<=127?2*m*p*q/255:m*(2*(255^p)*(255^q)/255^255)))/255|0;p=c.data[e+
1];q=a.data[e+1];a.data[e+1]=(r*q+(p<=127?2*m*p*q/255:m*(2*(255^p)*(255^q)/255^255)))/255|0;p=c.data[e+2];q=a.data[e+2];a.data[e+2]=(r*q+(p<=127?2*m*p*q/255:m*(2*(255^p)*(255^q)/255^255)))/255|0}}};R.hardLightOntoOpaqueFusionWithTransparentLayerMasked=function(a,c,d,b,g){let n=0|b.getHeight(),f=0|b.getWidth(),e=(c.width-f)*4|0,k=0|c.offsetOfPixel(b.left,b.top),l=g.width-f|0;b=0|g.offsetOfPixel(b.left,b.top);for(let h=0;h<n;h++,k+=e,b+=l)for(let m=0;m<f;m++,k+=4,b++){let p=c.data[k+3]*g.data[b]*d/
25500|0,q,r;if(p){let u=255^p;q=c.data[k];r=a.data[k];a.data[k]=(u*r+(q<=127?2*p*q*r/255:p*(2*(255^q)*(255^r)/255^255)))/255|0;q=c.data[k+1];r=a.data[k+1];a.data[k+1]=(u*r+(q<=127?2*p*q*r/255:p*(2*(255^q)*(255^r)/255^255)))/255|0;q=c.data[k+2];r=a.data[k+2];a.data[k+2]=(u*r+(q<=127?2*p*q*r/255:p*(2*(255^q)*(255^r)/255^255)))/255|0}}};R.hardLightOntoTransparentFusionWithOpaqueLayerMasked=function(a,c,d,b,g){d=0|b.getHeight();let n=0|b.getWidth(),f=(c.width-n)*4|0,e=0|c.offsetOfPixel(b.left,b.top),
k=g.width-n|0;b=0|g.offsetOfPixel(b.left,b.top);for(let h=0;h<d;h++,e+=f,b+=k)for(let m=0;m<n;m++,e+=4,b++){var l=c.data[e+3]*g.data[b]/255|0;let p,q;if(l){let r=l+(p=a.data[e+3])-(l*p/255|0)|0,u=l*p/255|0,v=l*(255^p)/255|0,y=(255^l)*p/255|0;l=c.data[e];q=a.data[e];a.data[e]=(v*l+y*q+(l<=127?2*u*l*q/255:u*(2*(255^l)*(255^q)/255^255)))/r|0;l=c.data[e+1];q=a.data[e+1];a.data[e+1]=(v*l+y*q+(l<=127?2*u*l*q/255:u*(2*(255^l)*(255^q)/255^255)))/r|0;l=c.data[e+2];q=a.data[e+2];a.data[e+2]=(v*l+y*q+(l<=127?
2*u*l*q/255:u*(2*(255^l)*(255^q)/255^255)))/r|0;a.data[e+3]=r}}};R.hardLightOntoTransparentFusionWithTransparentLayerMasked=function(a,c,d,b,g){let n=0|b.getHeight(),f=0|b.getWidth(),e=(c.width-f)*4|0,k=0|c.offsetOfPixel(b.left,b.top),l=g.width-f|0;b=0|g.offsetOfPixel(b.left,b.top);for(let m=0;m<n;m++,k+=e,b+=l)for(let p=0;p<f;p++,k+=4,b++){var h=c.data[k+3]*g.data[b]*d/25500|0;let q,r;if(h){let u=h+(q=a.data[k+3])-(h*q/255|0)|0,v=h*q/255|0,y=h*(255^q)/255|0,C=(255^h)*q/255|0;h=c.data[k];r=a.data[k];
a.data[k]=(y*h+C*r+(h<=127?2*v*h*r/255:v*(2*(255^h)*(255^r)/255^255)))/u|0;h=c.data[k+1];r=a.data[k+1];a.data[k+1]=(y*h+C*r+(h<=127?2*v*h*r/255:v*(2*(255^h)*(255^r)/255^255)))/u|0;h=c.data[k+2];r=a.data[k+2];a.data[k+2]=(y*h+C*r+(h<=127?2*v*h*r/255:v*(2*(255^h)*(255^r)/255^255)))/u|0;a.data[k+3]=u}}};R.softLightOntoOpaqueFusionWithOpaqueLayer=function(a,c,d,b){d=0|b.getHeight();let g=0|b.getWidth(),n=(c.width-g)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let f=0;f<d;f++,b+=n)for(let e=0;e<g;e++,b+=
4){let k=c.data[b+3],l,h;if(k){let m=255^k;l=c.data[b];h=a.data[b];a.data[b]=(m*h+k*(l<=127?((2*l-255)*Ab[h]/255|0)+h:((2*l-255)*Bb[h]/255|0)+h))/255|0;l=c.data[b+1];h=a.data[b+1];a.data[b+1]=(m*h+k*(l<=127?((2*l-255)*Ab[h]/255|0)+h:((2*l-255)*Bb[h]/255|0)+h))/255|0;l=c.data[b+2];h=a.data[b+2];a.data[b+2]=(m*h+k*(l<=127?((2*l-255)*Ab[h]/255|0)+h:((2*l-255)*Bb[h]/255|0)+h))/255|0}}};R.softLightOntoOpaqueFusionWithTransparentLayer=function(a,c,d,b){let g=0|b.getHeight(),n=0|b.getWidth(),f=(c.width-
n)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<g;e++,b+=f)for(let k=0;k<n;k++,b+=4){let l=c.data[b+3]*d/100|0,h,m;if(l){let p=255^l;h=c.data[b];m=a.data[b];a.data[b]=(p*m+l*(h<=127?((2*h-255)*Ab[m]/255|0)+m:((2*h-255)*Bb[m]/255|0)+m))/255|0;h=c.data[b+1];m=a.data[b+1];a.data[b+1]=(p*m+l*(h<=127?((2*h-255)*Ab[m]/255|0)+m:((2*h-255)*Bb[m]/255|0)+m))/255|0;h=c.data[b+2];m=a.data[b+2];a.data[b+2]=(p*m+l*(h<=127?((2*h-255)*Ab[m]/255|0)+m:((2*h-255)*Bb[m]/255|0)+m))/255|0}}};R.softLightOntoTransparentFusionWithOpaqueLayer=
function(a,c,d,b){d=0|b.getHeight();let g=0|b.getWidth(),n=(c.width-g)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<d;e++,b+=n)for(let k=0;k<g;k++,b+=4){var f=c.data[b+3];let l,h;if(f){let m=f+(l=a.data[b+3])-(f*l/255|0)|0,p=f*l/255|0,q=f*(255^l)/255|0,r=(255^f)*l/255|0;f=c.data[b];h=a.data[b];a.data[b]=(q*f+r*h+(f<=127?p*(((2*f-255)*Ab[h]/255|0)+h):p*(((2*f-255)*Bb[h]/255|0)+h)))/m|0;f=c.data[b+1];h=a.data[b+1];a.data[b+1]=(q*f+r*h+(f<=127?p*(((2*f-255)*Ab[h]/255|0)+h):p*(((2*f-255)*Bb[h]/
255|0)+h)))/m|0;f=c.data[b+2];h=a.data[b+2];a.data[b+2]=(q*f+r*h+(f<=127?p*(((2*f-255)*Ab[h]/255|0)+h):p*(((2*f-255)*Bb[h]/255|0)+h)))/m|0;a.data[b+3]=m}}};R.softLightOntoTransparentFusionWithTransparentLayer=function(a,c,d,b){let g=0|b.getHeight(),n=0|b.getWidth(),f=(c.width-n)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let k=0;k<g;k++,b+=f)for(let l=0;l<n;l++,b+=4){var e=c.data[b+3]*d/100|0;let h,m;if(e){let p=e+(h=a.data[b+3])-(e*h/255|0)|0,q=e*h/255|0,r=e*(255^h)/255|0,u=(255^e)*h/255|0;e=c.data[b];
m=a.data[b];a.data[b]=(r*e+u*m+(e<=127?q*(((2*e-255)*Ab[m]/255|0)+m):q*(((2*e-255)*Bb[m]/255|0)+m)))/p|0;e=c.data[b+1];m=a.data[b+1];a.data[b+1]=(r*e+u*m+(e<=127?q*(((2*e-255)*Ab[m]/255|0)+m):q*(((2*e-255)*Bb[m]/255|0)+m)))/p|0;e=c.data[b+2];m=a.data[b+2];a.data[b+2]=(r*e+u*m+(e<=127?q*(((2*e-255)*Ab[m]/255|0)+m):q*(((2*e-255)*Bb[m]/255|0)+m)))/p|0;a.data[b+3]=p}}};R.softLightOntoOpaqueFusionWithOpaqueLayerMasked=function(a,c,d,b,g){d=0|b.getHeight();let n=0|b.getWidth(),f=(c.width-n)*4|0,e=0|c.offsetOfPixel(b.left,
b.top),k=g.width-n|0;b=0|g.offsetOfPixel(b.left,b.top);for(let l=0;l<d;l++,e+=f,b+=k)for(let h=0;h<n;h++,e+=4,b++){let m=c.data[e+3]*g.data[b]/255|0,p,q;if(m){let r=255^m;p=c.data[e];q=a.data[e];a.data[e]=(r*q+m*(p<=127?((2*p-255)*Ab[q]/255|0)+q:((2*p-255)*Bb[q]/255|0)+q))/255|0;p=c.data[e+1];q=a.data[e+1];a.data[e+1]=(r*q+m*(p<=127?((2*p-255)*Ab[q]/255|0)+q:((2*p-255)*Bb[q]/255|0)+q))/255|0;p=c.data[e+2];q=a.data[e+2];a.data[e+2]=(r*q+m*(p<=127?((2*p-255)*Ab[q]/255|0)+q:((2*p-255)*Bb[q]/255|0)+q))/
255|0}}};R.softLightOntoOpaqueFusionWithTransparentLayerMasked=function(a,c,d,b,g){let n=0|b.getHeight(),f=0|b.getWidth(),e=(c.width-f)*4|0,k=0|c.offsetOfPixel(b.left,b.top),l=g.width-f|0;b=0|g.offsetOfPixel(b.left,b.top);for(let h=0;h<n;h++,k+=e,b+=l)for(let m=0;m<f;m++,k+=4,b++){let p=c.data[k+3]*g.data[b]*d/25500|0,q,r;if(p){let u=255^p;q=c.data[k];r=a.data[k];a.data[k]=(u*r+p*(q<=127?((2*q-255)*Ab[r]/255|0)+r:((2*q-255)*Bb[r]/255|0)+r))/255|0;q=c.data[k+1];r=a.data[k+1];a.data[k+1]=(u*r+p*(q<=
127?((2*q-255)*Ab[r]/255|0)+r:((2*q-255)*Bb[r]/255|0)+r))/255|0;q=c.data[k+2];r=a.data[k+2];a.data[k+2]=(u*r+p*(q<=127?((2*q-255)*Ab[r]/255|0)+r:((2*q-255)*Bb[r]/255|0)+r))/255|0}}};R.softLightOntoTransparentFusionWithOpaqueLayerMasked=function(a,c,d,b,g){d=0|b.getHeight();let n=0|b.getWidth(),f=(c.width-n)*4|0,e=0|c.offsetOfPixel(b.left,b.top),k=g.width-n|0;b=0|g.offsetOfPixel(b.left,b.top);for(let h=0;h<d;h++,e+=f,b+=k)for(let m=0;m<n;m++,e+=4,b++){var l=c.data[e+3]*g.data[b]/255|0;let p,q;if(l){let r=
l+(p=a.data[e+3])-(l*p/255|0)|0,u=l*p/255|0,v=l*(255^p)/255|0,y=(255^l)*p/255|0;l=c.data[e];q=a.data[e];a.data[e]=(v*l+y*q+(l<=127?u*(((2*l-255)*Ab[q]/255|0)+q):u*(((2*l-255)*Bb[q]/255|0)+q)))/r|0;l=c.data[e+1];q=a.data[e+1];a.data[e+1]=(v*l+y*q+(l<=127?u*(((2*l-255)*Ab[q]/255|0)+q):u*(((2*l-255)*Bb[q]/255|0)+q)))/r|0;l=c.data[e+2];q=a.data[e+2];a.data[e+2]=(v*l+y*q+(l<=127?u*(((2*l-255)*Ab[q]/255|0)+q):u*(((2*l-255)*Bb[q]/255|0)+q)))/r|0;a.data[e+3]=r}}};R.softLightOntoTransparentFusionWithTransparentLayerMasked=
function(a,c,d,b,g){let n=0|b.getHeight(),f=0|b.getWidth(),e=(c.width-f)*4|0,k=0|c.offsetOfPixel(b.left,b.top),l=g.width-f|0;b=0|g.offsetOfPixel(b.left,b.top);for(let m=0;m<n;m++,k+=e,b+=l)for(let p=0;p<f;p++,k+=4,b++){var h=c.data[k+3]*g.data[b]*d/25500|0;let q,r;if(h){let u=h+(q=a.data[k+3])-(h*q/255|0)|0,v=h*q/255|0,y=h*(255^q)/255|0,C=(255^h)*q/255|0;h=c.data[k];r=a.data[k];a.data[k]=(y*h+C*r+(h<=127?v*(((2*h-255)*Ab[r]/255|0)+r):v*(((2*h-255)*Bb[r]/255|0)+r)))/u|0;h=c.data[k+1];r=a.data[k+1];
a.data[k+1]=(y*h+C*r+(h<=127?v*(((2*h-255)*Ab[r]/255|0)+r):v*(((2*h-255)*Bb[r]/255|0)+r)))/u|0;h=c.data[k+2];r=a.data[k+2];a.data[k+2]=(y*h+C*r+(h<=127?v*(((2*h-255)*Ab[r]/255|0)+r):v*(((2*h-255)*Bb[r]/255|0)+r)))/u|0;a.data[k+3]=u}}};R.vividLightOntoOpaqueFusionWithOpaqueLayer=function(a,c,d,b){d=0|b.getHeight();let g=0|b.getWidth(),n=(c.width-g)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let f=0;f<d;f++,b+=n)for(let e=0;e<g;e++,b+=4){let k=c.data[b+3],l,h;if(k){let m=255^k;l=c.data[b];h=a.data[b];
a.data[b]=(m*h+(l<=127?k*(0==l?0:255-Math.min(255,(255-h)*255/(2*l)|0)):k*(255==l?255:Math.min(255,255*h/(2*(255-l))|0))))/255|0;l=c.data[b+1];h=a.data[b+1];a.data[b+1]=(m*h+(l<=127?k*(0==l?0:255-Math.min(255,(255-h)*255/(2*l)|0)):k*(255==l?255:Math.min(255,255*h/(2*(255-l))|0))))/255|0;l=c.data[b+2];h=a.data[b+2];a.data[b+2]=(m*h+(l<=127?k*(0==l?0:255-Math.min(255,(255-h)*255/(2*l)|0)):k*(255==l?255:Math.min(255,255*h/(2*(255-l))|0))))/255|0}}};R.vividLightOntoOpaqueFusionWithTransparentLayer=function(a,
c,d,b){let g=0|b.getHeight(),n=0|b.getWidth(),f=(c.width-n)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<g;e++,b+=f)for(let k=0;k<n;k++,b+=4){let l=c.data[b+3]*d/100|0,h,m;if(l){let p=255^l;h=c.data[b];m=a.data[b];a.data[b]=(p*m+(h<=127?l*(0==h?0:255-Math.min(255,(255-m)*255/(2*h)|0)):l*(255==h?255:Math.min(255,255*m/(2*(255-h))|0))))/255|0;h=c.data[b+1];m=a.data[b+1];a.data[b+1]=(p*m+(h<=127?l*(0==h?0:255-Math.min(255,(255-m)*255/(2*h)|0)):l*(255==h?255:Math.min(255,255*m/(2*(255-h))|0))))/
255|0;h=c.data[b+2];m=a.data[b+2];a.data[b+2]=(p*m+(h<=127?l*(0==h?0:255-Math.min(255,(255-m)*255/(2*h)|0)):l*(255==h?255:Math.min(255,255*m/(2*(255-h))|0))))/255|0}}};R.vividLightOntoTransparentFusionWithOpaqueLayer=function(a,c,d,b){d=0|b.getHeight();let g=0|b.getWidth(),n=(c.width-g)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<d;e++,b+=n)for(let k=0;k<g;k++,b+=4){var f=c.data[b+3];let l,h;if(f){let m=f+(l=a.data[b+3])-(f*l/255|0)|0,p=f*l/255|0,q=f*(255^l)/255|0,r=(255^f)*l/255|0;f=c.data[b];
h=a.data[b];a.data[b]=(q*f+r*h+(f<=127?p*(0==f?0:255-Math.min(255,(255-h)*255/(2*f)|0)):p*(255==f?255:Math.min(255,255*h/(2*(255-f))|0))))/m|0;f=c.data[b+1];h=a.data[b+1];a.data[b+1]=(q*f+r*h+(f<=127?p*(0==f?0:255-Math.min(255,(255-h)*255/(2*f)|0)):p*(255==f?255:Math.min(255,255*h/(2*(255-f))|0))))/m|0;f=c.data[b+2];h=a.data[b+2];a.data[b+2]=(q*f+r*h+(f<=127?p*(0==f?0:255-Math.min(255,(255-h)*255/(2*f)|0)):p*(255==f?255:Math.min(255,255*h/(2*(255-f))|0))))/m|0;a.data[b+3]=m}}};R.vividLightOntoTransparentFusionWithTransparentLayer=
function(a,c,d,b){let g=0|b.getHeight(),n=0|b.getWidth(),f=(c.width-n)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let k=0;k<g;k++,b+=f)for(let l=0;l<n;l++,b+=4){var e=c.data[b+3]*d/100|0;let h,m;if(e){let p=e+(h=a.data[b+3])-(e*h/255|0)|0,q=e*h/255|0,r=e*(255^h)/255|0,u=(255^e)*h/255|0;e=c.data[b];m=a.data[b];a.data[b]=(r*e+u*m+(e<=127?q*(0==e?0:255-Math.min(255,(255-m)*255/(2*e)|0)):q*(255==e?255:Math.min(255,255*m/(2*(255-e))|0))))/p|0;e=c.data[b+1];m=a.data[b+1];a.data[b+1]=(r*e+u*m+(e<=127?q*(0==
e?0:255-Math.min(255,(255-m)*255/(2*e)|0)):q*(255==e?255:Math.min(255,255*m/(2*(255-e))|0))))/p|0;e=c.data[b+2];m=a.data[b+2];a.data[b+2]=(r*e+u*m+(e<=127?q*(0==e?0:255-Math.min(255,(255-m)*255/(2*e)|0)):q*(255==e?255:Math.min(255,255*m/(2*(255-e))|0))))/p|0;a.data[b+3]=p}}};R.vividLightOntoOpaqueFusionWithOpaqueLayerMasked=function(a,c,d,b,g){d=0|b.getHeight();let n=0|b.getWidth(),f=(c.width-n)*4|0,e=0|c.offsetOfPixel(b.left,b.top),k=g.width-n|0;b=0|g.offsetOfPixel(b.left,b.top);for(let l=0;l<d;l++,
e+=f,b+=k)for(let h=0;h<n;h++,e+=4,b++){let m=c.data[e+3]*g.data[b]/255|0,p,q;if(m){let r=255^m;p=c.data[e];q=a.data[e];a.data[e]=(r*q+(p<=127?m*(0==p?0:255-Math.min(255,(255-q)*255/(2*p)|0)):m*(255==p?255:Math.min(255,255*q/(2*(255-p))|0))))/255|0;p=c.data[e+1];q=a.data[e+1];a.data[e+1]=(r*q+(p<=127?m*(0==p?0:255-Math.min(255,(255-q)*255/(2*p)|0)):m*(255==p?255:Math.min(255,255*q/(2*(255-p))|0))))/255|0;p=c.data[e+2];q=a.data[e+2];a.data[e+2]=(r*q+(p<=127?m*(0==p?0:255-Math.min(255,(255-q)*255/(2*
p)|0)):m*(255==p?255:Math.min(255,255*q/(2*(255-p))|0))))/255|0}}};R.vividLightOntoOpaqueFusionWithTransparentLayerMasked=function(a,c,d,b,g){let n=0|b.getHeight(),f=0|b.getWidth(),e=(c.width-f)*4|0,k=0|c.offsetOfPixel(b.left,b.top),l=g.width-f|0;b=0|g.offsetOfPixel(b.left,b.top);for(let h=0;h<n;h++,k+=e,b+=l)for(let m=0;m<f;m++,k+=4,b++){let p=c.data[k+3]*g.data[b]*d/25500|0,q,r;if(p){let u=255^p;q=c.data[k];r=a.data[k];a.data[k]=(u*r+(q<=127?p*(0==q?0:255-Math.min(255,(255-r)*255/(2*q)|0)):p*(255==
q?255:Math.min(255,255*r/(2*(255-q))|0))))/255|0;q=c.data[k+1];r=a.data[k+1];a.data[k+1]=(u*r+(q<=127?p*(0==q?0:255-Math.min(255,(255-r)*255/(2*q)|0)):p*(255==q?255:Math.min(255,255*r/(2*(255-q))|0))))/255|0;q=c.data[k+2];r=a.data[k+2];a.data[k+2]=(u*r+(q<=127?p*(0==q?0:255-Math.min(255,(255-r)*255/(2*q)|0)):p*(255==q?255:Math.min(255,255*r/(2*(255-q))|0))))/255|0}}};R.vividLightOntoTransparentFusionWithOpaqueLayerMasked=function(a,c,d,b,g){d=0|b.getHeight();let n=0|b.getWidth(),f=(c.width-n)*4|0,
e=0|c.offsetOfPixel(b.left,b.top),k=g.width-n|0;b=0|g.offsetOfPixel(b.left,b.top);for(let h=0;h<d;h++,e+=f,b+=k)for(let m=0;m<n;m++,e+=4,b++){var l=c.data[e+3]*g.data[b]/255|0;let p,q;if(l){let r=l+(p=a.data[e+3])-(l*p/255|0)|0,u=l*p/255|0,v=l*(255^p)/255|0,y=(255^l)*p/255|0;l=c.data[e];q=a.data[e];a.data[e]=(v*l+y*q+(l<=127?u*(0==l?0:255-Math.min(255,(255-q)*255/(2*l)|0)):u*(255==l?255:Math.min(255,255*q/(2*(255-l))|0))))/r|0;l=c.data[e+1];q=a.data[e+1];a.data[e+1]=(v*l+y*q+(l<=127?u*(0==l?0:255-
Math.min(255,(255-q)*255/(2*l)|0)):u*(255==l?255:Math.min(255,255*q/(2*(255-l))|0))))/r|0;l=c.data[e+2];q=a.data[e+2];a.data[e+2]=(v*l+y*q+(l<=127?u*(0==l?0:255-Math.min(255,(255-q)*255/(2*l)|0)):u*(255==l?255:Math.min(255,255*q/(2*(255-l))|0))))/r|0;a.data[e+3]=r}}};R.vividLightOntoTransparentFusionWithTransparentLayerMasked=function(a,c,d,b,g){let n=0|b.getHeight(),f=0|b.getWidth(),e=(c.width-f)*4|0,k=0|c.offsetOfPixel(b.left,b.top),l=g.width-f|0;b=0|g.offsetOfPixel(b.left,b.top);for(let m=0;m<
n;m++,k+=e,b+=l)for(let p=0;p<f;p++,k+=4,b++){var h=c.data[k+3]*g.data[b]*d/25500|0;let q,r;if(h){let u=h+(q=a.data[k+3])-(h*q/255|0)|0,v=h*q/255|0,y=h*(255^q)/255|0,C=(255^h)*q/255|0;h=c.data[k];r=a.data[k];a.data[k]=(y*h+C*r+(h<=127?v*(0==h?0:255-Math.min(255,(255-r)*255/(2*h)|0)):v*(255==h?255:Math.min(255,255*r/(2*(255-h))|0))))/u|0;h=c.data[k+1];r=a.data[k+1];a.data[k+1]=(y*h+C*r+(h<=127?v*(0==h?0:255-Math.min(255,(255-r)*255/(2*h)|0)):v*(255==h?255:Math.min(255,255*r/(2*(255-h))|0))))/u|0;h=
c.data[k+2];r=a.data[k+2];a.data[k+2]=(y*h+C*r+(h<=127?v*(0==h?0:255-Math.min(255,(255-r)*255/(2*h)|0)):v*(255==h?255:Math.min(255,255*r/(2*(255-h))|0))))/u|0;a.data[k+3]=u}}};R.linearLightOntoOpaqueFusionWithOpaqueLayer=function(a,c,d,b){d=0|b.getHeight();let g=0|b.getWidth(),n=(c.width-g)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let f=0;f<d;f++,b+=n)for(let e=0;e<g;e++,b+=4){let k=c.data[b+3],l;if(k){let h=255^k;l=a.data[b];a.data[b]=(h*l+k*Math.min(255,Math.max(0,l+2*c.data[b]-255)))/255|0;l=
a.data[b+1];a.data[b+1]=(h*l+k*Math.min(255,Math.max(0,l+2*c.data[b+1]-255)))/255|0;l=a.data[b+2];a.data[b+2]=(h*l+k*Math.min(255,Math.max(0,l+2*c.data[b+2]-255)))/255|0}}};R.linearLightOntoOpaqueFusionWithTransparentLayer=function(a,c,d,b){let g=0|b.getHeight(),n=0|b.getWidth(),f=(c.width-n)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<g;e++,b+=f)for(let k=0;k<n;k++,b+=4){let l=c.data[b+3]*d/100|0,h;if(l){let m=255^l;h=a.data[b];a.data[b]=(m*h+l*Math.min(255,Math.max(0,h+2*c.data[b]-255)))/
255|0;h=a.data[b+1];a.data[b+1]=(m*h+l*Math.min(255,Math.max(0,h+2*c.data[b+1]-255)))/255|0;h=a.data[b+2];a.data[b+2]=(m*h+l*Math.min(255,Math.max(0,h+2*c.data[b+2]-255)))/255|0}}};R.linearLightOntoTransparentFusionWithOpaqueLayer=function(a,c,d,b){d=0|b.getHeight();let g=0|b.getWidth(),n=(c.width-g)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<d;e++,b+=n)for(let k=0;k<g;k++,b+=4){var f=c.data[b+3];let l,h;if(f){let m=f+(l=a.data[b+3])-(f*l/255|0)|0,p=f*l/255|0,q=f*(255^l)/255|0,r=(255^f)*
l/255|0;f=c.data[b];h=a.data[b];a.data[b]=(q*f+r*h+p*Math.min(255,Math.max(0,h+2*f-255)))/m|0;f=c.data[b+1];h=a.data[b+1];a.data[b+1]=(q*f+r*h+p*Math.min(255,Math.max(0,h+2*f-255)))/m|0;f=c.data[b+2];h=a.data[b+2];a.data[b+2]=(q*f+r*h+p*Math.min(255,Math.max(0,h+2*f-255)))/m|0;a.data[b+3]=m}}};R.linearLightOntoTransparentFusionWithTransparentLayer=function(a,c,d,b){let g=0|b.getHeight(),n=0|b.getWidth(),f=(c.width-n)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let k=0;k<g;k++,b+=f)for(let l=0;l<n;l++,
b+=4){var e=c.data[b+3]*d/100|0;let h,m;if(e){let p=e+(h=a.data[b+3])-(e*h/255|0)|0,q=e*h/255|0,r=e*(255^h)/255|0,u=(255^e)*h/255|0;e=c.data[b];m=a.data[b];a.data[b]=(r*e+u*m+q*Math.min(255,Math.max(0,m+2*e-255)))/p|0;e=c.data[b+1];m=a.data[b+1];a.data[b+1]=(r*e+u*m+q*Math.min(255,Math.max(0,m+2*e-255)))/p|0;e=c.data[b+2];m=a.data[b+2];a.data[b+2]=(r*e+u*m+q*Math.min(255,Math.max(0,m+2*e-255)))/p|0;a.data[b+3]=p}}};R.linearLightOntoOpaqueFusionWithOpaqueLayerMasked=function(a,c,d,b,g){d=0|b.getHeight();
let n=0|b.getWidth(),f=(c.width-n)*4|0,e=0|c.offsetOfPixel(b.left,b.top),k=g.width-n|0;b=0|g.offsetOfPixel(b.left,b.top);for(let l=0;l<d;l++,e+=f,b+=k)for(let h=0;h<n;h++,e+=4,b++){let m=c.data[e+3]*g.data[b]/255|0,p;if(m){let q=255^m;p=a.data[e];a.data[e]=(q*p+m*Math.min(255,Math.max(0,p+2*c.data[e]-255)))/255|0;p=a.data[e+1];a.data[e+1]=(q*p+m*Math.min(255,Math.max(0,p+2*c.data[e+1]-255)))/255|0;p=a.data[e+2];a.data[e+2]=(q*p+m*Math.min(255,Math.max(0,p+2*c.data[e+2]-255)))/255|0}}};R.linearLightOntoOpaqueFusionWithTransparentLayerMasked=
function(a,c,d,b,g){let n=0|b.getHeight(),f=0|b.getWidth(),e=(c.width-f)*4|0,k=0|c.offsetOfPixel(b.left,b.top),l=g.width-f|0;b=0|g.offsetOfPixel(b.left,b.top);for(let h=0;h<n;h++,k+=e,b+=l)for(let m=0;m<f;m++,k+=4,b++){let p=c.data[k+3]*g.data[b]*d/25500|0,q;if(p){let r=255^p;q=a.data[k];a.data[k]=(r*q+p*Math.min(255,Math.max(0,q+2*c.data[k]-255)))/255|0;q=a.data[k+1];a.data[k+1]=(r*q+p*Math.min(255,Math.max(0,q+2*c.data[k+1]-255)))/255|0;q=a.data[k+2];a.data[k+2]=(r*q+p*Math.min(255,Math.max(0,q+
2*c.data[k+2]-255)))/255|0}}};R.linearLightOntoTransparentFusionWithOpaqueLayerMasked=function(a,c,d,b,g){d=0|b.getHeight();let n=0|b.getWidth(),f=(c.width-n)*4|0,e=0|c.offsetOfPixel(b.left,b.top),k=g.width-n|0;b=0|g.offsetOfPixel(b.left,b.top);for(let h=0;h<d;h++,e+=f,b+=k)for(let m=0;m<n;m++,e+=4,b++){var l=c.data[e+3]*g.data[b]/255|0;let p,q;if(l){let r=l+(p=a.data[e+3])-(l*p/255|0)|0,u=l*p/255|0,v=l*(255^p)/255|0,y=(255^l)*p/255|0;l=c.data[e];q=a.data[e];a.data[e]=(v*l+y*q+u*Math.min(255,Math.max(0,
q+2*l-255)))/r|0;l=c.data[e+1];q=a.data[e+1];a.data[e+1]=(v*l+y*q+u*Math.min(255,Math.max(0,q+2*l-255)))/r|0;l=c.data[e+2];q=a.data[e+2];a.data[e+2]=(v*l+y*q+u*Math.min(255,Math.max(0,q+2*l-255)))/r|0;a.data[e+3]=r}}};R.linearLightOntoTransparentFusionWithTransparentLayerMasked=function(a,c,d,b,g){let n=0|b.getHeight(),f=0|b.getWidth(),e=(c.width-f)*4|0,k=0|c.offsetOfPixel(b.left,b.top),l=g.width-f|0;b=0|g.offsetOfPixel(b.left,b.top);for(let m=0;m<n;m++,k+=e,b+=l)for(let p=0;p<f;p++,k+=4,b++){var h=
c.data[k+3]*g.data[b]*d/25500|0;let q,r;if(h){let u=h+(q=a.data[k+3])-(h*q/255|0)|0,v=h*q/255|0,y=h*(255^q)/255|0,C=(255^h)*q/255|0;h=c.data[k];r=a.data[k];a.data[k]=(y*h+C*r+v*Math.min(255,Math.max(0,r+2*h-255)))/u|0;h=c.data[k+1];r=a.data[k+1];a.data[k+1]=(y*h+C*r+v*Math.min(255,Math.max(0,r+2*h-255)))/u|0;h=c.data[k+2];r=a.data[k+2];a.data[k+2]=(y*h+C*r+v*Math.min(255,Math.max(0,r+2*h-255)))/u|0;a.data[k+3]=u}}};R.pinLightOntoOpaqueFusionWithOpaqueLayer=function(a,c,d,b){d=0|b.getHeight();let g=
0|b.getWidth(),n=(c.width-g)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let f=0;f<d;f++,b+=n)for(let e=0;e<g;e++,b+=4){let k=c.data[b+3],l,h;if(k){let m=255^k;l=c.data[b];h=a.data[b];a.data[b]=(m*h+k*(h>=2*l?2*l:h<=2*l-255?2*l-255:h))/255|0;l=c.data[b+1];h=a.data[b+1];a.data[b+1]=(m*h+k*(h>=2*l?2*l:h<=2*l-255?2*l-255:h))/255|0;l=c.data[b+2];h=a.data[b+2];a.data[b+2]=(m*h+k*(h>=2*l?2*l:h<=2*l-255?2*l-255:h))/255|0}}};R.pinLightOntoOpaqueFusionWithTransparentLayer=function(a,c,d,b){let g=0|b.getHeight(),
n=0|b.getWidth(),f=(c.width-n)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<g;e++,b+=f)for(let k=0;k<n;k++,b+=4){let l=c.data[b+3]*d/100|0,h,m;if(l){let p=255^l;h=c.data[b];m=a.data[b];a.data[b]=(p*m+l*(m>=2*h?2*h:m<=2*h-255?2*h-255:m))/255|0;h=c.data[b+1];m=a.data[b+1];a.data[b+1]=(p*m+l*(m>=2*h?2*h:m<=2*h-255?2*h-255:m))/255|0;h=c.data[b+2];m=a.data[b+2];a.data[b+2]=(p*m+l*(m>=2*h?2*h:m<=2*h-255?2*h-255:m))/255|0}}};R.pinLightOntoTransparentFusionWithOpaqueLayer=function(a,c,d,b){d=0|b.getHeight();
let g=0|b.getWidth(),n=(c.width-g)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<d;e++,b+=n)for(let k=0;k<g;k++,b+=4){var f=c.data[b+3];let l,h;if(f){let m=f+(l=a.data[b+3])-(f*l/255|0)|0,p=f*l/255|0,q=f*(255^l)/255|0,r=(255^f)*l/255|0;f=c.data[b];h=a.data[b];a.data[b]=(q*f+r*h+p*(h>=2*f?2*f:h<=2*f-255?2*f-255:h))/m|0;f=c.data[b+1];h=a.data[b+1];a.data[b+1]=(q*f+r*h+p*(h>=2*f?2*f:h<=2*f-255?2*f-255:h))/m|0;f=c.data[b+2];h=a.data[b+2];a.data[b+2]=(q*f+r*h+p*(h>=2*f?2*f:h<=2*f-255?2*f-255:h))/
m|0;a.data[b+3]=m}}};R.pinLightOntoTransparentFusionWithTransparentLayer=function(a,c,d,b){let g=0|b.getHeight(),n=0|b.getWidth(),f=(c.width-n)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let k=0;k<g;k++,b+=f)for(let l=0;l<n;l++,b+=4){var e=c.data[b+3]*d/100|0;let h,m;if(e){let p=e+(h=a.data[b+3])-(e*h/255|0)|0,q=e*h/255|0,r=e*(255^h)/255|0,u=(255^e)*h/255|0;e=c.data[b];m=a.data[b];a.data[b]=(r*e+u*m+q*(m>=2*e?2*e:m<=2*e-255?2*e-255:m))/p|0;e=c.data[b+1];m=a.data[b+1];a.data[b+1]=(r*e+u*m+q*(m>=2*e?
2*e:m<=2*e-255?2*e-255:m))/p|0;e=c.data[b+2];m=a.data[b+2];a.data[b+2]=(r*e+u*m+q*(m>=2*e?2*e:m<=2*e-255?2*e-255:m))/p|0;a.data[b+3]=p}}};R.pinLightOntoOpaqueFusionWithOpaqueLayerMasked=function(a,c,d,b,g){d=0|b.getHeight();let n=0|b.getWidth(),f=(c.width-n)*4|0,e=0|c.offsetOfPixel(b.left,b.top),k=g.width-n|0;b=0|g.offsetOfPixel(b.left,b.top);for(let l=0;l<d;l++,e+=f,b+=k)for(let h=0;h<n;h++,e+=4,b++){let m=c.data[e+3]*g.data[b]/255|0,p,q;if(m){let r=255^m;p=c.data[e];q=a.data[e];a.data[e]=(r*q+m*
(q>=2*p?2*p:q<=2*p-255?2*p-255:q))/255|0;p=c.data[e+1];q=a.data[e+1];a.data[e+1]=(r*q+m*(q>=2*p?2*p:q<=2*p-255?2*p-255:q))/255|0;p=c.data[e+2];q=a.data[e+2];a.data[e+2]=(r*q+m*(q>=2*p?2*p:q<=2*p-255?2*p-255:q))/255|0}}};R.pinLightOntoOpaqueFusionWithTransparentLayerMasked=function(a,c,d,b,g){let n=0|b.getHeight(),f=0|b.getWidth(),e=(c.width-f)*4|0,k=0|c.offsetOfPixel(b.left,b.top),l=g.width-f|0;b=0|g.offsetOfPixel(b.left,b.top);for(let h=0;h<n;h++,k+=e,b+=l)for(let m=0;m<f;m++,k+=4,b++){let p=c.data[k+
3]*g.data[b]*d/25500|0,q,r;if(p){let u=255^p;q=c.data[k];r=a.data[k];a.data[k]=(u*r+p*(r>=2*q?2*q:r<=2*q-255?2*q-255:r))/255|0;q=c.data[k+1];r=a.data[k+1];a.data[k+1]=(u*r+p*(r>=2*q?2*q:r<=2*q-255?2*q-255:r))/255|0;q=c.data[k+2];r=a.data[k+2];a.data[k+2]=(u*r+p*(r>=2*q?2*q:r<=2*q-255?2*q-255:r))/255|0}}};R.pinLightOntoTransparentFusionWithOpaqueLayerMasked=function(a,c,d,b,g){d=0|b.getHeight();let n=0|b.getWidth(),f=(c.width-n)*4|0,e=0|c.offsetOfPixel(b.left,b.top),k=g.width-n|0;b=0|g.offsetOfPixel(b.left,
b.top);for(let h=0;h<d;h++,e+=f,b+=k)for(let m=0;m<n;m++,e+=4,b++){var l=c.data[e+3]*g.data[b]/255|0;let p,q;if(l){let r=l+(p=a.data[e+3])-(l*p/255|0)|0,u=l*p/255|0,v=l*(255^p)/255|0,y=(255^l)*p/255|0;l=c.data[e];q=a.data[e];a.data[e]=(v*l+y*q+u*(q>=2*l?2*l:q<=2*l-255?2*l-255:q))/r|0;l=c.data[e+1];q=a.data[e+1];a.data[e+1]=(v*l+y*q+u*(q>=2*l?2*l:q<=2*l-255?2*l-255:q))/r|0;l=c.data[e+2];q=a.data[e+2];a.data[e+2]=(v*l+y*q+u*(q>=2*l?2*l:q<=2*l-255?2*l-255:q))/r|0;a.data[e+3]=r}}};R.pinLightOntoTransparentFusionWithTransparentLayerMasked=
function(a,c,d,b,g){let n=0|b.getHeight(),f=0|b.getWidth(),e=(c.width-f)*4|0,k=0|c.offsetOfPixel(b.left,b.top),l=g.width-f|0;b=0|g.offsetOfPixel(b.left,b.top);for(let m=0;m<n;m++,k+=e,b+=l)for(let p=0;p<f;p++,k+=4,b++){var h=c.data[k+3]*g.data[b]*d/25500|0;let q,r;if(h){let u=h+(q=a.data[k+3])-(h*q/255|0)|0,v=h*q/255|0,y=h*(255^q)/255|0,C=(255^h)*q/255|0;h=c.data[k];r=a.data[k];a.data[k]=(y*h+C*r+v*(r>=2*h?2*h:r<=2*h-255?2*h-255:r))/u|0;h=c.data[k+1];r=a.data[k+1];a.data[k+1]=(y*h+C*r+v*(r>=2*h?2*
h:r<=2*h-255?2*h-255:r))/u|0;h=c.data[k+2];r=a.data[k+2];a.data[k+2]=(y*h+C*r+v*(r>=2*h?2*h:r<=2*h-255?2*h-255:r))/u|0;a.data[k+3]=u}}};R.passthroughOntoOpaqueFusionWithTransparentLayer=function(a,c,d,b){let g=0|b.getHeight(),n=0|b.getWidth(),f=(c.width-n)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<g;e++,b+=f)for(let k=0;k<n;k++,b+=4){let l=c.data[b+3],h=d/100,m=1-h,p=l*h+255*m;a.data[b]=(c.data[b]*l*h+255*a.data[b]*m)/p|0;a.data[b+1]=(c.data[b+1]*l*h+255*a.data[b+1]*m)/p|0;a.data[b+2]=(c.data[b+
2]*l*h+255*a.data[b+2]*m)/p|0;a.data[b+3]=p}};R.passthroughOntoOpaqueFusionWithOpaqueLayer=R.passthroughOntoOpaqueFusionWithTransparentLayer;R.passthroughOntoTransparentFusionWithTransparentLayer=function(a,c,d,b){let g=0|b.getHeight(),n=0|b.getWidth(),f=(c.width-n)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<g;e++,b+=f)for(let k=0;k<n;k++,b+=4){let l=c.data[b+3],h=a.data[b+3],m=d/100,p=1-m,q=l*m+h*p;a.data[b]=(c.data[b]*l*m+a.data[b]*h*p)/q|0;a.data[b+1]=(c.data[b+1]*l*m+a.data[b+1]*h*p)/
q|0;a.data[b+2]=(c.data[b+2]*l*m+a.data[b+2]*h*p)/q|0;a.data[b+3]=q}};R.passthroughOntoTransparentFusionWithOpaqueLayer=R.passthroughOntoTransparentFusionWithTransparentLayer;R.passthroughOntoOpaqueFusionWithTransparentLayerMasked=function(a,c,d,b,g){let n=0|b.getHeight(),f=0|b.getWidth(),e=(c.width-f)*4|0,k=0|c.offsetOfPixel(b.left,b.top),l=g.width-f|0;b=0|g.offsetOfPixel(b.left,b.top);for(let h=0;h<n;h++,k+=e,b+=l)for(let m=0;m<f;m++,k+=4,b++){let p=c.data[k+3],q=g.data[b]*d/25500,r=1-q,u=p*q+255*
r;a.data[k]=(c.data[k]*p*q+255*a.data[k]*r)/u|0;a.data[k+1]=(c.data[k+1]*p*q+255*a.data[k+1]*r)/u|0;a.data[k+2]=(c.data[k+2]*p*q+255*a.data[k+2]*r)/u|0;a.data[k+3]=u}};R.passthroughOntoOpaqueFusionWithOpaqueLayerMasked=R.passthroughOntoOpaqueFusionWithTransparentLayerMasked;R.passthroughOntoTransparentFusionWithTransparentLayerMasked=function(a,c,d,b,g){let n=0|b.getHeight(),f=0|b.getWidth(),e=(c.width-f)*4|0,k=0|c.offsetOfPixel(b.left,b.top),l=g.width-f|0;b=0|g.offsetOfPixel(b.left,b.top);for(let h=
0;h<n;h++,k+=e,b+=l)for(let m=0;m<f;m++,k+=4,b++){let p=c.data[k+3],q=a.data[k+3],r=g.data[b]*d/25500,u=1-r,v=p*r+q*u;a.data[k]=(c.data[k]*p*r+a.data[k]*q*u)/v|0;a.data[k+1]=(c.data[k+1]*p*r+a.data[k+1]*q*u)/v|0;a.data[k+2]=(c.data[k+2]*p*r+a.data[k+2]*q*u)/v|0;a.data[k+3]=v}};R.passthroughOntoTransparentFusionWithOpaqueLayerMasked=R.passthroughOntoTransparentFusionWithTransparentLayerMasked;R.replaceOntoFusionWithTransparentLayer=function(a,c,d,b){let g=0|b.getHeight(),n=0|b.getWidth(),f=(c.width-
n)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<g;e++,b+=f)for(let k=0;k<n;k++,b+=4){let l=c.data[b+3]*d/100|0;a.data[b]=c.data[b];a.data[b+1]=c.data[b+1];a.data[b+2]=c.data[b+2];a.data[b+3]=l}};R.replaceOntoFusionWithOpaqueLayer=function(a,c,d,b){d=0|b.getHeight();let g=0|b.getWidth(),n=(c.width-g)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let f=0;f<d;f++,b+=n)for(let e=0;e<g;e++,b+=4){let k=c.data[b+3];a.data[b]=c.data[b];a.data[b+1]=c.data[b+1];a.data[b+2]=c.data[b+2];a.data[b+3]=k}};R.replaceOntoFusionWithTransparentLayerMasked=
function(a,c,d,b,g){let n=0|b.getHeight(),f=0|b.getWidth(),e=(c.width-f)*4|0,k=0|c.offsetOfPixel(b.left,b.top),l=g.width-f|0;b=0|g.offsetOfPixel(b.left,b.top);for(let h=0;h<n;h++,k+=e,b+=l)for(let m=0;m<f;m++,k+=4,b++){let p=c.data[k+3]*g.data[b]*d/25500|0;a.data[k]=c.data[k];a.data[k+1]=c.data[k+1];a.data[k+2]=c.data[k+2];a.data[k+3]=p}};R.replaceOntoFusionWithOpaqueLayerMasked=function(a,c,d,b,g){d=0|b.getHeight();let n=0|b.getWidth(),f=(c.width-n)*4|0,e=0|c.offsetOfPixel(b.left,b.top),k=g.width-
n|0;b=0|g.offsetOfPixel(b.left,b.top);for(let l=0;l<d;l++,e+=f,b+=k)for(let h=0;h<n;h++,e+=4,b++){let m=c.data[e+3]*g.data[b]/255|0;a.data[e]=c.data[e];a.data[e+1]=c.data[e+1];a.data[e+2]=c.data[e+2];a.data[e+3]=m}};R.replaceAlphaOntoFusionWithTransparentLayer=function(a,c,d,b){let g=0|b.getHeight(),n=0|b.getWidth(),f=(c.width-n)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<g;e++,b+=f)for(let k=0;k<n;k++,b+=4)a.data[b+3]=c.data[b+3]*d/100|0};R.replaceAlphaOntoFusionWithTransparentLayerMasked=
function(a,c,d,b,g){let n=0|b.getHeight(),f=0|b.getWidth(),e=(c.width-f)*4|0,k=0|c.offsetOfPixel(b.left,b.top),l=g.width-f|0;b=0|g.offsetOfPixel(b.left,b.top);for(let h=0;h<n;h++,k+=e,b+=l)for(let m=0;m<f;m++,k+=4,b++)a.data[k+3]=c.data[k+3]*g.data[b]*d/25500|0};R.replaceAlphaOntoFusionWithOpaqueLayer=function(a,c,d,b){d=0|b.getHeight();let g=0|b.getWidth(),n=(c.width-g)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let f=0;f<d;f++,b+=n)for(let e=0;e<g;e++,b+=4)a.data[b+3]=c.data[b+3]};R.replaceAlphaOntoFusionWithOpaqueLayerMasked=
function(a,c,d,b,g){d=0|b.getHeight();let n=0|b.getWidth(),f=(c.width-n)*4|0,e=0|c.offsetOfPixel(b.left,b.top),k=g.width-n|0;b=0|g.offsetOfPixel(b.left,b.top);for(let l=0;l<d;l++,e+=f,b+=k)for(let h=0;h<n;h++,e+=4,b++)a.data[e+3]=c.data[e+3]*g.data[b]/255|0};R.upgradeMultiplyOfOpaqueLayer=function(a,c,d,b){d=0|b.getHeight();let g=0|b.getWidth(),n=(c.width-g)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let f=0;f<d;f++,b+=n)for(let e=0;e<g;e++,b+=4){let k=c.data[b+3],l,h;k&&(l=c.data[b],h=a.data[b],c.data[b]=
l+Math.ceil((255-l)*h*k%65025/(h*k)),l=c.data[b+1],h=a.data[b+1],c.data[b+1]=l+Math.ceil((255-l)*h*k%65025/(h*k)),l=c.data[b+2],h=a.data[b+2],c.data[b+2]=l+Math.ceil((255-l)*h*k%65025/(h*k)))}};R.upgradeMultiplyOfTransparentLayer=function(a,c,d,b){let g=0|b.getHeight(),n=0|b.getWidth(),f=(c.width-n)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<g;e++,b+=f)for(let k=0;k<n;k++,b+=4){let l=c.data[b+3]*d/100|0,h,m;l&&(h=c.data[b],m=a.data[b],c.data[b]=h+Math.ceil((255-h)*m*l%65025/(m*l)),h=c.data[b+
1],m=a.data[b+1],c.data[b+1]=h+Math.ceil((255-h)*m*l%65025/(m*l)),h=c.data[b+2],m=a.data[b+2],c.data[b+2]=h+Math.ceil((255-h)*m*l%65025/(m*l)))}};R._normalFuseImageOntoImageAtPosition=function(a,c,d,b,g,n){d=0|b.getHeight();let f=0|b.getWidth(),e=(c.width-f)*4|0;b=0|c.offsetOfPixel(b.left,b.top);let k=(a.width-f)*4|0;g=0|a.offsetOfPixel(g,n);for(n=0;n<d;n++,b+=e,g+=k)for(let h=0;h<f;h++,b+=4,g+=4){var l=c.data[b+3];let m;if(l){let p=l+(m=a.data[g+3])-(l*m/255|0)|0;l=255*l/p|0;let q=255-l;a.data[g]=
(c.data[b]*l+a.data[g]*q)/255|0;a.data[g+1]=(c.data[b+1]*l+a.data[g+1]*q)/255|0;a.data[g+2]=(c.data[b+2]*l+a.data[g+2]*q)/255|0;a.data[g+3]=p}}};R.LM_NORMAL=0;R.LM_MULTIPLY=1;R.LM_ADD=2;R.LM_SCREEN=3;R.LM_LIGHTEN=4;R.LM_DARKEN=5;R.LM_SUBTRACT=6;R.LM_DODGE=7;R.LM_BURN=8;R.LM_OVERLAY=9;R.LM_HARDLIGHT=10;R.LM_SOFTLIGHT=11;R.LM_VIVIDLIGHT=12;R.LM_LINEARLIGHT=13;R.LM_PINLIGHT=14;R.LM_PASSTHROUGH=15;R.LM_MULTIPLY2=16;R.LM_FIRST=0;R.LM_LAST=16;R.LM_LAST_CHIBIPAINT=R.LM_PINLIGHT;R.BLEND_MODE_CODENAMES="normal multiply add screen lighten darken subtract dodge burn overlay hardLight softLight vividLight linearLight pinLight passthrough multiply2".split(" ");
R.BLEND_MODE_DISPLAY_NAMES="Normal;Multiply;Add;Screen;Lighten;Darken;Subtract;Dodge;Burn;Overlay;Hard Light;Soft Light;Vivid Light;Linear Light;Pin Light;Passthrough;Multiply".split(";");for(let a=0;a<256;a++){let c=a/255;Ab[a]=(c-c*c)*255|0}for(let a=0;a<256;a++){let c=a/255;Bb[a]=(Math.sqrt(c)-c)*255|0}gb.prototype.copyFrom=function(a){this.name=a.name;this.blendMode=a.blendMode;this.useLegacyMultiply=a.useLegacyMultiply;this.alpha=a.alpha;this.visible=a.visible;this.parent=a.parent;this.lockAlpha=
a.lockAlpha;a.mask?this.mask?this.mask.copyPixelsFrom(a.mask):this.mask=a.mask.clone():this.mask=null;this.maskLinked=a.maskLinked;this.maskVisible=a.maskVisible;a.maskThumbnail?this.maskThumbnail?this.maskThumbnail.copyPixelsFrom(a.maskThumbnail):this.maskThumbnail=a.maskThumbnail.clone():this.maskThumbnail=null};gb.prototype.setMask=function(a){(this.mask=a)||(this.maskThumbnail=null)};gb.prototype.setAlpha=function(a){this.alpha=a};gb.prototype.getAlpha=function(){return this.alpha};gb.prototype.getEffectiveAlpha=
function(){return this.visible?this.alpha:0};gb.prototype.getEffectiveMask=function(){return this.maskVisible?this.mask:null};gb.prototype.setName=function(a){this.name=a};gb.prototype.getName=function(){return this.name};gb.prototype.setBlendMode=function(a){this.blendMode=a;a===R.LM_MULTIPLY?this.useLegacyMultiply=!0:a===R.LM_MULTIPLY2&&(this.useLegacyMultiply=!1)};gb.prototype.getBlendMode=function(){return this.blendMode};gb.prototype.getLockAlpha=function(){return this.lockAlpha};gb.prototype.setLockAlpha=
function(a){this.lockAlpha=a};gb.prototype.setVisible=function(a){this.visible=a};gb.prototype.getVisible=function(){return this.visible};gb.prototype.isVisible=gb.prototype.getVisible;gb.prototype.setMaskLinked=function(a){this.maskLinked=a};gb.prototype.getMaskLinked=function(){return this.maskLinked};gb.prototype.setMaskVisible=function(a){this.maskVisible=a};gb.prototype.getMaskVisible=function(){return this.maskVisible};gb.prototype.getMemoryUsed=function(){return 0};gb.prototype.getDepth=function(){return null==
this.parent?0:this.parent.getDepth()+1};gb.prototype.ancestorsAreVisible=function(){return null==this.parent||this.parent.visible&&this.parent.ancestorsAreVisible()};gb.prototype.hasAncestor=function(a){return this.parent==a||this.parent&&this.parent.hasAncestor(a)};gb.prototype.clone=function(){throw"Pure virtual CPLayer.clone() call";};gb.prototype.getNonTransparentBounds=function(a){return new za(0,0,0,0)};gb.prototype.rebuildMaskThumbnail=function(){if(this.mask){if(!this.maskThumbnail){var a=
Math.ceil(Math.max(this.mask.width/gb.LAYER_THUMBNAIL_WIDTH,this.mask.height/gb.LAYER_THUMBNAIL_HEIGHT));this.maskThumbnail=new Na(Math.floor(this.mask.width/a),Math.floor(this.mask.height/a),8)}this.maskThumbnail.createThumbnailFrom(this.mask)}else this.maskThumbnail=null};gb.prototype.getMaskThumbnail=function(){return!this.maskThumbnail&&this.mask&&this.rebuildMaskThumbnail(),this.maskThumbnail};gb.LAYER_THUMBNAIL_WIDTH=80;gb.LAYER_THUMBNAIL_HEIGHT=50;Da.prototype=Object.create(gb.prototype);Da.prototype.constructor=
Da;Da.createFromImage=function(a,c){c=new Da(0,0,c);return c.image=a,c};Da.prototype.clone=function(){var a=new Da(0,0,this.name);return a.copyFrom(this),a};Da.prototype.copyFrom=function(a){gb.prototype.copyFrom.call(this,a);this.clip=a.clip;this.image?this.image.copyPixelsFrom(a.image):this.image=a.image.clone()};Da.prototype.hasAlpha=function(){return 100!=this.alpha||this.image.hasAlpha()};Da.prototype.hasAlphaInRect=function(a){return 100!=this.alpha||this.image.hasAlphaInRect(a)};Da.prototype.copyImageFrom=
function(a){this.image.copyPixelsFrom(a)};Da.prototype.getClippingBase=function(){if(this.clip&&this.parent)for(var a=this.parent.indexOf(this)-1;a>=0;a--)if(this.parent.layers[a]instanceof Da){if(!this.parent.layers[a].clip)return this.parent.layers[a]}else break;return null};Da.prototype.getClip=function(){return this.clip};Da.prototype.setClip=function(a){this.clip=a};Da.prototype.getNonTransparentBounds=function(a){return this.image.getNonTransparentBounds(a)};Da.prototype.getBounds=function(){return new za(0,
0,this.image.width,this.image.height)};Da.prototype.getMemoryUsed=function(){return this.image?this.image.getMemorySize():0};Da.prototype.rebuildImageThumbnail=function(){if(!this.imageThumbnail){var a=Math.ceil(Math.max(this.image.width/gb.LAYER_THUMBNAIL_WIDTH,this.image.height/gb.LAYER_THUMBNAIL_HEIGHT));this.imageThumbnail=new I(Math.floor(this.image.width/a),Math.floor(this.image.height/a))}this.imageThumbnail.createThumbnailFrom(this.image)};Da.prototype.getImageThumbnail=function(){return this.imageThumbnail||
this.rebuildImageThumbnail(),this.imageThumbnail};R.blendFunctionNameForParameters=function(a,c,d,b){d=R.BLEND_MODE_CODENAMES[d]+"Onto";return a?d+="TransparentFusion":d+="OpaqueFusion",100==c?d+="WithOpaqueLayer":d+="WithTransparentLayer",b&&(d+="Masked"),d};R.fuseImageOntoImage=function(a,c,d,b,g,n,f){b<=0||(c=R.blendFunctionNameForParameters(c,b,g,null!=f),n=a.getBounds().clipTo(n),this[c](a,d,b,n,f))};R.normalFuseImageOntoImageAtPosition=function(a,c,d,b,g){g=g.clone();d=new za(d,b,0,0);a.getBounds().clipSourceDest(g,
d);this._normalFuseImageOntoImageAtPosition(a,c,100,g,d.left,d.top)};R.multiplyAlphaBy=function(a,c){if(c<100)if(0==c)a.clearAll(0);else{a=a.data;for(var d=3;d<a.length;d+=4)a[d]=Math.round(a[d]*c/100)}};R.multiplyAlphaByMask=function(a,c,d){c/=25500;for(var b=I.ALPHA_BYTE_OFFSET,g=0;b<a.data.length;b+=I.BYTES_PER_PIXEL,g++)a.data[b]=Math.round(a.data[b]*d.data[g]*c)};R.copyAndMultiplyAlphaBy=function(a,c,d,b){if(100==d)a.copyBitmapRect(c,b.left,b.top,b);else if(0==d)a.clearRect(b,0);else for(a=c.data,
c=0;c<a.length;c+=4)a[c]=a[c],a[c+1]=a[c+1],a[c+2]=a[c+2],a[c+3]=Math.round(a[c+3]*d/100)};Cd.prototype.addChildren=function(a){null!=a&&(Array.isArray(a)?(a.forEach(c=>c.parent=this),this.layers=this.layers.concat(a)):(a.parent=this,this.layers.push(a)))};var Jb={};!function(a){function c(){}function d(f,e){for(var k=f.length;k--;)if(f[k].listener===e)return k;return-1}function b(f){return function(){return this[f].apply(this,arguments)}}var g=c.prototype,n=a.EventEmitter;g.getListeners=function(f){var e,
k,l=this._getEvents();if(f instanceof RegExp)for(k in e={},l)l.hasOwnProperty(k)&&f.test(k)&&(e[k]=l[k]);else e=l[f]||(l[f]=[]);return e};g.flattenListeners=function(f){var e,k=[];for(e=0;e<f.length;e+=1)k.push(f[e].listener);return k};g.getListenersAsObject=function(f){var e,k=this.getListeners(f);return k instanceof Array&&((e={})[f]=k),e||k};g.addListener=function(f,e){if(!function p(m){return"function"==typeof m||m instanceof RegExp||!!m&&"object"==typeof m&&p(m.listener)}(e))throw TypeError("listener must be a function");
var k;f=this.getListenersAsObject(f);var l="object"==typeof e;for(k in f)f.hasOwnProperty(k)&&-1===d(f[k],e)&&f[k].push(l?e:{listener:e,once:!1});return this};g.on=b("addListener");g.addOnceListener=function(f,e){return this.addListener(f,{listener:e,once:!0})};g.once=b("addOnceListener");g.defineEvent=function(f){return this.getListeners(f),this};g.defineEvents=function(f){for(var e=0;e<f.length;e+=1)this.defineEvent(f[e]);return this};g.removeListener=function(f,e){var k,l;f=this.getListenersAsObject(f);
for(l in f)f.hasOwnProperty(l)&&-1!==(k=d(f[l],e))&&f[l].splice(k,1);return this};g.off=b("removeListener");g.addListeners=function(f,e){return this.manipulateListeners(!1,f,e)};g.removeListeners=function(f,e){return this.manipulateListeners(!0,f,e)};g.manipulateListeners=function(f,e,k){var l,h,m=f?this.removeListener:this.addListener;f=f?this.removeListeners:this.addListeners;if("object"!=typeof e||e instanceof RegExp)for(l=k.length;l--;)m.call(this,e,k[l]);else for(l in e)e.hasOwnProperty(l)&&
(h=e[l])&&("function"==typeof h?m.call(this,l,h):f.call(this,l,h));return this};g.removeEvent=function(f){var e,k=typeof f,l=this._getEvents();if("string"===k)delete l[f];else if(f instanceof RegExp)for(e in l)l.hasOwnProperty(e)&&f.test(e)&&delete l[e];else delete this._events;return this};g.removeAllListeners=b("removeEvent");g.emitEvent=function(f,e){var k,l,h,m=this.getListenersAsObject(f);for(h in m)if(m.hasOwnProperty(h)){var p=0;for(k=m[h].slice(0);p<k.length;p++)!0===(l=k[p]).once&&this.removeListener(f,
l.listener),l.listener.apply(this,e||[])===this._getOnceReturnValue()&&this.removeListener(f,l.listener)}return this};g.trigger=b("emitEvent");g.emit=function(f){var e=Array.prototype.slice.call(arguments,1);return this.emitEvent(f,e)};g.setOnceReturnValue=function(f){return this._onceReturnValue=f,this};g._getOnceReturnValue=function(){return!this.hasOwnProperty("_onceReturnValue")||this._onceReturnValue};g._getEvents=function(){return this._events||(this._events={})};c.noConflict=function(){return a.EventEmitter=
n,c};"function"==typeof define&&define.amd?define(function(){return c}):Jb?Jb=c:a.EventEmitter=c}("u">typeof window?window:Jb||{});class Ug extends Ga(Jb){close(){this.layer=this.buffer=null;this.emitEvent("changeLayer")}setLayer(a){this.layer=a;this.invalidRect=a.getBounds();this.emitEvent("changeLayer")}isOpen(){return null!=this.layer}invalidateRect(a){this.invalidRect.union(a)}getImageData(){this.prepareMask();if(!this.invalidRect.isEmpty()&&this.layer&&this.layer.mask){var a=this.buffer,c=this.layer.mask,
d=this.invalidRect,b=d.top*c.width+d.left,g=b*I.BYTES_PER_PIXEL,n=d.getWidth();d=d.getHeight();var f=c.width-n,e=f*I.BYTES_PER_PIXEL;for(let k=0;k<d;k++,b+=f,g+=e)for(let l=0;l<n;l++,b++,g+=I.BYTES_PER_PIXEL)a.data[g+I.RED_BYTE_OFFSET]=c.data[b],a.data[g+I.GREEN_BYTE_OFFSET]=c.data[b],a.data[g+I.BLUE_BYTE_OFFSET]=c.data[b],a.data[g+I.ALPHA_BYTE_OFFSET]=255;!0;this.invalidRect.makeEmpty()}return this.buffer}constructor(a,c){super();this.layer=a;this.buffer=a.mask.getImageData(0,0,a.mask.width,a.mask.height);
this.invalidRect=new za(0,0,0,0);this.prepareMask=c}}class Xb{merge(a){return!1}noChange(){return!1}getMemoryUsed(a,c){return 0}compact(){}}lb.prototype.getRgb=function(){return this.rgb};lb.prototype.getSaturation=function(){return this.saturation};lb.prototype.getHue=function(){return this.hue};lb.prototype.getValue=function(){return this.value};lb.prototype.setRgbComponents=function(a,c,d){this.setRgb(a<<16|c<<8|d)};lb.prototype.setRgb=function(a){this.rgb=a;var c=a>>16&255,d=a>>8&255;a&=255;this.value=
Math.max(c,Math.max(d,a));var b=Math.min(c,Math.min(d,a));if(0==this.value?this.saturation=0:this.saturation=~~((this.value-b)/this.value*255),0==this.saturation)this.hue=0;else{var g=(this.value-c)/(this.value-b),n=(this.value-d)/(this.value-b);b=(this.value-a)/(this.value-b);var f=0;this.value==c&&(f=b-n);this.value==d&&(f=2+g-b);this.value==a&&(f=4+n-g);(f*=60)<0&&(f+=360);this.hue=~~f}};lb.prototype.setHsv=function(a,c,d){this.hue=a;this.saturation=c;this.value=d;this.rgb=Ud(this)};lb.prototype.setHue=
function(a){this.hue=a;this.rgb=Ud(this)};lb.prototype.setSaturation=function(a){this.saturation=a;this.rgb=Ud(this)};lb.prototype.setValue=function(a){this.value=a;this.rgb=Ud(this)};lb.prototype.setGreyscale=function(a){this.rgb=lb.greyToRGB(a);this.saturation=this.hue=0;this.value=a};lb.prototype.clone=function(){var a=new lb(0);return a.copyFrom(this),a};lb.prototype.copyFrom=function(a){this.rgb=a.rgb;this.hue=a.hue;this.saturation=a.saturation;this.value=a.value};lb.prototype.isEqual=function(a){return this.rgb==
a.rgb&&this.hue==a.hue&&this.saturation==a.saturation&&this.value==a.value};lb.greyToRGB=function(a){return a|a<<8|a<<16};sb.prototype.setToIdentity=function(){this.m=[1,0,0,1,0,0]};sb.prototype.multiply=function(a){var c=this.m[1]*a.m[0]+this.m[3]*a.m[1],d=this.m[0]*a.m[2]+this.m[2]*a.m[3],b=this.m[1]*a.m[2]+this.m[3]*a.m[3],g=this.m[0]*a.m[4]+this.m[2]*a.m[5]+this.m[4],n=this.m[1]*a.m[4]+this.m[3]*a.m[5]+this.m[5];this.m[0]=this.m[0]*a.m[0]+this.m[2]*a.m[1];this.m[1]=c;this.m[2]=d;this.m[3]=b;this.m[4]=
g;this.m[5]=n};sb.prototype.preMultiply=function(a){var c=a.m[1]*this.m[0]+a.m[3]*this.m[1],d=a.m[0]*this.m[2]+a.m[2]*this.m[3],b=a.m[1]*this.m[2]+a.m[3]*this.m[3],g=a.m[0]*this.m[4]+a.m[2]*this.m[5]+a.m[4],n=a.m[1]*this.m[4]+a.m[3]*this.m[5]+a.m[5];this.m[0]=a.m[0]*this.m[0]+a.m[2]*this.m[1];this.m[1]=c;this.m[2]=d;this.m[3]=b;this.m[4]=g;this.m[5]=n};sb.prototype.invert=function(){var a=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),c=-this.m[1]*a,d=-this.m[2]*a,b=this.m[0]*a,g=a*(this.m[2]*this.m[5]-
this.m[3]*this.m[4]),n=a*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);this.m[0]=this.m[3]*a;this.m[1]=c;this.m[2]=d;this.m[3]=b;this.m[4]=g;this.m[5]=n};sb.prototype.getInverted=function(){var a=new sb;return a.m[0]=this.m[0],a.m[1]=this.m[1],a.m[2]=this.m[2],a.m[3]=this.m[3],a.m[4]=this.m[4],a.m[5]=this.m[5],a.invert(),a};sb.prototype.rotate=function(a){var c=Math.cos(a);a=Math.sin(a);var d=this.m[1]*c+this.m[3]*a,b=-(this.m[0]*a)+this.m[2]*c,g=-(this.m[1]*a)+this.m[3]*c;this.m[0]=this.m[0]*c+this.m[2]*
a;this.m[1]=d;this.m[2]=b;this.m[3]=g};sb.prototype.rotateAroundPoint=function(a,c,d){this.translate(c,d);this.rotate(a);this.translate(-c,-d)};sb.prototype.translate=function(a,c){this.m[4]+=this.m[0]*a+this.m[2]*c;this.m[5]+=this.m[1]*a+this.m[3]*c};sb.prototype.scale=function(a,c){this.m[0]*=a;this.m[1]*=a;this.m[2]*=c;this.m[3]*=c};sb.prototype.scaleAroundPoint=function(a,c,d,b){this.translate(d,b);this.scale(a,c);this.translate(-d,-b)};sb.prototype.shear=function(a,c){var d=this.m[1]+this.m[3]*
c,b=this.m[2]+this.m[0]*a;a=this.m[3]+this.m[1]*a;this.m[0]+=this.m[2]*c;this.m[1]=d;this.m[2]=b;this.m[3]=a};sb.prototype.getTransformedPoint=function(a){return{x:a.x*this.m[0]+a.y*this.m[2]+this.m[4],y:a.x*this.m[1]+a.y*this.m[3]+this.m[5]}};sb.prototype.transformPoints=function(a){for(var c=0;c<a.length;c++)a[c]=this.getTransformedPoint(a[c])};sb.prototype.getTranslateX=function(){return this.m[4]};sb.prototype.getTranslateY=function(){return this.m[5]};sb.prototype.clone=function(){var a=new sb;
return a.m[0]=this.m[0],a.m[1]=this.m[1],a.m[2]=this.m[2],a.m[3]=this.m[3],a.m[4]=this.m[4],a.m[5]=this.m[5],a};sb.prototype.getDeterminant=function(){return this.m[0]*this.m[3]-this.m[1]*this.m[2]};sb.prototype.decompose=function(){var a=this.getDeterminant(),c=Math.sqrt(this.m[0]*this.m[0]+this.m[1]*this.m[1]);return{translate:{x:this.m[4],y:this.m[5]},rotate:Math.sign(this.m[1])*Math.acos(this.m[0]/c),scale:{x:c,y:a/c},shear:{x:Math.atan((this.m[0]*this.m[2]+this.m[1]*this.m[3])/(c*c)),y:0}}};
sb.prototype.toString=function(){return"["+this.m[0].toFixed(2)+" "+this.m[2].toFixed(2)+" "+this.m[4].toFixed(2)+"]\n["+this.m[1].toFixed(2)+" "+this.m[3].toFixed(2)+" "+this.m[5].toFixed(2)+"]\n[0.00 0.00 1.00]"};Math.sign=Math.sign||function(a){return 0==(a*=1)||isNaN(a)?a:a>0?1:-1};uc.prototype.toInt=function(){return Math.max(0,Math.min(255,Math.round(255*this.r)))<<16|Math.max(0,Math.min(255,Math.round(255*this.g)))<<8|Math.max(0,Math.min(255,Math.round(255*this.b)))};uc.prototype.mixWith=function(a,
c){this.r=this.r*(1-c)+a.r*c;this.g=this.g*(1-c)+a.g*c;this.b=this.b*(1-c)+a.b*c};uc.prototype.clone=function(){return new uc(this.r,this.g,this.b)};uc.createFromInt=function(a){return new uc((a>>>16&255)/255,(a>>>8&255)/255,(255&a)/255)};class ld{calcAlphaScale(a){return a<=230?.5:.5+(a-230)/25*(180/255-.5)}paintDab(a,c,d,b,g,n,f){n.alpha=Math.round(250/254*(n.alpha-1)+5);a=2===b.toolNb?this.calcAlphaScale(n.alpha):b.alphaScale;a=Math.max(1,Math.ceil(n.alpha*a));switch(b.paintMode){case wa.PAINT_MODE_FLOW:this._paintFlow(g,
c,n.brush,n.width,a);break;case wa.PAINT_MODE_OPACITY:this._paintOpacity(g,c,n.brush,n.width,a)}}mergeOntoImage(a,c,d){let b=this._strokeBuffer.data;var g=this._strokedRegion;c=c.data;let n=a.data,f=d>>16&255,e=d>>8&255;d&=255;let k=0|g.getWidth(),l=0|g.getHeight(),h=this._strokeBuffer.offsetOfPixel(g.left,g.top);g=a.offsetOfPixel(g.left,g.top);let m=this._strokeBuffer.width-k|0;a=(a.width-k)*I.BYTES_PER_PIXEL|0;for(let q=0;q<l;q++,h+=m,g+=a)for(let r=0;r<k;r++,h++,g+=I.BYTES_PER_PIXEL){var p=b[h]/
255+.5|0;if(p>0){let u=p+c[g+I.ALPHA_BYTE_OFFSET]*(255-p)/255|0;p=255*p/u|0;let v=255-p;n[g]=(f*p+c[g]*v)/255&255;n[g+1]=(e*p+c[g+1]*v)/255&255;n[g+2]=(d*p+c[g+2]*v)/255&255;n[g+3]=u}}}mergeOntoMask(a,c,d){let b=this._strokeBuffer.data;var g=this._strokedRegion;c=c.data;let n=a.data,f=0|g.getWidth(),e=0|g.getHeight(),k=a.offsetOfPixel(g.left,g.top);g=this._strokeBuffer.offsetOfPixel(g.left,g.top);let l=this._strokeBuffer.width-f|0;a=a.width-f|0;for(let h=0;h<e;h++,g+=l,k+=a)for(let m=0;m<f;m++,g++,
k++){let p=b[g]/255|0;p>0&&(n[k]=(d*p+c[k]*(255-p))/255)}}_paintFlow(a,c,d,b,g){let n=this._strokeBuffer.data;a=a.left+a.top*b;let f=this._strokeBuffer.offsetOfPixel(c.left,c.top),e=c.getHeight(),k=c.getWidth();b-=k;let l=this._strokeBuffer.width-k;this._strokedRegion.union(c);for(c=0;c<e;c++,a+=b,f+=l)for(let h=0;h<k;h++,a++,f++){let m=d[a]*g;0!=m&&(n[f]=Math.min(65025,n[f]+(255-n[f]/255)*m/255))}}_paintOpacity(a,c,d,b,g){let n=this._strokeBuffer.data;a=a.left+a.top*b;let f=this._strokeBuffer.offsetOfPixel(c.left,
c.top),e=c.getWidth();b-=e;let k=this._strokeBuffer.width-e;g=Math.min(255,g);this._strokedRegion.union(c);for(let l=c.top;l<c.bottom;l++,a+=b,f+=k)for(let h=0;h<e;h++,a++,f++)n[f]=Math.max(d[a]*g,n[f])}beginStroke(){}endStroke(){}constructor(a,c){this._strokeBuffer=a;this._strokedRegion=c;this.wantsOutputAsInput=!0}}class Vg extends ld{mergeOntoImage(a,c,d){d=this._strokeBuffer.data;let b=this._strokedRegion;c=c.data;let g=a.data;for(let n=b.top;n<b.bottom;n++){let f=a.offsetOfPixel(b.left,n)+I.ALPHA_BYTE_OFFSET,
e=this._strokeBuffer.offsetOfPixel(b.left,n);for(let k=b.left;k<b.right;k++,f+=I.BYTES_PER_PIXEL){let l=d[e++]/255|0;l>0&&(g[f]=c[f]*(255-l)/255)}}}}class Wg extends ld{mergeOntoImage(a,c,d){d=this._strokeBuffer.data;var b=this._strokedRegion;let g=b.getWidth(),n=b.getHeight(),f=a.offsetOfPixel(b.left,b.top);b=this._strokeBuffer.offsetOfPixel(b.left,b.top);let e=(a.width-g)*I.BYTES_PER_PIXEL,k=this._strokeBuffer.width-g;c=c.data;a=a.data;for(let h=0;h<n;h++,b+=k,f+=e)for(let m=0;m<g;m++,b++,f+=I.BYTES_PER_PIXEL){var l=
d[b]/255|0;l>0&&0!=c[f+I.ALPHA_BYTE_OFFSET]&&(l=(l+255)/255,a[f+I.RED_BYTE_OFFSET]=c[f+I.RED_BYTE_OFFSET]*l,a[f+I.GREEN_BYTE_OFFSET]=c[f+I.GREEN_BYTE_OFFSET]*l,a[f+I.BLUE_BYTE_OFFSET]=c[f+I.BLUE_BYTE_OFFSET]*l)}}mergeOntoMask(a,c,d){d=this._strokeBuffer.data;var b=this._strokedRegion;let g=b.getWidth(),n=b.getHeight(),f=a.offsetOfPixel(b.left,b.top);b=this._strokeBuffer.offsetOfPixel(b.left,b.top);let e=a.width-g,k=this._strokeBuffer.width-g;c=c.data;a=a.data;for(let l=0;l<n;l++,b+=k,f+=e)for(let h=
0;h<g;h++,b++,f++){let m=d[b]/255|0;m>0&&(a[f]=Math.min((m+255)/255*c[f],255))}}}class Xg extends ld{mergeOntoImage(a,c,d){d=this._strokeBuffer.data;var b=this._strokedRegion;let g=b.getWidth(),n=b.getHeight(),f=a.offsetOfPixel(b.left,b.top);b=this._strokeBuffer.offsetOfPixel(b.left,b.top);let e=(a.width-g)*I.BYTES_PER_PIXEL,k=this._strokeBuffer.width-g;c=c.data;a=a.data;for(let l=0;l<n;l++,b+=k,f+=e)for(let h=0;h<g;h++,b++,f+=I.BYTES_PER_PIXEL){let m=d[b]/255|0;m>0&&0!=c[f+I.ALPHA_BYTE_OFFSET]&&
(a[f+I.RED_BYTE_OFFSET]=c[f+I.RED_BYTE_OFFSET]-(260-c[f+I.RED_BYTE_OFFSET])*m/255|0,a[f+I.GREEN_BYTE_OFFSET]=c[f+I.GREEN_BYTE_OFFSET]-(260-c[f+I.GREEN_BYTE_OFFSET])*m/255|0,a[f+I.BLUE_BYTE_OFFSET]=c[f+I.BLUE_BYTE_OFFSET]-(260-c[f+I.BLUE_BYTE_OFFSET])*m/255|0)}}mergeOntoMask(a,c,d){d=this._strokeBuffer.data;var b=this._strokedRegion;let g=b.getWidth(),n=b.getHeight(),f=a.offsetOfPixel(b.left,b.top);b=this._strokeBuffer.offsetOfPixel(b.left,b.top);let e=a.width-g,k=this._strokeBuffer.width-g;c=c.data;
a=a.data;for(let l=0;l<n;l++,b+=k,f+=e)for(let h=0;h<g;h++,b++,f++){let m=d[b]/255|0;m>0&&(a[f]=Math.max(c[f]-(260-c[f])*m/255,0))}}}class Yg extends ld{mergeOntoImage(a,c,d){d=this._strokeBuffer.data;let b=this._strokedRegion,g=c.data;a=a.data;var n=b.getWidth();let f=c.width*I.BYTES_PER_PIXEL,e=c.offsetOfPixel(b.left,b.top),k=this._strokeBuffer.offsetOfPixel(b.left,b.top),l=(c.width-n)*I.BYTES_PER_PIXEL;n=this._strokeBuffer.width-n;let h,m,p,q,r=function(v){h+=g[v+I.RED_BYTE_OFFSET];m+=g[v+I.GREEN_BYTE_OFFSET];
p+=g[v+I.BLUE_BYTE_OFFSET];q+=g[v+I.ALPHA_BYTE_OFFSET]};for(let v=b.top;v<b.bottom;v++,e+=l,k+=n)for(let y=b.left;y<b.right;y++,e+=I.BYTES_PER_PIXEL,k++){var u=d[k]/255|0;if(u>0){u=64+-63*u/255|0;let C=u+4;h=u*g[e+I.RED_BYTE_OFFSET];m=u*g[e+I.GREEN_BYTE_OFFSET];p=u*g[e+I.BLUE_BYTE_OFFSET];q=u*g[e+I.ALPHA_BYTE_OFFSET];r(v>0?e-f:e);r(v<c.height-1?e+f:e);r(y>0?e-I.BYTES_PER_PIXEL:e);r(y<c.width-1?e+I.BYTES_PER_PIXEL:e);q/=C;h/=C;m/=C;p/=C;a[e+I.RED_BYTE_OFFSET]=0|h;a[e+I.GREEN_BYTE_OFFSET]=0|m;a[e+I.BLUE_BYTE_OFFSET]=
0|p;a[e+I.ALPHA_BYTE_OFFSET]=0|q}}}mergeOntoMask(a,c,d){d=this._strokeBuffer.data;let b=this._strokedRegion,g=c.data;a=a.data;var n=b.getWidth();let f=c.width,e=c.offsetOfPixel(b.left,b.top),k=this._strokeBuffer.offsetOfPixel(b.left,b.top),l=c.width-n;n=this._strokeBuffer.width-n;for(let p=b.top;p<b.bottom;p++,e+=l,k+=n)for(let q=b.left;q<b.right;q++,e++,k++){var h=d[k]/255|0;if(h>0){var m=64+-63*h/255|0;h=m+4;m=m*g[e]+g[p>0?e-f:e]+g[p<c.height-1?e+f:e]+g[q>0?e-1:e]+g[q<c.width-1?e+1:e];a[e]=m/h|
0}}}}class ef extends ld{mergeOntoImage(a,c,d){d=this._strokeBuffer.data;var b=this._strokedRegion;c=c.data;let g=a.data,n=this._strokeBuffer.offsetOfPixel(b.left,b.top),f=a.offsetOfPixel(b.left,b.top),e=0|b.getWidth();b=0|b.getHeight();let k=this._strokeBuffer.width-e|0;a=(a.width-e)*I.BYTES_PER_PIXEL|0;for(let m=0;m<b;m++,n+=k,f+=a)for(let p=0;p<e;p++,n++,f+=I.BYTES_PER_PIXEL){let q=d[n];var l=q>>>24;if(l>0){var h=c[f+I.ALPHA_BYTE_OFFSET];h=l+h-l*h/255|0;l=255*l/h|0;let r=255-l;g[f]=((q>>16&255)*
l+c[f]*r)/255|0;g[f+1]=((q>>8&255)*l+c[f+1]*r)/255|0;g[f+2]=((255&q)*l+c[f+2]*r)/255|0;g[f+3]=h}}}mergeOntoMask(a,c,d){d=this._strokeBuffer.data;var b=this._strokedRegion;c=c.data;let g=a.data,n=this._strokeBuffer.offsetOfPixel(b.left,b.top),f=a.offsetOfPixel(b.left,b.top),e=0|b.getWidth();b=0|b.getHeight();let k=this._strokeBuffer.width-e|0;a=a.width-e|0;for(let l=0;l<b;l++,n+=k,f+=a)for(let h=0;h<e;h++,n++,f++){let m=d[n],p=m>>8;p>0&&(g[f]=((255&m)*p+c[f]*(255-p))/255|0)}}}let qg=2/6;class Dd extends ef{static _sampleGrey(a,
c,d,b,g){c|=0;d|=0;let n=[{x:c,y:d}];for(let f=.25;f<1.001;f+=.25)Array.prototype.push.apply(n,[{x:~~(c+f*b),y:d},{x:~~(c-f*b),y:d},{x:c,y:~~(d+f*g)},{x:c,y:~~(d-f*g)},{x:~~(c+.7*f*b),y:~~(d+.7*f*g)},{x:~~(c+.7*f*b),y:~~(d-.7*f*g)},{x:~~(c-.7*f*b),y:~~(d+.7*f*g)},{x:~~(c-.7*f*b),y:~~(d-.7*f*g)}]);return of(n.map(f=>a.getPixel(f.x,f.y)))}static _sampleRGB(a,c,d,b,g,n){c|=0;d|=0;var f=[{x:c,y:d}];for(let e=.25;e<1.001;e+=.25)Array.prototype.push.apply(f,[{x:~~(c+e*b),y:d},{x:~~(c-e*b),y:d},{x:c,y:~~(d+
e*g)},{x:c,y:~~(d-e*g)},{x:~~(c+.7*e*b),y:~~(d+.7*e*g)},{x:~~(c+.7*e*b),y:~~(d-.7*e*g)},{x:~~(c-.7*e*b),y:~~(d+.7*e*g)},{x:~~(c-.7*e*b),y:~~(d-.7*e*g)}]);c=[];for(let e of f)e.x<0||e.y<0||e.x>=a.width||e.y>=a.height||(f=(e.y*a.width+e.x)*4,a.data[f+3]>0&&c.push(uc.createFromInt(-16777216|a.data[f]<<16|a.data[f+1]<<8|a.data[f+2])));return 0===c.length?n:pf(c)}_paintToColorStrokeBuffer(a,c,d,b,g,n){let f=this._strokeBuffer.data,e=c.getWidth(),k=c.getHeight(),l=this._strokeBuffer.width-e,h=b-e;a=a.left+
a.top*b;b=this._strokeBuffer.offsetOfPixel(c.left,c.top);this._strokedRegion.union(c);for(c=0;c<k;c++,a+=h,b+=l)for(let q=0;q<e;q++,a++,b++){var m=d[a]*g/255|0;if(m>0){let r=f[b];var p=r>>>24;p=m+p-m*p/255|0;m=255-(255*m/p|0);f[b]=p<<24|(n>>16&255)+((r>>16&255)*m-(n>>16&255)*m)/255<<16|(n>>8&255)+((r>>8&255)*m-(n>>8&255)*m)/255<<8|(255&n)+((255&r)*m-(255&n)*m)/255}}}_paintToGreyscaleStrokeBuffer(a,c,d,b,g,n){let f=this._strokeBuffer.data;this._strokedRegion.union(c);for(let l=c.top,h=a.top;l<c.bottom;l++,
h++){let m=a.left+h*b,p=this._strokeBuffer.offsetOfPixel(c.left,l);for(let q=c.left;q<c.right;q++,m++,p++){var e=d[m]*g/255|0;if(e<=0)continue;let r=f[p];var k=r>>8;k=e+k-e*k/255|0;k>0&&(e=255-(255*e/k|0),f[p]=k<<8|n+((255&r)*e-n*e)/255)}}}beginStroke(){this._previousSamples=null}paintDab(a,c,d,b,g,n,f){a=this.isTransparentCanvas?.3:1;n.alpha=247/254*(n.alpha-1)+8;n.alpha*=a;var e,k;a=Math.max(1,n.alpha/4);var l=(c.left+c.right)/2,h=(c.top+c.bottom)/2,m=Math.max(1,Math.min(64,c.getWidth()*qg)),p=
Math.max(1,Math.min(64,c.getHeight()*qg));if(d instanceof Na){null==this._previousSamples&&(this._previousSamples=Array(50),this._previousSamples.fill(Dd._sampleGrey(d,l,h,m,p)));let r=of(this._previousSamples);var q=r;f=q=r=q*(1-(e=b.resat*b.resat))+(255&f)*e;d=Dd._sampleGrey(d,l,h,m,p);r=f*(1-(k=b.bleed))+d*k;this._previousSamples.push(r);this._previousSamples.shift();this._paintToGreyscaleStrokeBuffer(g,c,n.brush,n.width,a,Math.round(q))}else null==this._previousSamples&&(this._previousSamples=
Array(50),k=uc.createFromInt(f),this._previousSamples.fill(Dd._sampleRGB(d,l,h,m,p,k))),k=pf(this._previousSamples),k.mixWith(uc.createFromInt(f),b.resat*b.resat),e=k.toInt(),f=uc.createFromInt(f),d=Dd._sampleRGB(d,l,h,m,p,f),this.isTransparentCanvas=f===d,k.mixWith(d,b.bleed),this._previousSamples.push(k),this._previousSamples.shift(),this._paintToColorStrokeBuffer(g,c,n.brush,n.width,a,e)}constructor(a,c){super(a,c);this.wantsOutputAsInput=!0}}class $g extends ef{_accumulatePaintFromMask(a,c,d,
b){let g=this._brushBuffer.data,n=a.data,f=d.getWidth(),e=d.getHeight();c=c.left+c.top*this._brushBuffer.width;d=a.offsetOfPixel(d.left,d.top);let k=this._brushBuffer.width-f;a=a.width-f;if(!(b<=0))for(let h=0;h<e;h++,c+=k,d+=a)for(let m=0;m<f;m++,c++,d++){let p=n[d],q=g[c];var l=q>>8;l=b+l-b*l/255|0;let r=255-(255*b/l|0);g[c]=l<<8|p+((255&q)*r-p*r)/255}}_resaturateBrushWithGrey(a,c,d){if(!(c<=0)){var b=this._brushBuffer.data,g=a.getWidth(),n=a.getHeight();a=a.left+a.top*this._brushBuffer.width;var f=
this._brushBuffer.width-g;for(let k=0;k<n;k++,a+=f)for(let l=0;l<g;l++,a++){let h=b[a];var e=h>>8;e=c+e-c*e/255|0;let m=255-(255*c/e|0);b[a]=e<<8|d+((255&h)*m-d*m)/255}}}_paintToGreyscaleStrokeBuffer(a,c,d,b,g){let n=this._strokeBuffer.data,f=this._brushBuffer.data,e=a.data;this._strokedRegion.union(d);for(let l=d.top,h=c.top;l<d.bottom;l++,h++){let m=this._brushBuffer.offsetOfPixel(c.left,h),p=this._strokeBuffer.offsetOfPixel(d.left,l),q=a.offsetOfPixel(d.left,l);for(let r=d.left;r<d.right;r++,m++,
q++,p++){let u=f[m];var k=(u>>8)*b[m]*g/65025|0;k>0&&(k=255-k,n[p]=65280|(255&u)+(e[q]*k-(255&u)*k)/255)}}}_accumulatePaintFromImage(a,c,d,b){let g=this._brushBuffer.data,n=a.data,f=d.getWidth(),e=d.getHeight();c=c.left+c.top*this._brushBuffer.width;d=a.offsetOfPixel(d.left,d.top);let k=this._brushBuffer.width-f;a=(a.width-f)*I.BYTES_PER_PIXEL;for(let m=0;m<e;m++,c+=k,d+=a)for(let p=0;p<f;p++,c++,d+=I.BYTES_PER_PIXEL){var l=n[d+I.ALPHA_BYTE_OFFSET]*b/255|0;if(l>0){let q=g[c];var h=q>>>24;h=l+h-l*
h/255|0;l=255-(255*l/h|0);let r=n[d+I.RED_BYTE_OFFSET],u=n[d+I.GREEN_BYTE_OFFSET],v=n[d+I.BLUE_BYTE_OFFSET];g[c]=h<<24|r+((q>>16&255)*l-r*l)/255<<16|u+((q>>8&255)*l-u*l)/255<<8|v+((255&q)*l-v*l)/255}}}_resaturateBrushWithColor(a,c,d){if(!(c<=0)){var b=this._brushBuffer.data,g=a.getWidth(),n=a.getHeight();a=a.left+a.top*this._brushBuffer.width;var f=this._brushBuffer.width-g;for(let k=0;k<n;k++,a+=f)for(let l=0;l<g;l++,a++){let h=b[a];var e=h>>>24;e=c+e-c*e/255|0;let m=255-(255*c/e|0);b[a]=e<<24|(d>>>
16&255)+((h>>>16&255)*m-(d>>>16&255)*m)/255<<16|(d>>>8&255)+((h>>>8&255)*m-(d>>>8&255)*m)/255<<8|(255&d)+((255&h)*m-(255&d)*m)/255}}}_paintToColorStrokeBuffer(a,c,d,b,g){let n=this._strokeBuffer.data,f=this._brushBuffer.data,e=a.data;this._strokedRegion.union(d);for(let h=d.top,m=c.top;h<d.bottom;h++,m++){let p=this._brushBuffer.offsetOfPixel(c.left,m),q=this._strokeBuffer.offsetOfPixel(d.left,h),r=a.offsetOfPixel(d.left,h);for(let u=d.left;u<d.right;u++,p++,r+=I.BYTES_PER_PIXEL,q++){let v=f[p];var k=
(v>>>24)*b[p]*g/65025|0;if(k>0){var l=e[r+I.ALPHA_BYTE_OFFSET];l=k+l-k*l/255|0;k=255-(255*k/l|0);n[q]=l<<24|(v>>16&255)+(e[r+I.RED_BYTE_OFFSET]*k-(v>>16&255)*k)/255<<16|(v>>8&255)+(e[r+I.GREEN_BYTE_OFFSET]*k-(v>>8&255)*k)/255<<8|(255&v)+(e[r+I.BLUE_BYTE_OFFSET]*k-(255&v)*k)/255}}}}paintDab(a,c,d,b,g,n,f){a instanceof I?null==this._brushBuffer?(this._brushBuffer=new Na(n.width,n.height,32),this._accumulatePaintFromImage(d,g,c,255)):(this._resaturateBrushWithColor(g,~~(b.resat<=0?0:Math.max(1,b.resat*
b.resat*255)),16777215&f),this._paintToColorStrokeBuffer(a,g,c,n.brush,n.alpha),this._accumulatePaintFromImage(d,g,c,~~(255*b.bleed))):null==this._brushBuffer?(this._brushBuffer=new Na(n.width,n.height,16),this._accumulatePaintFromMask(d,g,c,255)):(this._resaturateBrushWithGrey(g,~~(b.resat<=0?0:Math.max(1,b.resat*b.resat*255)),255&f),this._paintToGreyscaleStrokeBuffer(a,g,c,n.brush,n.alpha),this._accumulatePaintFromMask(d,g,c,~~(255*b.bleed)))}endStroke(){this._brushBuffer=null}constructor(a,c){super(a,
c);this.wantsOutputAsInput=!0;this.isTransparentCanvas=!1}}class Zg extends ef{_sampleFromMask(a,c,d,b){let g=this._brushBuffer.data,n=c.getWidth(),f=c.getHeight(),e=this._brushBuffer.offsetOfPixel(c.left,c.top);d=a.offsetOfPixel(d.left,d.top);let k=this._brushBuffer.width-n,l=a.width-n,h=255-b;if(255!=b){for(let m=0;m<f;m++,e+=k,d+=l)for(let p=0;p<n;p++,e++,d++){let q=a.data[d],r=g[e],u=(q*h+(255&r)*b)/255,v=(255*h+(r>>8)*b)/255<<8|u;v==r&&(q>u?v++:q<u&&v--);g[e]=v}qf(this._brushBuffer,c)}}_paintToMask(a,
c,d,b){let g=c.getWidth(),n=c.getHeight();c=this._brushBuffer.offsetOfPixel(c.left,c.top);d=a.offsetOfPixel(d.left,d.top);let f=this._brushBuffer.width-g,e=a.width-g;a=a.data;let k=this._brushBuffer.data;for(let l=0;l<n;l++,d+=e,c+=f)for(let h=0;h<g;h++,c++,d++){let m=k[c],p=255&m;((m>>8)*b[c]/255|0)>0&&(a[d]=p)}}_sampleFromImage(a,c,d,b){let g=this._brushBuffer.data,n=c.getWidth(),f=c.getHeight(),e=this._brushBuffer.offsetOfPixel(c.left,c.top);d=a.offsetOfPixel(d.left,d.top);let k=this._brushBuffer.width-
n,l=(a.width-n)*I.BYTES_PER_PIXEL,h=255-b;if(255!=b){for(let p=0;p<f;p++,e+=k,d+=l)for(let q=0;q<n;q++,e++,d+=I.BYTES_PER_PIXEL){let r=a.data[d+I.RED_BYTE_OFFSET],u=a.data[d+I.GREEN_BYTE_OFFSET],v=a.data[d+I.BLUE_BYTE_OFFSET];var m=g[e];let y=(a.data[d+I.ALPHA_BYTE_OFFSET]*h+(m>>24&255)*b)/255<<24&4278190080|(r*h+(m>>16&255)*b)/255<<16&16711680|(u*h+(m>>8&255)*b)/255<<8&65280|(v*h+(255&m)*b)/255&255;if(y==m){m=(16711680&y)>>16;let C=(65280&y)>>8,w=255&y;r>m?y+=65536:r<m&&(y-=65536);u>C?y+=256:u<C&&
(y-=256);v>w?y+=1:v<w&&--y}g[e]=y}qf(this._brushBuffer,c)}}_paintToImage(a,c,d,b){let g=c.getWidth(),n=c.getHeight();c=this._brushBuffer.offsetOfPixel(c.left,c.top);d=a.offsetOfPixel(d.left,d.top);let f=this._brushBuffer.width-g,e=(a.width-g)*I.BYTES_PER_PIXEL;a=a.data;let k=this._brushBuffer.data;for(let l=0;l<n;l++,d+=e,c+=f)for(let h=0;h<g;h++,c++,d+=I.BYTES_PER_PIXEL){let m=k[c];((m>>>24)*b[c]/255|0)>0&&(a[d+I.RED_BYTE_OFFSET]=m>>16&255,a[d+I.GREEN_BYTE_OFFSET]=m>>8&255,a[d+I.BLUE_BYTE_OFFSET]=
255&m,a[d+I.ALPHA_BYTE_OFFSET]=m>>24&255)}}paintDab(a,c,d,b,g,n,f){a instanceof I?null==this._brushBuffer?(this._brushBuffer=new Na(n.width,n.height,32),this._sampleFromImage(d,g,c,0)):(this._sampleFromImage(d,g,c,n.alpha),this._paintToImage(a,g,c,n.brush)):null==this._brushBuffer?(this._brushBuffer=new Na(n.width,n.height,16),this._sampleFromMask(d,g,c,0)):(this._sampleFromMask(d,g,c,n.alpha),this._paintToMask(a,g,c,n.brush))}mergeOntoImage(a,c,d){}mergeOntoMask(a,c,d){}beginStroke(){this._brushBuffer=
null}endStroke(){this._brushBuffer=null}constructor(a,c){super(a,c);this._brushBuffer=null;this.noMergePhase=this.wantsOutputAsInput=!0}}"use strict";"use strict";ec.prototype=Object.create(Ga(Jb).prototype);ec.prototype.constructor=ec;ec.prototype.getBounds=function(){return new za(0,0,this.width,this.height)};ec.prototype.isPointWithin=function(a,c){return a>=0&&c>=0&&a<this.width&&c<this.height};ec.EDITING_MODE_IMAGE=0;ec.EDITING_MODE_MASK=1;ib.prototype.readChar=function(){return this.pos<this.end?
String.fromCharCode(this.data[this.pos++]):(this.eof=!0,-1)};ib.prototype.readByte=function(){return this.pos<this.end?this.data[this.pos++]:(this.eof=!0,-1)};ib.prototype.readU8=ib.prototype.readByte;ib.prototype.readS8=function(){var a;return 128&(a=this.readByte())?4294967040|a:a};ib.prototype.unreadChar=function(a){this.pos--};ib.prototype.peekChar=function(){return this.pos<this.end?String.fromCharCode(this.data[this.pos]):(this.eof=!0,-1)};ib.prototype.readString=function(a){var c,d=Array(a);
for(c=0;c<a;c++)d[c]=this.readChar();return d.join("")};ib.prototype.readS16=function(){var a;return 32768&(a=this.readByte()<<8|this.readByte())?4294901760|a:a};ib.prototype.readU16BE=function(){return this.readByte()<<8|this.readByte()};ib.prototype.readU16LE=function(){var a=this.readByte();return this.readByte()<<8|a};ib.prototype.readU32BE=function(){return(this.readByte()<<24|this.readByte()<<16|this.readByte()<<8|this.readByte())>>>0};ib.prototype.readU32LE=function(){var a=this.readByte(),
c=this.readByte(),d=this.readByte();return(this.readByte()<<24|d<<16|c<<8|a)>>>0};ib.prototype.readBytes=function(a){var c=this.data.subarray(this.pos,this.pos+a);return this.pos+=a,this.pos>this.end&&(this.eof=!0),c};ib.prototype.skip=function(a){this.pos+=a;this.pos>this.end&&(this.eof=!0)};ib.prototype.seek=function(a){this.pos=a};ib.prototype.writeBytes=function(a){for(var c=0;c<a.length;c++)this.data[this.pos++]=a[c]};ib.prototype.writeByte=function(a){this.data[this.pos++]=a};ib.prototype.writeU8=
ib.prototype.writeByte;ib.prototype.writeU16LE=function(a){this.data[this.pos++]=a;this.data[this.pos++]=a>>8};ib.prototype.writeU16BE=function(a){this.data[this.pos++]=a>>8;this.data[this.pos++]=a};ib.prototype.writeU32BE=function(a){this.data[this.pos++]=a>>24;this.data[this.pos++]=a>>16;this.data[this.pos++]=a>>8;this.data[this.pos++]=a};ib.prototype.writeU32LE=function(a){this.data[this.pos++]=a;this.data[this.pos++]=a>>8;this.data[this.pos++]=a>>16;this.data[this.pos++]=a>>24};ib.prototype.writeDoubleBE=
function(a){a=new Uint8Array((new Float64Array([a])).buffer);for(var c=a.length-1;c>=0;c--)this.writeByte(a[c])};ib.prototype.writeFloatBE=function(a){a=new Uint8Array((new Float32Array([a])).buffer);for(var c=a.length-1;c>=0;c--)this.writeByte(a[c])};ib.prototype.writeString=function(a){for(var c=0;c<a.length;c++)this.data[this.pos++]=a.charCodeAt(c)};ib.prototype.writeUnsignedIntBE=function(a,c){switch(void 0===c&&(c=this.measureUnsignedInt(a)),c){case 5:this.writeU8(Math.floor(a/4294967296));case 4:this.writeU8(a>>
24);case 3:this.writeU8(a>>16);case 2:this.writeU8(a>>8);case 1:this.writeU8(a);break;default:throw"Bad UINT size "+c;}};ib.prototype.measureUnsignedInt=function(a){return a<256?1:a<65536?2:a<16777216?3:a<4294967296?4:5};ib.prototype.getAsDataArray=function(){if(this.pos<this.data.byteLength)return this.data.subarray(0,this.pos);if(this.pos==this.data.byteLength)return this.data;throw"ArrayDataStream's pos lies beyond end of buffer";};ib.prototype.EOF=-1;var Me={},Qa={},Nh="u">typeof Uint8Array&&
"u">typeof Uint16Array&&"u">typeof Int32Array;Qa.assign=function(a){for(var c=Array.prototype.slice.call(arguments,1);c.length;){var d=c.shift();if(d){if("object"!=typeof d)throw TypeError(d+"must be non-object");for(var b in d)Object.prototype.hasOwnProperty.call(d,b)&&(a[b]=d[b])}}return a};Qa.shrinkBuf=function(a,c){return a.length===c?a:a.subarray?a.subarray(0,c):(a.length=c,a)};var Oh={arraySet:function(a,c,d,b,g){if(c.subarray&&a.subarray)return void a.set(c.subarray(d,d+b),g);for(var n=0;n<
b;n++)a[g+n]=c[d+n]},flattenChunks:function(a){var c,d;var b=c=0;for(d=a.length;c<d;c++)b+=a[c].length;c=0;var g=new Uint8Array(b);b=0;for(d=a.length;c<d;c++){var n=a[c];g.set(n,b);b+=n.length}return g}},Ph={arraySet:function(a,c,d,b,g){for(var n=0;n<b;n++)a[g+n]=c[d+n]},flattenChunks:function(a){return[].concat.apply([],a)}};"use strict";"use strict";"use strict";Qa.setTyped=function(a){a?(Qa.Buf8=Uint8Array,Qa.Buf16=Uint16Array,Qa.Buf32=Int32Array,Qa.assign(Qa,Oh)):(Qa.Buf8=Array,Qa.Buf16=Array,
Qa.Buf32=Array,Qa.assign(Qa,Ph))};Qa.setTyped(Nh);var Qh=Qa.assign,Pd={};Lc(Pd,"Deflate",function(){return rg},function(a){return rg=a});Lc(Pd,"deflate",function(){return sg},function(a){return sg=a});Lc(Pd,"deflateRaw",function(){return tg},function(a){return tg=a});Lc(Pd,"gzip",function(){return ug},function(a){return ug=a});var Ce=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],Wd=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],Rh=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,2,3,7],vg=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Jc=Array(576);md(Jc);var Qd=Array(60);md(Qd);var Ed=Array(512);md(Ed);var Gd=Array(256);md(Gd);var De=Array(29);md(De);var Xd=Array(30);md(Xd);var wg=!1;"use strict";var ch=function(a){if(!wg){var c,d,b=Array(16);for(c=d=0;d<28;d++){var g=0;for(De[d]=c;g<1<<Ce[d];g++)Gd[c++]=d}Gd[c-1]=d;for(d=c=0;d<16;d++)for(g=0,Xd[d]=c;g<1<<Wd[d];g++)Ed[c++]=d;for(c>>=7;d<30;d++)for(g=0,Xd[d]=c<<7;g<1<<Wd[d]-7;g++)Ed[256+c++]=d;for(g=0;g<=15;g++)b[g]=
0;for(g=0;g<=143;)Jc[2*g+1]=8,g++,b[8]++;for(;g<=255;)Jc[2*g+1]=9,g++,b[9]++;for(;g<=279;)Jc[2*g+1]=7,g++,b[7]++;for(;g<=287;)Jc[2*g+1]=8,g++,b[8]++;uf(Jc,287,b);for(g=0;g<30;g++)Qd[2*g+1]=5,Qd[2*g]=tf(g,5);ng=new ze(Jc,Ce,257,286,15);og=new ze(Qd,Wd,0,30,15);pg=new ze([],Rh,0,19,7);!0;wg=!0}a.l_desc=new Ae(a.dyn_ltree,ng);a.d_desc=new Ae(a.dyn_dtree,og);a.bl_desc=new Ae(a.bl_tree,pg);a.bi_buf=0;a.bi_valid=0;vf(a)};var ah=function(a,c,d,b){var g,n,f=0;a.level>0?(2===a.strm.data_type&&(a.strm.data_type=
function(e){var k,l=4093624447;for(k=0;k<=31;k++,l>>>=1)if(1&l&&0!==e.dyn_ltree[2*k])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(k=32;k<256;k++)if(0!==e.dyn_ltree[2*k])return 1;return 0}(a)),Ee(a,a.l_desc),Ee(a,a.d_desc),f=function(e){var k;zf(e,e.dyn_ltree,e.l_desc.max_code);zf(e,e.dyn_dtree,e.d_desc.max_code);Ee(e,e.bl_desc);for(k=18;k>=3&&0===e.bl_tree[2*vg[k]+1];k--);return e.opt_len+=3*(k+1)+5+5+4,k}(a),g=a.opt_len+3+7>>>3,(n=a.static_len+3+7>>>3)<=
g&&(g=n)):g=n=d+5;d+4<=g&&-1!==c?Bf(a,c,d,b):4===a.strategy||n===g?(jc(a,2+ +!!b,3),yf(a,Jc,Qd)):(jc(a,4+ +!!b,3),function(e,k,l,h){var m;jc(e,k-257,5);jc(e,l-1,5);jc(e,h-4,4);for(m=0;m<h;m++)jc(e,e.bl_tree[2*vg[m]+1],3);Af(e,e.dyn_ltree,k-1);Af(e,e.dyn_dtree,l-1)}(a,a.l_desc.max_code+1,a.d_desc.max_code+1,f+1),yf(a,a.dyn_ltree,a.dyn_dtree));vf(a);b&&wf(a)};var Qc=function(a,c,d){return a.pending_buf[a.d_buf+2*a.last_lit]=c>>>8&255,a.pending_buf[a.d_buf+2*a.last_lit+1]=255&c,a.pending_buf[a.l_buf+
a.last_lit]=255&d,a.last_lit++,0===c?a.dyn_ltree[2*d]++:(a.matches++,c--,a.dyn_ltree[(Gd[d]+256+1)*2]++,a.dyn_dtree[2*sf(c)]++),a.last_lit===a.lit_bufsize-1};var Sh=function(a){jc(a,2,3);zc(a,256,Jc);16===a.bi_valid?(Fd(a,a.bi_buf),a.bi_buf=0,a.bi_valid=0):a.bi_valid>=8&&(a.pending_buf[a.pending++]=255&a.bi_buf,a.bi_buf>>=8,a.bi_valid-=8)};var nd={};"use strict";nd=function(a,c,d,b){var g=65535&a;a=a>>>16&65535;for(var n;0!==d;){n=d>2E3?2E3:d;d-=n;do a=a+(g=g+c[b++]|0)|0;while(--n);g%=65521;a%=65521}return g|
a<<16};var Pb={},Th=function(){for(var a,c=[],d=0;d<256;d++){a=d;for(var b=0;b<8;b++)a=1&a?3988292384^a>>>1:a>>>1;c[d]=a}return c}();"use strict";Pb=function(a,c,d,b){d=b+d;for(a^=-1;b<d;b++)a=a>>>8^Th[(a^c[b])&255];return-1^a};var ad={};ad={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"};var Id=[new Ac(0,0,0,0,function(a,c){var d=65535;for(65535>a.pending_buf_size-5&&(d=a.pending_buf_size-
5);;){if(a.lookahead<=1){if(bd(a),0===a.lookahead&&0===c)return 1;if(0===a.lookahead)break}a.strstart+=a.lookahead;a.lookahead=0;var b=a.block_start+d;if((0===a.strstart||a.strstart>=b)&&(a.lookahead=a.strstart-b,a.strstart=b,Ub(a,!1),0===a.strm.avail_out)||a.strstart-a.block_start>=a.w_size-262&&(Ub(a,!1),0===a.strm.avail_out))return 1}return(a.insert=0,4===c)?(Ub(a,!0),0===a.strm.avail_out)?3:4:(a.strstart>a.block_start&&(Ub(a,!1),a.strm.avail_out),1)}),new Ac(4,4,8,4,Fe),new Ac(4,5,16,8,Fe),new Ac(4,
6,32,32,Fe),new Ac(4,4,16,16,od),new Ac(8,16,32,32,od),new Ac(8,16,128,128,od),new Ac(8,32,128,256,od),new Ac(32,128,258,1024,od),new Ac(32,258,258,4096,od)];"use strict";var Uh=function(a,c){if(!a||!a.state||c>5||c<0)return a?Nc(a,-2):-2;if(b=a.state,!a.output||!a.input&&0!==a.avail_in||666===b.status&&4!==c)return Nc(a,0===a.avail_out?-5:-2);if(b.strm=a,d=b.last_flush,b.last_flush=c,42===b.status)if(2===b.wrap)a.adler=0,nb(b,31),nb(b,139),nb(b,8),b.gzhead?(nb(b,+!!b.gzhead.text+2*!!b.gzhead.hcrc+
4*!!b.gzhead.extra+8*!!b.gzhead.name+16*!!b.gzhead.comment),nb(b,255&b.gzhead.time),nb(b,b.gzhead.time>>8&255),nb(b,b.gzhead.time>>16&255),nb(b,b.gzhead.time>>24&255),nb(b,9===b.level?2:4*(b.strategy>=2||b.level<2)),nb(b,255&b.gzhead.os),b.gzhead.extra&&b.gzhead.extra.length&&(nb(b,255&b.gzhead.extra.length),nb(b,b.gzhead.extra.length>>8&255)),b.gzhead.hcrc&&(a.adler=Pb(a.adler,b.pending_buf,b.pending,0)),b.gzindex=0,b.status=69):(nb(b,0),nb(b,0),nb(b,0),nb(b,0),nb(b,0),nb(b,9===b.level?2:4*(b.strategy>=
2||b.level<2)),nb(b,3),b.status=113);else{var d,b;var g=8+(b.w_bits-8<<4)<<8;g|=(b.strategy>=2||b.level<2?0:b.level<6?1:6===b.level?2:3)<<6;0!==b.strstart&&(g|=32);b.status=113;Hd(b,g+(31-g%31));0!==b.strstart&&(Hd(b,a.adler>>>16),Hd(b,65535&a.adler));a.adler=1}if(69===b.status)if(b.gzhead.extra){for(g=b.pending;b.gzindex<(65535&b.gzhead.extra.length)&&(b.pending!==b.pending_buf_size||(b.gzhead.hcrc&&b.pending>g&&(a.adler=Pb(a.adler,b.pending_buf,b.pending-g,g)),Pc(a),g=b.pending,b.pending!==b.pending_buf_size));)nb(b,
255&b.gzhead.extra[b.gzindex]),b.gzindex++;b.gzhead.hcrc&&b.pending>g&&(a.adler=Pb(a.adler,b.pending_buf,b.pending-g,g));b.gzindex===b.gzhead.extra.length&&(b.gzindex=0,b.status=73)}else b.status=73;if(73===b.status)if(b.gzhead.name){g=b.pending;do{if(b.pending===b.pending_buf_size&&(b.gzhead.hcrc&&b.pending>g&&(a.adler=Pb(a.adler,b.pending_buf,b.pending-g,g)),Pc(a),g=b.pending,b.pending===b.pending_buf_size)){var n=1;break}n=b.gzindex<b.gzhead.name.length?255&b.gzhead.name.charCodeAt(b.gzindex++):
0;nb(b,n)}while(0!==n);b.gzhead.hcrc&&b.pending>g&&(a.adler=Pb(a.adler,b.pending_buf,b.pending-g,g));0===n&&(b.gzindex=0,b.status=91)}else b.status=91;if(91===b.status)if(b.gzhead.comment){g=b.pending;do{if(b.pending===b.pending_buf_size&&(b.gzhead.hcrc&&b.pending>g&&(a.adler=Pb(a.adler,b.pending_buf,b.pending-g,g)),Pc(a),g=b.pending,b.pending===b.pending_buf_size)){n=1;break}n=b.gzindex<b.gzhead.comment.length?255&b.gzhead.comment.charCodeAt(b.gzindex++):0;nb(b,n)}while(0!==n);b.gzhead.hcrc&&b.pending>
g&&(a.adler=Pb(a.adler,b.pending_buf,b.pending-g,g));0===n&&(b.status=103)}else b.status=103;if(103===b.status&&(b.gzhead.hcrc?(b.pending+2>b.pending_buf_size&&Pc(a),b.pending+2<=b.pending_buf_size&&(nb(b,255&a.adler),nb(b,a.adler>>8&255),a.adler=0,b.status=113)):b.status=113),0!==b.pending){if(Pc(a),0===a.avail_out)return b.last_flush=-1,0}else if(0===a.avail_in&&(c<<1)-9*(c>4)<=(d<<1)-9*(d>4)&&4!==c)return Nc(a,-5);if(666===b.status&&0!==a.avail_in)return Nc(a,-5);if(0!==a.avail_in||0!==b.lookahead||
0!==c&&666!==b.status){d=2===b.strategy?function(f,e){for(var k;;){if(0===f.lookahead&&(bd(f),0===f.lookahead)){if(0===e)return 1;break}if(f.match_length=0,k=Qc(f,0,f.window[f.strstart]),f.lookahead--,f.strstart++,k&&(Ub(f,!1),0===f.strm.avail_out))return 1}return(f.insert=0,4===e)?(Ub(f,!0),0===f.strm.avail_out)?3:4:f.last_lit&&(Ub(f,!1),0===f.strm.avail_out)?1:2}(b,c):3===b.strategy?function(f,e){for(var k,l,h,m,p=f.window;;){if(f.lookahead<=258){if(bd(f),f.lookahead<=258&&0===e)return 1;if(0===
f.lookahead)break}if(f.match_length=0,f.lookahead>=3&&f.strstart>0&&(l=p[h=f.strstart-1])===p[++h]&&l===p[++h]&&l===p[++h]){for(m=f.strstart+258;l===p[++h]&&l===p[++h]&&l===p[++h]&&l===p[++h]&&l===p[++h]&&l===p[++h]&&l===p[++h]&&l===p[++h]&&h<m;);f.match_length=258-(m-h);f.match_length>f.lookahead&&(f.match_length=f.lookahead)}if(f.match_length>=3?(k=Qc(f,1,f.match_length-3),f.lookahead-=f.match_length,f.strstart+=f.match_length,f.match_length=0):(k=Qc(f,0,f.window[f.strstart]),f.lookahead--,f.strstart++),
k&&(Ub(f,!1),0===f.strm.avail_out))return 1}return(f.insert=0,4===e)?(Ub(f,!0),0===f.strm.avail_out)?3:4:f.last_lit&&(Ub(f,!1),0===f.strm.avail_out)?1:2}(b,c):Id[b.level].func(b,c);if((3===d||4===d)&&(b.status=666),1===d||3===d)return 0===a.avail_out&&(b.last_flush=-1),0;if(2===d&&(1===c?Sh(b):5!==c&&(Bf(b,0,0,!1),3===c&&(Oc(b.head),0===b.lookahead&&(b.strstart=0,b.block_start=0,b.insert=0))),Pc(a),0===a.avail_out))return b.last_flush=-1,0}return 4!==c?0:b.wrap<=0?1:(2===b.wrap?(nb(b,255&a.adler),
nb(b,a.adler>>8&255),nb(b,a.adler>>16&255),nb(b,a.adler>>24&255),nb(b,255&a.total_in),nb(b,a.total_in>>8&255),nb(b,a.total_in>>16&255),nb(b,a.total_in>>24&255)):(Hd(b,a.adler>>>16),Hd(b,65535&a.adler)),Pc(a),b.wrap>0&&(b.wrap=-b.wrap),+(0===b.pending))};var Vh=function(a){var c;return a&&a.state?42!==(c=a.state.status)&&69!==c&&73!==c&&91!==c&&103!==c&&113!==c&&666!==c?Nc(a,-2):(a.state=null,113===c?Nc(a,-3):0):-2};var dh=function(a,c){var d,b,g;var n=c.length;if(!a||!a.state||2===(b=(d=a.state).wrap)||
1===b&&42!==d.status||d.lookahead)return-2;1===b&&(a.adler=nd(a.adler,c,n,0));d.wrap=0;n>=d.w_size&&(0===b&&(Oc(d.head),d.strstart=0,d.block_start=0,d.insert=0),g=new Qa.Buf8(d.w_size),Qa.arraySet(g,c,n-d.w_size,d.w_size,0),c=g,n=d.w_size);g=a.avail_in;var f=a.next_in;var e=a.input;a.avail_in=n;a.next_in=0;a.input=c;for(bd(d);d.lookahead>=3;){c=d.strstart;n=d.lookahead-2;do d.ins_h=(d.ins_h<<d.hash_shift^d.window[c+3-1])&d.hash_mask,d.prev[c&d.w_mask]=d.head[d.ins_h],d.head[d.ins_h]=c,c++;while(--n);
d.strstart=c;d.lookahead=2;bd(d)}return d.strstart+=d.lookahead,d.block_start=d.strstart,d.insert=d.lookahead,d.lookahead=0,d.match_length=d.prev_length=2,d.match_available=0,a.next_in=f,a.input=e,a.avail_in=g,d.wrap=b,0};var Ff=!0,Ef=!0;try{String.fromCharCode.apply(null,[0])}catch(a){Ff=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(a){Ef=!1}for(var Rd=new Qa.Buf8(256),Uc=0;Uc<256;Uc++)Rd[Uc]=Uc>=252?6:Uc>=248?5:Uc>=240?4:Uc>=224?3:Uc>=192?2:1;"use strict";Rd[254]=Rd[254]=1;var He=
function(a){var c,d,b,g=a.length,n=0;for(b=0;b<g;b++)(64512&(c=a.charCodeAt(b)))==55296&&b+1<g&&(64512&(d=a.charCodeAt(b+1)))==56320&&(c=65536+(c-55296<<10)+(d-56320),b++),n+=c<128?1:c<2048?2:c<65536?3:4;var f=0;var e=new Qa.Buf8(n);for(b=0;f<n;b++)(64512&(c=a.charCodeAt(b)))==55296&&b+1<g&&(64512&(d=a.charCodeAt(b+1)))==56320&&(c=65536+(c-55296<<10)+(d-56320),b++),c<128?e[f++]=c:(c<2048?e[f++]=192|c>>>6:(c<65536?e[f++]=224|c>>>12:(e[f++]=240|c>>>18,e[f++]=128|c>>>12&63),e[f++]=128|c>>>6&63),e[f++]=
128|63&c);return e};var Wh=function(a){for(var c=new Qa.Buf8(a.length),d=0,b=c.length;d<b;d++)c[d]=a.charCodeAt(d);return c};var Xh=function(a,c){var d,b,g,n=c||a.length,f=Array(2*n);for(c=d=0;c<n;)if((b=a[c++])<128)f[d++]=b;else if((g=Rd[b])>4)f[d++]=65533,c+=g-1;else{for(b&=2===g?31:3===g?15:7;g>1&&c<n;)b=b<<6|63&a[c++],g--;g>1?f[d++]=65533:b<65536?f[d++]=b:(b-=65536,f[d++]=55296|b>>10&1023,f[d++]=56320|1023&b)}return Df(f,d)};var Yh=function(a,c){var d;(c=c||a.length)>a.length&&(c=a.length);for(d=
c-1;d>=0&&(192&a[d])==128;)d--;return d<0||0===d?c:d+Rd[a[d]]>c?d:c};var Ge={};Ge=function(){this.input=null;this.total_in=this.avail_in=this.next_in=0;this.output=null;this.total_out=this.avail_out=this.next_out=0;this.msg="";this.state=null;this.data_type=2;this.adler=0};var Gf=Object.prototype.toString;"use strict";"use strict";cd.prototype.push=function(a,c){var d,b,g=this.strm,n=this.options.chunkSize;if(this.ended)return!1;c=c===~~c?c:4*(!0===c);"string"==typeof a?g.input=He(a):"[object ArrayBuffer]"===
Gf.call(a)?g.input=new Uint8Array(a):g.input=a;g.next_in=0;g.avail_in=g.input.length;do{if(0===g.avail_out&&(g.output=new Qa.Buf8(n),g.next_out=0,g.avail_out=n),1!==(b=Uh(g,c))&&0!==b)return this.onEnd(b),this.ended=!0,!1;(0===g.avail_out||0===g.avail_in&&(4===c||2===c))&&("string"===this.options.to?this.onData(Df(d=Qa.shrinkBuf(g.output,g.next_out),d.length)):this.onData(Qa.shrinkBuf(g.output,g.next_out)))}while((g.avail_in>0||0===g.avail_out)&&1!==b);return 4===c?(b=Vh(this.strm),this.onEnd(b),
this.ended=!0,0===b):(2===c&&(this.onEnd(0),g.avail_out=0),!0)};cd.prototype.onData=function(a){this.chunks.push(a)};cd.prototype.onEnd=function(a){0===a&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=Qa.flattenChunks(this.chunks));this.chunks=[];this.err=a;this.msg=this.strm.msg};var rg=cd;var sg=Ie;var tg=function(a,c){return(c=c||{}).raw=!0,Ie(a,c)};var ug=function(a,c){return(c=c||{}).gzip=!0,Ie(a,c)};var Sd={};"use strict";Lc(Sd,"Inflate",function(){return xg},function(a){return xg=
a});Lc(Sd,"inflate",function(){return yg},function(a){return yg=a});Lc(Sd,"inflateRaw",function(){return zg},function(a){return zg=a});Lc(Sd,"ungzip",function(){return Ag},function(a){return Ag=a});var Bg={};"use strict";Bg=function(a,c){var d,b,g,n;var f=a.state;var e=a.next_in;var k=a.input;var l=e+(a.avail_in-5);var h=a.next_out;var m=a.output;c=h-(c-a.avail_out);var p=h+(a.avail_out-257);var q=f.dmax;var r=f.wsize;var u=f.whave;var v=f.wnext;var y=f.window;var C=f.hold;var w=f.bits;var D=f.lencode;
var x=f.distcode;var G=(1<<f.lenbits)-1;var H=(1<<f.distbits)-1;a:do for(w<15&&(C+=k[e++]<<w,w+=8,C+=k[e++]<<w,w+=8),d=D[C&G];;){if(C>>>=b=d>>>24,w-=b,0==(b=d>>>16&255))m[h++]=65535&d;else if(16&b){var N=65535&d;(b&=15)&&(w<b&&(C+=k[e++]<<w,w+=8),N+=C&(1<<b)-1,C>>>=b,w-=b);w<15&&(C+=k[e++]<<w,w+=8,C+=k[e++]<<w,w+=8);for(d=x[C&H];;){if(C>>>=b=d>>>24,w-=b,16&(b=d>>>16&255)){if(g=65535&d,w<(b&=15)&&(C+=k[e++]<<w,(w+=8)<b&&(C+=k[e++]<<w,w+=8)),(g+=C&(1<<b)-1)>q){a.msg="invalid distance too far back";
f.mode=30;break a}if(C>>>=b,w-=b,g>(b=h-c)){if((b=g-b)>u&&f.sane){a.msg="invalid distance too far back";f.mode=30;break a}if(d=0,n=y,0===v){if(d+=r-b,b<N){N-=b;do m[h++]=y[d++];while(--b);d=h-g;n=m}}else if(v<b){if(d+=r+v-b,(b-=v)<N){N-=b;do m[h++]=y[d++];while(--b);if(d=0,v<N){N-=b=v;do m[h++]=y[d++];while(--b);d=h-g;n=m}}}else if(d+=v-b,b<N){N-=b;do m[h++]=y[d++];while(--b);d=h-g;n=m}for(;N>2;)m[h++]=n[d++],m[h++]=n[d++],m[h++]=n[d++],N-=3;N&&(m[h++]=n[d++],N>1&&(m[h++]=n[d++]))}else{d=h-g;do m[h++]=
m[d++],m[h++]=m[d++],m[h++]=m[d++],N-=3;while(N>2);N&&(m[h++]=m[d++],N>1&&(m[h++]=m[d++]))}}else if((64&b)==0){d=x[(65535&d)+(C&(1<<b)-1)];continue}else{a.msg="invalid distance code";f.mode=30;break a}break}}else if((64&b)==0){d=D[(65535&d)+(C&(1<<b)-1)];continue}else{32&b?f.mode=12:(a.msg="invalid literal/length code",f.mode=30);break a}break}while(e<l&&h<p);e-=N=w>>3;w-=N<<3;a.next_in=e;a.next_out=h;a.avail_in=e<l?5+(l-e):5-(e-l);a.avail_out=h<p?257+(p-h):257-(h-p);f.hold=C&(1<<w)-1;f.bits=w};var xd=
{},Zh=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],$h=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],ai=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],bi=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];xd=function(a,c,d,b,g,n,f,e){var k,l,h,m,p,q,r=e.bits,u,v,y,C,w,D=0,x,G=null,H=0,N=
new Qa.Buf16(16);var B=new Qa.Buf16(16);var P=null,V=0;for(u=0;u<=15;u++)N[u]=0;for(v=0;v<b;v++)N[c[d+v]]++;var L=15;for(y=r;L>=1&&0===N[L];L--);if(y>L&&(y=L),0===L)return g[n++]=20971520,g[n++]=20971520,e.bits=1,0;for(r=1;r<L&&0===N[r];r++);y<r&&(y=r);for(u=k=1;u<=15;u++)if(k<<=1,(k-=N[u])<0)return-1;if(k>0&&(0===a||1!==L))return-1;u=1;for(B[1]=0;u<15;u++)B[u+1]=B[u]+N[u];for(v=0;v<b;v++)0!==c[d+v]&&(f[B[c[d+v]]++]=v);if(0===a?(G=P=f,m=19):1===a?(G=Zh,H-=257,P=$h,V-=257,m=256):(G=ai,P=bi,m=-1),x=
0,v=0,u=r,B=n,C=y,w=0,h=-1,b=(D=1<<y)-1,1===a&&D>852||2===a&&D>592)return 1;for(;;){var ia=u-w;f[v]<m?(p=0,q=f[v]):f[v]>m?(p=P[V+f[v]],q=G[H+f[v]]):(p=96,q=0);k=1<<u-w;r=l=1<<C;do g[B+(x>>w)+(l-=k)]=ia<<24|p<<16|q;while(0!==l);for(k=1<<u-1;x&k;)k>>=1;if(0!==k?(x&=k-1,x+=k):x=0,v++,0==--N[u]){if(u===L)break;u=c[d+f[v]]}if(u>y&&(x&b)!==h){0===w&&(w=y);B+=r;for(k=1<<(C=u-w);C+w<L&&!((k-=N[C+w])<=0);)C++,k<<=1;if(D+=1<<C,1===a&&D>852||2===a&&D>592)return 1;g[h=x&b]=y<<24|C<<16|B-n}}return 0!==x&&(g[B+
x]=u-w<<24|4194304),e.bits=y,0};var Cg=!0;"use strict";var ci=function(a,c){var d,b,g,n,f,e,k,l,h=0,m=new Qa.Buf8(4),p=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!a||!a.state||!a.output||!a.input&&0!==a.avail_in)return-2;12===(d=a.state).mode&&(d.mode=13);var q=a.next_out;var r=a.output;var u=a.avail_out;var v=a.next_in;var y=a.input;var C=a.avail_in;var w=d.hold;var D=d.bits;var x=C;var G=u;var H=0;a:for(;;)switch(d.mode){case 1:if(0===d.wrap){d.mode=13;break}for(;D<16;){if(0===C)break a;
C--;w+=y[v++]<<D;D+=8}if(2&d.wrap&&35615===w){d.check=0;m[0]=255&w;m[1]=w>>>8&255;d.check=Pb(d.check,m,2,0);D=w=0;d.mode=2;break}if(d.flags=0,d.head&&(d.head.done=!1),!(1&d.wrap)||(((255&w)<<8)+(w>>8))%31){a.msg="incorrect header check";d.mode=30;break}if((15&w)!=8){a.msg="unknown compression method";d.mode=30;break}if(w>>>=4,D-=4,k=(15&w)+8,0===d.wbits)d.wbits=k;else if(k>d.wbits){a.msg="invalid window size";d.mode=30;break}d.dmax=1<<k;a.adler=d.check=1;d.mode=512&w?10:12;D=w=0;break;case 2:for(;D<
16;){if(0===C)break a;C--;w+=y[v++]<<D;D+=8}if(d.flags=w,(255&d.flags)!=8){a.msg="unknown compression method";d.mode=30;break}if(57344&d.flags){a.msg="unknown header flags set";d.mode=30;break}d.head&&(d.head.text=w>>8&1);512&d.flags&&(m[0]=255&w,m[1]=w>>>8&255,d.check=Pb(d.check,m,2,0));D=w=0;d.mode=3;case 3:for(;D<32;){if(0===C)break a;C--;w+=y[v++]<<D;D+=8}d.head&&(d.head.time=w);512&d.flags&&(m[0]=255&w,m[1]=w>>>8&255,m[2]=w>>>16&255,m[3]=w>>>24&255,d.check=Pb(d.check,m,4,0));D=w=0;d.mode=4;case 4:for(;D<
16;){if(0===C)break a;C--;w+=y[v++]<<D;D+=8}d.head&&(d.head.xflags=255&w,d.head.os=w>>8);512&d.flags&&(m[0]=255&w,m[1]=w>>>8&255,d.check=Pb(d.check,m,2,0));D=w=0;d.mode=5;case 5:if(1024&d.flags){for(;D<16;){if(0===C)break a;C--;w+=y[v++]<<D;D+=8}d.length=w;d.head&&(d.head.extra_len=w);512&d.flags&&(m[0]=255&w,m[1]=w>>>8&255,d.check=Pb(d.check,m,2,0));D=w=0}else d.head&&(d.head.extra=null);d.mode=6;case 6:if(1024&d.flags&&((b=d.length)>C&&(b=C),b&&(d.head&&(k=d.head.extra_len-d.length,d.head.extra||
(d.head.extra=Array(d.head.extra_len)),Qa.arraySet(d.head.extra,y,v,b,k)),512&d.flags&&(d.check=Pb(d.check,y,b,v)),C-=b,v+=b,d.length-=b),d.length))break a;d.length=0;d.mode=7;case 7:if(2048&d.flags){if(0===C)break a;b=0;do k=y[v+b++],d.head&&k&&d.length<65536&&(d.head.name+=String.fromCharCode(k));while(k&&b<C);if(512&d.flags&&(d.check=Pb(d.check,y,b,v)),C-=b,v+=b,k)break a}else d.head&&(d.head.name=null);d.length=0;d.mode=8;case 8:if(4096&d.flags){if(0===C)break a;b=0;do k=y[v+b++],d.head&&k&&d.length<
65536&&(d.head.comment+=String.fromCharCode(k));while(k&&b<C);if(512&d.flags&&(d.check=Pb(d.check,y,b,v)),C-=b,v+=b,k)break a}else d.head&&(d.head.comment=null);d.mode=9;case 9:if(512&d.flags){for(;D<16;){if(0===C)break a;C--;w+=y[v++]<<D;D+=8}if(w!==(65535&d.check)){a.msg="header crc mismatch";d.mode=30;break}D=w=0}d.head&&(d.head.hcrc=d.flags>>9&1,d.head.done=!0);a.adler=d.check=0;d.mode=12;break;case 10:for(;D<32;){if(0===C)break a;C--;w+=y[v++]<<D;D+=8}a.adler=d.check=Hf(w);D=w=0;d.mode=11;case 11:if(0===
d.havedict)return a.next_out=q,a.avail_out=u,a.next_in=v,a.avail_in=C,d.hold=w,d.bits=D,2;a.adler=d.check=1;d.mode=12;case 12:if(5===c||6===c)break a;case 13:if(d.last){w>>>=7&D;D-=7&D;d.mode=27;break}for(;D<3;){if(0===C)break a;C--;w+=y[v++]<<D;D+=8}switch(d.last=1&w,--D,3&(w>>>=1)){case 0:d.mode=14;break;case 1:var N=d;if(Cg){cf=new Qa.Buf32(512);df=new Qa.Buf32(32);for(n=0;n<144;)N.lens[n++]=8;for(;n<256;)N.lens[n++]=9;for(;n<280;)N.lens[n++]=7;for(;n<288;)N.lens[n++]=8;xd(1,N.lens,0,288,cf,0,
N.work,{bits:9});for(n=0;n<32;)N.lens[n++]=5;xd(2,N.lens,0,32,df,0,N.work,{bits:5});Cg=!1}N.lencode=cf;N.lenbits=9;N.distcode=df;N.distbits=5;if(!0,d.mode=20,6===c){w>>>=2;D-=2;break a}break;case 2:d.mode=17;break;case 3:a.msg="invalid block type",d.mode=30}w>>>=2;D-=2;break;case 14:w>>>=7&D;for(D-=7&D;D<32;){if(0===C)break a;C--;w+=y[v++]<<D;D+=8}if((65535&w)!=(w>>>16^65535)){a.msg="invalid stored block lengths";d.mode=30;break}if(d.length=65535&w,w=0,D=0,d.mode=15,6===c)break a;case 15:d.mode=16;
case 16:if(b=d.length){if(b>C&&(b=C),b>u&&(b=u),0===b)break a;Qa.arraySet(r,y,v,b,q);C-=b;v+=b;u-=b;q+=b;d.length-=b;break}d.mode=12;break;case 17:for(;D<14;){if(0===C)break a;C--;w+=y[v++]<<D;D+=8}if(d.nlen=(31&w)+257,D-=5,d.ndist=(31&(w>>>=5))+1,D-=5,d.ncode=(15&(w>>>=5))+4,w>>>=4,D-=4,d.nlen>286||d.ndist>30){a.msg="too many length or distance symbols";d.mode=30;break}d.have=0;d.mode=18;case 18:for(;d.have<d.ncode;){for(;D<3;){if(0===C)break a;C--;w+=y[v++]<<D;D+=8}d.lens[p[d.have++]]=7&w;w>>>=
3;D-=3}for(;d.have<19;)d.lens[p[d.have++]]=0;if(d.lencode=d.lendyn,d.lenbits=7,l={bits:d.lenbits},H=xd(0,d.lens,0,19,d.lencode,0,d.work,l),d.lenbits=l.bits,H){a.msg="invalid code lengths set";d.mode=30;break}d.have=0;d.mode=19;case 19:for(;d.have<d.nlen+d.ndist;){for(;f=(h=d.lencode[w&(1<<d.lenbits)-1])>>>24,N=65535&h,!(f<=D);){if(0===C)break a;C--;w+=y[v++]<<D;D+=8}if(N<16)w>>>=f,D-=f,d.lens[d.have++]=N;else{if(16===N){for(n=f+2;D<n;){if(0===C)break a;C--;w+=y[v++]<<D;D+=8}if(w>>>=f,D-=f,0===d.have){a.msg=
"invalid bit length repeat";d.mode=30;break}k=d.lens[d.have-1];b=3+(3&w);w>>>=2;D-=2}else if(17===N){for(n=f+3;D<n;){if(0===C)break a;C--;w+=y[v++]<<D;D+=8}w>>>=f;D-=f;k=0;b=3+(7&w);w>>>=3;D-=3}else{for(n=f+7;D<n;){if(0===C)break a;C--;w+=y[v++]<<D;D+=8}w>>>=f;D-=f;k=0;b=11+(127&w);w>>>=7;D-=7}if(d.have+b>d.nlen+d.ndist){a.msg="invalid bit length repeat";d.mode=30;break}for(;b--;)d.lens[d.have++]=k}}if(30===d.mode)break;if(0===d.lens[256]){a.msg="invalid code -- missing end-of-block";d.mode=30;break}if(d.lenbits=
9,l={bits:d.lenbits},H=xd(1,d.lens,0,d.nlen,d.lencode,0,d.work,l),d.lenbits=l.bits,H){a.msg="invalid literal/lengths set";d.mode=30;break}if(d.distbits=6,d.distcode=d.distdyn,l={bits:d.distbits},H=xd(2,d.lens,d.nlen,d.ndist,d.distcode,0,d.work,l),d.distbits=l.bits,H){a.msg="invalid distances set";d.mode=30;break}if(d.mode=20,6===c)break a;case 20:d.mode=21;case 21:if(C>=6&&u>=258){a.next_out=q;a.avail_out=u;a.next_in=v;a.avail_in=C;d.hold=w;d.bits=D;Bg(a,G);q=a.next_out;r=a.output;u=a.avail_out;v=
a.next_in;y=a.input;C=a.avail_in;w=d.hold;D=d.bits;12===d.mode&&(d.back=-1);break}for(d.back=0;f=(h=d.lencode[w&(1<<d.lenbits)-1])>>>24,n=h>>>16&255,N=65535&h,!(f<=D);){if(0===C)break a;C--;w+=y[v++]<<D;D+=8}if(n&&(240&n)==0){var B=f;var P=n;for(e=N;f=(h=d.lencode[e+((w&(1<<B+P)-1)>>B)])>>>24,n=h>>>16&255,N=65535&h,!(B+f<=D);){if(0===C)break a;C--;w+=y[v++]<<D;D+=8}w>>>=B;D-=B;d.back+=B}if(w>>>=f,D-=f,d.back+=f,d.length=N,0===n){d.mode=26;break}if(32&n){d.back=-1;d.mode=12;break}if(64&n){a.msg="invalid literal/length code";
d.mode=30;break}d.extra=15&n;d.mode=22;case 22:if(d.extra){for(n=d.extra;D<n;){if(0===C)break a;C--;w+=y[v++]<<D;D+=8}d.length+=w&(1<<d.extra)-1;w>>>=d.extra;D-=d.extra;d.back+=d.extra}d.was=d.length;d.mode=23;case 23:for(;f=(h=d.distcode[w&(1<<d.distbits)-1])>>>24,n=h>>>16&255,N=65535&h,!(f<=D);){if(0===C)break a;C--;w+=y[v++]<<D;D+=8}if((240&n)==0){B=f;P=n;for(e=N;f=(h=d.distcode[e+((w&(1<<B+P)-1)>>B)])>>>24,n=h>>>16&255,N=65535&h,!(B+f<=D);){if(0===C)break a;C--;w+=y[v++]<<D;D+=8}w>>>=B;D-=B;d.back+=
B}if(w>>>=f,D-=f,d.back+=f,64&n){a.msg="invalid distance code";d.mode=30;break}d.offset=N;d.extra=15&n;d.mode=24;case 24:if(d.extra){for(n=d.extra;D<n;){if(0===C)break a;C--;w+=y[v++]<<D;D+=8}d.offset+=w&(1<<d.extra)-1;w>>>=d.extra;D-=d.extra;d.back+=d.extra}if(d.offset>d.dmax){a.msg="invalid distance too far back";d.mode=30;break}d.mode=25;case 25:if(0===u)break a;if(b=G-u,d.offset>b){if((b=d.offset-b)>d.whave&&d.sane){a.msg="invalid distance too far back";d.mode=30;break}b>d.wnext?(b-=d.wnext,g=
d.wsize-b):g=d.wnext-b;b>d.length&&(b=d.length);n=d.window}else n=r,g=q-d.offset,b=d.length;b>u&&(b=u);u-=b;d.length-=b;do r[q++]=n[g++];while(--b);0===d.length&&(d.mode=21);break;case 26:if(0===u)break a;r[q++]=d.length;u--;d.mode=21;break;case 27:if(d.wrap){for(;D<32;){if(0===C)break a;C--;w|=y[v++]<<D;D+=8}if(G-=u,a.total_out+=G,d.total+=G,G&&(a.adler=d.check=d.flags?Pb(d.check,r,G,q-G):nd(d.check,r,G,q-G)),G=u,(d.flags?w:Hf(w))!==d.check){a.msg="incorrect data check";d.mode=30;break}D=w=0}d.mode=
28;case 28:if(d.wrap&&d.flags){for(;D<32;){if(0===C)break a;C--;w+=y[v++]<<D;D+=8}if(w!==(0|d.total)){a.msg="incorrect length check";d.mode=30;break}D=w=0}d.mode=29;case 29:H=1;break a;case 30:H=-3;break a;case 31:return-4;default:return-2}return(a.next_out=q,a.avail_out=u,a.next_in=v,a.avail_in=C,d.hold=w,d.bits=D,(d.wsize||G!==a.avail_out&&d.mode<30&&(d.mode<27||4!==c))&&If(a,a.output,a.next_out,G-a.avail_out))?(d.mode=31,-4):(x-=a.avail_in,G-=a.avail_out,a.total_in+=x,a.total_out+=G,d.total+=G,
d.wrap&&G&&(a.adler=d.check=d.flags?Pb(d.check,r,G,a.next_out-G):nd(d.check,r,G,a.next_out-G)),a.data_type=d.bits+64*!!d.last+128*(12===d.mode)+256*(20===d.mode||15===d.mode),(0===x&&0===G||4===c)&&0===H&&(H=-5),H)};var di=function(a){if(!a||!a.state)return-2;var c=a.state;return c.window&&(c.window=null),a.state=null,0};var fh=function(a,c){var d;return a&&a.state&&(2&(d=a.state).wrap)!=0?(d.head=c,c.done=!1,0):-2};var Lf=function(a,c){var d,b=c.length;return a&&a.state&&(0===(d=a.state).wrap||11===
d.mode)?11===d.mode&&nd(1,c,b,0)!==d.check?-3:If(a,c,b,b)?(d.mode=31,-4):(d.havedict=1,0):-2};var Gb={};"use strict";Gb={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};
var Jf={};Jf=function(){this.os=this.xflags=this.time=this.text=0;this.extra=null;this.extra_len=0;this.comment=this.name="";this.hcrc=0;this.done=!1};var Kf=Object.prototype.toString;dd.prototype.push=function(a,c){var d,b,g,n,f=this.strm,e=this.options.chunkSize,k=this.options.dictionary,l=!1;if(this.ended)return!1;c=c===~~c?c:!0===c?Gb.Z_FINISH:Gb.Z_NO_FLUSH;"string"==typeof a?f.input=Wh(a):"[object ArrayBuffer]"===Kf.call(a)?f.input=new Uint8Array(a):f.input=a;f.next_in=0;f.avail_in=f.input.length;
do{if(0===f.avail_out&&(f.output=new Qa.Buf8(e),f.next_out=0,f.avail_out=e),(d=ci(f,Gb.Z_NO_FLUSH))===Gb.Z_NEED_DICT&&k&&(d=Lf(this.strm,k)),d===Gb.Z_BUF_ERROR&&!0===l&&(d=Gb.Z_OK,l=!1),d!==Gb.Z_STREAM_END&&d!==Gb.Z_OK)return this.onEnd(d),this.ended=!0,!1;f.next_out&&(0===f.avail_out||d===Gb.Z_STREAM_END||0===f.avail_in&&(c===Gb.Z_FINISH||c===Gb.Z_SYNC_FLUSH))&&("string"===this.options.to?(b=Yh(f.output,f.next_out),g=f.next_out-b,n=Xh(f.output,b),f.next_out=g,f.avail_out=e-g,g&&Qa.arraySet(f.output,
f.output,b,g,0),this.onData(n)):this.onData(Qa.shrinkBuf(f.output,f.next_out)));0===f.avail_in&&0===f.avail_out&&(l=!0)}while((f.avail_in>0||0===f.avail_out)&&d!==Gb.Z_STREAM_END);return(d===Gb.Z_STREAM_END&&(c=Gb.Z_FINISH),c===Gb.Z_FINISH)?(d=di(this.strm),this.onEnd(d),this.ended=!0,d===Gb.Z_OK):(c===Gb.Z_SYNC_FLUSH&&(this.onEnd(Gb.Z_OK),f.avail_out=0),!0)};dd.prototype.onData=function(a){this.chunks.push(a)};dd.prototype.onEnd=function(a){a===Gb.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):
this.result=Qa.flattenChunks(this.chunks));this.chunks=[];this.err=a;this.msg=this.strm.msg};var xg=dd;var yg=Je;var zg=function(a,c){return(c=c||{}).raw=!0,Je(a,c)};var Ag=Je;var Dg={};Qh(Dg,Pd,Sd,Gb);Me=Dg;Ke.FIXED_HEADER_LENGTH=16;Yd.HEADER_LENGTH=8;class Eg{readFixedHeader(a){this.payloadOffset=a.readU32BE();this.blendMode=a.readU32BE();this.alpha=a.readU32BE();let c=a.readU32BE();this.visible=(1&c)!=0;this.clip=(2&c)!=0;this.hasMask=(4&c)!=0;this.maskLinked=(8&c)!=0;this.maskVisible=(16&c)!=
0;this.expanded=(32&c)!=0;this.lockAlpha=(64&c)!=0;this.blendMode===R.LM_MULTIPLY&&(128&c)!=0&&(this.blendMode=R.LM_MULTIPLY2);this.nameLength=a.readU32BE()}getFixedHeaderLen(){return 20}getVariableHeaderLen(){return this.nameLength}readVariableSizeHeader(a){a=a.readString(this.nameLength);let c=new Uint8Array(a.length);for(let d=0;d<a.length;d++)c[d]=255&a.charCodeAt(d);try{this.name=(new TextDecoder("utf-8")).decode(c)}catch(d){this.name=a}}decode(a){for(var c;;){if(this.skipBytes>0){if(this.skipBytes>=
a.length)return this.skipBytes-=a.length,null;a=a.subarray(this.skipBytes);this.skipBytes=0}switch(this.state){case 0:if(a.length<this.getFixedHeaderLen())break;c=new ib(a);this.readFixedHeader(c);a=a.subarray(c.pos);this.state=1;continue;case 1:if(a.length<this.getVariableHeaderLen())break;c=new ib(a);this.readVariableSizeHeader(c);this.layer=this.createLayer();this.hasMask&&(this.layer.setMask(new Na(this.width,this.height,8)),this.maskDecoder=new ei(this.layer.mask));this.layer instanceof Da&&
(this.colorDecoder=new fi(this.layer.image));this.skipBytes=this.payloadOffset-this.getFixedHeaderLen();this.colorDecoder?this.state=3:this.maskDecoder?this.state=4:this.state=5;continue;case 3:if(a=this.colorDecoder.decode(a),this.colorDecoder.done){this.maskDecoder?this.state=4:this.state=5;continue}break;case 4:if(a=this.maskDecoder.decode(a),this.maskDecoder.done){this.state=5;continue}break;case 5:c=this.payloadOffset;this.colorDecoder&&(c+=this.colorDecoder.bytesTotal);this.maskDecoder&&(c+=
this.maskDecoder.bytesTotal);this.state=6;this.skipBytes=this.chunkHeader.chunkSize-c;continue;case 6:this.done=!0}break}return a}constructor(a,c,d){this.chunkHeader=a;this.width=c;this.height=d;this.nameLength=this.skipBytes=this.payloadOffset=this.state=0;this.done=!1;this.maskDecoder=this.colorDecoder=null}}class gh extends Eg{createLayer(){let a=new Da(this.width,this.height,this.name);return a.setBlendMode(this.blendMode),a.setAlpha(this.alpha),a.setVisible(this.visible),a.setClip(this.clip),
a.setMaskLinked(this.maskLinked),a.setMaskVisible(this.maskVisible),a.setLockAlpha(this.lockAlpha),a}}class hh extends Eg{readFixedHeader(a){super.readFixedHeader.call(this,a);this.childLayers=a.readU32BE()}getFixedHeaderLen(){return super.getFixedHeaderLen.call(this)+4}createLayer(){let a=new cb(this.name,this.blendMode);return a.setAlpha(this.alpha),a.setVisible(this.visible),a.setExpanded(this.expanded),a.setMaskLinked(this.maskLinked),a.setMaskVisible(this.maskVisible),a}constructor(a,c,d){super(a,
c,d);this.childLayers=0}}class fi{decode(a){if(null==a)return null;var c=this.bytesRead%I.BYTES_PER_PIXEL,d=this.bytesRead-c;let b=0,g=[I.ALPHA_BYTE_OFFSET,I.RED_BYTE_OFFSET,I.GREEN_BYTE_OFFSET,I.BLUE_BYTE_OFFSET];for(;c<I.BYTES_PER_PIXEL&&b<a.length;c++)this.output[d+g[c]]=a[b],b++;this.bytesRead+=b;var n=0|Math.min(a.length-b,this.bytesTotal-this.bytesRead);c=n/I.BYTES_PER_PIXEL|0;n%=I.BYTES_PER_PIXEL;for(d=0;d<c;d++)this.output[this.bytesRead+I.ALPHA_BYTE_OFFSET]=a[b],this.output[this.bytesRead+
I.RED_BYTE_OFFSET]=a[b+1],this.output[this.bytesRead+I.GREEN_BYTE_OFFSET]=a[b+2],this.output[this.bytesRead+I.BLUE_BYTE_OFFSET]=a[b+3],this.bytesRead+=I.BYTES_PER_PIXEL,b+=I.BYTES_PER_PIXEL;c=0;for(d=this.bytesRead;c<n;c++)this.output[d+g[c]]=a[b],b++;return(this.bytesRead+=n,this.bytesRead>=this.bytesTotal&&(this.done=!0),b<a.length)?a.subarray(b):null}constructor(a){this.bytesRead=0;this.bytesTotal=a.width*a.height*I.BYTES_PER_PIXEL;this.output=a.data;this.done=!1}}class ei{decode(a){if(null==a)return null;
let c=0|Math.min(a.length,this.bytesTotal-this.bytesRead),d=this.bytesRead,b;for(b=0;b<c;b++,d++)this.output[d]=a[b];return(this.bytesRead=d,this.bytesRead>=this.bytesTotal&&(this.done=!0),b<a.length)?a.subarray(b):null}constructor(a){this.bytesRead=0;this.bytesTotal=a.width*a.height;this.output=a.data;this.done=!1}}pd.prototype.read=function(a){if(null==a)return null;var c=new ib(new Uint8Array(a)),d=[];if(1!=c.readU16BE())return null;a=c.readU16BE();for(var b=0;b<a;b++)if(0==c.readU16BE()){var g=
255*c.readU16BE()/65535,n=255*c.readU16BE()/65535,f=255*c.readU16BE()/65535;c.readU16BE();d.push(g<<16|n<<8|f)}return d};pd.prototype.write=function(a){var c=new ib(new Uint8Array(4+10*a.length));c.writeU16BE(1);c.writeU16BE(a.length);for(var d=0;d<a.length;d++){var b=a[d];c.writeU16BE(0);c.writeU16BE((b>>16&255)*257);c.writeU16BE((b>>8&255)*257);c.writeU16BE((255&b)*257);c.writeU16BE(0)}return c.getAsDataArray()};Jd.prototype=Object.create(Ga(Jb).prototype);Jd.prototype.constructor=Jd;var ce={};
"use strict";"use strict";var Fg=function(){function a(f,e,k){var l=new XMLHttpRequest;l.open("GET",f);l.responseType="blob";l.onload=function(){n(l.response,e,k)};l.onerror=function(){console.error("could not download file")};l.send()}function c(f){var e=new XMLHttpRequest;e.open("HEAD",f,!1);try{e.send()}catch(k){}return 200<=e.status&&299>=e.status}function d(f){try{f.dispatchEvent(new MouseEvent("click"))}catch(k){var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,
0,0,0,80,20,!1,!1,!1,!1,0,null);f.dispatchEvent(e)}}var b="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof Tc&&Tc.global===Tc?Tc:void 0,g=b.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),n=b.saveAs||("object"!=typeof window||window!==b?function(){}:"download"in HTMLAnchorElement.prototype&&!g?function(f,e,k){var l=b.URL||b.webkitURL,h=document.createElement("a");
h.download=e=e||f.name||"download";h.rel="noopener";"string"==typeof f?(h.href=f,h.origin===location.origin?d(h):c(h.href)?a(f,e,k):d(h,h.target="_blank")):(h.href=l.createObjectURL(f),setTimeout(function(){l.revokeObjectURL(h.href)},4E4),setTimeout(function(){d(h)},0))}:"msSaveOrOpenBlob"in navigator?function(f,e,k){if(e=e||f.name||"download","string"!=typeof f){var l;navigator.msSaveOrOpenBlob((void 0===(l=k)?l={autoBom:!1}:"object"!=typeof l&&(console.warn("Deprecated: Expected third argument to be a object"),
l={autoBom:!l}),l.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(f.type)?new Blob(["\ufeff",f],{type:f.type}):f),e)}else if(c(f))a(f,e,k);else{var h=document.createElement("a");h.href=f;h.target="_blank";setTimeout(function(){d(h)})}}:function(f,e,k,l){if((l=l||open("","_blank"))&&(l.document.title=l.document.body.innerText="downloading..."),"string"==typeof f)return a(f,e,k);e="application/octet-stream"===f.type;k=/constructor/i.test(b.HTMLElement)||b.safari;
var h=/CriOS\/[\d]+/.test(navigator.userAgent);if((h||e&&k||g)&&"u">typeof FileReader){var m=new FileReader;m.onloadend=function(){var r=m.result;r=h?r:r.replace(/^data:[^;]*;/,"data:attachment/file;");l?l.location.href=r:location=r;l=null};m.readAsDataURL(f)}else{var p=b.URL||b.webkitURL,q=p.createObjectURL(f);l?l.location=q:location.href=q;l=null;setTimeout(function(){p.revokeObjectURL(q)},4E4)}});ce=b.saveAs=n.saveAs=n};"function"==typeof define&&define.amd?define([],Fg):Fg();var cg={};var Uf=
function(a){for(var c,d=a.length,b=d%3,g=[],n=0,f=d-b;n<f;n+=16383){for(var e=g,k=e.push,l,h=a,m=n+16383>f?f:n+16383,p=[],q=n;q<m;q+=3)l=(h[q]<<16&16711680)+(h[q+1]<<8&65280)+(255&h[q+2]),p.push(Dc[l>>18&63]+Dc[l>>12&63]+Dc[l>>6&63]+Dc[63&l]);l=p.join("");k.call(e,l)}return 1===b?g.push(Dc[(c=a[d-1])>>2]+Dc[c<<4&63]+"=="):2===b&&g.push(Dc[(c=(a[d-2]<<8)+a[d-1])>>10]+Dc[c>>4&63]+Dc[c<<2&63]+"="),g.join("")};for(var Dc=[],rc=[],kh="u">typeof Uint8Array?Uint8Array:Array,yd=0;yd<64;++yd)Dc[yd]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[yd],
rc["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(yd)]=yd;rc[45]=62;rc[95]=63;var se=function(a,c,d,b,g){var n=8*g-b-1;var f=(1<<n)-1,e=f>>1,k=-7;g=d?g-1:0;var l=d?-1:1,h=a[c+g];g+=l;d=h&(1<<-k)-1;h>>=-k;for(k+=n;k>0;d=256*d+a[c+g],g+=l,k-=8);n=d&(1<<-k)-1;d>>=-k;for(k+=b;k>0;n=256*n+a[c+g],g+=l,k-=8);if(0===d)d=1-e;else{if(d===f)return n?NaN:1/0*(h?-1:1);n+=Math.pow(2,b);d-=e}return(h?-1:1)*n*Math.pow(2,d-b)};var Yf=function(a,c,d,b,g,n){var f,e,k,l=8*n-g-1,h=(1<<l)-
1,m=h>>1,p=5.960464477539062E-8*(23===g);n=b?0:n-1;b=b?1:-1;var q=+(c<0||0===c&&1/c<0);for(isNaN(c=Math.abs(c))||c===1/0?(e=+!!isNaN(c),f=h):(f=Math.floor(Math.log(c)/Math.LN2),c*(k=Math.pow(2,-f))<1&&(f--,k*=2),f+m>=1?c+=p/k:c+=p*Math.pow(2,1-m),c*k>=2&&(f++,k/=2),f+m>=h?(e=0,f=h):f+m>=1?(e=(c*k-1)*Math.pow(2,g),f+=m):(e=c*Math.pow(2,m-1)*Math.pow(2,g),f=0));g>=8;a[d+n]=255&e,n+=b,e/=256,g-=8);f=f<<g|e;for(l+=g;l>0;a[d+n]=255&f,n+=b,f/=256,l-=8);a[d+n-b]|=128*q};var Gg="function"==typeof Symbol&&
"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;oa.TYPED_ARRAY_SUPPORT=function(){try{var a=new Uint8Array(1),c={foo:function(){return 42}};return Object.setPrototypeOf(c,Uint8Array.prototype),Object.setPrototypeOf(a,c),42===a.foo()}catch(d){return!1}}();!oa.TYPED_ARRAY_SUPPORT&&"u">typeof console&&"function"==typeof console.error&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");
Object.defineProperty(oa.prototype,"parent",{enumerable:!0,get:function(){if(oa.isBuffer(this))return this.buffer}});Object.defineProperty(oa.prototype,"offset",{enumerable:!0,get:function(){if(oa.isBuffer(this))return this.byteOffset}});oa.poolSize=8192;oa.from=function(a,c,d){return Of(a,c,d)};Object.setPrototypeOf(oa.prototype,Uint8Array.prototype);Object.setPrototypeOf(oa,Uint8Array);oa.alloc=function(a,c,d){return(Rf(a),a<=0)?Fc(a):void 0!==c?"string"==typeof d?Fc(a).fill(c,d):Fc(a).fill(c):
Fc(a)};oa.allocUnsafe=function(a){return Ne(a)};oa.allocUnsafeSlow=function(a){return Ne(a)};oa.isBuffer=function(a){return null!=a&&!0===a._isBuffer&&a!==oa.prototype};oa.compare=function(a,c){if(Bc(a,Uint8Array)&&(a=oa.from(a,a.offset,a.byteLength)),Bc(c,Uint8Array)&&(c=oa.from(c,c.offset,c.byteLength)),!oa.isBuffer(a)||!oa.isBuffer(c))throw TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(a===c)return 0;for(var d=a.length,b=c.length,g=0,n=Math.min(d,b);g<n;++g)if(a[g]!==
c[g]){d=a[g];b=c[g];break}return d<b?-1:+(b<d)};oa.isEncoding=function(a){switch(String(a).toLowerCase()){case "hex":case "utf8":case "utf-8":case "ascii":case "latin1":case "binary":case "base64":case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return!0;default:return!1}};oa.concat=function(a,c){if(!Array.isArray(a))throw TypeError('"list" argument must be an Array of Buffers');if(0===a.length)return oa.alloc(0);if(void 0===c)for(c=d=0;d<a.length;++d)c+=a[d].length;var d;c=oa.allocUnsafe(c);
var b=0;for(d=0;d<a.length;++d){var g=a[d];if(Bc(g,Uint8Array))b+g.length>c.length?oa.from(g).copy(c,b):Uint8Array.prototype.set.call(c,g,b);else if(oa.isBuffer(g))g.copy(c,b);else throw TypeError('"list" argument must be an Array of Buffers');b+=g.length}return c};oa.byteLength=Pf;oa.prototype._isBuffer=!0;oa.prototype.swap16=function(){var a=this.length;if(a%2!=0)throw RangeError("Buffer size must be a multiple of 16-bits");for(var c=0;c<a;c+=2)ed(this,c,c+1);return this};oa.prototype.swap32=function(){var a=
this.length;if(a%4!=0)throw RangeError("Buffer size must be a multiple of 32-bits");for(var c=0;c<a;c+=4)ed(this,c,c+3),ed(this,c+1,c+2);return this};oa.prototype.swap64=function(){var a=this.length;if(a%8!=0)throw RangeError("Buffer size must be a multiple of 64-bits");for(var c=0;c<a;c+=8)ed(this,c,c+7),ed(this,c+1,c+6),ed(this,c+2,c+5),ed(this,c+3,c+4);return this};oa.prototype.toString=function(){var a=this.length;return 0===a?"":0==arguments.length?Tf(this,0,a):ih.apply(this,arguments)};oa.prototype.toLocaleString=
oa.prototype.toString;oa.prototype.equals=function(a){if(!oa.isBuffer(a))throw TypeError("Argument must be a Buffer");return this===a||0===oa.compare(this,a)};oa.prototype.inspect=function(){var a="";return a=this.toString("hex",0,50).replace(/(.{2})/g,"$1 ").trim(),this.length>50&&(a+=" ... "),"<Buffer "+a+">"};Gg&&(oa.prototype[Gg]=oa.prototype.inspect);oa.prototype.compare=function(a,c,d,b,g){if(Bc(a,Uint8Array)&&(a=oa.from(a,a.offset,a.byteLength)),!oa.isBuffer(a))throw TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+
typeof a);if(void 0===c&&(c=0),void 0===d&&(d=a?a.length:0),void 0===b&&(b=0),void 0===g&&(g=this.length),c<0||d>a.length||b<0||g>this.length)throw RangeError("out of range index");if(b>=g&&c>=d)return 0;if(b>=g)return-1;if(c>=d)return 1;if(c>>>=0,d>>>=0,b>>>=0,g>>>=0,this===a)return 0;var n=g-b,f=d-c,e=Math.min(n,f);b=this.slice(b,g);a=a.slice(c,d);for(c=0;c<e;++c)if(b[c]!==a[c]){n=b[c];f=a[c];break}return n<f?-1:+(f<n)};oa.prototype.includes=function(a,c,d){return-1!==this.indexOf(a,c,d)};oa.prototype.indexOf=
function(a,c,d){return Vf(this,a,c,d,!0)};oa.prototype.lastIndexOf=function(a,c,d){return Vf(this,a,c,d,!1)};oa.prototype.write=function(a,c,d,b){if(void 0===c)b="utf8",d=this.length,c=0;else if(void 0===d&&"string"==typeof c)b=c,d=this.length,c=0;else if(isFinite(c))c>>>=0,isFinite(d)?(d>>>=0,void 0===b&&(b="utf8")):(b=d,d=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var g,n,f,e,k,l,h,m,p=this.length-c;if((void 0===d||d>p)&&(d=p),a.length>0&&
(d<0||c<0)||c>this.length)throw RangeError("Attempt to write outside buffer bounds");b||="utf8";for(p=!1;;)switch(b){case "hex":return function(q,r,u,v){u=Number(u)||0;var y=q.length-u;v?(v=Number(v))>y&&(v=y):v=y;y=r.length;v>y/2&&(v=y/2);for(y=0;y<v;++y){var C,w=parseInt(r.substr(2*y,2),16);if((C=w)!=C)break;q[u+y]=w}return y}(this,a,c,d);case "utf8":case "utf-8":return g=c,n=d,Zd(Qe(a,this.length-g),this,g,n);case "ascii":case "latin1":case "binary":return f=c,e=d,Zd(function(q){for(var r=[],u=
0;u<q.length;++u)r.push(255&q.charCodeAt(u));return r}(a),this,f,e);case "base64":return k=c,l=d,Zd(Sf(a),this,k,l);case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return h=c,m=d,Zd(function(q,r){for(var u,v,y=[],C=0;C<q.length&&!((r-=2)<0);++C)v=(u=q.charCodeAt(C))>>8,y.push(u%256),y.push(v);return y}(a,this.length-h),this,h,m);default:if(p)throw TypeError("Unknown encoding: "+b);b=(""+b).toLowerCase();p=!0}};oa.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||
this,0)}};oa.prototype.slice=function(a,c){var d=this.length;a=~~a;c=void 0===c?d:~~c;a<0?(a+=d)<0&&(a=0):a>d&&(a=d);c<0?(c+=d)<0&&(c=0):c>d&&(c=d);c<a&&(c=a);a=this.subarray(a,c);return Object.setPrototypeOf(a,oa.prototype),a};oa.prototype.readUintLE=oa.prototype.readUIntLE=function(a,c,d){a>>>=0;c>>>=0;d||Sb(a,c,this.length);d=this[a];for(var b=1,g=0;++g<c&&(b*=256);)d+=this[a+g]*b;return d};oa.prototype.readUintBE=oa.prototype.readUIntBE=function(a,c,d){a>>>=0;c>>>=0;d||Sb(a,c,this.length);d=this[a+
--c];for(var b=1;c>0&&(b*=256);)d+=this[a+--c]*b;return d};oa.prototype.readUint8=oa.prototype.readUInt8=function(a,c){return a>>>=0,c||Sb(a,1,this.length),this[a]};oa.prototype.readUint16LE=oa.prototype.readUInt16LE=function(a,c){return a>>>=0,c||Sb(a,2,this.length),this[a]|this[a+1]<<8};oa.prototype.readUint16BE=oa.prototype.readUInt16BE=function(a,c){return a>>>=0,c||Sb(a,2,this.length),this[a]<<8|this[a+1]};oa.prototype.readUint32LE=oa.prototype.readUInt32LE=function(a,c){return a>>>=0,c||Sb(a,
4,this.length),(this[a]|this[a+1]<<8|this[a+2]<<16)+16777216*this[a+3]};oa.prototype.readUint32BE=oa.prototype.readUInt32BE=function(a,c){return a>>>=0,c||Sb(a,4,this.length),16777216*this[a]+(this[a+1]<<16|this[a+2]<<8|this[a+3])};oa.prototype.readIntLE=function(a,c,d){a>>>=0;c>>>=0;d||Sb(a,c,this.length);d=this[a];for(var b=1,g=0;++g<c&&(b*=256);)d+=this[a+g]*b;return d>=b*128&&(d-=Math.pow(2,8*c)),d};oa.prototype.readIntBE=function(a,c,d){a>>>=0;c>>>=0;d||Sb(a,c,this.length);d=c;for(var b=1,g=
this[a+--d];d>0&&(b*=256);)g+=this[a+--d]*b;return g>=b*128&&(g-=Math.pow(2,8*c)),g};oa.prototype.readInt8=function(a,c){return(a>>>=0,c||Sb(a,1,this.length),128&this[a])?-(255-this[a]+1):this[a]};oa.prototype.readInt16LE=function(a,c){a>>>=0;c||Sb(a,2,this.length);a=this[a]|this[a+1]<<8;return 32768&a?4294901760|a:a};oa.prototype.readInt16BE=function(a,c){a>>>=0;c||Sb(a,2,this.length);a=this[a+1]|this[a]<<8;return 32768&a?4294901760|a:a};oa.prototype.readInt32LE=function(a,c){return a>>>=0,c||Sb(a,
4,this.length),this[a]|this[a+1]<<8|this[a+2]<<16|this[a+3]<<24};oa.prototype.readInt32BE=function(a,c){return a>>>=0,c||Sb(a,4,this.length),this[a]<<24|this[a+1]<<16|this[a+2]<<8|this[a+3]};oa.prototype.readFloatLE=function(a,c){return a>>>=0,c||Sb(a,4,this.length),se(this,a,!0,23,4)};oa.prototype.readFloatBE=function(a,c){return a>>>=0,c||Sb(a,4,this.length),se(this,a,!1,23,4)};oa.prototype.readDoubleLE=function(a,c){return a>>>=0,c||Sb(a,8,this.length),se(this,a,!0,52,8)};oa.prototype.readDoubleBE=
function(a,c){return a>>>=0,c||Sb(a,8,this.length),se(this,a,!1,52,8)};oa.prototype.writeUintLE=oa.prototype.writeUIntLE=function(a,c,d,b){(a*=1,c>>>=0,d>>>=0,b)||kc(this,a,c,d,Math.pow(2,8*d)-1,0);b=1;var g=0;for(this[c]=255&a;++g<d&&(b*=256);)this[c+g]=a/b&255;return c+d};oa.prototype.writeUintBE=oa.prototype.writeUIntBE=function(a,c,d,b){(a*=1,c>>>=0,d>>>=0,b)||kc(this,a,c,d,Math.pow(2,8*d)-1,0);b=d-1;var g=1;for(this[c+b]=255&a;--b>=0&&(g*=256);)this[c+b]=a/g&255;return c+d};oa.prototype.writeUint8=
oa.prototype.writeUInt8=function(a,c,d){return a*=1,c>>>=0,d||kc(this,a,c,1,255,0),this[c]=255&a,c+1};oa.prototype.writeUint16LE=oa.prototype.writeUInt16LE=function(a,c,d){return a*=1,c>>>=0,d||kc(this,a,c,2,65535,0),this[c]=255&a,this[c+1]=a>>>8,c+2};oa.prototype.writeUint16BE=oa.prototype.writeUInt16BE=function(a,c,d){return a*=1,c>>>=0,d||kc(this,a,c,2,65535,0),this[c]=a>>>8,this[c+1]=255&a,c+2};oa.prototype.writeUint32LE=oa.prototype.writeUInt32LE=function(a,c,d){return a*=1,c>>>=0,d||kc(this,
a,c,4,4294967295,0),this[c+3]=a>>>24,this[c+2]=a>>>16,this[c+1]=a>>>8,this[c]=255&a,c+4};oa.prototype.writeUint32BE=oa.prototype.writeUInt32BE=function(a,c,d){return a*=1,c>>>=0,d||kc(this,a,c,4,4294967295,0),this[c]=a>>>24,this[c+1]=a>>>16,this[c+2]=a>>>8,this[c+3]=255&a,c+4};oa.prototype.writeIntLE=function(a,c,d,b){(a*=1,c>>>=0,b)||(b=Math.pow(2,8*d-1),kc(this,a,c,d,b-1,-b));b=0;var g=1,n=0;for(this[c]=255&a;++b<d&&(g*=256);)a<0&&0===n&&0!==this[c+b-1]&&(n=1),this[c+b]=(a/g|0)-n&255;return c+d};
oa.prototype.writeIntBE=function(a,c,d,b){(a*=1,c>>>=0,b)||(b=Math.pow(2,8*d-1),kc(this,a,c,d,b-1,-b));b=d-1;var g=1,n=0;for(this[c+b]=255&a;--b>=0&&(g*=256);)a<0&&0===n&&0!==this[c+b+1]&&(n=1),this[c+b]=(a/g|0)-n&255;return c+d};oa.prototype.writeInt8=function(a,c,d){return a*=1,c>>>=0,d||kc(this,a,c,1,127,-128),a<0&&(a=255+a+1),this[c]=255&a,c+1};oa.prototype.writeInt16LE=function(a,c,d){return a*=1,c>>>=0,d||kc(this,a,c,2,32767,-32768),this[c]=255&a,this[c+1]=a>>>8,c+2};oa.prototype.writeInt16BE=
function(a,c,d){return a*=1,c>>>=0,d||kc(this,a,c,2,32767,-32768),this[c]=a>>>8,this[c+1]=255&a,c+2};oa.prototype.writeInt32LE=function(a,c,d){return a*=1,c>>>=0,d||kc(this,a,c,4,2147483647,-2147483648),this[c]=255&a,this[c+1]=a>>>8,this[c+2]=a>>>16,this[c+3]=a>>>24,c+4};oa.prototype.writeInt32BE=function(a,c,d){return a*=1,c>>>=0,d||kc(this,a,c,4,2147483647,-2147483648),a<0&&(a=4294967295+a+1),this[c]=a>>>24,this[c+1]=a>>>16,this[c+2]=a>>>8,this[c+3]=255&a,c+4};oa.prototype.writeFloatLE=function(a,
c,d){return Xf(this,a,c,!0,d)};oa.prototype.writeFloatBE=function(a,c,d){return Xf(this,a,c,!1,d)};oa.prototype.writeDoubleLE=function(a,c,d){return Zf(this,a,c,!0,d)};oa.prototype.writeDoubleBE=function(a,c,d){return Zf(this,a,c,!1,d)};oa.prototype.copy=function(a,c,d,b){if(!oa.isBuffer(a))throw TypeError("argument should be a Buffer");if(d||=0,b||0===b||(b=this.length),c>=a.length&&(c=a.length),c||=0,b>0&&b<d&&(b=d),b===d||0===a.length||0===this.length)return 0;if(c<0)throw RangeError("targetStart out of bounds");
if(d<0||d>=this.length)throw RangeError("Index out of range");if(b<0)throw RangeError("sourceEnd out of bounds");b>this.length&&(b=this.length);a.length-c<b-d&&(b=a.length-c+d);var g=b-d;return this===a&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(c,d,b):Uint8Array.prototype.set.call(a,this.subarray(d,b),c),g};oa.prototype.fill=function(a,c,d,b){if("string"==typeof a){if("string"==typeof c?(b=c,c=0,d=this.length):"string"==typeof d&&(b=d,d=this.length),void 0!==b&&"string"!=
typeof b)throw TypeError("encoding must be a string");if("string"==typeof b&&!oa.isEncoding(b))throw TypeError("Unknown encoding: "+b);if(1===a.length){var g=a.charCodeAt(0);("utf8"===b&&g<128||"latin1"===b)&&(a=g)}}else"number"==typeof a?a&=255:"boolean"==typeof a&&(a=Number(a));if(c<0||this.length<c||this.length<d)throw RangeError("Out of range index");if(d<=c)return this;if(c>>>=0,d=void 0===d?this.length:d>>>0,a||=0,"number"==typeof a)for(b=c;b<d;++b)this[b]=a;else{g=oa.isBuffer(a)?a:oa.from(a,
b);var n=g.length;if(0===n)throw TypeError('The value "'+a+'" is invalid for argument "value"');for(b=0;b<d-c;++b)this[b+c]=g[b%n]}return this};var lh=/[^+/0-9A-Za-z-_]/g,jh=function(){for(var a=Array(256),c=0;c<16;++c)for(var d=16*c,b=0;b<16;++b)a[d+b]="0123456789abcdef"[c]+"0123456789abcdef"[b];return a}(),Hg={},Kb=Hg={};try{var Rc="function"==typeof setTimeout?setTimeout:Re}catch(a){Rc=Re}try{var Sc="function"==typeof clearTimeout?clearTimeout:Se}catch(a){Sc=Se}var Gc=[],qd=!1,$d=-1;Kb.nextTick=
function(a){var c=Array(arguments.length-1);if(arguments.length>1)for(var d=1;d<arguments.length;d++)c[d-1]=arguments[d];Gc.push(new bg(a,c));1!==Gc.length||qd||$f(ag)};bg.prototype.run=function(){this.fun.apply(null,this.array)};Kb.title="browser";Kb.browser=!0;Kb.env={};Kb.argv=[];Kb.version="";Kb.versions={};Kb.on=Hc;Kb.addListener=Hc;Kb.once=Hc;Kb.off=Hc;Kb.removeListener=Hc;Kb.removeAllListeners=Hc;Kb.emit=Hc;Kb.prependListener=Hc;Kb.prependOnceListener=Hc;Kb.listeners=function(a){return[]};
Kb.binding=function(a){throw Error("process.binding is not supported");};Kb.cwd=function(){return"/"};Kb.chdir=function(a){throw Error("process.chdir is not supported");};Kb.umask=function(){return 0};cg=function g(c,d,b){function n(k,l){if(!d[k]){if(!c[k]){if(f)return f(k,!0);l=Error("Cannot find module '"+k+"'");throw l.code="MODULE_NOT_FOUND",l;}l=d[k]={exports:{}};c[k][0].call(l.exports,function(h){return n(c[k][1][h]||h)},l,l.exports,g,c,d,b)}return d[k].exports}for(var f=void 0,e=0;e<b.length;e++)n(b[e]);
return n}({1:[function(c,d,b){var g=c("./utils"),n=c("./support");b.encode=function(f){for(var e,k,l,h,m,p,q=[],r=0,u=f.length,v,y="string"!==g.getTypeOf(f);r<f.length;)v=u-r,l=y?(e=f[r++],k=r<u?f[r++]:0,r<u?f[r++]:0):(e=f.charCodeAt(r++),k=r<u?f.charCodeAt(r++):0,r<u?f.charCodeAt(r++):0),h=e>>2,m=(3&e)<<4|k>>4,p=1<v?(15&k)<<2|l>>6:64,l=2<v?63&l:64,q.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(h)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(m)+
"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(p)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(l));return q.join("")};b.decode=function(f){var e,k,l,h=0,m=0;if(f.substr(0,5)==="data:")throw Error("Invalid base64 input, it looks like a data url.");var p;var q=3*(f=f.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(f.charAt(f.length-1)==="="&&q--,f.charAt(f.length-2)==="="&&q--,q%1!=0)throw Error("Invalid base64 input, bad content length.");for(p=
n.uint8array?new Uint8Array(0|q):Array(0|q);h<f.length;){q="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(f.charAt(h++))<<2|(e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(f.charAt(h++)))>>4;e=(15&e)<<4|(k="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(f.charAt(h++)))>>2;var r=(3&k)<<6|(l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(f.charAt(h++)));p[m++]=q;64!==k&&(p[m++]=e);64!==
l&&(p[m++]=r)}return p}},{"./support":30,"./utils":32}],2:[function(c,d,b){function g(l,h,m,p,q){this.compressedSize=l;this.uncompressedSize=h;this.crc32=m;this.compression=p;this.compressedContent=q}var n=c("./external"),f=c("./stream/DataWorker"),e=c("./stream/Crc32Probe"),k=c("./stream/DataLengthProbe");g.prototype={getContentWorker:function(){var l=(new f(n.Promise.resolve(this.compressedContent))).pipe(this.compression.uncompressWorker()).pipe(new k("data_length")),h=this;return l.on("end",function(){if(this.streamInfo.data_length!==
h.uncompressedSize)throw Error("Bug : uncompressed data size mismatch");}),l},getCompressedWorker:function(){return(new f(n.Promise.resolve(this.compressedContent))).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}};g.createWorkerFrom=function(l,h,m){return l.pipe(new e).pipe(new k("uncompressedSize")).pipe(h.compressWorker(m)).pipe(new k("compressedSize")).withStreamInfo("compression",
h)};d.exports=g},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(c,d,b){var g=c("./stream/GenericWorker");b.STORE={magic:"\x00\x00",compressWorker:function(){return new g("STORE compression")},uncompressWorker:function(){return new g("STORE decompression")}};b.DEFLATE=c("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(c,d,b){var g=c("./utils"),n=function(){for(var f,e=[],k=0;k<256;k++){f=k;for(var l=0;l<8;l++)f=1&f?3988292384^
f>>>1:f>>>1;e[k]=f}return e}();d.exports=function(f,e){return void 0!==f&&f.length?"string"!==g.getTypeOf(f)?function(k,l,h){h=0+h;k^=-1;for(var m=0;m<h;m++)k=k>>>8^n[255&(k^l[m])];return-1^k}(0|e,f,f.length):function(k,l,h){h=0+h;k^=-1;for(var m=0;m<h;m++)k=k>>>8^n[255&(k^l.charCodeAt(m))];return-1^k}(0|e,f,f.length):0}},{"./utils":32}],5:[function(c,d,b){b.base64=!1;b.binary=!1;b.dir=!1;b.createFolders=!0;b.date=null;b.compression=null;b.compressionOptions=null;b.comment=null;b.unixPermissions=
null;b.dosPermissions=null},{}],6:[function(c,d,b){d.exports={Promise:"u">typeof Promise?Promise:c("lie")}},{lie:37}],7:[function(c,d,b){function g(l,h){e.call(this,"FlateWorker/"+l);this._pako=null;this._pakoAction=l;this._pakoOptions=h;this.meta={}}d="u">typeof Uint8Array&&"u">typeof Uint16Array&&"u">typeof Uint32Array;var n=c("pako"),f=c("./utils"),e=c("./stream/GenericWorker"),k=d?"uint8array":"array";b.magic="\b\x00";f.inherits(g,e);g.prototype.processChunk=function(l){this.meta=l.meta;null===
this._pako&&this._createPako();this._pako.push(f.transformTo(k,l.data),!1)};g.prototype.flush=function(){e.prototype.flush.call(this);null===this._pako&&this._createPako();this._pako.push([],!0)};g.prototype.cleanUp=function(){e.prototype.cleanUp.call(this);this._pako=null};g.prototype._createPako=function(){this._pako=new n[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var l=this;this._pako.onData=function(h){l.push({data:h,meta:l.meta})}};b.compressWorker=function(l){return new g("Deflate",
l)};b.uncompressWorker=function(){return new g("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(c,d,b){function g(p,q){var r,u="";for(r=0;r<q;r++)u+=String.fromCharCode(255&p),p>>>=8;return u}function n(p,q,r,u,v,y){var C,w,D=p.file,x=p.compression,G=y!==l.utf8encode,H=e.transformTo("string",y(D.name)),N=e.transformTo("string",l.utf8encode(D.name)),B=D.comment;y=e.transformTo("string",y(B));var P=e.transformTo("string",l.utf8encode(B)),V=N.length!==D.name.length,L=P.length!==
B.length,ia=B="",aa="",ma=D.dir,ca=D.date,ra=0,ka=0,qa=0;q&&!r||(ra=p.crc32,ka=p.compressedSize,qa=p.uncompressedSize);p=0;q&&(p|=8);!G&&(V||L)&&(p|=2048);G=q=0;ma&&(q|=16);"UNIX"===v?(G=798,q|=(C=D.unixPermissions,w=C,C||(w=ma?16893:33204),(65535&w)<<16)):(G=20,q|=63&(D.dosPermissions||0));v=(ca.getUTCHours()<<6|ca.getUTCMinutes())<<5|ca.getUTCSeconds()/2;C=(ca.getUTCFullYear()-1980<<4|ca.getUTCMonth()+1)<<5|ca.getUTCDate();V&&(ia=g(1,1)+g(h(H),4)+N,B+="up"+g(ia.length,2)+ia);L&&(aa=g(1,1)+g(h(y),
4)+P,B+="uc"+g(aa.length,2)+aa);N="";return N+="\n\x00",N+=g(p,2),N+=x.magic,N+=g(v,2),N+=g(C,2),N+=g(ra,4),N+=g(ka,4),N+=g(qa,4),N+=g(H.length,2),N+=g(B.length,2),{fileRecord:m.LOCAL_FILE_HEADER+N+H+B,dirRecord:m.CENTRAL_FILE_HEADER+g(G,2)+N+g(y.length,2)+"\x00\x00\x00\x00"+g(q,4)+g(u,4)+H+B+y}}function f(p,q,r,u){k.call(this,"ZipFileWorker");this.bytesWritten=0;this.zipComment=q;this.zipPlatform=r;this.encodeFileName=u;this.streamFiles=p;this.accumulate=!1;this.contentBuffer=[];this.dirRecords=
[];this.entriesCount=this.currentSourceOffset=0;this.currentFile=null;this._sources=[]}var e=c("../utils"),k=c("../stream/GenericWorker"),l=c("../utf8"),h=c("../crc32"),m=c("../signature");e.inherits(f,k);f.prototype.push=function(p){var q=p.meta.percent||0,r=this.entriesCount,u=this._sources.length;this.accumulate?this.contentBuffer.push(p):(this.bytesWritten+=p.data.length,k.prototype.push.call(this,{data:p.data,meta:{currentFile:this.currentFile,percent:r?(q+100*(r-u-1))/r:100}}))};f.prototype.openedSource=
function(p){this.currentSourceOffset=this.bytesWritten;this.currentFile=p.file.name;var q=this.streamFiles&&!p.file.dir;q?(p=n(p,q,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName),this.push({data:p.fileRecord,meta:{percent:0}})):this.accumulate=!0};f.prototype.closedSource=function(p){this.accumulate=!1;var q=this.streamFiles&&!p.file.dir,r=n(p,q,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(r.dirRecord),q)this.push({data:m.DATA_DESCRIPTOR+
g(p.crc32,4)+g(p.compressedSize,4)+g(p.uncompressedSize,4),meta:{percent:100}});else for(this.push({data:r.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null};f.prototype.flush=function(){for(var p,q,r,u,v=this.bytesWritten,y=0;y<this.dirRecords.length;y++)this.push({data:this.dirRecords[y],meta:{percent:100}});y=this.bytesWritten-v;var C=(p=this.dirRecords.length,q=this.zipComment,r=this.encodeFileName,u=e.transformTo("string",r(q)),
m.CENTRAL_DIRECTORY_END+"\x00\x00\x00\x00"+g(p,2)+g(p,2)+g(y,4)+g(v,4)+g(u.length,2)+u);this.push({data:C,meta:{percent:100}})};f.prototype.prepareNextSource=function(){this.previous=this._sources.shift();this.openedSource(this.previous.streamInfo);this.isPaused?this.previous.pause():this.previous.resume()};f.prototype.registerPrevious=function(p){this._sources.push(p);var q=this;return p.on("data",function(r){q.processChunk(r)}),p.on("end",function(){q.closedSource(q.previous.streamInfo);q._sources.length?
q.prepareNextSource():q.end()}),p.on("error",function(r){q.error(r)}),this};f.prototype.resume=function(){return!!k.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))};f.prototype.error=function(p){var q=this._sources;if(!k.prototype.error.call(this,p))return!1;for(var r=0;r<q.length;r++)try{q[r].error(p)}catch(u){}return!0};f.prototype.lock=function(){k.prototype.lock.call(this);
for(var p=this._sources,q=0;q<p.length;q++)p[q].lock()};d.exports=f},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(c,d,b){var g=c("../compressions"),n=c("./ZipFileWorker");b.generateWorker=function(f,e,k){var l=new n(e.streamFiles,k,e.platform,e.encodeFileName),h=0;try{f.forEach(function(m,p){h++;var q=p.options.compression||e.compression,r=g[q];if(!r)throw Error(q+" is not a valid compression method !");q=p.dir;var u=p.date;p._compressWorker(r,
p.options.compressionOptions||e.compressionOptions||{}).withStreamInfo("file",{name:m,dir:q,date:u,comment:p.comment||"",unixPermissions:p.unixPermissions,dosPermissions:p.dosPermissions}).pipe(l)}),l.entriesCount=h}catch(m){l.error(m)}return l}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(c,d,b){function g(){if(!(this instanceof g))return new g;if(arguments.length)throw Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=
Object.create(null);this.comment=null;this.root="";this.clone=function(){var n=new g,f;for(f in this)"function"!=typeof this[f]&&(n[f]=this[f]);return n}}(g.prototype=c("./object")).loadAsync=c("./load");g.support=c("./support");g.defaults=c("./defaults");g.version="3.10.1";g.loadAsync=function(n,f){return(new g).loadAsync(n,f)};g.external=c("./external");d.exports=g},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(c,d,b){var g=c("./utils"),n=c("./external"),
f=c("./utf8"),e=c("./zipEntries"),k=c("./stream/Crc32Probe"),l=c("./nodejsUtils");d.exports=function(h,m){var p=this;return m=g.extend(m||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:f.utf8decode}),l.isNode&&l.isStream(h)?n.Promise.reject(Error("JSZip can't accept a stream when loading a zip file.")):g.prepareContent("the loaded zip file",h,!0,m.optimizedBinaryString,m.base64).then(function(q){var r=new e(m);return r.load(q),r}).then(function(q){var r=[n.Promise.resolve(q)];
q=q.files;if(m.checkCRC32)for(var u=0;u<q.length;u++)r.push(function(v){return new n.Promise(function(y,C){var w=v.decompressed.getContentWorker().pipe(new k);w.on("error",function(D){C(D)}).on("end",function(){w.streamInfo.crc32!==v.decompressed.crc32?C(Error("Corrupted zip : CRC32 mismatch")):y()}).resume()})}(q[u]));return n.Promise.all(r)}).then(function(q){q=q.shift();for(var r=q.files,u=0;u<r.length;u++){var v=r[u],y=v.fileNameStr,C=g.resolve(v.fileNameStr);p.file(C,v.decompressed,{binary:!0,
optimizedBinaryString:!0,date:v.date,dir:v.dir,comment:v.fileCommentStr.length?v.fileCommentStr:null,unixPermissions:v.unixPermissions,dosPermissions:v.dosPermissions,createFolders:m.createFolders});v.dir||(p.file(C).unsafeOriginalName=y)}return q.zipComment.length&&(p.comment=q.zipComment),p})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(c,d,b){function g(f,e){n.call(this,"Nodejs stream input adapter for "+f);this._upstreamEnded=
!1;this._bindStream(e)}b=c("../utils");var n=c("../stream/GenericWorker");b.inherits(g,n);g.prototype._bindStream=function(f){var e=this;(this._stream=f).pause();f.on("data",function(k){e.push({data:k,meta:{percent:0}})}).on("error",function(k){e.isPaused?this.generatedError=k:e.error(k)}).on("end",function(){e.isPaused?e._upstreamEnded=!0:e.end()})};g.prototype.pause=function(){return!!n.prototype.pause.call(this)&&(this._stream.pause(),!0)};g.prototype.resume=function(){return!!n.prototype.resume.call(this)&&
(this._upstreamEnded?this.end():this._stream.resume(),!0)};d.exports=g},{"../stream/GenericWorker":28,"../utils":32}],13:[function(c,d,b){function g(f,e,k){n.call(this,e);this._helper=f;var l=this;f.on("data",function(h,m){l.push(h)||l._helper.pause();k&&k(m)}).on("error",function(h){l.emit("error",h)}).on("end",function(){l.push(null)})}var n=c("readable-stream").Readable;c("../utils").inherits(g,n);g.prototype._read=function(){this._helper.resume()};d.exports=g},{"../utils":32,"readable-stream":16}],
14:[function(c,d,b){d.exports={isNode:!0,newBufferFrom:function(g,n){if(oa.from&&oa.from!==Uint8Array.from)return oa.from(g,n);if("number"==typeof g)throw Error('The "data" argument must not be a number');return new oa(g,n)},allocBuffer:function(g){if(oa.alloc)return oa.alloc(g);g=new oa(g);return g.fill(0),g},isBuffer:function(g){return oa.isBuffer(g)},isStream:function(g){return g&&"function"==typeof g.on&&"function"==typeof g.pause&&"function"==typeof g.resume}}},{}],15:[function(c,d,b){function g(y,
C,w){var D=f.getTypeOf(C),x=f.extend(w||{},l);x.date=x.date||new Date;null!==x.compression&&(x.compression=x.compression.toUpperCase());"string"==typeof x.unixPermissions&&(x.unixPermissions=parseInt(x.unixPermissions,8));x.unixPermissions&&16384&x.unixPermissions&&(x.dir=!0);x.dosPermissions&&16&x.dosPermissions&&(x.dir=!0);x.dir&&(y=u(y));var G;if(G=x.createFolders){var H=y;"/"===H.slice(-1)&&(H=H.substring(0,H.length-1));G=H.lastIndexOf("/");G=H=0<G?H.substring(0,G):""}G&&v.call(this,H,!0);D="string"===
D&&!1===x.binary&&!1===x.base64;w&&void 0!==w.binary||(x.binary=!D);(C instanceof h&&0===C.uncompressedSize||x.dir||!C||0===C.length)&&(x.base64=!1,x.binary=!0,C="",x.compression="STORE");C=C instanceof h||C instanceof e?C:q.isNode&&q.isStream(C)?new r(y,C):f.prepareContent(y,C,x.binary,x.optimizedBinaryString,x.base64);x=new m(y,C,x);this.files[y]=x}var n=c("./utf8"),f=c("./utils"),e=c("./stream/GenericWorker"),k=c("./stream/StreamHelper"),l=c("./defaults"),h=c("./compressedObject"),m=c("./zipObject"),
p=c("./generate"),q=c("./nodejsUtils"),r=c("./nodejs/NodejsStreamInputAdapter"),u=function(y){return"/"!==y.slice(-1)&&(y+="/"),y},v=function(y,C){return C=void 0!==C?C:l.createFolders,y=u(y),this.files[y]||g.call(this,y,null,{dir:!0,createFolders:C}),this.files[y]};d.exports={load:function(){throw Error("This method has been removed in JSZip 3.0, please check the upgrade guide.");},forEach:function(y){var C,w;for(C in this.files){var D=this.files[C];(w=C.slice(this.root.length,C.length))&&C.slice(0,
this.root.length)===this.root&&y(w,D)}},filter:function(y){var C=[];return this.forEach(function(w,D){y(w,D)&&C.push(D)}),C},file:function(y,C,w){if(1!=arguments.length)return y=this.root+y,g.call(this,y,C,w),this;if("[object RegExp]"===Object.prototype.toString.call(y)){var D=y;return this.filter(function(G,H){return!H.dir&&D.test(G)})}var x=this.files[this.root+y];return x&&!x.dir?x:null},folder:function(y){if(!y)return this;if("[object RegExp]"===Object.prototype.toString.call(y))return this.filter(function(D,
x){return x.dir&&y.test(D)});var C=v.call(this,this.root+y),w=this.clone();return w.root=C.name,w},remove:function(y){y=this.root+y;var C=this.files[y];if(C||("/"!==y.slice(-1)&&(y+="/"),C=this.files[y]),C&&!C.dir)delete this.files[y];else{C=this.filter(function(D,x){return x.name.slice(0,y.length)===y});for(var w=0;w<C.length;w++)delete this.files[C[w].name]}return this},generate:function(){throw Error("This method has been removed in JSZip 3.0, please check the upgrade guide.");},generateInternalStream:function(y){var C=
{};try{if((C=f.extend(y||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:n.utf8encode})).type=C.type.toLowerCase(),C.compression=C.compression.toUpperCase(),"binarystring"===C.type&&(C.type="string"),!C.type)throw Error("No output type specified.");f.checkSupport(C.type);"darwin"!==C.platform&&"freebsd"!==C.platform&&"linux"!==C.platform&&"sunos"!==C.platform||(C.platform="UNIX");"win32"===C.platform&&(C.platform=
"DOS");var w=p.generateWorker(this,C,C.comment||this.comment||"")}catch(D){(w=new e("error")).error(D)}return new k(w,C.type||"string",C.mimeType)},generateAsync:function(y,C){return this.generateInternalStream(y).accumulate(C)},generateNodeStream:function(y,C){return(y=y||{}).type||(y.type="nodebuffer"),this.generateInternalStream(y).toNodejsStream(C)}}},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,
"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(c,d,b){d.exports=c("stream")},{stream:void 0}],17:[function(c,d,b){function g(f){n.call(this,f);for(var e=0;e<this.data.length;e++)f[e]&=255}var n=c("./DataReader");c("../utils").inherits(g,n);g.prototype.byteAt=function(f){return this.data[this.zero+f]};g.prototype.lastIndexOfSignature=function(f){var e=f.charCodeAt(0),k=f.charCodeAt(1),l=f.charCodeAt(2);f=f.charCodeAt(3);for(var h=this.length-4;0<=h;--h)if(this.data[h]===e&&this.data[h+1]===
k&&this.data[h+2]===l&&this.data[h+3]===f)return h-this.zero;return-1};g.prototype.readAndCheckSignature=function(f){var e=f.charCodeAt(0),k=f.charCodeAt(1),l=f.charCodeAt(2);f=f.charCodeAt(3);var h=this.readData(4);return e===h[0]&&k===h[1]&&l===h[2]&&f===h[3]};g.prototype.readData=function(f){if(this.checkOffset(f),0===f)return[];var e=this.data.slice(this.zero+this.index,this.zero+this.index+f);return this.index+=f,e};d.exports=g},{"../utils":32,"./DataReader":18}],18:[function(c,d,b){function g(f){this.data=
f;this.length=f.length;this.zero=this.index=0}var n=c("../utils");g.prototype={checkOffset:function(f){this.checkIndex(this.index+f)},checkIndex:function(f){if(this.length<this.zero+f||f<0)throw Error("End of data reached (data length = "+this.length+", asked index = "+f+"). Corrupted zip ?");},setIndex:function(f){this.checkIndex(f);this.index=f},skip:function(f){this.setIndex(this.index+f)},byteAt:function(){},readInt:function(f){var e,k=0;this.checkOffset(f);for(e=this.index+f-1;e>=this.index;e--)k=
(k<<8)+this.byteAt(e);return this.index+=f,k},readString:function(f){return n.transformTo("string",this.readData(f))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var f=this.readInt(4);return new Date(Date.UTC(1980+(f>>25&127),(f>>21&15)-1,f>>16&31,f>>11&31,f>>5&63,(31&f)<<1))}};d.exports=g},{"../utils":32}],19:[function(c,d,b){function g(f){n.call(this,f)}var n=c("./Uint8ArrayReader");c("../utils").inherits(g,n);g.prototype.readData=
function(f){this.checkOffset(f);var e=this.data.slice(this.zero+this.index,this.zero+this.index+f);return this.index+=f,e};d.exports=g},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(c,d,b){function g(f){n.call(this,f)}var n=c("./DataReader");c("../utils").inherits(g,n);g.prototype.byteAt=function(f){return this.data.charCodeAt(this.zero+f)};g.prototype.lastIndexOfSignature=function(f){return this.data.lastIndexOf(f)-this.zero};g.prototype.readAndCheckSignature=function(f){return f===this.readData(4)};
g.prototype.readData=function(f){this.checkOffset(f);var e=this.data.slice(this.zero+this.index,this.zero+this.index+f);return this.index+=f,e};d.exports=g},{"../utils":32,"./DataReader":18}],21:[function(c,d,b){function g(f){n.call(this,f)}var n=c("./ArrayReader");c("../utils").inherits(g,n);g.prototype.readData=function(f){if(this.checkOffset(f),0===f)return new Uint8Array(0);var e=this.data.subarray(this.zero+this.index,this.zero+this.index+f);return this.index+=f,e};d.exports=g},{"../utils":32,
"./ArrayReader":17}],22:[function(c,d,b){var g=c("../utils"),n=c("../support"),f=c("./ArrayReader"),e=c("./StringReader"),k=c("./NodeBufferReader"),l=c("./Uint8ArrayReader");d.exports=function(h){var m=g.getTypeOf(h);return g.checkSupport(m),"string"!==m||n.uint8array?"nodebuffer"===m?new k(h):n.uint8array?new l(g.transformTo("uint8array",h)):new f(g.transformTo("array",h)):new e(h)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],
23:[function(c,d,b){b.LOCAL_FILE_HEADER="PK\u0003\u0004";b.CENTRAL_FILE_HEADER="PK\u0001\u0002";b.CENTRAL_DIRECTORY_END="PK\u0005\u0006";b.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\u0006\u0007";b.ZIP64_CENTRAL_DIRECTORY_END="PK\u0006\u0006";b.DATA_DESCRIPTOR="PK\u0007\b"},{}],24:[function(c,d,b){function g(e){n.call(this,"ConvertWorker to "+e);this.destType=e}var n=c("./GenericWorker"),f=c("../utils");f.inherits(g,n);g.prototype.processChunk=function(e){this.push({data:f.transformTo(this.destType,e.data),
meta:e.meta})};d.exports=g},{"../utils":32,"./GenericWorker":28}],25:[function(c,d,b){function g(){n.call(this,"Crc32Probe");this.withStreamInfo("crc32",0)}var n=c("./GenericWorker"),f=c("../crc32");c("../utils").inherits(g,n);g.prototype.processChunk=function(e){this.streamInfo.crc32=f(e.data,this.streamInfo.crc32||0);this.push(e)};d.exports=g},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(c,d,b){function g(f){n.call(this,"DataLengthProbe for "+f);this.propName=f;this.withStreamInfo(f,
0)}b=c("../utils");var n=c("./GenericWorker");b.inherits(g,n);g.prototype.processChunk=function(f){f&&(this.streamInfo[this.propName]=(this.streamInfo[this.propName]||0)+f.data.length);n.prototype.processChunk.call(this,f)};d.exports=g},{"../utils":32,"./GenericWorker":28}],27:[function(c,d,b){function g(e){f.call(this,"DataWorker");var k=this;this.dataIsReady=!1;this.max=this.index=0;this.data=null;this.type="";this._tickScheduled=!1;e.then(function(l){k.dataIsReady=!0;k.data=l;k.max=l&&l.length||
0;k.type=n.getTypeOf(l);k.isPaused||k._tickAndRepeat()},function(l){k.error(l)})}var n=c("../utils"),f=c("./GenericWorker");n.inherits(g,f);g.prototype.cleanUp=function(){f.prototype.cleanUp.call(this);this.data=null};g.prototype.resume=function(){return!!f.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,n.delay(this._tickAndRepeat,[],this)),!0)};g.prototype._tickAndRepeat=function(){this._tickScheduled=!1;this.isPaused||this.isFinished||(this._tick(),
this.isFinished||(n.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))};g.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var e=null,k=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case "string":e=this.data.substring(this.index,k);break;case "uint8array":e=this.data.subarray(this.index,k);break;case "array":case "nodebuffer":e=this.data.slice(this.index,k)}return this.index=k,this.push({data:e,meta:{percent:this.max?
this.index/this.max*100:0}})};d.exports=g},{"../utils":32,"./GenericWorker":28}],28:[function(c,d,b){function g(n){this.name=n||"default";this.streamInfo={};this.generatedError=null;this.extraStreamInfo={};this.isPaused=!0;this.isLocked=this.isFinished=!1;this._listeners={data:[],end:[],error:[]};this.previous=null}g.prototype={push:function(n){this.emit("data",n)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(n){this.emit("error",
n)}return!0},error:function(n){return!this.isFinished&&(this.isPaused?this.generatedError=n:(this.isFinished=!0,this.emit("error",n),this.previous&&this.previous.error(n),this.cleanUp()),!0)},on:function(n,f){return this._listeners[n].push(f),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null;this._listeners=[]},emit:function(n,f){if(this._listeners[n])for(var e=0;e<this._listeners[n].length;e++)this._listeners[n][e].call(this,f)},pipe:function(n){return n.registerPrevious(this)},
registerPrevious:function(n){if(this.isLocked)throw Error("The stream '"+this+"' has already been used.");this.streamInfo=n.streamInfo;this.mergeStreamInfo();this.previous=n;var f=this;return n.on("data",function(e){f.processChunk(e)}),n.on("end",function(){f.end()}),n.on("error",function(e){f.error(e)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var n=this.isPaused=
!1;return this.generatedError&&(this.error(this.generatedError),n=!0),this.previous&&this.previous.resume(),!n},flush:function(){},processChunk:function(n){this.push(n)},withStreamInfo:function(n,f){return this.extraStreamInfo[n]=f,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var n in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,n)&&(this.streamInfo[n]=this.extraStreamInfo[n])},lock:function(){if(this.isLocked)throw Error("The stream '"+this+"' has already been used.");
this.isLocked=!0;this.previous&&this.previous.lock()},toString:function(){var n="Worker "+this.name;return this.previous?this.previous+" -> "+n:n}};d.exports=g},{}],29:[function(c,d,b){function g(m,p,q){var r=p;switch(p){case "blob":case "arraybuffer":r="uint8array";break;case "base64":r="string"}try{this._internalType=r,this._outputType=p,this._mimeType=q,n.checkSupport(r),this._worker=m.pipe(new f(r)),m.lock()}catch(u){this._worker=new e("error"),this._worker.error(u)}}var n=c("../utils"),f=c("./ConvertWorker"),
e=c("./GenericWorker"),k=c("../base64");b=c("../support");var l=c("../external"),h=null;if(b.nodestream)try{h=c("../nodejs/NodejsStreamOutputAdapter")}catch(m){}g.prototype={accumulate:function(m){var p;return p=this,new l.Promise(function(q,r){var u=[],v=p._internalType,y=p._outputType,C=p._mimeType;p.on("data",function(w,D){u.push(w);m&&m(D)}).on("error",function(w){u=[];r(w)}).on("end",function(){try{var w=function(D,x,G){switch(D){case "blob":return n.newBlob(n.transformTo("arraybuffer",x),G);
case "base64":return k.encode(x);default:return n.transformTo(D,x)}}(y,function(D,x){var G,H=0,N=0;for(G=0;G<x.length;G++)N+=x[G].length;switch(D){case "string":return x.join("");case "array":return Array.prototype.concat.apply([],x);case "uint8array":D=new Uint8Array(N);for(G=0;G<x.length;G++)D.set(x[G],H),H+=x[G].length;return D;case "nodebuffer":return oa.concat(x);default:throw Error("concat : unsupported type '"+D+"'");}}(v,u),C);q(w)}catch(D){r(D)}u=[]}).resume()})},on:function(m,p){var q=this;
return"data"===m?this._worker.on(m,function(r){p.call(q,r.data,r.meta)}):this._worker.on(m,function(){n.delay(p,arguments,q)}),this},resume:function(){return n.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(m){if(n.checkSupport("nodestream"),"nodebuffer"!==this._outputType)throw Error(this._outputType+" is not supported by this method");return new h(this,{objectMode:"nodebuffer"!==this._outputType},m)}};d.exports=g},{"../base64":1,
"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(c,d,b){if(b.base64=!0,b.array=!0,b.string=!0,b.arraybuffer="u">typeof ArrayBuffer&&"u">typeof Uint8Array,b.nodebuffer=!0,b.uint8array="u">typeof Uint8Array,"u"<typeof ArrayBuffer)b.blob=!1;else{d=new ArrayBuffer(0);try{b.blob=0===(new Blob([d],{type:"application/zip"})).size}catch(n){try{var g=new (self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||
self.MSBlobBuilder);g.append(d);b.blob=0===g.getBlob("application/zip").size}catch(f){b.blob=!1}}}try{b.nodestream=!!c("readable-stream").Readable}catch(n){b.nodestream=!1}},{"readable-stream":16}],31:[function(c,d,b){function g(){l.call(this,"utf-8 decode");this.leftOver=null}function n(){l.call(this,"utf-8 encode")}var f=c("./utils"),e=c("./support"),k=c("./nodejsUtils"),l=c("./stream/GenericWorker"),h=Array(256);for(c=0;c<256;c++)h[c]=252<=c?6:248<=c?5:240<=c?4:224<=c?3:192<=c?2:1;h[254]=h[254]=
1;b.utf8encode=function(m){if(e.nodebuffer)m=k.newBufferFrom(m,"utf-8");else{var p,q,r,u,v=m.length,y=0;for(r=0;r<v;r++)55296==(64512&(p=m.charCodeAt(r)))&&r+1<v&&56320==(64512&(q=m.charCodeAt(r+1)))&&(p=65536+(p-55296<<10)+(q-56320),r++),y+=p<128?1:p<2048?2:p<65536?3:4;var C=e.uint8array?new Uint8Array(y):Array(y);for(r=u=0;u<y;r++)55296==(64512&(p=m.charCodeAt(r)))&&r+1<v&&56320==(64512&(q=m.charCodeAt(r+1)))&&(p=65536+(p-55296<<10)+(q-56320),r++),p<128?C[u++]=p:(p<2048?C[u++]=192|p>>>6:(p<65536?
C[u++]=224|p>>>12:(C[u++]=240|p>>>18,C[u++]=128|p>>>12&63),C[u++]=128|p>>>6&63),C[u++]=128|63&p);m=C}return m};b.utf8decode=function(m){if(e.nodebuffer)var p=f.transformTo("nodebuffer",m).toString("utf-8");else{p=f.transformTo(e.uint8array?"uint8array":"array",m);var q,r,u,v=p.length,y=Array(2*v);for(q=m=0;q<v;)if((r=p[q++])<128)y[m++]=r;else if(4<(u=h[r]))y[m++]=65533,q+=u-1;else{for(r&=2===u?31:3===u?15:7;1<u&&q<v;)r=r<<6|63&p[q++],u--;1<u?y[m++]=65533:r<65536?y[m++]=r:(r-=65536,y[m++]=55296|r>>
10&1023,y[m++]=56320|1023&r)}p=(y.length!==m&&(y.subarray?y=y.subarray(0,m):y.length=m),f.applyFromCharCode(y))}return p};f.inherits(g,l);g.prototype.processChunk=function(m){var p=f.transformTo(e.uint8array?"uint8array":"array",m.data);if(this.leftOver&&this.leftOver.length){if(e.uint8array){var q=p;(p=new Uint8Array(q.length+this.leftOver.length)).set(this.leftOver,0);p.set(q,this.leftOver.length)}else p=this.leftOver.concat(p);this.leftOver=null}q=p;var r=void 0,u;(r=r||q.length)>q.length&&(r=
q.length);for(u=r-1;0<=u&&128==(192&q[u]);)u--;q=u<0||0===u?r:u+h[q[u]]>r?u:r;r=p;q!==p.length&&(e.uint8array?(r=p.subarray(0,q),this.leftOver=p.subarray(q,p.length)):(r=p.slice(0,q),this.leftOver=p.slice(q,p.length)));this.push({data:b.utf8decode(r),meta:m.meta})};g.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:b.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)};b.Utf8DecodeWorker=g;f.inherits(n,l);n.prototype.processChunk=function(m){this.push({data:b.utf8encode(m.data),
meta:m.meta})};b.Utf8EncodeWorker=n},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(c,d,b){function g(v){return v}function n(v,y){for(var C=0;C<v.length;++C)y[C]=255&v.charCodeAt(C);return y}function f(v){var y=65536,C=b.getTypeOf(v),w=!0;if("uint8array"===C?w=r.applyCanBeUsed.uint8array:"nodebuffer"===C&&(w=r.applyCanBeUsed.nodebuffer),w)for(;1<y;)try{return r.stringifyByChunk(v,C,y)}catch(D){y=Math.floor(y/2)}return r.stringifyByChar(v)}function e(v,y){for(var C=
0;C<v.length;C++)y[C]=v[C];return y}var k=c("./support"),l=c("./base64"),h=c("./nodejsUtils"),m=c("./external");c("setimmediate");b.newBlob=function(v,y){b.checkSupport("blob");try{return new Blob([v],{type:y})}catch(w){try{var C=new (self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return C.append(v),C.getBlob(y)}catch(D){throw Error("Bug : can't construct the Blob.");}}};try{var p=k.uint8array&&1===String.fromCharCode.apply(null,new Uint8Array(1)).length}catch(v){p=
!1}c=p;try{var q=k.nodebuffer&&1===String.fromCharCode.apply(null,h.allocBuffer(1)).length}catch(v){q=!1}var r={stringifyByChunk:function(v,y,C){var w=[],D=0,x=v.length;if(x<=C)return String.fromCharCode.apply(null,v);for(;D<x;)"array"===y||"nodebuffer"===y?w.push(String.fromCharCode.apply(null,v.slice(D,Math.min(D+C,x)))):w.push(String.fromCharCode.apply(null,v.subarray(D,Math.min(D+C,x)))),D+=C;return w.join("")},stringifyByChar:function(v){for(var y="",C=0;C<v.length;C++)y+=String.fromCharCode(v[C]);
return y},applyCanBeUsed:{uint8array:c,nodebuffer:q}};b.applyFromCharCode=f;var u={};u.string={string:g,array:function(v){return n(v,Array(v.length))},arraybuffer:function(v){return u.string.uint8array(v).buffer},uint8array:function(v){return n(v,new Uint8Array(v.length))},nodebuffer:function(v){return n(v,h.allocBuffer(v.length))}};u.array={string:f,array:g,arraybuffer:function(v){return(new Uint8Array(v)).buffer},uint8array:function(v){return new Uint8Array(v)},nodebuffer:function(v){return h.newBufferFrom(v)}};
u.arraybuffer={string:function(v){return f(new Uint8Array(v))},array:function(v){return e(new Uint8Array(v),Array(v.byteLength))},arraybuffer:g,uint8array:function(v){return new Uint8Array(v)},nodebuffer:function(v){return h.newBufferFrom(new Uint8Array(v))}};u.uint8array={string:f,array:function(v){return e(v,Array(v.length))},arraybuffer:function(v){return v.buffer},uint8array:g,nodebuffer:function(v){return h.newBufferFrom(v)}};u.nodebuffer={string:f,array:function(v){return e(v,Array(v.length))},
arraybuffer:function(v){return u.nodebuffer.uint8array(v).buffer},uint8array:function(v){return e(v,new Uint8Array(v.length))},nodebuffer:g};b.transformTo=function(v,y){return(y=y||"",v)?(b.checkSupport(v),u[b.getTypeOf(y)][v](y)):y};b.resolve=function(v){v=v.split("/");for(var y=[],C=0;C<v.length;C++){var w=v[C];"."===w||""===w&&0!==C&&C!==v.length-1||(".."===w?y.pop():y.push(w))}return y.join("/")};b.getTypeOf=function(v){return"string"==typeof v?"string":"[object Array]"===Object.prototype.toString.call(v)?
"array":k.nodebuffer&&h.isBuffer(v)?"nodebuffer":k.uint8array&&v instanceof Uint8Array?"uint8array":k.arraybuffer&&v instanceof ArrayBuffer?"arraybuffer":void 0};b.checkSupport=function(v){if(!k[v.toLowerCase()])throw Error(v+" is not supported by this platform");};b.MAX_VALUE_16BITS=65535;b.MAX_VALUE_32BITS=-1;b.pretty=function(v){var y,C,w="";for(C=0;C<(v||"").length;C++)w+="\\x"+((y=v.charCodeAt(C))<16?"0":"")+y.toString(16).toUpperCase();return w};b.delay=function(v,y,C){setImmediate(function(){v.apply(C||
null,y||[])})};b.inherits=function(v,y){function C(){}C.prototype=y.prototype;v.prototype=new C};b.extend=function(){var v,y,C={};for(v=0;v<arguments.length;v++)for(y in arguments[v])Object.prototype.hasOwnProperty.call(arguments[v],y)&&void 0===C[y]&&(C[y]=arguments[v][y]);return C};b.prepareContent=function(v,y,C,w,D){return m.Promise.resolve(y).then(function(x){return k.blob&&(x instanceof Blob||-1!==["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(x)))&&"u">typeof FileReader?
new m.Promise(function(G,H){var N=new FileReader;N.onload=function(B){G(B.target.result)};N.onerror=function(B){H(B.target.error)};N.readAsArrayBuffer(x)}):x}).then(function(x){var G,H=b.getTypeOf(x);return H?("arraybuffer"===H?x=b.transformTo("uint8array",x):"string"===H&&(D?x=l.decode(x):C&&!0!==w&&(x=n(G=x,k.uint8array?new Uint8Array(G.length):Array(G.length)))),x):m.Promise.reject(Error("Can't read the data of '"+v+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},
{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(c,d,b){function g(h){this.files=[];this.loadOptions=h}var n=c("./reader/readerFor"),f=c("./utils"),e=c("./signature"),k=c("./zipEntry"),l=c("./support");g.prototype={checkSignature:function(h){if(!this.reader.readAndCheckSignature(h)){this.reader.index-=4;var m=this.reader.readString(4);throw Error("Corrupted zip or bug: unexpected signature ("+f.pretty(m)+", expected "+f.pretty(h)+")");}},isSignature:function(h,
m){var p=this.reader.index;this.reader.setIndex(h);h=this.reader.readString(4)===m;return this.reader.setIndex(p),h},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2);this.diskWithCentralDirStart=this.reader.readInt(2);this.centralDirRecordsOnThisDisk=this.reader.readInt(2);this.centralDirRecords=this.reader.readInt(2);this.centralDirSize=this.reader.readInt(4);this.centralDirOffset=this.reader.readInt(4);this.zipCommentLength=this.reader.readInt(2);var h=this.reader.readData(this.zipCommentLength);
h=f.transformTo(l.uint8array?"uint8array":"array",h);this.zipComment=this.loadOptions.decodeFileName(h)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8);this.reader.skip(4);this.diskNumber=this.reader.readInt(4);this.diskWithCentralDirStart=this.reader.readInt(4);this.centralDirRecordsOnThisDisk=this.reader.readInt(8);this.centralDirRecords=this.reader.readInt(8);this.centralDirSize=this.reader.readInt(8);this.centralDirOffset=this.reader.readInt(8);this.zip64ExtensibleData=
{};for(var h,m,p,q=this.zip64EndOfCentralSize-44;0<q;)h=this.reader.readInt(2),m=this.reader.readInt(4),p=this.reader.readData(m),this.zip64ExtensibleData[h]={id:h,length:m,value:p}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw Error("Multi-volumes zip are not supported");},readLocalFiles:function(){var h;for(h=0;h<
this.files.length;h++){var m=this.files[h];this.reader.setIndex(m.localHeaderOffset);this.checkSignature(e.LOCAL_FILE_HEADER);m.readLocalPart(this.reader);m.handleUTF8();m.processAttributes()}},readCentralDir:function(){var h;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(e.CENTRAL_FILE_HEADER);)(h=new k({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(h);if(this.centralDirRecords!==this.files.length&&0!==this.centralDirRecords&&
0===this.files.length)throw Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length);},readEndOfCentral:function(){var h=this.reader.lastIndexOfSignature(e.CENTRAL_DIRECTORY_END);if(h<0)throw this.isSignature(0,e.LOCAL_FILE_HEADER)?Error("Corrupted zip: can't find end of central directory"):Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(h);
var m=h;if(this.checkSignature(e.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===f.MAX_VALUE_16BITS||this.diskWithCentralDirStart===f.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===f.MAX_VALUE_16BITS||this.centralDirRecords===f.MAX_VALUE_16BITS||this.centralDirSize===f.MAX_VALUE_32BITS||this.centralDirOffset===f.MAX_VALUE_32BITS){if(this.zip64=!0,(h=this.reader.lastIndexOfSignature(e.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw Error("Corrupted zip: can't find the ZIP64 end of central directory locator");
if(this.reader.setIndex(h),this.checkSignature(e.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,e.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(e.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir);this.checkSignature(e.ZIP64_CENTRAL_DIRECTORY_END);
this.readBlockZip64EndOfCentral()}h=this.centralDirOffset+this.centralDirSize;this.zip64&&(h+=20,h+=12+this.zip64EndOfCentralSize);h=m-h;if(0<h)this.isSignature(m,e.CENTRAL_FILE_HEADER)||(this.reader.zero=h);else if(h<0)throw Error("Corrupted zip: missing "+Math.abs(h)+" bytes.");},prepareReader:function(h){this.reader=n(h)},load:function(h){this.prepareReader(h);this.readEndOfCentral();this.readCentralDir();this.readLocalFiles()}};d.exports=g},{"./reader/readerFor":22,"./signature":23,"./support":30,
"./utils":32,"./zipEntry":34}],34:[function(c,d,b){function g(p,q){this.options=p;this.loadOptions=q}var n=c("./reader/readerFor"),f=c("./utils"),e=c("./compressedObject"),k=c("./crc32"),l=c("./utf8"),h=c("./compressions"),m=c("./support");g.prototype={isEncrypted:function(){return 1==(1&this.bitFlag)},useUTF8:function(){return 2048==(2048&this.bitFlag)},readLocalPart:function(p){var q;if(p.skip(22),this.fileNameLength=p.readInt(2),q=p.readInt(2),this.fileName=p.readData(this.fileNameLength),p.skip(q),
-1===this.compressedSize||-1===this.uncompressedSize)throw Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");a:{q=this.compressionMethod;for(r in h)if(Object.prototype.hasOwnProperty.call(h,r)&&h[r].magic===q){var r=h[r];break a}r=null}if(null===r)throw Error("Corrupted zip : compression "+f.pretty(this.compressionMethod)+" unknown (inner file : "+f.transformTo("string",this.fileName)+")");this.decompressed=
new e(this.compressedSize,this.uncompressedSize,this.crc32,r,p.readData(this.compressedSize))},readCentralPart:function(p){this.versionMadeBy=p.readInt(2);p.skip(2);this.bitFlag=p.readInt(2);this.compressionMethod=p.readString(2);this.date=p.readDate();this.crc32=p.readInt(4);this.compressedSize=p.readInt(4);this.uncompressedSize=p.readInt(4);var q=p.readInt(2);if(this.extraFieldsLength=p.readInt(2),this.fileCommentLength=p.readInt(2),this.diskNumberStart=p.readInt(2),this.internalFileAttributes=
p.readInt(2),this.externalFileAttributes=p.readInt(4),this.localHeaderOffset=p.readInt(4),this.isEncrypted())throw Error("Encrypted zip are not supported");p.skip(q);this.readExtraFields(p);this.parseZIP64ExtraField(p);this.fileComment=p.readData(this.fileCommentLength)},processAttributes:function(){this.dosPermissions=this.unixPermissions=null;var p=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes);0==p&&(this.dosPermissions=63&this.externalFileAttributes);3==p&&(this.unixPermissions=
this.externalFileAttributes>>16&65535);this.dir||"/"!==this.fileNameStr.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var p=n(this.extraFields[1].value);this.uncompressedSize===f.MAX_VALUE_32BITS&&(this.uncompressedSize=p.readInt(8));this.compressedSize===f.MAX_VALUE_32BITS&&(this.compressedSize=p.readInt(8));this.localHeaderOffset===f.MAX_VALUE_32BITS&&(this.localHeaderOffset=p.readInt(8));this.diskNumberStart===f.MAX_VALUE_32BITS&&(this.diskNumberStart=p.readInt(4))}},
readExtraFields:function(p){var q=p.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});p.index+4<q;){var r=p.readInt(2);var u=p.readInt(2);var v=p.readData(u);this.extraFields[r]={id:r,length:u,value:v}}p.setIndex(q)},handleUTF8:function(){var p=m.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=l.utf8decode(this.fileName),this.fileCommentStr=l.utf8decode(this.fileComment);else{var q=this.findExtraFieldUnicodePath();null!==q?this.fileNameStr=q:(q=f.transformTo(p,
this.fileName),this.fileNameStr=this.loadOptions.decodeFileName(q));q=this.findExtraFieldUnicodeComment();null!==q?this.fileCommentStr=q:(p=f.transformTo(p,this.fileComment),this.fileCommentStr=this.loadOptions.decodeFileName(p))}},findExtraFieldUnicodePath:function(){var p=this.extraFields[28789];if(p){var q=n(p.value);return 1!==q.readInt(1)||k(this.fileName)!==q.readInt(4)?null:l.utf8decode(q.readData(p.length-5))}return null},findExtraFieldUnicodeComment:function(){var p=this.extraFields[25461];
if(p){var q=n(p.value);return 1!==q.readInt(1)||k(this.fileComment)!==q.readInt(4)?null:l.utf8decode(q.readData(p.length-5))}return null}};d.exports=g},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(c,d,b){function g(m,p,q){this.name=m;this.dir=q.dir;this.date=q.date;this.comment=q.comment;this.unixPermissions=q.unixPermissions;this.dosPermissions=q.dosPermissions;this._data=p;this._dataBinary=q.binary;this.options=
{compression:q.compression,compressionOptions:q.compressionOptions}}var n=c("./stream/StreamHelper"),f=c("./stream/DataWorker"),e=c("./utf8"),k=c("./compressedObject"),l=c("./stream/GenericWorker");g.prototype={internalStream:function(m){var p=null,q="string";try{if(!m)throw Error("No output type specified.");var r="string"===(q=m.toLowerCase())||"text"===q;"binarystring"!==q&&"text"!==q||(q="string");p=this._decompressWorker();var u=!this._dataBinary;u&&!r&&(p=p.pipe(new e.Utf8EncodeWorker));!u&&
r&&(p=p.pipe(new e.Utf8DecodeWorker))}catch(v){(p=new l("error")).error(v)}return new n(p,q,"")},async:function(m,p){return this.internalStream(m).accumulate(p)},nodeStream:function(m,p){return this.internalStream(m||"nodebuffer").toNodejsStream(p)},_compressWorker:function(m,p){if(this._data instanceof k&&this._data.compression.magic===m.magic)return this._data.getCompressedWorker();var q=this._decompressWorker();return this._dataBinary||(q=q.pipe(new e.Utf8EncodeWorker)),k.createWorkerFrom(q,m,
p)},_decompressWorker:function(){return this._data instanceof k?this._data.getContentWorker():this._data instanceof l?this._data:new f(this._data)}};c=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"];b=function(){throw Error("This method has been removed in JSZip 3.0, please check the upgrade guide.");};for(var h=0;h<c.length;h++)g.prototype[c[h]]=b;d.exports=g},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],
36:[function(c,d,b){(function(g){function n(){var q;f=!0;for(var r=p.length;r;){var u=p;p=[];for(q=-1;++q<r;)u[q]();r=p.length}f=!1}var f,e=g.MutationObserver||g.WebKitMutationObserver;if(e){var k=0;e=new e(n);var l=g.document.createTextNode("");e.observe(l,{characterData:!0});var h=function(){l.data=k=++k%2}}else if(g.setImmediate||void 0===g.MessageChannel)h="document"in g&&"onreadystatechange"in g.document.createElement("script")?function(){var q=g.document.createElement("script");q.onreadystatechange=
function(){n();q.onreadystatechange=null;q.parentNode.removeChild(q);q=null};g.document.documentElement.appendChild(q)}:function(){setTimeout(n,0)};else{var m=new g.MessageChannel;m.port1.onmessage=n;h=function(){m.port2.postMessage(0)}}var p=[];d.exports=function(q){1!==p.push(q)||f||h()}}).call(this,void 0!==Tc?Tc:"u">typeof self?self:"u">typeof window?window:{})},{}],37:[function(c,d,b){function g(){}function n(v){if("function"!=typeof v)throw TypeError("resolver must be a function");this.state=
u;this.queue=[];this.outcome=void 0;v!==g&&l(this,v)}function f(v,y,C){this.promise=v;"function"==typeof y&&(this.onFulfilled=y,this.callFulfilled=this.otherCallFulfilled);"function"==typeof C&&(this.onRejected=C,this.callRejected=this.otherCallRejected)}function e(v,y,C){m(function(){try{var w=y(C)}catch(D){return p.reject(v,D)}w===v?p.reject(v,TypeError("Cannot resolve promise with itself")):p.resolve(v,w)})}function k(v){var y=v&&v.then;if(v&&("object"==typeof v||"function"==typeof v)&&"function"==
typeof y)return function(){y.apply(v,arguments)}}function l(v,y){function C(G){D||(D=!0,p.reject(v,G))}function w(G){D||(D=!0,p.resolve(v,G))}var D=!1,x=h(function(){y(w,C)});"error"===x.status&&C(x.value)}function h(v,y){var C={};try{C.value=v(y),C.status="success"}catch(w){C.status="error",C.value=w}return C}var m=c("immediate"),p={},q=["REJECTED"],r=["FULFILLED"],u=["PENDING"];(d.exports=n).prototype.finally=function(v){if("function"!=typeof v)return this;var y=this.constructor;return this.then(function(C){return y.resolve(v()).then(function(){return C})},
function(C){return y.resolve(v()).then(function(){throw C;})})};n.prototype.catch=function(v){return this.then(null,v)};n.prototype.then=function(v,y){if("function"!=typeof v&&this.state===r||"function"!=typeof y&&this.state===q)return this;var C=new this.constructor(g);return this.state!==u?e(C,this.state===r?v:y,this.outcome):this.queue.push(new f(C,v,y)),C};f.prototype.callFulfilled=function(v){p.resolve(this.promise,v)};f.prototype.otherCallFulfilled=function(v){e(this.promise,this.onFulfilled,
v)};f.prototype.callRejected=function(v){p.reject(this.promise,v)};f.prototype.otherCallRejected=function(v){e(this.promise,this.onRejected,v)};p.resolve=function(v,y){var C=h(k,y);if("error"===C.status)return p.reject(v,C.value);if(C=C.value)l(v,C);else{v.state=r;v.outcome=y;C=-1;for(var w=v.queue.length;++C<w;)v.queue[C].callFulfilled(y)}return v};p.reject=function(v,y){v.state=q;v.outcome=y;for(var C=-1,w=v.queue.length;++C<w;)v.queue[C].callRejected(y);return v};n.resolve=function(v){return v instanceof
this?v:p.resolve(new this(g),v)};n.reject=function(v){var y=new this(g);return p.reject(y,v)};n.all=function(v){var y=this;if("[object Array]"!==Object.prototype.toString.call(v))return this.reject(TypeError("must be an array"));var C=v.length,w=!1;if(!C)return this.resolve([]);for(var D=Array(C),x=0,G=-1,H=new this(g);++G<C;)!function(N,B){y.resolve(N).then(function(P){D[B]=P;++x!==C||w||(w=!0,p.resolve(H,D))},function(P){w||(w=!0,p.reject(H,P))})}(v[G],G);return H};n.race=function(v){if("[object Array]"!==
Object.prototype.toString.call(v))return this.reject(TypeError("must be an array"));var y=v.length,C=!1;if(!y)return this.resolve([]);for(var w=-1,D=new this(g);++w<y;){var x=v[w];this.resolve(x).then(function(G){C||(C=!0,p.resolve(D,G))},function(G){C||(C=!0,p.reject(D,G))})}return D}},{immediate:36}],38:[function(c,d,b){b={};(0,c("./lib/utils/common").assign)(b,c("./lib/deflate"),c("./lib/inflate"),c("./lib/zlib/constants"));d.exports=b},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,
"./lib/zlib/constants":44}],39:[function(c,d,b){function g(p){if(!(this instanceof g))return new g(p);this.options=e.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},p||{});var q;p=this.options;p.raw&&0<p.windowBits?p.windowBits=-p.windowBits:p.gzip&&0<p.windowBits&&p.windowBits<16&&(p.windowBits+=16);this.err=0;this.msg="";this.ended=!1;this.chunks=[];this.strm=new h;this.strm.avail_out=0;var r=f.deflateInit2(this.strm,p.level,p.method,p.windowBits,p.memLevel,
p.strategy);if(0!==r)throw Error(l[r]);if(p.header&&f.deflateSetHeader(this.strm,p.header),p.dictionary){if(q="string"==typeof p.dictionary?k.string2buf(p.dictionary):"[object ArrayBuffer]"===m.call(p.dictionary)?new Uint8Array(p.dictionary):p.dictionary,0!==(r=f.deflateSetDictionary(this.strm,q)))throw Error(l[r]);this._dict_set=!0}}function n(p,q){q=new g(q);if(q.push(p,!0),q.err)throw q.msg||l[q.err];return q.result}var f=c("./zlib/deflate"),e=c("./utils/common"),k=c("./utils/strings"),l=c("./zlib/messages"),
h=c("./zlib/zstream"),m=Object.prototype.toString;g.prototype.push=function(p,q){var r,u=this.strm,v=this.options.chunkSize;if(this.ended)return!1;q=q===~~q?q:4*(!0===q);"string"==typeof p?u.input=k.string2buf(p):"[object ArrayBuffer]"===m.call(p)?u.input=new Uint8Array(p):u.input=p;u.next_in=0;u.avail_in=u.input.length;do{if(0===u.avail_out&&(u.output=new e.Buf8(v),u.next_out=0,u.avail_out=v),1!==(r=f.deflate(u,q))&&0!==r)return this.onEnd(r),this.ended=!0,!1;0!==u.avail_out&&(0!==u.avail_in||4!==
q&&2!==q)||("string"===this.options.to?this.onData(k.buf2binstring(e.shrinkBuf(u.output,u.next_out))):this.onData(e.shrinkBuf(u.output,u.next_out)))}while((0<u.avail_in||0===u.avail_out)&&1!==r);return 4===q?(r=f.deflateEnd(this.strm),this.onEnd(r),this.ended=!0,0===r):2!==q||(this.onEnd(0),u.avail_out=0,!0)};g.prototype.onData=function(p){this.chunks.push(p)};g.prototype.onEnd=function(p){0===p&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=e.flattenChunks(this.chunks));
this.chunks=[];this.err=p;this.msg=this.strm.msg};b.Deflate=g;b.deflate=n;b.deflateRaw=function(p,q){return(q=q||{}).raw=!0,n(p,q)};b.gzip=function(p,q){return(q=q||{}).gzip=!0,n(p,q)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(c,d,b){function g(r){if(!(this instanceof g))return new g(r);var u=this.options=e.assign({chunkSize:16384,windowBits:0,to:""},r||{});u.raw&&0<=u.windowBits&&u.windowBits<16&&(u.windowBits=-u.windowBits,
0===u.windowBits&&(u.windowBits=-15));!(0<=u.windowBits&&u.windowBits<16)||r&&r.windowBits||(u.windowBits+=32);15<u.windowBits&&u.windowBits<48&&0==(15&u.windowBits)&&(u.windowBits|=15);this.err=0;this.msg="";this.ended=!1;this.chunks=[];this.strm=new m;this.strm.avail_out=0;r=f.inflateInit2(this.strm,u.windowBits);if(r!==l.Z_OK)throw Error(h[r]);this.header=new p;f.inflateGetHeader(this.strm,this.header)}function n(r,u){u=new g(u);if(u.push(r,!0),u.err)throw u.msg||h[u.err];return u.result}var f=
c("./zlib/inflate"),e=c("./utils/common"),k=c("./utils/strings"),l=c("./zlib/constants"),h=c("./zlib/messages"),m=c("./zlib/zstream"),p=c("./zlib/gzheader"),q=Object.prototype.toString;g.prototype.push=function(r,u){var v,y,C,w,D,x=this.strm,G=this.options.chunkSize,H=this.options.dictionary,N=!1;if(this.ended)return!1;u=u===~~u?u:!0===u?l.Z_FINISH:l.Z_NO_FLUSH;"string"==typeof r?x.input=k.binstring2buf(r):"[object ArrayBuffer]"===q.call(r)?x.input=new Uint8Array(r):x.input=r;x.next_in=0;x.avail_in=
x.input.length;do{if(0===x.avail_out&&(x.output=new e.Buf8(G),x.next_out=0,x.avail_out=G),(v=f.inflate(x,l.Z_NO_FLUSH))===l.Z_NEED_DICT&&H&&(D="string"==typeof H?k.string2buf(H):"[object ArrayBuffer]"===q.call(H)?new Uint8Array(H):H,v=f.inflateSetDictionary(this.strm,D)),v===l.Z_BUF_ERROR&&!0===N&&(v=l.Z_OK,N=!1),v!==l.Z_STREAM_END&&v!==l.Z_OK)return this.onEnd(v),this.ended=!0,!1;x.next_out&&(0!==x.avail_out&&v!==l.Z_STREAM_END&&(0!==x.avail_in||u!==l.Z_FINISH&&u!==l.Z_SYNC_FLUSH)||("string"===this.options.to?
(y=k.utf8border(x.output,x.next_out),C=x.next_out-y,w=k.buf2string(x.output,y),x.next_out=C,x.avail_out=G-C,C&&e.arraySet(x.output,x.output,y,C,0),this.onData(w)):this.onData(e.shrinkBuf(x.output,x.next_out))));0===x.avail_in&&0===x.avail_out&&(N=!0)}while((0<x.avail_in||0===x.avail_out)&&v!==l.Z_STREAM_END);return v===l.Z_STREAM_END&&(u=l.Z_FINISH),u===l.Z_FINISH?(v=f.inflateEnd(this.strm),this.onEnd(v),this.ended=!0,v===l.Z_OK):u!==l.Z_SYNC_FLUSH||(this.onEnd(l.Z_OK),x.avail_out=0,!0)};g.prototype.onData=
function(r){this.chunks.push(r)};g.prototype.onEnd=function(r){r===l.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=e.flattenChunks(this.chunks));this.chunks=[];this.err=r;this.msg=this.strm.msg};b.Inflate=g;b.inflate=n;b.inflateRaw=function(r,u){return(u=u||{}).raw=!0,n(r,u)};b.ungzip=n},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(c,d,b){c="u">typeof Uint8Array&&
"u">typeof Uint16Array&&"u">typeof Int32Array;b.assign=function(f){for(var e=Array.prototype.slice.call(arguments,1);e.length;){var k=e.shift();if(k){if("object"!=typeof k)throw TypeError(k+"must be non-object");for(var l in k)k.hasOwnProperty(l)&&(f[l]=k[l])}}return f};b.shrinkBuf=function(f,e){return f.length===e?f:f.subarray?f.subarray(0,e):(f.length=e,f)};var g={arraySet:function(f,e,k,l,h){if(e.subarray&&f.subarray)f.set(e.subarray(k,k+l),h);else for(var m=0;m<l;m++)f[h+m]=e[k+m]},flattenChunks:function(f){var e,
k;var l=k=0;for(e=f.length;l<e;l++)k+=f[l].length;var h=new Uint8Array(k);l=k=0;for(e=f.length;l<e;l++){var m=f[l];h.set(m,k);k+=m.length}return h}},n={arraySet:function(f,e,k,l,h){for(var m=0;m<l;m++)f[h+m]=e[k+m]},flattenChunks:function(f){return[].concat.apply([],f)}};b.setTyped=function(f){f?(b.Buf8=Uint8Array,b.Buf16=Uint16Array,b.Buf32=Int32Array,b.assign(b,g)):(b.Buf8=Array,b.Buf16=Array,b.Buf32=Array,b.assign(b,n))};b.setTyped(c)},{}],42:[function(c,d,b){function g(l,h){if(h<65537&&(l.subarray&&
e||!l.subarray&&f))return String.fromCharCode.apply(null,n.shrinkBuf(l,h));for(var m="",p=0;p<h;p++)m+=String.fromCharCode(l[p]);return m}var n=c("./common"),f=!0,e=!0;try{String.fromCharCode.apply(null,[0])}catch(l){f=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(l){e=!1}var k=new n.Buf8(256);for(c=0;c<256;c++)k[c]=252<=c?6:248<=c?5:240<=c?4:224<=c?3:192<=c?2:1;k[254]=k[254]=1;b.string2buf=function(l){var h,m,p,q,r=l.length,u=0;for(p=0;p<r;p++)55296==(64512&(h=l.charCodeAt(p)))&&
p+1<r&&56320==(64512&(m=l.charCodeAt(p+1)))&&(h=65536+(h-55296<<10)+(m-56320),p++),u+=h<128?1:h<2048?2:h<65536?3:4;var v=new n.Buf8(u);for(p=q=0;q<u;p++)55296==(64512&(h=l.charCodeAt(p)))&&p+1<r&&56320==(64512&(m=l.charCodeAt(p+1)))&&(h=65536+(h-55296<<10)+(m-56320),p++),h<128?v[q++]=h:(h<2048?v[q++]=192|h>>>6:(h<65536?v[q++]=224|h>>>12:(v[q++]=240|h>>>18,v[q++]=128|h>>>12&63),v[q++]=128|h>>>6&63),v[q++]=128|63&h);return v};b.buf2binstring=function(l){return g(l,l.length)};b.binstring2buf=function(l){for(var h=
new n.Buf8(l.length),m=0,p=h.length;m<p;m++)h[m]=l.charCodeAt(m);return h};b.buf2string=function(l,h){var m,p,q,r=h||l.length,u=Array(2*r);for(h=m=0;h<r;)if((p=l[h++])<128)u[m++]=p;else if(4<(q=k[p]))u[m++]=65533,h+=q-1;else{for(p&=2===q?31:3===q?15:7;1<q&&h<r;)p=p<<6|63&l[h++],q--;1<q?u[m++]=65533:p<65536?u[m++]=p:(p-=65536,u[m++]=55296|p>>10&1023,u[m++]=56320|1023&p)}return g(u,m)};b.utf8border=function(l,h){var m;(h=h||l.length)>l.length&&(h=l.length);for(m=h-1;0<=m&&128==(192&l[m]);)m--;return m<
0||0===m?h:m+k[l[m]]>h?m:h}},{"./common":41}],43:[function(c,d,b){d.exports=function(g,n,f,e){var k=65535&g;g=g>>>16&65535;for(var l;0!==f;){for(f-=l=2E3<f?2E3:f;g=g+(k=k+n[e++]|0)|0,--l;);k%=65521;g%=65521}return k|g<<16}},{}],44:[function(c,d,b){d.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,
Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(c,d,b){var g=function(){for(var n,f=[],e=0;e<256;e++){n=e;for(var k=0;k<8;k++)n=1&n?3988292384^n>>>1:n>>>1;f[e]=n}return f}();d.exports=function(n,f,e,k){e=k+e;for(n^=-1;k<e;k++)n=n>>>8^g[255&(n^f[k])];return-1^n}},{}],46:[function(c,d,b){function g(B,P){return B.msg=H[P],P}function n(B){for(var P=B.length;0<=--P;)B[P]=0}function f(B){var P=
B.state,V=P.pending;V>B.avail_out&&(V=B.avail_out);0!==V&&(w.arraySet(B.output,P.pending_buf,P.pending_out,V,B.next_out),B.next_out+=V,P.pending_out+=V,B.total_out+=V,B.avail_out-=V,P.pending-=V,0===P.pending&&(P.pending_out=0))}function e(B,P){D._tr_flush_block(B,0<=B.block_start?B.block_start:-1,B.strstart-B.block_start,P);B.block_start=B.strstart;f(B.strm)}function k(B,P){B.pending_buf[B.pending++]=P}function l(B,P){B.pending_buf[B.pending++]=P>>>8&255;B.pending_buf[B.pending++]=255&P}function h(B,
P){var V,L,ia=B.max_chain_length,aa=B.strstart,ma=B.prev_length,ca=B.nice_match,ra=B.strstart>B.w_size-262?B.strstart-(B.w_size-262):0,ka=B.window,qa=B.w_mask,M=B.prev,A=B.strstart+258,K=ka[aa+ma-1],S=ka[aa+ma];B.prev_length>=B.good_match&&(ia>>=2);ca>B.lookahead&&(ca=B.lookahead);do if(ka[(V=P)+ma]===S&&ka[V+ma-1]===K&&ka[V]===ka[aa]&&ka[++V]===ka[aa+1]){aa+=2;for(V++;ka[++aa]===ka[++V]&&ka[++aa]===ka[++V]&&ka[++aa]===ka[++V]&&ka[++aa]===ka[++V]&&ka[++aa]===ka[++V]&&ka[++aa]===ka[++V]&&ka[++aa]===
ka[++V]&&ka[++aa]===ka[++V]&&aa<A;);if(L=258-(A-aa),aa=A-258,ma<L){if(B.match_start=P,ca<=(ma=L))break;K=ka[aa+ma-1];S=ka[aa+ma]}}while((P=M[P&qa])>ra&&0!=--ia);return ma<=B.lookahead?ma:B.lookahead}function m(B){var P,V,L,ia,aa,ma,ca,ra,ka,qa=B.w_size;do{if(ia=B.window_size-B.lookahead-B.strstart,B.strstart>=qa+(qa-262)){w.arraySet(B.window,B.window,qa,qa,0);B.match_start-=qa;B.strstart-=qa;B.block_start-=qa;for(P=V=B.hash_size;L=B.head[--P],B.head[P]=qa<=L?L-qa:0,--V;);for(P=V=qa;L=B.prev[--P],
B.prev[P]=qa<=L?L-qa:0,--V;);ia+=qa}if(0===B.strm.avail_in)break;if(aa=B.strm,ma=B.window,ca=B.strstart+B.lookahead,ka=void 0,(ra=ia)<(ka=aa.avail_in)&&(ka=ra),V=0===ka?0:(aa.avail_in-=ka,w.arraySet(ma,aa.input,aa.next_in,ka,ca),1===aa.state.wrap?aa.adler=x(aa.adler,ma,ka,ca):2===aa.state.wrap&&(aa.adler=G(aa.adler,ma,ka,ca)),aa.next_in+=ka,aa.total_in+=ka,ka),B.lookahead+=V,B.lookahead+B.insert>=3)for(P=B.strstart-B.insert,B.ins_h=B.window[P],B.ins_h=(B.ins_h<<B.hash_shift^B.window[P+1])&B.hash_mask;B.insert&&
(B.ins_h=(B.ins_h<<B.hash_shift^B.window[P+3-1])&B.hash_mask,B.prev[P&B.w_mask]=B.head[B.ins_h],B.head[B.ins_h]=P,P++,B.insert--,!(B.lookahead+B.insert<3)););}while(B.lookahead<262&&0!==B.strm.avail_in)}function p(B,P){for(var V,L;;){if(B.lookahead<262){if(m(B),B.lookahead<262&&0===P)return 1;if(0===B.lookahead)break}if(V=0,B.lookahead>=3&&(B.ins_h=(B.ins_h<<B.hash_shift^B.window[B.strstart+3-1])&B.hash_mask,V=B.prev[B.strstart&B.w_mask]=B.head[B.ins_h],B.head[B.ins_h]=B.strstart),0!==V&&B.strstart-
V<=B.w_size-262&&(B.match_length=h(B,V)),B.match_length>=3)if(L=D._tr_tally(B,B.strstart-B.match_start,B.match_length-3),B.lookahead-=B.match_length,B.match_length<=B.max_lazy_match&&B.lookahead>=3){for(B.match_length--;B.strstart++,B.ins_h=(B.ins_h<<B.hash_shift^B.window[B.strstart+3-1])&B.hash_mask,V=B.prev[B.strstart&B.w_mask]=B.head[B.ins_h],B.head[B.ins_h]=B.strstart,0!=--B.match_length;);B.strstart++}else B.strstart+=B.match_length,B.match_length=0,B.ins_h=B.window[B.strstart],B.ins_h=(B.ins_h<<
B.hash_shift^B.window[B.strstart+1])&B.hash_mask;else L=D._tr_tally(B,0,B.window[B.strstart]),B.lookahead--,B.strstart++;if(L&&(e(B,!1),0===B.strm.avail_out))return 1}return B.insert=B.strstart<2?B.strstart:2,4===P?(e(B,!0),0===B.strm.avail_out?3:4):B.last_lit&&(e(B,!1),0===B.strm.avail_out)?1:2}function q(B,P){for(var V,L,ia;;){if(B.lookahead<262){if(m(B),B.lookahead<262&&0===P)return 1;if(0===B.lookahead)break}if(V=0,B.lookahead>=3&&(B.ins_h=(B.ins_h<<B.hash_shift^B.window[B.strstart+3-1])&B.hash_mask,
V=B.prev[B.strstart&B.w_mask]=B.head[B.ins_h],B.head[B.ins_h]=B.strstart),B.prev_length=B.match_length,B.prev_match=B.match_start,B.match_length=2,0!==V&&B.prev_length<B.max_lazy_match&&B.strstart-V<=B.w_size-262&&(B.match_length=h(B,V),B.match_length<=5&&(1===B.strategy||3===B.match_length&&4096<B.strstart-B.match_start)&&(B.match_length=2)),B.prev_length>=3&&B.match_length<=B.prev_length){ia=B.strstart+B.lookahead-3;L=D._tr_tally(B,B.strstart-1-B.prev_match,B.prev_length-3);B.lookahead-=B.prev_length-
1;for(B.prev_length-=2;++B.strstart<=ia&&(B.ins_h=(B.ins_h<<B.hash_shift^B.window[B.strstart+3-1])&B.hash_mask,V=B.prev[B.strstart&B.w_mask]=B.head[B.ins_h],B.head[B.ins_h]=B.strstart),0!=--B.prev_length;);if(B.match_available=0,B.match_length=2,B.strstart++,L&&(e(B,!1),0===B.strm.avail_out))return 1}else if(B.match_available){if(D._tr_tally(B,0,B.window[B.strstart-1])&&e(B,!1),B.strstart++,B.lookahead--,0===B.strm.avail_out)return 1}else B.match_available=1,B.strstart++,B.lookahead--}return B.match_available&&
(D._tr_tally(B,0,B.window[B.strstart-1]),B.match_available=0),B.insert=B.strstart<2?B.strstart:2,4===P?(e(B,!0),0===B.strm.avail_out?3:4):B.last_lit&&(e(B,!1),0===B.strm.avail_out)?1:2}function r(B,P,V,L,ia){this.good_length=B;this.max_lazy=P;this.nice_length=V;this.max_chain=L;this.func=ia}function u(){this.strm=null;this.status=0;this.pending_buf=null;this.wrap=this.pending=this.pending_out=this.pending_buf_size=0;this.gzhead=null;this.gzindex=0;this.method=8;this.last_flush=-1;this.w_mask=this.w_bits=
this.w_size=0;this.window=null;this.window_size=0;this.head=this.prev=null;this.nice_match=this.good_match=this.strategy=this.level=this.max_lazy_match=this.max_chain_length=this.prev_length=this.lookahead=this.match_start=this.strstart=this.match_available=this.prev_match=this.match_length=this.block_start=this.hash_shift=this.hash_mask=this.hash_bits=this.hash_size=this.ins_h=0;this.dyn_ltree=new w.Buf16(1146);this.dyn_dtree=new w.Buf16(122);this.bl_tree=new w.Buf16(78);n(this.dyn_ltree);n(this.dyn_dtree);
n(this.bl_tree);this.bl_desc=this.d_desc=this.l_desc=null;this.bl_count=new w.Buf16(16);this.heap=new w.Buf16(573);n(this.heap);this.heap_max=this.heap_len=0;this.depth=new w.Buf16(573);n(this.depth);this.bi_valid=this.bi_buf=this.insert=this.matches=this.static_len=this.opt_len=this.d_buf=this.last_lit=this.lit_bufsize=this.l_buf=0}function v(B){var P;return B&&B.state?(B.total_in=B.total_out=0,B.data_type=2,(P=B.state).pending=0,P.pending_out=0,P.wrap<0&&(P.wrap=-P.wrap),P.status=P.wrap?42:113,
B.adler=+(2!==P.wrap),P.last_flush=0,D._tr_init(P),0):g(B,-2)}function y(B){var P,V=v(B);return 0===V&&((P=B.state).window_size=2*P.w_size,n(P.head),P.max_lazy_match=N[P.level].max_lazy,P.good_match=N[P.level].good_length,P.nice_match=N[P.level].nice_length,P.max_chain_length=N[P.level].max_chain,P.strstart=0,P.block_start=0,P.lookahead=0,P.insert=0,P.match_length=P.prev_length=2,P.match_available=0,P.ins_h=0),V}function C(B,P,V,L,ia,aa){if(!B)return-2;var ma=1;if(-1===P&&(P=6),L<0?(ma=0,L=-L):15<
L&&(ma=2,L-=16),ia<1||9<ia||8!==V||L<8||15<L||P<0||9<P||aa<0||4<aa)return g(B,-2);8===L&&(L=9);var ca=new u;return(B.state=ca).strm=B,ca.wrap=ma,ca.gzhead=null,ca.w_bits=L,ca.w_size=1<<ca.w_bits,ca.w_mask=ca.w_size-1,ca.hash_bits=ia+7,ca.hash_size=1<<ca.hash_bits,ca.hash_mask=ca.hash_size-1,ca.hash_shift=~~((ca.hash_bits+3-1)/3),ca.window=new w.Buf8(2*ca.w_size),ca.head=new w.Buf16(ca.hash_size),ca.prev=new w.Buf16(ca.w_size),ca.lit_bufsize=1<<ia+6,ca.pending_buf_size=4*ca.lit_bufsize,ca.pending_buf=
new w.Buf8(ca.pending_buf_size),ca.d_buf=+ca.lit_bufsize,ca.l_buf=3*ca.lit_bufsize,ca.level=P,ca.strategy=aa,ca.method=V,y(B)}var w=c("../utils/common"),D=c("./trees"),x=c("./adler32"),G=c("./crc32"),H=c("./messages");var N=[new r(0,0,0,0,function(B,P){var V=65535;for(65535>B.pending_buf_size-5&&(V=B.pending_buf_size-5);;){if(B.lookahead<=1){if(m(B),0===B.lookahead&&0===P)return 1;if(0===B.lookahead)break}B.strstart+=B.lookahead;B.lookahead=0;var L=B.block_start+V;if((0===B.strstart||B.strstart>=
L)&&(B.lookahead=B.strstart-L,B.strstart=L,e(B,!1),0===B.strm.avail_out)||B.strstart-B.block_start>=B.w_size-262&&(e(B,!1),0===B.strm.avail_out))return 1}return B.insert=0,4===P?(e(B,!0),0===B.strm.avail_out?3:4):(B.strstart>B.block_start&&(e(B,!1),B.strm.avail_out),1)}),new r(4,4,8,4,p),new r(4,5,16,8,p),new r(4,6,32,32,p),new r(4,4,16,16,q),new r(8,16,32,32,q),new r(8,16,128,128,q),new r(8,32,128,256,q),new r(32,128,258,1024,q),new r(32,258,258,4096,q)];b.deflateInit=function(B,P){return C(B,P,
8,15,8,0)};b.deflateInit2=C;b.deflateReset=y;b.deflateResetKeep=v;b.deflateSetHeader=function(B,P){return B&&B.state?2!==B.state.wrap?-2:(B.state.gzhead=P,0):-2};b.deflate=function(B,P){var V,L;if(!B||!B.state||5<P||P<0)return B?g(B,-2):-2;if(L=B.state,!B.output||!B.input&&0!==B.avail_in||666===L.status&&4!==P)return g(B,0===B.avail_out?-5:-2);if(L.strm=B,V=L.last_flush,L.last_flush=P,42===L.status)if(2===L.wrap)B.adler=0,k(L,31),k(L,139),k(L,8),L.gzhead?(k(L,+!!L.gzhead.text+2*!!L.gzhead.hcrc+4*
!!L.gzhead.extra+8*!!L.gzhead.name+16*!!L.gzhead.comment),k(L,255&L.gzhead.time),k(L,L.gzhead.time>>8&255),k(L,L.gzhead.time>>16&255),k(L,L.gzhead.time>>24&255),k(L,9===L.level?2:4*(2<=L.strategy||L.level<2)),k(L,255&L.gzhead.os),L.gzhead.extra&&L.gzhead.extra.length&&(k(L,255&L.gzhead.extra.length),k(L,L.gzhead.extra.length>>8&255)),L.gzhead.hcrc&&(B.adler=G(B.adler,L.pending_buf,L.pending,0)),L.gzindex=0,L.status=69):(k(L,0),k(L,0),k(L,0),k(L,0),k(L,0),k(L,9===L.level?2:4*(2<=L.strategy||L.level<
2)),k(L,3),L.status=113);else{var ia=8+(L.w_bits-8<<4)<<8;ia|=(2<=L.strategy||L.level<2?0:L.level<6?1:6===L.level?2:3)<<6;0!==L.strstart&&(ia|=32);L.status=113;l(L,ia+(31-ia%31));0!==L.strstart&&(l(L,B.adler>>>16),l(L,65535&B.adler));B.adler=1}if(69===L.status)if(L.gzhead.extra){for(ia=L.pending;L.gzindex<(65535&L.gzhead.extra.length)&&(L.pending!==L.pending_buf_size||(L.gzhead.hcrc&&L.pending>ia&&(B.adler=G(B.adler,L.pending_buf,L.pending-ia,ia)),f(B),ia=L.pending,L.pending!==L.pending_buf_size));)k(L,
255&L.gzhead.extra[L.gzindex]),L.gzindex++;L.gzhead.hcrc&&L.pending>ia&&(B.adler=G(B.adler,L.pending_buf,L.pending-ia,ia));L.gzindex===L.gzhead.extra.length&&(L.gzindex=0,L.status=73)}else L.status=73;if(73===L.status)if(L.gzhead.name){ia=L.pending;do{if(L.pending===L.pending_buf_size&&(L.gzhead.hcrc&&L.pending>ia&&(B.adler=G(B.adler,L.pending_buf,L.pending-ia,ia)),f(B),ia=L.pending,L.pending===L.pending_buf_size)){var aa=1;break}aa=L.gzindex<L.gzhead.name.length?255&L.gzhead.name.charCodeAt(L.gzindex++):
0;k(L,aa)}while(0!==aa);L.gzhead.hcrc&&L.pending>ia&&(B.adler=G(B.adler,L.pending_buf,L.pending-ia,ia));0===aa&&(L.gzindex=0,L.status=91)}else L.status=91;if(91===L.status)if(L.gzhead.comment){ia=L.pending;do{if(L.pending===L.pending_buf_size&&(L.gzhead.hcrc&&L.pending>ia&&(B.adler=G(B.adler,L.pending_buf,L.pending-ia,ia)),f(B),ia=L.pending,L.pending===L.pending_buf_size)){aa=1;break}aa=L.gzindex<L.gzhead.comment.length?255&L.gzhead.comment.charCodeAt(L.gzindex++):0;k(L,aa)}while(0!==aa);L.gzhead.hcrc&&
L.pending>ia&&(B.adler=G(B.adler,L.pending_buf,L.pending-ia,ia));0===aa&&(L.status=103)}else L.status=103;if(103===L.status&&(L.gzhead.hcrc?(L.pending+2>L.pending_buf_size&&f(B),L.pending+2<=L.pending_buf_size&&(k(L,255&B.adler),k(L,B.adler>>8&255),B.adler=0,L.status=113)):L.status=113),0!==L.pending){if(f(B),0===B.avail_out)return L.last_flush=-1,0}else if(0===B.avail_in&&(P<<1)-9*(4<P)<=(V<<1)-9*(4<V)&&4!==P)return g(B,-5);if(666===L.status&&0!==B.avail_in)return g(B,-5);if(0!==B.avail_in||0!==
L.lookahead||0!==P&&666!==L.status){V=2===L.strategy?function(ma,ca){for(var ra;;){if(0===ma.lookahead&&(m(ma),0===ma.lookahead)){if(0===ca)return 1;break}if(ma.match_length=0,ra=D._tr_tally(ma,0,ma.window[ma.strstart]),ma.lookahead--,ma.strstart++,ra&&(e(ma,!1),0===ma.strm.avail_out))return 1}return ma.insert=0,4===ca?(e(ma,!0),0===ma.strm.avail_out?3:4):ma.last_lit&&(e(ma,!1),0===ma.strm.avail_out)?1:2}(L,P):3===L.strategy?function(ma,ca){for(var ra,ka,qa,M,A=ma.window;;){if(ma.lookahead<=258){if(m(ma),
ma.lookahead<=258&&0===ca)return 1;if(0===ma.lookahead)break}if(ma.match_length=0,ma.lookahead>=3&&0<ma.strstart&&(ka=A[qa=ma.strstart-1])===A[++qa]&&ka===A[++qa]&&ka===A[++qa]){for(M=ma.strstart+258;ka===A[++qa]&&ka===A[++qa]&&ka===A[++qa]&&ka===A[++qa]&&ka===A[++qa]&&ka===A[++qa]&&ka===A[++qa]&&ka===A[++qa]&&qa<M;);ma.match_length=258-(M-qa);ma.match_length>ma.lookahead&&(ma.match_length=ma.lookahead)}if(ma.match_length>=3?(ra=D._tr_tally(ma,1,ma.match_length-3),ma.lookahead-=ma.match_length,ma.strstart+=
ma.match_length,ma.match_length=0):(ra=D._tr_tally(ma,0,ma.window[ma.strstart]),ma.lookahead--,ma.strstart++),ra&&(e(ma,!1),0===ma.strm.avail_out))return 1}return ma.insert=0,4===ca?(e(ma,!0),0===ma.strm.avail_out?3:4):ma.last_lit&&(e(ma,!1),0===ma.strm.avail_out)?1:2}(L,P):N[L.level].func(L,P);if(3!==V&&4!==V||(L.status=666),1===V||3===V)return 0===B.avail_out&&(L.last_flush=-1),0;if(2===V&&(1===P?D._tr_align(L):5!==P&&(D._tr_stored_block(L,0,0,!1),3===P&&(n(L.head),0===L.lookahead&&(L.strstart=
0,L.block_start=0,L.insert=0))),f(B),0===B.avail_out))return L.last_flush=-1,0}return 4!==P?0:L.wrap<=0?1:(2===L.wrap?(k(L,255&B.adler),k(L,B.adler>>8&255),k(L,B.adler>>16&255),k(L,B.adler>>24&255),k(L,255&B.total_in),k(L,B.total_in>>8&255),k(L,B.total_in>>16&255),k(L,B.total_in>>24&255)):(l(L,B.adler>>>16),l(L,65535&B.adler)),f(B),0<L.wrap&&(L.wrap=-L.wrap),+(0===L.pending))};b.deflateEnd=function(B){var P;return B&&B.state?42!==(P=B.state.status)&&69!==P&&73!==P&&91!==P&&103!==P&&113!==P&&666!==
P?g(B,-2):(B.state=null,113===P?g(B,-3):0):-2};b.deflateSetDictionary=function(B,P){var V,L,ia;var aa=P.length;if(!B||!B.state||2===(L=(V=B.state).wrap)||1===L&&42!==V.status||V.lookahead)return-2;1===L&&(B.adler=x(B.adler,P,aa,0));V.wrap=0;aa>=V.w_size&&(0===L&&(n(V.head),V.strstart=0,V.block_start=0,V.insert=0),ia=new w.Buf8(V.w_size),w.arraySet(ia,P,aa-V.w_size,V.w_size,0),P=ia,aa=V.w_size);ia=B.avail_in;var ma=B.next_in;var ca=B.input;B.avail_in=aa;B.next_in=0;B.input=P;for(m(V);V.lookahead>=
3;){P=V.strstart;for(aa=V.lookahead-2;V.ins_h=(V.ins_h<<V.hash_shift^V.window[P+3-1])&V.hash_mask,V.prev[P&V.w_mask]=V.head[V.ins_h],V.head[V.ins_h]=P,P++,--aa;);V.strstart=P;V.lookahead=2;m(V)}return V.strstart+=V.lookahead,V.block_start=V.strstart,V.insert=V.lookahead,V.lookahead=0,V.match_length=V.prev_length=2,V.match_available=0,B.next_in=ma,B.input=ca,B.avail_in=ia,V.wrap=L,0};b.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,
"./trees":52}],47:[function(c,d,b){d.exports=function(){this.os=this.xflags=this.time=this.text=0;this.extra=null;this.extra_len=0;this.comment=this.name="";this.hcrc=0;this.done=!1}},{}],48:[function(c,d,b){d.exports=function(g,n){var f,e,k,l;var h=g.state;var m=g.next_in;var p=g.input;var q=m+(g.avail_in-5);var r=g.next_out;var u=g.output;n=r-(n-g.avail_out);var v=r+(g.avail_out-257);var y=h.dmax;var C=h.wsize;var w=h.whave;var D=h.wnext;var x=h.window;var G=h.hold;var H=h.bits;var N=h.lencode;
var B=h.distcode;var P=(1<<h.lenbits)-1;var V=(1<<h.distbits)-1;a:do for(H<15&&(G+=p[m++]<<H,H+=8,G+=p[m++]<<H,H+=8),f=N[G&P];;){if(G>>>=e=f>>>24,H-=e,0==(e=f>>>16&255))u[r++]=65535&f;else{if(!(16&e)){if(0==(64&e)){f=N[(65535&f)+(G&(1<<e)-1)];continue}if(32&e){h.mode=12;break a}g.msg="invalid literal/length code";h.mode=30;break a}var L=65535&f;(e&=15)&&(H<e&&(G+=p[m++]<<H,H+=8),L+=G&(1<<e)-1,G>>>=e,H-=e);H<15&&(G+=p[m++]<<H,H+=8,G+=p[m++]<<H,H+=8);for(f=B[G&V];;){if(G>>>=e=f>>>24,H-=e,!(16&(e=f>>>
16&255))){if(0==(64&e)){f=B[(65535&f)+(G&(1<<e)-1)];continue}g.msg="invalid distance code";h.mode=30;break a}if(k=65535&f,H<(e&=15)&&(G+=p[m++]<<H,(H+=8)<e&&(G+=p[m++]<<H,H+=8)),y<(k+=G&(1<<e)-1)){g.msg="invalid distance too far back";h.mode=30;break a}if(G>>>=e,H-=e,(e=r-n)<k){if(w<(e=k-e)&&h.sane){g.msg="invalid distance too far back";h.mode=30;break a}if(l=x,(f=0)===D){if(f+=C-e,e<L){for(L-=e;u[r++]=x[f++],--e;);f=r-k;l=u}}else if(D<e){if(f+=C+D-e,(e-=D)<L){for(L-=e;u[r++]=x[f++],--e;);if(f=0,
D<L){for(L-=e=D;u[r++]=x[f++],--e;);f=r-k;l=u}}}else if(f+=D-e,e<L){for(L-=e;u[r++]=x[f++],--e;);f=r-k;l=u}for(;2<L;)u[r++]=l[f++],u[r++]=l[f++],u[r++]=l[f++],L-=3;L&&(u[r++]=l[f++],1<L&&(u[r++]=l[f++]))}else{for(f=r-k;u[r++]=u[f++],u[r++]=u[f++],u[r++]=u[f++],2<(L-=3););L&&(u[r++]=u[f++],1<L&&(u[r++]=u[f++]))}break}}break}while(m<q&&r<v);m-=L=H>>3;G&=(1<<(H-=L<<3))-1;g.next_in=m;g.next_out=r;g.avail_in=m<q?q-m+5:5-(m-q);g.avail_out=r<v?v-r+257:257-(r-v);h.hold=G;h.bits=H}},{}],49:[function(c,d,b){function g(w){return(w>>>
24&255)+(w>>>8&65280)+((65280&w)<<8)+((255&w)<<24)}function n(){this.mode=0;this.last=!1;this.wrap=0;this.havedict=!1;this.total=this.check=this.dmax=this.flags=0;this.head=null;this.wnext=this.whave=this.wsize=this.wbits=0;this.window=null;this.extra=this.offset=this.length=this.bits=this.hold=0;this.distcode=this.lencode=null;this.have=this.ndist=this.nlen=this.ncode=this.distbits=this.lenbits=0;this.next=null;this.lens=new m.Buf16(320);this.work=new m.Buf16(288);this.distdyn=this.lendyn=null;this.was=
this.back=this.sane=0}function f(w){var D;return w&&w.state?(D=w.state,w.total_in=w.total_out=D.total=0,w.msg="",D.wrap&&(w.adler=1&D.wrap),D.mode=1,D.last=0,D.havedict=0,D.dmax=32768,D.head=null,D.hold=0,D.bits=0,D.lencode=D.lendyn=new m.Buf32(852),D.distcode=D.distdyn=new m.Buf32(592),D.sane=1,D.back=-1,0):-2}function e(w){var D;return w&&w.state?((D=w.state).wsize=0,D.whave=0,D.wnext=0,f(w)):-2}function k(w,D){var x,G;return w&&w.state?(G=w.state,D<0?(x=0,D=-D):(x=1+(D>>4),D<48&&(D&=15)),D&&(D<
8||15<D)?-2:(null!==G.window&&G.wbits!==D&&(G.window=null),G.wrap=x,G.wbits=D,e(w))):-2}function l(w,D){var x;return w?((w.state=new n).window=null,0!==(x=k(w,D))&&(w.state=null),x):-2}function h(w,D,x,G){var H;w=w.state;return null===w.window&&(w.wsize=1<<w.wbits,w.wnext=0,w.whave=0,w.window=new m.Buf8(w.wsize)),G>=w.wsize?(m.arraySet(w.window,D,x-w.wsize,w.wsize,0),w.wnext=0,w.whave=w.wsize):(G<(H=w.wsize-w.wnext)&&(H=G),m.arraySet(w.window,D,x-G,H,w.wnext),(G-=H)?(m.arraySet(w.window,D,x-G,G,0),
w.wnext=G,w.whave=w.wsize):(w.wnext+=H,w.wnext===w.wsize&&(w.wnext=0),w.whave<w.wsize&&(w.whave+=H))),0}var m=c("../utils/common"),p=c("./adler32"),q=c("./crc32"),r=c("./inffast"),u=c("./inftrees"),v,y,C=!0;b.inflateReset=e;b.inflateReset2=k;b.inflateResetKeep=f;b.inflateInit=function(w){return l(w,15)};b.inflateInit2=l;b.inflate=function(w,D){var x,G,H,N,B,P,V,L=0,ia=new m.Buf8(4),aa=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!w||!w.state||!w.output||!w.input&&0!==w.avail_in)return-2;12===
(x=w.state).mode&&(x.mode=13);var ma=w.next_out;var ca=w.output;var ra=w.avail_out;var ka=w.next_in;var qa=w.input;var M=w.avail_in;var A=x.hold;var K=x.bits;var S=M;var na=ra;var Z=0;a:for(;;)switch(x.mode){case 1:if(0===x.wrap){x.mode=13;break}for(;K<16;){if(0===M)break a;M--;A+=qa[ka++]<<K;K+=8}if(2&x.wrap&&35615===A){ia[x.check=0]=255&A;ia[1]=A>>>8&255;x.check=q(x.check,ia,2,0);K=A=0;x.mode=2;break}if(x.flags=0,x.head&&(x.head.done=!1),!(1&x.wrap)||(((255&A)<<8)+(A>>8))%31){w.msg="incorrect header check";
x.mode=30;break}if(8!=(15&A)){w.msg="unknown compression method";x.mode=30;break}if(K-=4,P=8+(15&(A>>>=4)),0===x.wbits)x.wbits=P;else if(P>x.wbits){w.msg="invalid window size";x.mode=30;break}x.dmax=1<<P;w.adler=x.check=1;x.mode=512&A?10:12;K=A=0;break;case 2:for(;K<16;){if(0===M)break a;M--;A+=qa[ka++]<<K;K+=8}if(x.flags=A,8!=(255&x.flags)){w.msg="unknown compression method";x.mode=30;break}if(57344&x.flags){w.msg="unknown header flags set";x.mode=30;break}x.head&&(x.head.text=A>>8&1);512&x.flags&&
(ia[0]=255&A,ia[1]=A>>>8&255,x.check=q(x.check,ia,2,0));K=A=0;x.mode=3;case 3:for(;K<32;){if(0===M)break a;M--;A+=qa[ka++]<<K;K+=8}x.head&&(x.head.time=A);512&x.flags&&(ia[0]=255&A,ia[1]=A>>>8&255,ia[2]=A>>>16&255,ia[3]=A>>>24&255,x.check=q(x.check,ia,4,0));K=A=0;x.mode=4;case 4:for(;K<16;){if(0===M)break a;M--;A+=qa[ka++]<<K;K+=8}x.head&&(x.head.xflags=255&A,x.head.os=A>>8);512&x.flags&&(ia[0]=255&A,ia[1]=A>>>8&255,x.check=q(x.check,ia,2,0));K=A=0;x.mode=5;case 5:if(1024&x.flags){for(;K<16;){if(0===
M)break a;M--;A+=qa[ka++]<<K;K+=8}x.length=A;x.head&&(x.head.extra_len=A);512&x.flags&&(ia[0]=255&A,ia[1]=A>>>8&255,x.check=q(x.check,ia,2,0));K=A=0}else x.head&&(x.head.extra=null);x.mode=6;case 6:if(1024&x.flags&&(M<(G=x.length)&&(G=M),G&&(x.head&&(P=x.head.extra_len-x.length,x.head.extra||(x.head.extra=Array(x.head.extra_len)),m.arraySet(x.head.extra,qa,ka,G,P)),512&x.flags&&(x.check=q(x.check,qa,G,ka)),M-=G,ka+=G,x.length-=G),x.length))break a;x.length=0;x.mode=7;case 7:if(2048&x.flags){if(0===
M)break a;for(G=0;P=qa[ka+G++],x.head&&P&&x.length<65536&&(x.head.name+=String.fromCharCode(P)),P&&G<M;);if(512&x.flags&&(x.check=q(x.check,qa,G,ka)),M-=G,ka+=G,P)break a}else x.head&&(x.head.name=null);x.length=0;x.mode=8;case 8:if(4096&x.flags){if(0===M)break a;for(G=0;P=qa[ka+G++],x.head&&P&&x.length<65536&&(x.head.comment+=String.fromCharCode(P)),P&&G<M;);if(512&x.flags&&(x.check=q(x.check,qa,G,ka)),M-=G,ka+=G,P)break a}else x.head&&(x.head.comment=null);x.mode=9;case 9:if(512&x.flags){for(;K<
16;){if(0===M)break a;M--;A+=qa[ka++]<<K;K+=8}if(A!==(65535&x.check)){w.msg="header crc mismatch";x.mode=30;break}K=A=0}x.head&&(x.head.hcrc=x.flags>>9&1,x.head.done=!0);w.adler=x.check=0;x.mode=12;break;case 10:for(;K<32;){if(0===M)break a;M--;A+=qa[ka++]<<K;K+=8}w.adler=x.check=g(A);K=A=0;x.mode=11;case 11:if(0===x.havedict)return w.next_out=ma,w.avail_out=ra,w.next_in=ka,w.avail_in=M,x.hold=A,x.bits=K,2;w.adler=x.check=1;x.mode=12;case 12:if(5===D||6===D)break a;case 13:if(x.last){A>>>=7&K;K-=
7&K;x.mode=27;break}for(;K<3;){if(0===M)break a;M--;A+=qa[ka++]<<K;K+=8}switch(x.last=1&A,--K,3&(A>>>=1)){case 0:x.mode=14;break;case 1:var ha=x;if(C){v=new m.Buf32(512);y=new m.Buf32(32);for(H=0;H<144;)ha.lens[H++]=8;for(;H<256;)ha.lens[H++]=9;for(;H<280;)ha.lens[H++]=7;for(;H<288;)ha.lens[H++]=8;u(1,ha.lens,0,288,v,0,ha.work,{bits:9});for(H=0;H<32;)ha.lens[H++]=5;u(2,ha.lens,0,32,y,0,ha.work,{bits:5});C=!1}ha.lencode=v;ha.lenbits=9;ha.distcode=y;ha.distbits=5;if(x.mode=20,6!==D)break;A>>>=2;K-=
2;break a;case 2:x.mode=17;break;case 3:w.msg="invalid block type",x.mode=30}A>>>=2;K-=2;break;case 14:A>>>=7&K;for(K-=7&K;K<32;){if(0===M)break a;M--;A+=qa[ka++]<<K;K+=8}if((65535&A)!=(A>>>16^65535)){w.msg="invalid stored block lengths";x.mode=30;break}if(x.length=65535&A,K=A=0,x.mode=15,6===D)break a;case 15:x.mode=16;case 16:if(G=x.length){if(M<G&&(G=M),ra<G&&(G=ra),0===G)break a;m.arraySet(ca,qa,ka,G,ma);M-=G;ka+=G;ra-=G;ma+=G;x.length-=G;break}x.mode=12;break;case 17:for(;K<14;){if(0===M)break a;
M--;A+=qa[ka++]<<K;K+=8}if(x.nlen=257+(31&A),K-=5,x.ndist=1+(31&(A>>>=5)),K-=5,x.ncode=4+(15&(A>>>=5)),A>>>=4,K-=4,286<x.nlen||30<x.ndist){w.msg="too many length or distance symbols";x.mode=30;break}x.have=0;x.mode=18;case 18:for(;x.have<x.ncode;){for(;K<3;){if(0===M)break a;M--;A+=qa[ka++]<<K;K+=8}x.lens[aa[x.have++]]=7&A;A>>>=3;K-=3}for(;x.have<19;)x.lens[aa[x.have++]]=0;if(x.lencode=x.lendyn,x.lenbits=7,V={bits:x.lenbits},Z=u(0,x.lens,0,19,x.lencode,0,x.work,V),x.lenbits=V.bits,Z){w.msg="invalid code lengths set";
x.mode=30;break}x.have=0;x.mode=19;case 19:for(;x.have<x.nlen+x.ndist;){for(;L=x.lencode[A&(1<<x.lenbits)-1],N=65535&L,!((H=L>>>24)<=K);){if(0===M)break a;M--;A+=qa[ka++]<<K;K+=8}if(N<16)A>>>=H,K-=H,x.lens[x.have++]=N;else{if(16===N){for(ha=H+2;K<ha;){if(0===M)break a;M--;A+=qa[ka++]<<K;K+=8}if(A>>>=H,K-=H,0===x.have){w.msg="invalid bit length repeat";x.mode=30;break}P=x.lens[x.have-1];G=3+(3&A);A>>>=2;K-=2}else if(17===N){for(ha=H+3;K<ha;){if(0===M)break a;M--;A+=qa[ka++]<<K;K+=8}K-=H;P=0;G=3+(7&
(A>>>=H));A>>>=3;K-=3}else{for(ha=H+7;K<ha;){if(0===M)break a;M--;A+=qa[ka++]<<K;K+=8}K-=H;P=0;G=11+(127&(A>>>=H));A>>>=7;K-=7}if(x.have+G>x.nlen+x.ndist){w.msg="invalid bit length repeat";x.mode=30;break}for(;G--;)x.lens[x.have++]=P}}if(30===x.mode)break;if(0===x.lens[256]){w.msg="invalid code -- missing end-of-block";x.mode=30;break}if(x.lenbits=9,V={bits:x.lenbits},Z=u(1,x.lens,0,x.nlen,x.lencode,0,x.work,V),x.lenbits=V.bits,Z){w.msg="invalid literal/lengths set";x.mode=30;break}if(x.distbits=
6,x.distcode=x.distdyn,V={bits:x.distbits},Z=u(2,x.lens,x.nlen,x.ndist,x.distcode,0,x.work,V),x.distbits=V.bits,Z){w.msg="invalid distances set";x.mode=30;break}if(x.mode=20,6===D)break a;case 20:x.mode=21;case 21:if(6<=M&&258<=ra){w.next_out=ma;w.avail_out=ra;w.next_in=ka;w.avail_in=M;x.hold=A;x.bits=K;r(w,na);ma=w.next_out;ca=w.output;ra=w.avail_out;ka=w.next_in;qa=w.input;M=w.avail_in;A=x.hold;K=x.bits;12===x.mode&&(x.back=-1);break}for(x.back=0;ha=(L=x.lencode[A&(1<<x.lenbits)-1])>>>16&255,N=
65535&L,!((H=L>>>24)<=K);){if(0===M)break a;M--;A+=qa[ka++]<<K;K+=8}if(ha&&0==(240&ha)){var X=H;var ba=ha;for(B=N;ha=(L=x.lencode[B+((A&(1<<X+ba)-1)>>X)])>>>16&255,N=65535&L,!(X+(H=L>>>24)<=K);){if(0===M)break a;M--;A+=qa[ka++]<<K;K+=8}A>>>=X;K-=X;x.back+=X}if(A>>>=H,K-=H,x.back+=H,x.length=N,0===ha){x.mode=26;break}if(32&ha){x.back=-1;x.mode=12;break}if(64&ha){w.msg="invalid literal/length code";x.mode=30;break}x.extra=15&ha;x.mode=22;case 22:if(x.extra){for(ha=x.extra;K<ha;){if(0===M)break a;M--;
A+=qa[ka++]<<K;K+=8}x.length+=A&(1<<x.extra)-1;A>>>=x.extra;K-=x.extra;x.back+=x.extra}x.was=x.length;x.mode=23;case 23:for(;ha=(L=x.distcode[A&(1<<x.distbits)-1])>>>16&255,N=65535&L,!((H=L>>>24)<=K);){if(0===M)break a;M--;A+=qa[ka++]<<K;K+=8}if(0==(240&ha)){X=H;ba=ha;for(B=N;ha=(L=x.distcode[B+((A&(1<<X+ba)-1)>>X)])>>>16&255,N=65535&L,!(X+(H=L>>>24)<=K);){if(0===M)break a;M--;A+=qa[ka++]<<K;K+=8}A>>>=X;K-=X;x.back+=X}if(A>>>=H,K-=H,x.back+=H,64&ha){w.msg="invalid distance code";x.mode=30;break}x.offset=
N;x.extra=15&ha;x.mode=24;case 24:if(x.extra){for(ha=x.extra;K<ha;){if(0===M)break a;M--;A+=qa[ka++]<<K;K+=8}x.offset+=A&(1<<x.extra)-1;A>>>=x.extra;K-=x.extra;x.back+=x.extra}if(x.offset>x.dmax){w.msg="invalid distance too far back";x.mode=30;break}x.mode=25;case 25:if(0===ra)break a;if(G=na-ra,x.offset>G){if((G=x.offset-G)>x.whave&&x.sane){w.msg="invalid distance too far back";x.mode=30;break}H=G>x.wnext?(G-=x.wnext,x.wsize-G):x.wnext-G;G>x.length&&(G=x.length);ha=x.window}else ha=ca,H=ma-x.offset,
G=x.length;ra<G&&(G=ra);ra-=G;for(x.length-=G;ca[ma++]=ha[H++],--G;);0===x.length&&(x.mode=21);break;case 26:if(0===ra)break a;ca[ma++]=x.length;ra--;x.mode=21;break;case 27:if(x.wrap){for(;K<32;){if(0===M)break a;M--;A|=qa[ka++]<<K;K+=8}if(na-=ra,w.total_out+=na,x.total+=na,na&&(w.adler=x.check=x.flags?q(x.check,ca,na,ma-na):p(x.check,ca,na,ma-na)),na=ra,(x.flags?A:g(A))!==x.check){w.msg="incorrect data check";x.mode=30;break}K=A=0}x.mode=28;case 28:if(x.wrap&&x.flags){for(;K<32;){if(0===M)break a;
M--;A+=qa[ka++]<<K;K+=8}if(A!==(0|x.total)){w.msg="incorrect length check";x.mode=30;break}K=A=0}x.mode=29;case 29:Z=1;break a;case 30:Z=-3;break a;case 31:return-4;default:return-2}return w.next_out=ma,w.avail_out=ra,w.next_in=ka,w.avail_in=M,x.hold=A,x.bits=K,(x.wsize||na!==w.avail_out&&x.mode<30&&(x.mode<27||4!==D))&&h(w,w.output,w.next_out,na-w.avail_out)?(x.mode=31,-4):(S-=w.avail_in,na-=w.avail_out,w.total_in+=S,w.total_out+=na,x.total+=na,x.wrap&&na&&(w.adler=x.check=x.flags?q(x.check,ca,na,
w.next_out-na):p(x.check,ca,na,w.next_out-na)),w.data_type=x.bits+64*!!x.last+128*(12===x.mode)+256*(20===x.mode||15===x.mode),(0==S&&0===na||4===D)&&0===Z&&(Z=-5),Z)};b.inflateEnd=function(w){if(!w||!w.state)return-2;var D=w.state;return D.window&&(D.window=null),w.state=null,0};b.inflateGetHeader=function(w,D){var x;return w&&w.state?0==(2&(x=w.state).wrap)?-2:((x.head=D).done=!1,0):-2};b.inflateSetDictionary=function(w,D){var x,G=D.length;return w&&w.state?0!==(x=w.state).wrap&&11!==x.mode?-2:
11===x.mode&&p(1,D,G,0)!==x.check?-3:h(w,D,G,G)?(x.mode=31,-4):(x.havedict=1,0):-2};b.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(c,d,b){var g=c("../utils/common"),n=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],f=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],e=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,
257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],k=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];d.exports=function(l,h,m,p,q,r,u,v){var y,C,w,D,x,G=v.bits,H,N,B,P,V,L=0,ia,aa=null,ma=0,ca=new g.Buf16(16);var ra=new g.Buf16(16);var ka=null,qa=0;for(H=0;H<=15;H++)ca[H]=0;for(N=0;N<p;N++)ca[h[m+N]]++;var M=G;for(B=15;1<=B&&0===ca[B];B--);if(B<M&&(M=B),0===B)return q[r++]=20971520,q[r++]=20971520,v.bits=1,0;for(G=1;G<B&&0===
ca[G];G++);M<G&&(M=G);for(H=y=1;H<=15;H++)if(y<<=1,(y-=ca[H])<0)return-1;if(0<y&&(0===l||1!==B))return-1;ra[1]=0;for(H=1;H<15;H++)ra[H+1]=ra[H]+ca[H];for(N=0;N<p;N++)0!==h[m+N]&&(u[ra[h[m+N]]++]=N);if(D=0===l?(aa=ka=u,19):1===l?(aa=n,ma-=257,ka=f,qa-=257,256):(aa=e,ka=k,-1),H=G,ra=r,V=N=ia=0,w=-1,p=(L=1<<(P=M))-1,1===l&&852<L||2===l&&592<L)return 1;for(;;){var A=H-V;var K=u[N]<D?(x=0,u[N]):u[N]>D?(x=ka[qa+u[N]],aa[ma+u[N]]):(x=96,0);y=1<<H-V;for(G=C=1<<P;q[ra+(ia>>V)+(C-=y)]=A<<24|x<<16|K,0!==C;);
for(y=1<<H-1;ia&y;)y>>=1;if(0!==y?(ia&=y-1,ia+=y):ia=0,N++,0==--ca[H]){if(H===B)break;H=h[m+u[N]]}if(M<H&&(ia&p)!==w){0===V&&(V=M);ra+=G;for(y=1<<(P=H-V);P+V<B&&!((y-=ca[P+V])<=0);)P++,y<<=1;if(L+=1<<P,1===l&&852<L||2===l&&592<L)return 1;q[w=ia&p]=M<<24|P<<16|ra-r}}return 0!==ia&&(q[ra+ia]=H-V<<24|4194304),v.bits=M,0}},{"../utils/common":41}],51:[function(c,d,b){d.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error",
"-6":"incompatible version"}},{}],52:[function(c,d,b){function g(A){for(var K=A.length;0<=--K;)A[K]=0}function n(A,K,S,na,Z){this.static_tree=A;this.extra_bits=K;this.extra_base=S;this.elems=na;this.max_length=Z;this.has_stree=A&&A.length}function f(A,K){this.dyn_tree=A;this.max_code=0;this.stat_desc=K}function e(A){return A<256?ia[A]:ia[256+(A>>>7)]}function k(A,K){A.pending_buf[A.pending++]=255&K;A.pending_buf[A.pending++]=K>>>8&255}function l(A,K,S){A.bi_valid>16-S?(A.bi_buf|=K<<A.bi_valid&65535,
k(A,A.bi_buf),A.bi_buf=K>>16-A.bi_valid,A.bi_valid+=S-16):(A.bi_buf|=K<<A.bi_valid&65535,A.bi_valid+=S)}function h(A,K,S){l(A,S[2*K],S[2*K+1])}function m(A,K){for(var S=0;S|=1&A,A>>>=1,S<<=1,0<--K;);return S>>>1}function p(A,K,S){var na,Z=Array(16),ha=0;for(na=1;na<=15;na++)Z[na]=ha=ha+S[na-1]<<1;for(S=0;S<=K;S++)na=A[2*S+1],0!==na&&(A[2*S]=m(Z[na]++,na))}function q(A){var K;for(K=0;K<286;K++)A.dyn_ltree[2*K]=0;for(K=0;K<30;K++)A.dyn_dtree[2*K]=0;for(K=0;K<19;K++)A.bl_tree[2*K]=0;A.dyn_ltree[512]=
1;A.opt_len=A.static_len=0;A.last_lit=A.matches=0}function r(A){8<A.bi_valid?k(A,A.bi_buf):0<A.bi_valid&&(A.pending_buf[A.pending++]=A.bi_buf);A.bi_buf=0;A.bi_valid=0}function u(A,K,S,na){var Z=2*K,ha=2*S;return A[Z]<A[ha]||A[Z]===A[ha]&&na[K]<=na[S]}function v(A,K,S){for(var na=A.heap[S],Z=S<<1;Z<=A.heap_len&&(Z<A.heap_len&&u(K,A.heap[Z+1],A.heap[Z],A.depth)&&Z++,!u(K,na,A.heap[Z],A.depth));)A.heap[S]=A.heap[Z],S=Z,Z<<=1;A.heap[S]=na}function y(A,K,S){var na,Z,ha,X,ba=0;if(0!==A.last_lit)for(;na=
A.pending_buf[A.d_buf+2*ba]<<8|A.pending_buf[A.d_buf+2*ba+1],Z=A.pending_buf[A.l_buf+ba],ba++,0===na?h(A,Z,K):(h(A,(ha=aa[Z])+256+1,K),0!==(X=H[ha])&&l(A,Z-=ma[ha],X),h(A,ha=e(--na),S),0!==(X=N[ha])&&l(A,na-=qa[ha],X)),ba<A.last_lit;);h(A,256,K)}function C(A,K){var S,na,Z,ha=K.dyn_tree,X=K.stat_desc.static_tree,ba=K.stat_desc.has_stree,Ea=K.stat_desc.elems,Ha=-1;A.heap_len=0;A.heap_max=573;for(S=0;S<Ea;S++)0!==ha[2*S]?(A.heap[++A.heap_len]=Ha=S,A.depth[S]=0):ha[2*S+1]=0;for(;A.heap_len<2;)ha[2*(Z=
A.heap[++A.heap_len]=Ha<2?++Ha:0)]=1,A.depth[Z]=0,A.opt_len--,ba&&(A.static_len-=X[2*Z+1]);K.max_code=Ha;for(S=A.heap_len>>1;1<=S;S--)v(A,ha,S);for(Z=Ea;S=A.heap[1],A.heap[1]=A.heap[A.heap_len--],v(A,ha,1),na=A.heap[1],A.heap[--A.heap_max]=S,A.heap[--A.heap_max]=na,ha[2*Z]=ha[2*S]+ha[2*na],A.depth[Z]=(A.depth[S]>=A.depth[na]?A.depth[S]:A.depth[na])+1,ha[2*S+1]=ha[2*na+1]=Z,A.heap[1]=Z++,v(A,ha,1),2<=A.heap_len;);A.heap[--A.heap_max]=A.heap[1];var xb,Ka,Ua,Db,kb;S=K.dyn_tree;na=K.max_code;Z=K.stat_desc.static_tree;
X=K.stat_desc.has_stree;ba=K.stat_desc.extra_bits;Ea=K.stat_desc.extra_base;var qb=K.stat_desc.max_length,Ta=0;for(Ua=0;Ua<=15;Ua++)A.bl_count[Ua]=0;S[2*A.heap[A.heap_max]+1]=0;for(K=A.heap_max+1;K<573;K++)qb<(Ua=S[2*S[2*(xb=A.heap[K])+1]+1]+1)&&(Ua=qb,Ta++),S[2*xb+1]=Ua,na<xb||(A.bl_count[Ua]++,Db=0,Ea<=xb&&(Db=ba[xb-Ea]),kb=S[2*xb],A.opt_len+=kb*(Ua+Db),X&&(A.static_len+=kb*(Z[2*xb+1]+Db)));if(0!==Ta){do{for(Ua=qb-1;0===A.bl_count[Ua];)Ua--;A.bl_count[Ua]--;A.bl_count[Ua+1]+=2;A.bl_count[qb]--;
Ta-=2}while(0<Ta);for(Ua=qb;0!==Ua;Ua--)for(xb=A.bl_count[Ua];0!==xb;)na<(Ka=A.heap[--K])||(S[2*Ka+1]!==Ua&&(A.opt_len+=(Ua-S[2*Ka+1])*S[2*Ka],S[2*Ka+1]=Ua),xb--)}p(ha,Ha,A.bl_count)}function w(A,K,S){var na,Z=-1,ha=K[1],X=0,ba=7,Ea=4;0===ha&&(ba=138,Ea=3);K[2*(S+1)+1]=65535;for(na=0;na<=S;na++){var Ha=ha;ha=K[2*(na+1)+1];++X<ba&&Ha===ha||(X<Ea?A.bl_tree[2*Ha]+=X:0!==Ha?(Ha!==Z&&A.bl_tree[2*Ha]++,A.bl_tree[32]++):X<=10?A.bl_tree[34]++:A.bl_tree[36]++,Z=Ha,Ea=(X=0)===ha?(ba=138,3):Ha===ha?(ba=6,3):
(ba=7,4))}}function D(A,K,S){var na,Z,ha=-1,X=K[1],ba=0,Ea=7,Ha=4;0===X&&(Ea=138,Ha=3);for(na=0;na<=S;na++)if(Z=X,X=K[2*(na+1)+1],!(++ba<Ea&&Z===X)){if(ba<Ha)for(;h(A,Z,A.bl_tree),0!=--ba;);else 0!==Z?(Z!==ha&&(h(A,Z,A.bl_tree),ba--),h(A,16,A.bl_tree),l(A,ba-3,2)):ba<=10?(h(A,17,A.bl_tree),l(A,ba-3,3)):(h(A,18,A.bl_tree),l(A,ba-11,7));ha=Z;Ha=(ba=0)===X?(Ea=138,3):Z===X?(Ea=6,3):(Ea=7,4)}}function x(A,K,S,na){l(A,+!!na,3);r(A);k(A,S);k(A,~S);G.arraySet(A.pending_buf,A.window,K,S,A.pending);A.pending+=
S}var G=c("../utils/common"),H=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],N=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],B=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],P=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],V=Array(576);g(V);var L=Array(60);g(L);var ia=Array(512);g(ia);var aa=Array(256);g(aa);var ma=Array(29);g(ma);var ca,ra,ka,qa=Array(30);g(qa);var M=!1;b._tr_init=function(A){if(!M){var K,S,na,Z=Array(16);for(na=S=0;na<28;na++)for(ma[na]=S,K=0;K<
1<<H[na];K++)aa[S++]=na;aa[S-1]=na;for(na=S=0;na<16;na++)for(qa[na]=S,K=0;K<1<<N[na];K++)ia[S++]=na;for(S>>=7;na<30;na++)for(qa[na]=S<<7,K=0;K<1<<N[na]-7;K++)ia[256+S++]=na;for(K=0;K<=15;K++)Z[K]=0;for(K=0;K<=143;)V[2*K+1]=8,K++,Z[8]++;for(;K<=255;)V[2*K+1]=9,K++,Z[9]++;for(;K<=279;)V[2*K+1]=7,K++,Z[7]++;for(;K<=287;)V[2*K+1]=8,K++,Z[8]++;p(V,287,Z);for(K=0;K<30;K++)L[2*K+1]=5,L[2*K]=m(K,5);ca=new n(V,H,257,286,15);ra=new n(L,N,0,30,15);ka=new n([],B,0,19,7);M=!0}A.l_desc=new f(A.dyn_ltree,ca);A.d_desc=
new f(A.dyn_dtree,ra);A.bl_desc=new f(A.bl_tree,ka);A.bi_buf=0;A.bi_valid=0;q(A)};b._tr_stored_block=x;b._tr_flush_block=function(A,K,S,na){var Z,ha,X=0;0<A.level?(2===A.strm.data_type&&(A.strm.data_type=function(ba){var Ea,Ha=4093624447;for(Ea=0;Ea<=31;Ea++,Ha>>>=1)if(1&Ha&&0!==ba.dyn_ltree[2*Ea])return 0;if(0!==ba.dyn_ltree[18]||0!==ba.dyn_ltree[20]||0!==ba.dyn_ltree[26])return 1;for(Ea=32;Ea<256;Ea++)if(0!==ba.dyn_ltree[2*Ea])return 1;return 0}(A)),C(A,A.l_desc),C(A,A.d_desc),X=function(ba){var Ea;
w(ba,ba.dyn_ltree,ba.l_desc.max_code);w(ba,ba.dyn_dtree,ba.d_desc.max_code);C(ba,ba.bl_desc);for(Ea=18;3<=Ea&&0===ba.bl_tree[2*P[Ea]+1];Ea--);return ba.opt_len+=3*(Ea+1)+5+5+4,Ea}(A),Z=A.opt_len+3+7>>>3,(ha=A.static_len+3+7>>>3)<=Z&&(Z=ha)):Z=ha=S+5;S+4<=Z&&-1!==K?x(A,K,S,na):4===A.strategy||ha===Z?(l(A,2+ +!!na,3),y(A,V,L)):(l(A,4+ +!!na,3),function(ba,Ea,Ha,xb){var Ka;l(ba,Ea-257,5);l(ba,Ha-1,5);l(ba,xb-4,4);for(Ka=0;Ka<xb;Ka++)l(ba,ba.bl_tree[2*P[Ka]+1],3);D(ba,ba.dyn_ltree,Ea-1);D(ba,ba.dyn_dtree,
Ha-1)}(A,A.l_desc.max_code+1,A.d_desc.max_code+1,X+1),y(A,A.dyn_ltree,A.dyn_dtree));q(A);na&&r(A)};b._tr_tally=function(A,K,S){return A.pending_buf[A.d_buf+2*A.last_lit]=K>>>8&255,A.pending_buf[A.d_buf+2*A.last_lit+1]=255&K,A.pending_buf[A.l_buf+A.last_lit]=255&S,A.last_lit++,0===K?A.dyn_ltree[2*S]++:(A.matches++,K--,A.dyn_ltree[2*(aa[S]+256+1)]++,A.dyn_dtree[2*e(K)]++),A.last_lit===A.lit_bufsize-1};b._tr_align=function(A){l(A,2,3);h(A,256,V);16===A.bi_valid?(k(A,A.bi_buf),A.bi_buf=0,A.bi_valid=0):
8<=A.bi_valid&&(A.pending_buf[A.pending++]=255&A.bi_buf,A.bi_buf>>=8,A.bi_valid-=8)}},{"../utils/common":41}],53:[function(c,d,b){d.exports=function(){this.input=null;this.total_in=this.avail_in=this.next_in=0;this.output=null;this.total_out=this.avail_out=this.next_out=0;this.msg="";this.state=null;this.data_type=2;this.adler=0}},{}],54:[function(c,d,b){(function(g){!function(n,f){function e(w){delete r[w]}function k(w){if(u)setTimeout(k,0,w);else{var D=r[w];if(D){u=!0;try{var x=D.callback,G=D.args;
switch(G.length){case 0:x();break;case 1:x(G[0]);break;case 2:x(G[0],G[1]);break;case 3:x(G[0],G[1],G[2]);break;default:x.apply(f,G)}}finally{e(w),u=!1}}}}function l(w){w.source===n&&"string"==typeof w.data&&0===w.data.indexOf(p)&&k(+w.data.slice(p.length))}if(!n.setImmediate){var h,m,p,q=1,r={},u=!1,v=n.document,y=Object.getPrototypeOf&&Object.getPrototypeOf(n);y=y&&y.setTimeout?y:n;var C="[object process]"==={}.toString.call(n.process)?function(w){Hg.nextTick(function(){k(w)})}:function(){if(n.postMessage&&
!n.importScripts){var w=!0,D=n.onmessage;return n.onmessage=function(){w=!1},n.postMessage("","*"),n.onmessage=D,w}}()?(p="setImmediate$"+Math.random()+"$",n.addEventListener?n.addEventListener("message",l,!1):n.attachEvent("onmessage",l),function(w){n.postMessage(p+w,"*")}):n.MessageChannel?((m=new MessageChannel).port1.onmessage=function(w){k(w.data)},function(w){m.port2.postMessage(w)}):v&&"onreadystatechange"in v.createElement("script")?(h=v.documentElement,function(w){var D=v.createElement("script");
D.onreadystatechange=function(){k(w);D.onreadystatechange=null;h.removeChild(D);D=null};h.appendChild(D)}):function(w){setTimeout(k,0,w)};y.setImmediate=function(w){"function"!=typeof w&&(w=Function(""+w));for(var D=Array(arguments.length-1),x=0;x<D.length;x++)D[x]=arguments[x+1];return r[q]={callback:w,args:D},C(q),q++};y.clearImmediate=e}}("u"<typeof self?void 0===g?this:g:self)}).call(this,void 0!==Tc?Tc:"u">typeof self?self:"u">typeof window?window:{})},{}]},{},[10])(10);var be={};be=JSON.parse('{"Dodge (tool)":"Dodge","Burn (tool)":"Burn","Color (picker)":"Color","Color swatches (shorter)":"Swatches"}');
let We={ja:JSON.parse('{"File":"\u30d5\u30a1\u30a4\u30eb","Export as png":"PNG\u3067\u4fdd\u5b58","Save the PNG image, CHI project file, and swatches file together as a ZIP package":"\u753b\u50cf\u3068\u56fa\u6709\u5f62\u5f0f\u30d5\u30a1\u30a4\u30eb\u3092ZIP\u3067\u4fdd\u5b58\u3057\u307e\u3059","Export as zip":"ZIP\u3067\u4fdd\u5b58","Backup to browser storage":"\u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u3092\u30d6\u30e9\u30a6\u30b6\u306b\u4fdd\u5b58","Save the current drawing to the browser\'s local database":"\u73fe\u5728\u306e\u753b\u50cf\u3092\u30d6\u30e9\u30a6\u30b6\u306e\u30ed\u30fc\u30ab\u30eb\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306b\u4fdd\u5b58\u3057\u307e\u3059","Post Oekaki":"\u753b\u50cf\u3092\u6295\u7a3f","Edit":"\u7de8\u96c6","Undo":"\u53d6\u308a\u6d88\u3057","Redo":"\u3084\u308a\u76f4\u3057","Cut":"\u5207\u308a\u53d6\u308a","Copy":"\u30b3\u30d4\u30fc","Clear history":"\u5c65\u6b74\u6d88\u53bb","Copy merged":"\u7d50\u5408\u30b3\u30d4\u30fc","Paste":"\u8cbc\u308a\u4ed8\u3051","Select all":"\u3059\u3079\u3066\u9078\u629e","Deselect":"\u9078\u629e\u89e3\u9664","Transform":"\u5909\u5f62","Selection":"\u9078\u629e\u7bc4\u56f2","Constrain":"\u7e26\u6a2a\u6bd4\u3092\u7dad\u6301","Layers":"\u30ec\u30a4\u30e4\u30fc","Duplicate":"\u8907\u88fd","Merge down":"\u4e0b\u306e\u30ec\u30a4\u30e4\u30fc\u3068\u7d50\u5408","Merge group":"\u30b0\u30eb\u30fc\u30d7\u7d50\u5408","Merge all layers":"\u5168\u30ec\u30a4\u30e4\u30fc\u7d50\u5408","Create merged layer":"\u7d50\u5408\u30ec\u30a4\u30e4\u30fc\u3092\u8ffd\u52a0","Add layer mask":"\u30ec\u30a4\u30e4\u30fc\u30de\u30b9\u30af\u8ffd\u52a0","Delete mask":"\u30ec\u30a4\u30e4\u30fc\u30de\u30b9\u30af\u524a\u9664","Delete layer mask":"\u30ec\u30a4\u30e4\u30fc\u30de\u30b9\u30af\u524a\u9664","Apply mask":"\u30ec\u30a4\u30e4\u30fc\u30de\u30b9\u30af\u9069\u7528","Apply layer mask":"\u30ec\u30a4\u30e4\u30fc\u30de\u30b9\u30af\u9069\u7528","Disable mask":"\u30ec\u30a4\u30e4\u30fc\u30de\u30b9\u30af\u7121\u52b9\u5316","Enable mask":"\u30ec\u30a4\u30e4\u30fc\u30de\u30b9\u30af\u6709\u52b9\u5316","Clip to the layer below":"\u4e0b\u306e\u30ec\u30a4\u30e4\u30fc\u3067\u30af\u30ea\u30c3\u30d4\u30f3\u30b0","Unclip from the layer below":"\u30af\u30ea\u30c3\u30d4\u30f3\u30b0\u89e3\u9664","Effects":"\u52b9\u679c","Clear":"\u6d88\u53bb","Clear with texture":"\u30c6\u30af\u30b9\u30c1\u30e3\u3067\u6d88\u53bb","Fill":"\u5857\u308a\u6f70\u3057","Flip horizontal":"\u5de6\u53f3\u53cd\u8ee2","Flip vertical":"\u4e0a\u4e0b\u53cd\u8ee2","Invert":"\u30cd\u30ac\u30dd\u30b8\u53cd\u8ee2","Convert brightness to opacity":"\u8f1d\u5ea6\u3092\u900f\u660e\u5ea6\u306b\u5909\u63db","Box blur...":"\u307c\u304b\u3057","Box blur":"\u307c\u304b\u3057","Blur amount":"\u307c\u304b\u3057\u91cf","Iterations (1~8, larger gives smoother blur)":"\u53cd\u5fa9 (1~8,\u5927\u304d\u3044\u307b\u3069\u307c\u304b\u3057\u304c\u6ed1\u3089\u304b)","Mosaic":"\u30e2\u30b6\u30a4\u30af","Block size":"\u30d6\u30ed\u30c3\u30af\u30b5\u30a4\u30ba","Color halftone":"\u30ab\u30e9\u30fc\u30cf\u30fc\u30d5\u30c8\u30fc\u30f3","Mono halftone":"\u5358\u8272\u30cf\u30fc\u30d5\u30c8\u30fc\u30f3","Dot size":"\u30c9\u30c3\u30c8\u30b5\u30a4\u30ba","Chromatic aberration":"\u8272\u53ce\u5dee (RGB\u305a\u3089\u3057)","Offset X":"\u6a2a\u65b9\u5411 X","Offset Y":"\u7e26\u65b9\u5411 Y","Apply to all (create merged layer)":"\u5168\u4f53\u306b\u9069\u7528 (\u7d50\u5408\u30ec\u30a4\u30e4\u30fc\u3092\u8ffd\u52a0)","Edge expand":"\u7e01\u53d6\u308a","Edge expand width":"\u7e01\u306e\u5e45","Fill Inside with edge color":"\u7e01\u306e\u8272\u3067\u5185\u5074\u3092\u5857\u308a\u6f70\u3059","Monochromatic noise":"\u5358\u8272\u30ce\u30a4\u30ba","Color noise":"\u30ab\u30e9\u30fc\u30ce\u30a4\u30ba","View":"\u8868\u793a","Full-screen mode":"\u30d5\u30eb\u30b9\u30af\u30ea\u30fc\u30f3\u30e2\u30fc\u30c9","Zoom in":"\u62e1\u5927","Zoom out":"\u7e2e\u5c0f","Zoom 100%":"100%","Reset Rotation":"\u56de\u8ee2\u3092\u30ea\u30bb\u30c3\u30c8","Smooth-out zoomed canvas":"\u30ba\u30fc\u30e0\u3092\u306a\u3081\u3089\u304b\u306b\u8868\u793a\u3059\u308b","Show grid":"\u30b0\u30ea\u30c3\u30c9\u3092\u8868\u793a","Grid options...":"\u30b0\u30ea\u30c3\u30c9\u306e\u8a2d\u5b9a","Palettes":"\u30d1\u30ec\u30c3\u30c8","Rearrange":"\u521d\u671f\u5316","Toggle palettes":"\u8868\u793a\u975e\u8868\u793a\u5207\u308a\u66ff\u3048","Mobile mode":"\u30e2\u30d0\u30a4\u30eb\u30e2\u30fc\u30c9","PC mode":"PC\u30e2\u30fc\u30c9","Use old icons":"\u53e4\u3044\u30a2\u30a4\u30b3\u30f3","Show tool options":"\u30c4\u30fc\u30eb\u30aa\u30d7\u30b7\u30e7\u30f3","Show color":"\u30ab\u30e9\u30fc","Show layers":"\u30ec\u30a4\u30e4\u30fc","Show misc":"\u64cd\u4f5c","Show stroke":"\u30b9\u30c8\u30ed\u30fc\u30af","Show swatches":"\u30ab\u30e9\u30fc\u30bb\u30c3\u30c8","Show textures":"\u30c6\u30af\u30b9\u30c1\u30e3","Show tools":"\u30c4\u30fc\u30eb","Help":"\u30d8\u30eb\u30d7","Tablet support":"\u30bf\u30d6\u30ec\u30c3\u30c8\u30b5\u30dd\u30fc\u30c8","Shortcuts":"\u30b7\u30e7\u30fc\u30c8\u30ab\u30c3\u30c8","About":"litaChix\u306b\u3064\u3044\u3066","Removes all undo/redo information to regain memory":"\u5c65\u6b74\u3092\u30af\u30ea\u30a2\u3057\u3066\u30e1\u30e2\u30ea\u3092\u958b\u653e\u3057\u307e\u3059","Clears the selected area":"\u6d88\u53bb","Invert the image colors":"\u30cd\u30ac\u30dd\u30b8\u53cd\u8ee2","Blur effect":"\u307c\u304b\u3057\u30d5\u30a3\u30eb\u30bf","Fills the selection with noise":"\u5358\u8272\u30ce\u30a4\u30ba\u3067\u5857\u308a\u6f70\u3057","Fills the selection with colored noise":"\u30ab\u30e9\u30fc\u30ce\u30a4\u30ba\u3067\u5857\u308a\u6f70\u3057","Linear interpolation is used to give a smoothed looked to the picture when zoomed in":"\u753b\u50cf\u306e\u62e1\u5927\u6642\u306b\u88dc\u5b8c\u3057\u3066\u6ed1\u3089\u304b\u306b\u8868\u793a\u3057\u307e\u3059","Rearrange the palette windows":"\u30d1\u30ec\u30c3\u30c8\u3092\u518d\u914d\u7f6e","Hides or shows all palettes":"\u30d1\u30ec\u30c3\u30c8\u306e\u8868\u793a/\u975e\u8868\u793a","You\'re about to clear the current Undo/Redo history.\\nThis operation cannot be undone, are you sure you want to do that?":"\u30a2\u30f3\u30c9\u30a5\u30fb\u30ea\u30c9\u30a5\u306e\u5c65\u6b74\u3092\u6d88\u53bb\u3057\u3088\u3046\u3068\u3057\u3066\u3044\u307e\u3059\u3002\\n\u3053\u306e\u64cd\u4f5c\u306f\u5143\u306b\u623b\u3059\u3053\u3068\u304c\u3067\u304d\u307e\u305b\u3093\u3002\u672c\u5f53\u306b\u5b9f\u884c\u3057\u307e\u3059\u304b?","Misc":"\u64cd\u4f5c","Round Pixelated":"\u5186\u30d4\u30af\u30bb\u30eb","Round Hard Edge":"\u5186\u30cf\u30fc\u30c9\u30a8\u30c3\u30b8","Round Soft":"\u5186\u30bd\u30d5\u30c8","Square Pixelated":"\u89d2\u30d4\u30af\u30bb\u30eb","Square Hard Edge":"\u89d2\u30cf\u30fc\u30c9\u30a8\u30c3\u30b8","Color (picker)":"\u30ab\u30e9\u30fc","Tool options":"\u30c4\u30fc\u30eb\u30aa\u30d7\u30b7\u30e7\u30f3","Brush size":"\u30d6\u30e9\u30b7\u30b5\u30a4\u30ba","Opacity":"\u4e0d\u900f\u660e\u5ea6","Color":"\u8272\u88dc\u5145","Blend":"\u6df7\u8272","Spacing":"\u9593\u9694","Scattering":"\u6563\u4e71","Smoothing":"\u624b\u3076\u308c\u88dc\u6b63","Rotation":"\u89d2\u5ea6","Color swatches":"\u30ab\u30e9\u30fc\u30bb\u30c3\u30c8","Color swatches (shorter)":"\u30ab\u30e9\u30fc\u30bb\u30c3\u30c8","Remove":"\u524a\u9664","Replace with current color":"\u9078\u629e\u4e2d\u306e\u8272\u306b\u7f6e\u304d\u63db\u3048","Save swatches to your computer...":"\u30ab\u30e9\u30fc\u30bb\u30c3\u30c8\u3092PC\u306b\u4fdd\u5b58","Load swatches from your computer...":"\u30ab\u30e9\u30fc\u30bb\u30c3\u30c8\u3092PC\u304b\u3089\u8aad\u307f\u8fbc\u307f","Add the current brush color as a new swatch":"\u9078\u629e\u4e2d\u306e\u8272\u3092\u8ffd\u52a0","Refer all layers":"\u5168\u30ec\u30a4\u30e4\u30fc\u53c2\u7167","Blend all layers":"\u5168\u30ec\u30a4\u30e4\u30fc\u6df7\u5408","Lock transparency":"\u900f\u660e\u90e8\u5206\u3092\u4fdd\u8b77","Textures":"\u30c6\u30af\u30b9\u30c1\u30e3","Customize":"\u30ab\u30b9\u30bf\u30de\u30a4\u30ba","Inverse":"\u30cd\u30ac\u30dd\u30b8\u53cd\u8ee2","Mirror":"\u5de6\u53f3\u53cd\u8ee2","Brightness":"\u8f1d\u5ea6","Contrast":"\u30b3\u30f3\u30c8\u30e9\u30b9\u30c8","Scale":"\u62e1\u5927\u7387","Reset":"\u30ea\u30bb\u30c3\u30c8","Layer blending mode":"\u5408\u6210\u30e2\u30fc\u30c9","Normal":"\u901a\u5e38","Multiply":"\u4e57\u7b97","Add":"\u52a0\u7b97","Screen":"\u30b9\u30af\u30ea\u30fc\u30f3","Lighten":"\u6bd4\u8f03(\u660e)","Darken":"\u6bd4\u8f03(\u6697)","Subtract":"\u6e1b\u7b97","Dodge":"\u8986\u3044\u713c\u304d","Burn":"\u713c\u304d\u8fbc\u307f","Overlay":"\u30aa\u30fc\u30d0\u30fc\u30ec\u30a4","Hard Light":"\u30cf\u30fc\u30c9\u30e9\u30a4\u30c8","Soft Light":"\u30bd\u30d5\u30c8\u30e9\u30a4\u30c8","Vivid Light":"\u30d3\u30d3\u30c3\u30c9\u30e9\u30a4\u30c8","Linear Light":"\u30ea\u30cb\u30a2\u30e9\u30a4\u30c8","Pin Light":"\u30d4\u30f3\u30e9\u30a4\u30c8","Passthrough":"\u901a\u904e","Stroke":"\u30b9\u30c8\u30ed\u30fc\u30af","Free-hand":"\u30d5\u30ea\u30fc\u30cf\u30f3\u30c9","Straight line":"\u76f4\u7dda","Bezier curve":"Bz\uff08\u30d9\u30b8\u30a7\uff09\u66f2\u7dda","Tools":"\u30c4\u30fc\u30eb","Marquee":"\u9078\u629e\u7bc4\u56f2","Move tool":"\u79fb\u52d5","Flood fill":"\u30d0\u30b1\u30c4\u5857\u308a","Grow fill area":"\u9818\u57df\u62e1\u5f35","Gradient fill":"\u30b0\u30e9\u30c7\u30fc\u30b7\u30e7\u30f3","Color picker":"\u30b9\u30dd\u30a4\u30c8","Rotate canvas":"\u30ad\u30e3\u30f3\u30d0\u30b9\u306e\u56de\u8ee2","Grab canvas":"\u30ad\u30e3\u30f3\u30d0\u30b9\u306e\u4f4d\u7f6e","Pencil":"\u925b\u7b46","Pen":"\u30da\u30f3","Airbrush":"\u30a8\u30a2\u30d6\u30e9\u30b7","Waterpaint":"\u6c34\u5f69","Eraser":"\u6d88\u3057\u30b4\u30e0","Soft eraser":"\u8584\u6d88\u3057","Smudge":"\u6307\u5148","Blender":"\u6df7\u8272","Dodge (tool)":"\u8986\u3044\u713c\u304d","Burn (tool)":"\u713c\u304d\u8fbc\u307f","Blur":"\u307c\u304b\u3057","Grid options":"\u30b0\u30ea\u30c3\u30c9\u306e\u8a2d\u5b9a","Grid size":"\u30b0\u30ea\u30c3\u30c9\u30b5\u30a4\u30ba","Rename...":"\u540d\u524d\u3092\u5909\u66f4","Add layer":"\u65b0\u898f\u30ec\u30a4\u30e4\u30fc","Delete layer":"\u30ec\u30a4\u30e4\u30fc\u524a\u9664","Add group":"\u65b0\u898f\u30b0\u30eb\u30fc\u30d7","Delete group":"\u30b0\u30eb\u30fc\u30d7\u524a\u9664","Add mask":"\u30ec\u30a4\u30e4\u30fc\u30de\u30b9\u30af\u8ffd\u52a0","Gradient":"\u30b0\u30e9\u30c7\u30fc\u30b7\u30e7\u30f3\u4f5c\u6210","Zoom and Rotate":"\u30ba\u30fc\u30e0\u3068\u56de\u8ee2","Reset View":"\u8868\u793a\u3092\u521d\u671f\u5316","Transform style":"\u5909\u5f62\u30b9\u30bf\u30a4\u30eb","Apply transform":"\u5909\u5f62\u78ba\u5b9a","Complete transform":"\u5909\u5f62\u3092\u5b8c\u4e86","Undo transform":"\u53d6\u308a\u6d88\u3057","You need to finish transforming this layer before you can do that. What would you like to do with the transform?":"\u7d9a\u884c\u3059\u308b\u305f\u3081\u306b\u5909\u5f62\u3092\u5b8c\u4e86\u3057\u307e\u3059\u3002","Smooth":"\u30b9\u30e0\u30fc\u30ba","Sharp":"\u30b7\u30e3\u30fc\u30d7","Opacity: ":"\u4e0d\u900f\u660e\u5ea6:","Please enter a color in hex format":"16\u9032\u5f62\u5f0f\u3067\u8272\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044\uff08#xxxxxx\u306e\u5f62\uff09","Cancel":"\u30ad\u30e3\u30f3\u30bb\u30eb","Ok":"OK","Okay":"OK","OK":"OK","Whoops! This layer is currently hidden":"\u975e\u8868\u793a\u30ec\u30a4\u30e4\u30fc\u3067\u3059\u3002","Whoops! This layer\'s opacity is currently 0%":"\u30ec\u30a4\u30e4\u30fc\u306e\u4e0d\u900f\u660e\u5ea6\u304c0%\u3067\u3059","Whoops! You can\'t draw on a group":"\u30b0\u30eb\u30fc\u30d7\u30d5\u30a9\u30eb\u30c0\u306b\u306f\u63cf\u3051\u307e\u305b\u3093","Whoops! All of the selected pixels are transparent!":"\u30ec\u30a4\u30e4\u30fc\u304c\u7a7a\u3067\u3059","Image":"\u753b\u50cf","Layer mask":"\u30ec\u30a4\u30e4\u30fc\u30de\u30b9\u30af","Sorry, you can\'t remove the last remaining layer in the drawing.":"\u6700\u5f8c\u306e1\u3064\u306a\u306e\u3067\u524a\u9664\u3067\u304d\u307e\u305b\u3093\u3002","Are you sure you want to send your drawing to the server and finish drawing now?":"\u753b\u50cf\u3092\u30b5\u30fc\u30d0\u30fc\u306b\u9001\u4fe1\u3057\u307e\u3059\u3002\u7d42\u4e86\u3057\u3066\u3082\u3088\u308d\u3057\u3044\u3067\u3059\u304b\uff1f","Your drawing has unsaved changes! Are you sure to want to navigate away?":"\u753b\u50cf\u306b\u672a\u4fdd\u5b58\u306e\u5909\u66f4\u304c\u3042\u308a\u307e\u3059\u3002\u7d42\u4e86\u3057\u3066\u3082\u3088\u308d\u3057\u3044\u3067\u3059\u304b\uff1f","Many of the menu options and painting tools have keyboard shortcuts which are written next to them or appear when you hover.":"\u5229\u7528\u53ef\u80fd\u306a\u30ad\u30fc\u30dc\u30fc\u30c9\u30b7\u30e7\u30fc\u30c8\u30ab\u30c3\u30c8\u306e\u3044\u304f\u3064\u304b\u306f\u30e1\u30cb\u30e5\u30fc\u306e\u6a2a\u3084\u30c4\u30fc\u30eb\u30c1\u30c3\u30d7\u306b\u8868\u793a\u3055\u308c\u3066\u3044\u307e\u3059\u3002","Here are some other shortcuts which are not as obvious!":"\u3053\u306e\u4e00\u89a7\u306f\u305d\u308c\u4ee5\u5916\u306e\u30b7\u30e7\u30fc\u30c8\u30ab\u30c3\u30c8\u3092\u307e\u3068\u3081\u305f\u3082\u306e\u3067\u3059\u3002","Right":"\u53f3","Left":"\u5de6","Middle":"\u4e2d","or":"\u307e\u305f\u306f","Double click":"\u30c0\u30d6\u30eb\u30af\u30ea\u30c3\u30af","Color swatches palette":"\u30ab\u30e9\u30fc\u30bb\u30c3\u30c8","Use as the drawing color":"\u30d1\u30ec\u30c3\u30c8\u306e\u8272\u3092\u53d6\u5f97","Remove or replace a color swatch":"\u30d1\u30ec\u30c3\u30c8\u306e\u5909\u66f4\uff65\u524a\u9664","Line drawing mode":"\u76f4\u7dda\u30e2\u30fc\u30c9","Snap line to nearest 45 degrees":"45\u00b0\u5358\u4f4d\u3067\u30b9\u30ca\u30c3\u30d7","Painting tools":"\u30c4\u30fc\u30eb","Change brush opacity":"\u30d6\u30e9\u30b7\u306e\u4e0d\u900f\u660e\u5ea6","Change brush size":"\u30d6\u30e9\u30b7\u30b5\u30a4\u30ba","Brush palette":"\u30d6\u30e9\u30b7\u30d1\u30ec\u30c3\u30c8","Adjust brush sliders more precisely":"\u30d6\u30e9\u30b7\u30b9\u30e9\u30a4\u30c0\u30fc\u3092\u3088\u308a\u7d30\u304b\u304f\u8abf\u6574","Drawing canvas":"\u30ad\u30e3\u30f3\u30d0\u30b9","Move the canvas around":"\u30ad\u30e3\u30f3\u30d0\u30b9\u306e\u79fb\u52d5","Rotate the canvas":"\u30ad\u30e3\u30f3\u30d0\u30b9\u306e\u56de\u8ee2","Zoom":"\u30ba\u30fc\u30e0","Zoom the canvas":"\u30ad\u30e3\u30f3\u30d0\u30b9\u306e\u62e1\u5927\u7e2e\u5c0f","Sample the color under the cursor":"\u30ad\u30e3\u30f3\u30d0\u30b9\u306e\u8272\u3092\u30b9\u30dd\u30a4\u30c8","Flip View Horizontal":"\u8868\u793a\u306e\u5de6\u53f3\u53cd\u8ee2","Layers palette":"\u30ec\u30a4\u30e4\u30fc\u30d1\u30ec\u30c3\u30c8","Rename layer":"\u30ec\u30a4\u30e4\u30fc\u540d\u5909\u66f4","Toggle mask enable/disable":"\u30de\u30b9\u30af\u306e\u6709\u52b9/\u7121\u52b9\u5207\u308a\u66ff\u3048","Toggle mask View":"\u30de\u30b9\u30af\u306e\u8868\u793a/\u975e\u8868\u793a\u5207\u308a\u66ff\u3048","Save Oekaki":"\u4fdd\u5b58","Saving drawing...":"\u753b\u50cf\u3092\u4fdd\u5b58\u4e2d\u2026","Preparing your drawing to be saved, please wait...":"\u753b\u50cf\u3092\u4fdd\u5b58\u3059\u308b\u6e96\u5099\u3092\u3057\u3066\u3044\u307e\u3059\u3002\u3057\u3070\u3089\u304f\u304a\u5f85\u3061\u304f\u3060\u3055\u3044\u2026","Drawing saved!":"\u753b\u50cf\u3092\u4fdd\u5b58\u3057\u307e\u3057\u305f\uff01","Your drawing has been saved, would you like to post it to the forum now?":"\u753b\u50cf\u306e\u4fdd\u5b58\u306b\u6210\u529f\u3057\u307e\u3057\u305f\u3002\u30d5\u30a9\u30fc\u30e9\u30e0\u3078\u6295\u7a3f\u3057\u307e\u3059\u304b\uff1f","Yes, post it now":"\u306f\u3044\u3001\u6295\u7a3f\u3057\u307e\u3059","No, keep drawing":"\u307e\u3060\u63cf\u304d\u307e\u3059","No, quit and I\'ll finish it later":"\u30a2\u30d7\u30ea\u3092\u7d42\u4e86\u3057\u3066\u7d9a\u304d\u3092\u5f8c\u3067\u63cf\u304f","Your drawing has been saved, would you like to view it on the forum now?":"\u753b\u50cf\u306e\u4fdd\u5b58\u306b\u6210\u529f\u3057\u307e\u3057\u305f\u3002\u30d5\u30a9\u30fc\u30e9\u30e0\u3078\u6295\u7a3f\u3057\u307e\u3059\u304b\uff1f","Yes, view the post":"\u306f\u3044\u3001\u6295\u7a3f\u3057\u307e\u3059\u3002","Your drawing has been saved, redirecting you to view your new post now...":"\u753b\u50cf\u306e\u4fdd\u5b58\u306b\u6210\u529f\u3057\u307e\u3057\u305f\u3002\u6295\u7a3f\u5148\u306b\u79fb\u52d5\u3057\u307e\u3059\u3002","Sorry, your drawing could not be saved, Please see the error message.":"\u753b\u50cf\u3092\u4fdd\u5b58\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002\u30a8\u30e9\u30fc\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u3054\u78ba\u8a8d\u304f\u3060\u3055\u3044\u3002","Sorry, your drawing could not be saved, please try again later.":"\u753b\u50cf\u3092\u4fdd\u5b58\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002\u6642\u9593\u3092\u7f6e\u3044\u3066\u518d\u5ea6\u6295\u7a3f\u3057\u3066\u307f\u3066\u304f\u3060\u3055\u3044\u3002","The error returned from the server was":"\u30b5\u30fc\u30d0\u30fc\u304b\u3089\u8fd4\u3063\u3066\u6765\u305f\u30a8\u30e9\u30fc","The file size exceeds the server limit.":"\u30d5\u30a1\u30a4\u30eb\u30b5\u30a4\u30ba\u304c\u30b5\u30fc\u30d0\u30fc\u306e\u4e0a\u9650\u3092\u8d85\u3048\u3066\u3044\u307e\u3059\u3002","The total size of FormData is within the acceptable range.":"FormData\u306e\u5408\u8a08\u30b5\u30a4\u30ba\u306f\u5236\u9650\u7bc4\u56f2\u5185\u3067\u3059\u3002","Limit size":"\u4e0a\u9650\u30b5\u30a4\u30ba","Current size":"\u73fe\u5728\u306e\u30b5\u30a4\u30ba","Network response was not OK":"\u901a\u4fe1\u30a8\u30e9\u30fc","HTTP status code":"HTTP\u30b9\u30c6\u30fc\u30bf\u30b9\u30b3\u30fc\u30c9","Unsaved data detected.\\nInterrupt image loading and restore it?":"\u672a\u4fdd\u5b58\u306e\u30c7\u30fc\u30bf\u304c\u3042\u308a\u307e\u3059\u3002\\n\u753b\u50cf\u306e\u8aad\u307f\u8fbc\u307f\u3092\u4e2d\u65ad\u3057\u3066\u5fa9\u5143\u3057\u307e\u3059\u304b\uff1f","Unsaved data detected. Would you like to restore it?":"\u672a\u4fdd\u5b58\u306e\u30c7\u30fc\u30bf\u304c\u3042\u308a\u307e\u3059\u3002\u5fa9\u5143\u3057\u307e\u3059\u304b\uff1f"}'),
en:be},ae=be,Xe="en";Kd.prototype=Object.create(Ga(Jb).prototype);Kd.prototype.constructor=Kd;var zb={};zb=function(){function c(t,z){return z&&`${z}::${Mb++}`||t.uidEvent||Mb++}function d(t){let z=c(t);return t.uidEvent=z,Yb[z]=Yb[z]||{},Yb[z]}function b(t,z,J=null){return Object.values(t).find(T=>T.callable===z&&T.delegationSelector===J)}function g(t,z,J){let T="string"==typeof z,ea=e(t);return wc.has(ea)||(ea=t),[T,T?J:z||J,ea]}function n(t,z,J,T,ea){var pa,ya;if("string"==typeof z&&t){var [Ba,
Ra,$a]=g(z,J,T);if(z in Mc){let Sa;Sa=Ra;Ra=function(Ca){if(!Ca.relatedTarget||Ca.relatedTarget!==Ca.delegateTarget&&!Ca.delegateTarget.contains(Ca.relatedTarget))return Sa.call(this,Ca)}}T=d(t);T=T[$a]||(T[$a]={});var ua=b(T,Ra,Ba?J:null);if(ua)return void(ua.oneOff=ua.oneOff&&ea);z=c(Ra,z.replace(vc,""));ua=Ba?(pa=Ra,function ab(Ca){let Ya=t.querySelectorAll(J);for(let {target:Va}=Ca;Va&&Va!==this;Va=Va.parentNode)for(let Wa of Ya)if(Wa===Va)return k(Ca,{delegateTarget:Va}),ab.oneOff&&ta.off(t,
Ca.type,J,pa),pa.apply(Va,[Ca])}):(ya=Ra,function Ya(ab){return k(ab,{delegateTarget:t}),Ya.oneOff&&ta.off(t,ab.type,ya),ya.apply(t,[ab])});ua.delegationSelector=Ba?J:null;ua.callable=Ra;ua.oneOff=ea;ua.uidEvent=z;T[z]=ua;t.addEventListener($a,ua,Ba)}}function f(t,z,J,T,ea){(T=b(z[J],T,ea))&&(t.removeEventListener(J,T,!!ea),delete z[J][T.uidEvent])}function e(t){return Mc[t=t.replace(fc,"")]||t}function k(t,z={}){for(let [J,T]of Object.entries(z))try{t[J]=T}catch(ea){Object.defineProperty(t,J,{configurable:!0,
get:()=>T})}return t}function l(t){if("true"===t)return!0;if("false"===t)return!1;if(t===Number(t).toString())return Number(t);if(""===t||"null"===t)return null;if("string"!=typeof t)return t;try{return JSON.parse(decodeURIComponent(t))}catch(z){return t}}function h(t){return t.replace(/[A-Z]/g,z=>`-${z.toLowerCase()}`)}function m(t){return t?(t.nodeName||"").toLowerCase():null}function p(t){return null==t?window:"[object Window]"!==t.toString()?(t=t.ownerDocument)&&t.defaultView||window:t}function q(t){return t instanceof
p(t).Element||t instanceof Element}function r(t){return t instanceof p(t).HTMLElement||t instanceof HTMLElement}function u(t){return"u">typeof ShadowRoot&&(t instanceof p(t).ShadowRoot||t instanceof ShadowRoot)}function v(t){return t.split("-")[0]}function y(){var t=navigator.userAgentData;return null!=t&&t.brands&&Array.isArray(t.brands)?t.brands.map(function(z){return z.brand+"/"+z.version}).join(" "):navigator.userAgent}function C(){return!/^((?!chrome|android).)*safari/i.test(y())}function w(t,
z,J){void 0===z&&(z=!1);void 0===J&&(J=!1);var T=t.getBoundingClientRect(),ea=1,pa=1;z&&r(t)&&(ea=t.offsetWidth>0&&Cc(T.width)/t.offsetWidth||1,pa=t.offsetHeight>0&&Cc(T.height)/t.offsetHeight||1);t=(q(t)?p(t):window).visualViewport;z=!C()&&J;J=(T.left+(z&&t?t.offsetLeft:0))/ea;t=(T.top+(z&&t?t.offsetTop:0))/pa;ea=T.width/ea;T=T.height/pa;return{width:ea,height:T,top:t,right:J+ea,bottom:t+T,left:J,x:J,y:t}}function D(t){var z=w(t),J=t.offsetWidth,T=t.offsetHeight;return 1>=Math.abs(z.width-J)&&(J=
z.width),1>=Math.abs(z.height-T)&&(T=z.height),{x:t.offsetLeft,y:t.offsetTop,width:J,height:T}}function x(t,z){var J=z.getRootNode&&z.getRootNode();if(t.contains(z))return!0;if(J&&u(J)){do{if(z&&t.isSameNode(z))return!0;z=z.parentNode||z.host}while(z)}return!1}function G(t){return p(t).getComputedStyle(t)}function H(t){return((q(t)?t.ownerDocument:t.document)||window.document).documentElement}function N(t){return"html"===m(t)?t:t.assignedSlot||t.parentNode||(u(t)?t.host:null)||H(t)}function B(t){return r(t)&&
"fixed"!==G(t).position?t.offsetParent:null}function P(t){for(var z=p(t),J=B(t);J&&["table","td","th"].indexOf(m(J))>=0&&"static"===G(J).position;)J=B(J);if(!J||"html"!==m(J)&&("body"!==m(J)||"static"!==G(J).position)){if(!J)a:{J=/firefox/i.test(y());if(!/Trident/i.test(y())||!r(t)||"fixed"!==G(t).position)for(t=N(t),u(t)&&(t=t.host);r(t)&&0>["html","body"].indexOf(m(t));){var T=G(t);if("none"!==T.transform||"none"!==T.perspective||"paint"===T.contain||-1!==["transform","perspective"].indexOf(T.willChange)||
J&&"filter"===T.willChange||J&&T.filter&&"none"!==T.filter){J=t;break a}t=t.parentNode}J=null}z=J||z}return z}function V(t){return["top","bottom"].indexOf(t)>=0?"x":"y"}function L(t){return Object.assign({},{top:0,right:0,bottom:0,left:0},t)}function ia(t,z){return z.reduce(function(J,T){return J[T]=t,J},{})}function aa(t){return t.split("-")[1]}function ma(t){var z,J=t.popper,T=t.popperRect,ea=t.placement,pa=t.variation,ya=t.offsets,Ba=t.position,Ra=t.gpuAcceleration,$a=t.adaptive,ua=t.roundOffsets,
Sa=t.isFixed;t=ya.x;t=void 0===t?0:t;var Ca=ya.y;Ca=void 0===Ca?0:Ca;Ca="function"==typeof ua?ua({x:t,y:Ca}):{x:t,y:Ca};t=Ca.x;Ca=Ca.y;var ab=ya.hasOwnProperty("x");ya=ya.hasOwnProperty("y");var Ya="left",Va="top",Wa=window;if($a){var bb=P(J),Cb="clientHeight",fb="clientWidth";bb===p(J)&&"static"!==G(bb=H(J)).position&&"absolute"===Ba&&(Cb="scrollHeight",fb="scrollWidth");("top"===ea||(ea==="left"||ea==="right")&&"end"===pa)&&(Va="bottom",Ca-=(Sa&&bb===Wa&&Wa.visualViewport?Wa.visualViewport.height:
bb[Cb])-T.height,Ca*=Ra?1:-1);ea!=="left"&&("top"!==ea&&ea!=="bottom"||"end"!==pa)||(Ya="right",t-=(Sa&&bb===Wa&&Wa.visualViewport?Wa.visualViewport.width:bb[fb])-T.width,t*=Ra?1:-1)}var Ma,tb,ub,Fb,vb,rb;T=Object.assign({position:Ba},$a&&ge);ua=!0===ua?(Ma={x:t,y:Ca},tb=p(J),ub=Ma.x,Fb=Ma.y,{x:Cc(ub*(vb=tb.devicePixelRatio||1))/vb||0,y:Cc(Fb*vb)/vb||0}):{x:t,y:Ca};return t=ua.x,Ca=ua.y,Ra?Object.assign({},T,((rb={})[Va]=ya?"0":"",rb[Ya]=ab?"0":"",rb.transform=1>=(Wa.devicePixelRatio||1)?"translate("+
t+"px, "+Ca+"px)":"translate3d("+t+"px, "+Ca+"px, 0)",rb)):Object.assign({},T,((z={})[Va]=ya?Ca+"px":"",z[Ya]=ab?t+"px":"",z.transform="",z))}function ca(t){return t.replace(/left|right|bottom|top/g,function(z){return Md[z]})}function ra(t){return t.replace(/start|end/g,function(z){return Nd[z]})}function ka(t){t=p(t);return{scrollLeft:t.pageXOffset,scrollTop:t.pageYOffset}}function qa(t){return w(H(t)).left+ka(t).scrollLeft}function M(t){t=G(t);return/auto|scroll|overlay|hidden/.test(t.overflow+
t.overflowY+t.overflowX)}function A(t,z){void 0===z&&(z=[]);var J,T=function ya(pa){return["html","body","#document"].indexOf(m(pa))>=0?pa.ownerDocument.body:r(pa)&&M(pa)?pa:ya(N(pa))}(t);t=T===(null==(J=t.ownerDocument)?void 0:J.body);J=p(T);T=t?[J].concat(J.visualViewport||[],M(T)?T:[]):T;z=z.concat(T);return t?z:z.concat(A(N(T)))}function K(t){return Object.assign({},t,{left:t.x,top:t.y,right:t.x+t.width,bottom:t.y+t.height})}function S(t,z,J){var T,ea,pa,ya,Ba,Ra,$a;if(z==="viewport"){z=p(t);
var ua=H(t);z=z.visualViewport;var Sa=ua.clientWidth;ua=ua.clientHeight;var Ca=T=0;z&&(Sa=z.width,ua=z.height,((ea=C())||!ea&&"fixed"===J)&&(T=z.offsetLeft,Ca=z.offsetTop));t={width:Sa,height:ua,x:T+qa(t),y:Ca};J=K(t)}else J=q(z)?((Sa=w(z,!1,"fixed"===J)).top=Sa.top+z.clientTop,Sa.left+=z.clientLeft,Sa.bottom=Sa.top+z.clientHeight,Sa.right=Sa.left+z.clientWidth,Sa.width=z.clientWidth,Sa.height=z.clientHeight,Sa.x=Sa.left,Sa.y=Sa.top,Sa):K((ua=H(t),Ca=H(ua),ea=ka(ua),pa=null==(T=ua.ownerDocument)?
void 0:T.body,ya=Eb(Ca.scrollWidth,Ca.clientWidth,pa?pa.scrollWidth:0,pa?pa.clientWidth:0),Ba=Eb(Ca.scrollHeight,Ca.clientHeight,pa?pa.scrollHeight:0,pa?pa.clientHeight:0),Ra=-ea.scrollLeft+qa(ua),$a=-ea.scrollTop,"rtl"===G(pa||Ca).direction&&(Ra+=Eb(Ca.clientWidth,pa?pa.clientWidth:0)-ya),{width:ya,height:Ba,x:Ra,y:$a}));return J}function na(t){var z=t.reference,J=t.element,T=(t=t.placement)?v(t):null;t=t?aa(t):null;var ea=z.x+z.width/2-J.width/2;var pa=z.y+z.height/2-J.height/2;switch(T){case "top":ea=
{x:ea,y:z.y-J.height};break;case "bottom":ea={x:ea,y:z.y+z.height};break;case "right":ea={x:z.x+z.width,y:pa};break;case "left":ea={x:z.x-J.width,y:pa};break;default:ea={x:z.x,y:z.y}}T=T?V(T):null;if(null!=T)switch(pa="y"===T?"height":"width",t){case "start":ea[T]-=z[pa]/2-J[pa]/2;break;case "end":ea[T]+=z[pa]/2-J[pa]/2}return ea}function Z(t,z){void 0===z&&(z={});var J,T,ea,pa,ya,Ba,Ra,$a,ua=z;z=ua.placement;z=void 0===z?t.placement:z;var Sa=ua.strategy,Ca=void 0===Sa?t.strategy:Sa,ab=ua.boundary,
Ya=ua.rootBoundary;Sa=ua.elementContext;Sa=void 0===Sa?"popper":Sa;var Va=ua.altBoundary;ua=ua.padding;ua=void 0===ua?0:ua;ua=L("number"!=typeof ua?ua:ia(ua,Rb));var Wa=t.rects.popper;Va=t.elements[void 0!==Va&&Va?Sa==="popper"?"reference":"popper":Sa];Va=(J=q(Va)?Va:Va.contextElement||H(t.elements.popper),T=void 0===ab?"clippingParents":ab,ea=void 0===Ya?"viewport":Ya,Ra=(Ba=[].concat("clippingParents"===T?(pa=A(N(J)),q(ya=["absolute","fixed"].indexOf(G(J).position)>=0&&r(J)?P(J):J)?pa.filter(function(fb){return q(fb)&&
x(fb,ya)&&"body"!==m(fb)}):[]):[].concat(T),[ea]))[0],($a=Ba.reduce(function(fb,Ma){Ma=S(J,Ma,Ca);return fb.top=Eb(Ma.top,fb.top),fb.right=tc(Ma.right,fb.right),fb.bottom=tc(Ma.bottom,fb.bottom),fb.left=Eb(Ma.left,fb.left),fb},S(J,Ra,Ca))).width=$a.right-$a.left,$a.height=$a.bottom-$a.top,$a.x=$a.left,$a.y=$a.top,$a);T=w(t.elements.reference);ea=na({reference:T,element:Wa,placement:z});ea=K(Object.assign({},Wa,ea));T=Sa==="popper"?ea:T;var bb={top:Va.top-T.top+ua.top,bottom:T.bottom-Va.bottom+ua.bottom,
left:Va.left-T.left+ua.left,right:T.right-Va.right+ua.right};t=t.modifiersData.offset;if(Sa==="popper"&&t){var Cb=t[z];Object.keys(bb).forEach(function(fb){var Ma=["right","bottom"].indexOf(fb)>=0?1:-1,tb=["top","bottom"].indexOf(fb)>=0?"y":"x";bb[fb]+=Cb[tb]*Ma})}return bb}function ha(t,z,J){return void 0===J&&(J={x:0,y:0}),{top:t.top-z.height-J.y,right:t.right-z.width+J.x,bottom:t.bottom-z.height+J.y,left:t.left-z.width-J.x}}function X(t){return["top","right","bottom","left"].some(function(z){return t[z]>=
0})}function ba(){for(var t=arguments.length,z=Array(t),J=0;J<t;J++)z[J]=arguments[J];return!z.some(function(T){return!(T&&"function"==typeof T.getBoundingClientRect)})}function Ea(t){void 0===t&&(t={});var z=t.defaultModifiers,J=void 0===z?[]:z;t=t.defaultOptions;var T=void 0===t?Fa:t;return function(ea,pa,ya){function Ba(){Sa.forEach(function(Ya){return Ya()});Sa=[]}void 0===ya&&(ya=T);var Ra,$a,ua={placement:"bottom",orderedModifiers:[],options:Object.assign({},Fa,T),modifiersData:{},elements:{reference:ea,
popper:pa},attributes:{},styles:{}},Sa=[],Ca=!1,ab={state:ua,setOptions:function(Ya){Ya="function"==typeof Ya?Ya(ua.options):Ya;Ba();ua.options=Object.assign({},T,ua.options,Ya);ua.scrollParents={reference:q(ea)?A(ea):ea.contextElement?A(ea.contextElement):[],popper:A(pa)};var Va,Wa,bb,Cb,fb;Ya=(Va=Object.keys(fb=[].concat(J,ua.options.modifiers).reduce(function(Ma,tb){var ub=Ma[tb.name];return Ma[tb.name]=ub?Object.assign({},ub,tb,{options:Object.assign({},ub.options,tb.options),data:Object.assign({},
ub.data,tb.data)}):tb,Ma},{})).map(function(Ma){return fb[Ma]}),Wa=new Map,bb=new Set,Cb=[],Va.forEach(function(Ma){Wa.set(Ma.name,Ma)}),Va.forEach(function(Ma){bb.has(Ma.name)||function Fb(ub){bb.add(ub.name);[].concat(ub.requires||[],ub.requiresIfExists||[]).forEach(function(vb){bb.has(vb)||(vb=Wa.get(vb))&&Fb(vb)});Cb.push(ub)}(Ma)}),Ob.reduce(function(Ma,tb){return Ma.concat(Cb.filter(function(ub){return ub.phase===tb}))},[]));return ua.orderedModifiers=Ya.filter(function(Ma){return Ma.enabled}),
ua.orderedModifiers.forEach(function(Ma){var tb=Ma.name,ub=Ma.options;Ma=Ma.effect;"function"==typeof Ma&&(tb=Ma({state:ua,name:tb,instance:ab,options:void 0===ub?{}:ub}),Sa.push(tb||function(){}))}),ab.update()},forceUpdate:function(){if(!Ca){var Ya=ua.elements,Va=Ya.reference;Ya=Ya.popper;if(ba(Va,Ya)){ua.rects={reference:(Wa=P(Ya),bb="fixed"===ua.options.strategy,tb=r(Wa),ub=r(Wa)&&(fb=Cc((Cb=Wa.getBoundingClientRect()).width)/Wa.offsetWidth||1,Ma=Cc(Cb.height)/Wa.offsetHeight||1,1!==fb||1!==Ma),
Fb=H(Wa),vb=w(Va,ub,bb),rb={scrollLeft:0,scrollTop:0},dc={x:0,y:0},(tb||!tb&&!bb)&&(("body"!==m(Wa)||M(Fb))&&(rb=Wa!==p(Wa)&&r(Wa)?{scrollLeft:Wa.scrollLeft,scrollTop:Wa.scrollTop}:ka(Wa)),r(Wa)?((dc=w(Wa,!0)).x+=Wa.clientLeft,dc.y+=Wa.clientTop):Fb&&(dc.x=qa(Fb))),{x:vb.left+rb.scrollLeft-dc.x,y:vb.top+rb.scrollTop-dc.y,width:vb.width,height:vb.height}),popper:D(Ya)};ua.reset=!1;ua.placement=ua.options.placement;ua.orderedModifiers.forEach(function(Vc){return ua.modifiersData[Vc.name]=Object.assign({},
Vc.data)});var Wa,bb,Cb,fb,Ma,tb,ub,Fb,vb,rb,dc;for(Va=0;Va<ua.orderedModifiers.length;Va++)!0!==ua.reset?(bb=ua.orderedModifiers[Va],Wa=bb.fn,Cb=bb.options,Cb=void 0===Cb?{}:Cb,bb=bb.name,"function"==typeof Wa&&(ua=Wa({state:ua,options:Cb,name:bb,instance:ab})||ua)):(ua.reset=!1,Va=-1)}}},update:(Ra=function(){return new Promise(function(Ya){ab.forceUpdate();Ya(ua)})},function(){return $a||=new Promise(function(Ya){Promise.resolve().then(function(){$a=void 0;Ya(Ra())})}),$a}),destroy:function(){Ba();
Ca=!0}};return ba(ea,pa)?(ab.setOptions(ya).then(function(Ya){!Ca&&ya.onFirstUpdate&&ya.onFirstUpdate(Ya)}),ab):ab}}let Ha=new Map,xb={set(t,z,J){Ha.has(t)||Ha.set(t,new Map);t=Ha.get(t);t.has(z)||0===t.size?t.set(z,J):console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(t.keys())[0]}.`)},get:(t,z)=>Ha.has(t)&&Ha.get(t).get(z)||null,remove(t,z){if(Ha.has(t)){var J=Ha.get(t);J.delete(z);0===J.size&&Ha.delete(t)}}},Ka=t=>(t&&window.CSS&&window.CSS.escape&&
(t=t.replace(/#([^\s"#']+)/g,(z,J)=>`#${CSS.escape(J)}`)),t),Ua=t=>!(!t||"object"!=typeof t)&&(void 0!==t.jquery&&(t=t[0]),void 0!==t.nodeType),Db=t=>Ua(t)?t.jquery?t[0]:t:"string"==typeof t&&t.length>0?document.querySelector(Ka(t)):null,kb=t=>{if(!Ua(t)||0===t.getClientRects().length)return!1;let z="visible"===getComputedStyle(t).getPropertyValue("visibility"),J=t.closest("details:not([open])");return J?J!==t&&((t=t.closest("summary"))&&t.parentNode!==J||null===t)?!1:z:z},qb=t=>!t||t.nodeType!==
Node.ELEMENT_NODE||!!t.classList.contains("disabled")||(void 0!==t.disabled?t.disabled:t.hasAttribute("disabled")&&"false"!==t.getAttribute("disabled")),Ta=t=>document.documentElement.attachShadow?"function"==typeof t.getRootNode?(t=t.getRootNode(),t instanceof ShadowRoot?t:null):t instanceof ShadowRoot?t:t.parentNode?Ta(t.parentNode):null:null,Wb=()=>{},wb=t=>{t.offsetHeight},ac=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,mb=[],eb=t=>{var z=()=>{let J=ac();
if(J){let T=t.NAME,ea=J.fn[T];J.fn[T]=t.jQueryInterface;J.fn[T].Constructor=t;J.fn[T].noConflict=()=>(J.fn[T]=ea,t.jQueryInterface)}};"loading"===document.readyState?(mb.length||document.addEventListener("DOMContentLoaded",()=>{for(let J of mb)J()}),mb.push(z)):z()},Hb=(t,z=[],J=t)=>"function"==typeof t?t.call(...z):J,pb=(t,z,J=!0)=>{if(!J)return void Hb(t);J=(pa=>{if(!pa)return 0;let {transitionDuration:ya,transitionDelay:Ba}=window.getComputedStyle(pa);pa=Number.parseFloat(ya);let Ra=Number.parseFloat(Ba);
return pa||Ra?(ya=ya.split(",")[0],Ba=Ba.split(",")[0],1E3*(Number.parseFloat(ya)+Number.parseFloat(Ba))):0})(z)+5;let T=!1,ea=({target:pa})=>{pa===z&&(T=!0,z.removeEventListener("transitionend",ea),Hb(t))};z.addEventListener("transitionend",ea);setTimeout(()=>{T||z.dispatchEvent(new Event("transitionend"))},J)},pc=(t,z,J,T)=>{let ea=t.length;z=t.indexOf(z);return-1===z?!J&&T?t[ea-1]:t[0]:(z+=J?1:-1,T&&(z=(z+ea)%ea),t[Math.max(0,Math.min(z,ea-1))])},vc=/[^.]*(?=\..*)\.|.*/,fc=/\..*/,$b=/::\d+$/,Yb=
{},Mb=1,Mc={mouseenter:"mouseover",mouseleave:"mouseout"},wc=new Set("click dblclick mouseup mousedown contextmenu mousewheel DOMMouseScroll mouseover mouseout mousemove selectstart selectend keydown keypress keyup orientationchange touchstart touchmove touchend touchcancel pointerdown pointermove pointerup pointerleave pointercancel gesturestart gesturechange gestureend focus blur change reset select submit focusin focusout load unload beforeunload resize move DOMContentLoaded readystatechange error abort scroll".split(" ")),
ta={on(t,z,J,T){n(t,z,J,T,!1)},one(t,z,J,T){n(t,z,J,T,!0)},off(t,z,J,T){if("string"==typeof z&&t){var [ea,pa,ya]=g(z,J,T);T=ya!==z;var Ba=d(t),Ra=Ba[ya]||{},$a=z.startsWith(".");if(void 0===pa){if($a)for(var ua of Object.keys(Ba)){J=z.slice(1);for(let [Sa,Ca]of Object.entries(Ba[ua]||{}))Sa.includes(J)&&f(t,Ba,ua,Ca.callable,Ca.delegationSelector)}for(let [Sa,Ca]of Object.entries(Ra))ua=Sa.replace($b,""),T&&!z.includes(ua)||f(t,Ba,ya,Ca.callable,Ca.delegationSelector)}else Object.keys(Ra).length&&
f(t,Ba,ya,pa,ea?J:null)}},trigger(t,z,J){if("string"!=typeof z||!t)return null;let T=ac(),ea=null,pa=!0,ya=!0,Ba=!1;z!==e(z)&&T&&(ea=T.Event(z,J),T(t).trigger(ea),pa=!ea.isPropagationStopped(),ya=!ea.isImmediatePropagationStopped(),Ba=ea.isDefaultPrevented());z=k(new Event(z,{bubbles:pa,cancelable:!0}),J);return Ba&&z.preventDefault(),ya&&t.dispatchEvent(z),z.defaultPrevented&&ea&&ea.preventDefault(),z}},Zb={setDataAttribute(t,z,J){t.setAttribute(`data-bs-${h(z)}`,J)},removeDataAttribute(t,z){t.removeAttribute(`data-bs-${h(z)}`)},
getDataAttributes(t){if(!t)return{};let z={};for(let J of Object.keys(t.dataset).filter(T=>T.startsWith("bs")&&!T.startsWith("bsConfig"))){let T=J.replace(/^bs/,"");z[T=T.charAt(0).toLowerCase()+T.slice(1)]=l(t.dataset[J])}return z},getDataAttribute:(t,z)=>l(t.getAttribute(`data-bs-${h(z)}`))};class ic{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw Error('You have to implement the static method "NAME", for each component!');}_getConfig(t){return t=this._mergeConfigObj(t),
t=this._configAfterMerge(t),this._typeCheckConfig(t),t}_configAfterMerge(t){return t}_mergeConfigObj(t,z){let J=Ua(z)?Zb.getDataAttribute(z,"config"):{};return{...this.constructor.Default,...("object"==typeof J?J:{}),...(Ua(z)?Zb.getDataAttributes(z):{}),...("object"==typeof t?t:{})}}_typeCheckConfig(t,z=this.constructor.DefaultType){for(let [J,T]of Object.entries(z))if(z=t[J],z=Ua(z)?"element":null==z?`${z}`:Object.prototype.toString.call(z).match(/\s([a-z]+)/i)[1].toLowerCase(),!(new RegExp(T)).test(z))throw TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${J}" provided type "${z}" but expected type "${T}".`);
}}class Nb extends ic{dispose(){for(let t of(xb.remove(this._element,this.constructor.DATA_KEY),ta.off(this._element,this.constructor.EVENT_KEY),Object.getOwnPropertyNames(this)))this[t]=null}_queueCallback(t,z,J=!0){pb(t,z,J)}_getConfig(t){return t=this._mergeConfigObj(t,this._element),t=this._configAfterMerge(t),this._typeCheckConfig(t),t}static getInstance(t){return xb.get(Db(t),this.DATA_KEY)}static getOrCreateInstance(t,z={}){return this.getInstance(t)||new this(t,"object"==typeof z?z:null)}static get VERSION(){return"5.3.8"}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(t){return`${t}${this.EVENT_KEY}`}constructor(t,
z){super();(t=Db(t))&&(this._element=t,this._config=this._getConfig(z),xb.set(this._element,this.constructor.DATA_KEY,this))}}let Ec=t=>{let z=t.getAttribute("data-bs-target");if(!z||"#"===z){t=t.getAttribute("href");if(!t||!t.includes("#")&&!t.startsWith("."))return null;t.includes("#")&&!t.startsWith("#")&&(t=`#${t.split("#")[1]}`);z=t&&"#"!==t?t.trim():null}return z?z.split(",").map(J=>Ka(J)).join(","):null},Pa={find:(t,z=document.documentElement)=>[].concat(...Element.prototype.querySelectorAll.call(z,
t)),findOne:(t,z=document.documentElement)=>Element.prototype.querySelector.call(z,t),children:(t,z)=>[].concat(...t.children).filter(J=>J.matches(z)),parents(t,z){let J=[];for(t=t.parentNode.closest(z);t;)J.push(t),t=t.parentNode.closest(z);return J},prev(t,z){for(t=t.previousElementSibling;t;){if(t.matches(z))return[t];t=t.previousElementSibling}return[]},next(t,z){for(t=t.nextElementSibling;t;){if(t.matches(z))return[t];t=t.nextElementSibling}return[]},focusableChildren(t){let z='a button input textarea select details [tabindex] [contenteditable="true"]'.split(" ").map(J=>
`${J}:not([tabindex^="-"])`).join(",");return this.find(z,t).filter(J=>!qb(J)&&kb(J))},getSelectorFromElement(t){return(t=Ec(t))&&Pa.findOne(t)?t:null},getElementFromSelector(t){return(t=Ec(t))?Pa.findOne(t):null},getMultipleElementsFromSelector(t){return(t=Ec(t))?Pa.find(t):[]}},bc=(t,z="hide")=>{let J=t.NAME;ta.on(document,`click.dismiss${t.EVENT_KEY}`,`[data-bs-dismiss="${J}"]`,function(T){(["A","AREA"].includes(this.tagName)&&T.preventDefault(),qb(this))||(T=Pa.getElementFromSelector(this)||this.closest(`.${J}`),
t.getOrCreateInstance(T)[z]())})};class qc extends Nb{static get NAME(){return"alert"}close(){if(!ta.trigger(this._element,"close.bs.alert").defaultPrevented){this._element.classList.remove("show");var t=this._element.classList.contains("fade");this._queueCallback(()=>this._destroyElement(),this._element,t)}}_destroyElement(){this._element.remove();ta.trigger(this._element,"closed.bs.alert");this.dispose()}static jQueryInterface(t){return this.each(function(){let z=qc.getOrCreateInstance(this);if("string"==
typeof t){if(void 0===z[t]||t.startsWith("_")||"constructor"===t)throw TypeError(`No method named "${t}"`);z[t](this)}})}}bc(qc,"close");eb(qc);class E extends Nb{static get NAME(){return"button"}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle("active"))}static jQueryInterface(t){return this.each(function(){let z=E.getOrCreateInstance(this);"toggle"===t&&z[t]()})}}ta.on(document,"click.bs.button.data-api",'[data-bs-toggle="button"]',t=>{t.preventDefault();t=t.target.closest('[data-bs-toggle="button"]');
E.getOrCreateInstance(t).toggle()});eb(E);let O={endCallback:null,leftCallback:null,rightCallback:null},Q={endCallback:"(function|null)",leftCallback:"(function|null)",rightCallback:"(function|null)"};class Y extends ic{static get Default(){return O}static get DefaultType(){return Q}static get NAME(){return"swipe"}dispose(){ta.off(this._element,".bs.swipe")}_start(t){this._supportPointerEvents?this._eventIsPointerPenTouch(t)&&(this._deltaX=t.clientX):this._deltaX=t.touches[0].clientX}_end(t){this._eventIsPointerPenTouch(t)&&
(this._deltaX=t.clientX-this._deltaX);this._handleSwipe();Hb(this._config.endCallback)}_move(t){this._deltaX=t.touches&&t.touches.length>1?0:t.touches[0].clientX-this._deltaX}_handleSwipe(){var t=Math.abs(this._deltaX);t<=40||(t/=this._deltaX,this._deltaX=0,t&&Hb(t>0?this._config.rightCallback:this._config.leftCallback))}_initEvents(){this._supportPointerEvents?(ta.on(this._element,"pointerdown.bs.swipe",t=>this._start(t)),ta.on(this._element,"pointerup.bs.swipe",t=>this._end(t)),this._element.classList.add("pointer-event")):
(ta.on(this._element,"touchstart.bs.swipe",t=>this._start(t)),ta.on(this._element,"touchmove.bs.swipe",t=>this._move(t)),ta.on(this._element,"touchend.bs.swipe",t=>this._end(t)))}_eventIsPointerPenTouch(t){return this._supportPointerEvents&&("pen"===t.pointerType||"touch"===t.pointerType)}static isSupported(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints>0}constructor(t,z){super();(this._element=t)&&Y.isSupported()&&(this._config=this._getConfig(z),this._deltaX=0,this._supportPointerEvents=
!!window.PointerEvent,this._initEvents())}}let da={ArrowLeft:"right",ArrowRight:"left"},ja={interval:5E3,keyboard:!0,pause:"hover",ride:!1,touch:!0,wrap:!0},va={interval:"(number|boolean)",keyboard:"boolean",pause:"(string|boolean)",ride:"(boolean|string)",touch:"boolean",wrap:"boolean"};class Ja extends Nb{static get Default(){return ja}static get DefaultType(){return va}static get NAME(){return"carousel"}next(){this._slide("next")}nextWhenVisible(){!document.hidden&&kb(this._element)&&this.next()}prev(){this._slide("prev")}pause(){this._isSliding&&
this._element.dispatchEvent(new Event("transitionend"));this._clearInterval()}cycle(){this._clearInterval();this._updateInterval();this._interval=setInterval(()=>this.nextWhenVisible(),this._config.interval)}_maybeEnableCycle(){this._config.ride&&(this._isSliding?ta.one(this._element,"slid.bs.carousel",()=>this.cycle()):this.cycle())}to(t){let z=this._getItems();if(!(t>z.length-1||t<0)){if(this._isSliding)return void ta.one(this._element,"slid.bs.carousel",()=>this.to(t));var J=this._getItemIndex(this._getActive());
J===t||this._slide(t>J?"next":"prev",z[t])}}dispose(){this._swipeHelper&&this._swipeHelper.dispose();super.dispose()}_configAfterMerge(t){return t.defaultInterval=t.interval,t}_addEventListeners(){this._config.keyboard&&ta.on(this._element,"keydown.bs.carousel",t=>this._keydown(t));"hover"===this._config.pause&&(ta.on(this._element,"mouseenter.bs.carousel",()=>this.pause()),ta.on(this._element,"mouseleave.bs.carousel",()=>this._maybeEnableCycle()));this._config.touch&&Y.isSupported()&&this._addTouchEventListeners()}_addTouchEventListeners(){for(let t of Pa.find(".carousel-item img",
this._element))ta.on(t,"dragstart.bs.carousel",z=>z.preventDefault());this._swipeHelper=new Y(this._element,{leftCallback:()=>this._slide(this._directionToOrder("left")),rightCallback:()=>this._slide(this._directionToOrder("right")),endCallback:()=>{"hover"===this._config.pause&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout(()=>this._maybeEnableCycle(),500+this._config.interval))}})}_keydown(t){if(!/input|textarea/i.test(t.target.tagName)){var z=da[t.key];
z&&(t.preventDefault(),this._slide(this._directionToOrder(z)))}}_getItemIndex(t){return this._getItems().indexOf(t)}_setActiveIndicatorElement(t){if(this._indicatorsElement){var z=Pa.findOne(".active",this._indicatorsElement);z.classList.remove("active");z.removeAttribute("aria-current");(t=Pa.findOne(`[data-bs-slide-to="${t}"]`,this._indicatorsElement))&&(t.classList.add("active"),t.setAttribute("aria-current","true"))}}_updateInterval(){var t=this._activeElement||this._getActive();t&&(t=Number.parseInt(t.getAttribute("data-bs-interval"),
10),this._config.interval=t||this._config.defaultInterval)}_slide(t,z=null){if(!this._isSliding){var J=this._getActive(),T=t==="next",ea=z||pc(this._getItems(),J,T,this._config.wrap);if(ea!==J){var pa=this._getItemIndex(ea),ya=$a=>ta.trigger(this._element,$a,{relatedTarget:ea,direction:this._orderToDirection(t),from:this._getItemIndex(J),to:pa});if(!ya("slide.bs.carousel").defaultPrevented&&J&&ea){z=!!this._interval;this.pause();this._isSliding=!0;this._setActiveIndicatorElement(pa);this._activeElement=
ea;var Ba=T?"carousel-item-start":"carousel-item-end",Ra=T?"carousel-item-next":"carousel-item-prev";ea.classList.add(Ra);ea.offsetHeight;J.classList.add(Ba);ea.classList.add(Ba);this._queueCallback(()=>{ea.classList.remove(Ba,Ra);ea.classList.add("active");J.classList.remove("active",Ra,Ba);this._isSliding=!1;ya("slid.bs.carousel")},J,this._isAnimated());z&&this.cycle()}}}}_isAnimated(){return this._element.classList.contains("slide")}_getActive(){return Pa.findOne(".active.carousel-item",this._element)}_getItems(){return Pa.find(".carousel-item",
this._element)}_clearInterval(){this._interval&&(clearInterval(this._interval),this._interval=null)}_directionToOrder(t){return"rtl"===document.documentElement.dir?t==="left"?"prev":"next":t==="left"?"next":"prev"}_orderToDirection(t){return"rtl"===document.documentElement.dir?t==="prev"?"left":"right":t==="prev"?"right":"left"}static jQueryInterface(t){return this.each(function(){let z=Ja.getOrCreateInstance(this,t);if("number"!=typeof t){if("string"==typeof t){if(void 0===z[t]||t.startsWith("_")||
"constructor"===t)throw TypeError(`No method named "${t}"`);z[t]()}}else z.to(t)})}constructor(t,z){super(t,z);this._activeElement=this._interval=null;this._isSliding=!1;this._swipeHelper=this.touchTimeout=null;this._indicatorsElement=Pa.findOne(".carousel-indicators",this._element);this._addEventListeners();this._config.ride==="carousel"&&this.cycle()}}ta.on(document,"click.bs.carousel.data-api","[data-bs-slide], [data-bs-slide-to]",function(t){var z=Pa.getElementFromSelector(this);if(z&&z.classList.contains("carousel"))return t.preventDefault(),
t=Ja.getOrCreateInstance(z),z=this.getAttribute("data-bs-slide-to"),z?t.to(z):"next"===Zb.getDataAttribute(this,"slide")?t.next():t.prev(),void t._maybeEnableCycle()});ta.on(window,"load.bs.carousel.data-api",()=>{for(let t of Pa.find('[data-bs-ride="carousel"]'))Ja.getOrCreateInstance(t)});eb(Ja);let hb={parent:null,toggle:!0},nc={parent:"(null|element)",toggle:"boolean"};class hc extends Nb{static get Default(){return hb}static get DefaultType(){return nc}static get NAME(){return"collapse"}toggle(){this._isShown()?
this.hide():this.show()}show(){if(!this._isTransitioning&&!this._isShown()){var t=[];if(!(this._config.parent&&(t=this._getFirstLevelChildren(".collapse.show, .collapse.collapsing").filter(J=>J!==this._element).map(J=>hc.getOrCreateInstance(J,{toggle:!1}))),t.length&&t[0]._isTransitioning||ta.trigger(this._element,"show.bs.collapse").defaultPrevented)){for(let J of t)J.hide();var z=this._getDimension();this._element.classList.remove("collapse");this._element.classList.add("collapsing");this._element.style[z]=
0;this._addAriaAndCollapsedClass(this._triggerArray,!0);this._isTransitioning=!0;t=`scroll${z[0].toUpperCase()+z.slice(1)}`;this._queueCallback(()=>{this._isTransitioning=!1;this._element.classList.remove("collapsing");this._element.classList.add("collapse","show");this._element.style[z]="";ta.trigger(this._element,"shown.bs.collapse")},this._element,!0);this._element.style[z]=`${this._element[t]}px`}}}hide(){if(!this._isTransitioning&&this._isShown()&&!ta.trigger(this._element,"hide.bs.collapse").defaultPrevented){var t=
this._getDimension();for(let z of(this._element.style[t]=`${this._element.getBoundingClientRect()[t]}px`,wb(this._element),this._element.classList.add("collapsing"),this._element.classList.remove("collapse","show"),this._triggerArray)){let J=Pa.getElementFromSelector(z);J&&!this._isShown(J)&&this._addAriaAndCollapsedClass([z],!1)}this._isTransitioning=!0;this._element.style[t]="";this._queueCallback(()=>{this._isTransitioning=!1;this._element.classList.remove("collapsing");this._element.classList.add("collapse");
ta.trigger(this._element,"hidden.bs.collapse")},this._element,!0)}}_isShown(t=this._element){return t.classList.contains("show")}_configAfterMerge(t){return t.toggle=!!t.toggle,t.parent=Db(t.parent),t}_getDimension(){return this._element.classList.contains("collapse-horizontal")?"width":"height"}_initializeChildren(){if(this._config.parent)for(let t of this._getFirstLevelChildren('[data-bs-toggle="collapse"]')){let z=Pa.getElementFromSelector(t);z&&this._addAriaAndCollapsedClass([t],this._isShown(z))}}_getFirstLevelChildren(t){let z=
Pa.find(":scope .collapse .collapse",this._config.parent);return Pa.find(t,this._config.parent).filter(J=>!z.includes(J))}_addAriaAndCollapsedClass(t,z){if(t.length)for(let J of t)J.classList.toggle("collapsed",!z),J.setAttribute("aria-expanded",z)}static jQueryInterface(t){let z={};return"string"==typeof t&&/show|hide/.test(t)&&(z.toggle=!1),this.each(function(){let J=hc.getOrCreateInstance(this,z);if("string"==typeof t){if(void 0===J[t])throw TypeError(`No method named "${t}"`);J[t]()}})}constructor(t,
z){for(const J of(super(t,z),this._isTransitioning=!1,this._triggerArray=[],Pa.find('[data-bs-toggle="collapse"]')))t=Pa.getSelectorFromElement(J),z=Pa.find(t).filter(T=>T===this._element),null!==t&&z.length&&this._triggerArray.push(J);this._initializeChildren();this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown());this._config.toggle&&this.toggle()}}ta.on(document,"click.bs.collapse.data-api",'[data-bs-toggle="collapse"]',function(t){for(let z of(("A"===t.target.tagName||
t.delegateTarget&&"A"===t.delegateTarget.tagName)&&t.preventDefault(),Pa.getMultipleElementsFromSelector(this)))hc.getOrCreateInstance(z,{toggle:!1}).toggle()});eb(hc);var Rb=["top","bottom","right","left"],Lb=Rb.reduce(function(t,z){return t.concat([z+"-start",z+"-end"])},[]),ob=[].concat(Rb,["auto"]).reduce(function(t,z){return t.concat([z,z+"-start",z+"-end"])},[]),Ob="beforeRead read afterRead beforeMain main afterMain beforeWrite write afterWrite".split(" ");let yc={name:"applyStyles",enabled:!0,
phase:"write",fn:function(t){var z=t.state;Object.keys(z.elements).forEach(function(J){var T=z.styles[J]||{},ea=z.attributes[J]||{},pa=z.elements[J];r(pa)&&m(pa)&&(Object.assign(pa.style,T),Object.keys(ea).forEach(function(ya){var Ba=ea[ya];!1===Ba?pa.removeAttribute(ya):pa.setAttribute(ya,!0===Ba?"":Ba)}))})},effect:function(t){var z=t.state,J={popper:{position:z.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(z.elements.popper.style,J.popper),
z.styles=J,z.elements.arrow&&Object.assign(z.elements.arrow.style,J.arrow),function(){Object.keys(z.elements).forEach(function(T){var ea=z.elements[T],pa=z.attributes[T]||{};T=Object.keys(z.styles.hasOwnProperty(T)?z.styles[T]:J[T]).reduce(function(ya,Ba){return ya[Ba]="",ya},{});r(ea)&&m(ea)&&(Object.assign(ea.style,T),Object.keys(pa).forEach(function(ya){ea.removeAttribute(ya)}))})}},requires:["computeStyles"]};var Eb=Math.max,tc=Math.min,Cc=Math.round;let rd={name:"arrow",enabled:!0,phase:"main",
fn:function(t){var z,J=t.state,T=t.name,ea=t.options,pa=J.elements.arrow,ya=J.modifiersData.popperOffsets,Ba=v(J.placement);t=V(Ba);Ba=["left","right"].indexOf(Ba)>=0?"height":"width";if(pa&&ya){var Ra;ea=(Ra=ea.padding,L("number"!=typeof(Ra="function"==typeof Ra?Ra(Object.assign({},J.rects,{placement:J.placement})):Ra)?Ra:ia(Ra,Rb)));Ra=D(pa);var $a="y"===t?"top":"left",ua="y"===t?"bottom":"right",Sa=J.rects.reference[Ba]+J.rects.reference[t]-ya[t]-J.rects.popper[Ba];ya=ya[t]-J.rects.reference[t];
pa=(pa=P(pa))?"y"===t?pa.clientHeight||0:pa.clientWidth||0:0;ya=pa/2-Ra[Ba]/2+(Sa/2-ya/2);Ba=Eb(ea[$a],tc(ya,pa-Ra[Ba]-ea[ua]));J.modifiersData[T]=((z={})[t]=Ba,z.centerOffset=Ba-ya,z)}},effect:function(t){var z=t.state;t=t.options.element;t=void 0===t?"[data-popper-arrow]":t;null!=t&&("string"!=typeof t||(t=z.elements.popper.querySelector(t)))&&x(z.elements.popper,t)&&(z.elements.arrow=t)},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};var ge={top:"auto",right:"auto",bottom:"auto",
left:"auto"};let sd={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function(t){var z=t.state,J=t.options,T=J.gpuAcceleration;t=J.adaptive;J=J.roundOffsets;J=void 0===J||J;T={placement:v(z.placement),variation:aa(z.placement),popper:z.elements.popper,popperRect:z.rects.popper,gpuAcceleration:void 0===T||T,isFixed:"fixed"===z.options.strategy};null!=z.modifiersData.popperOffsets&&(z.styles.popper=Object.assign({},z.styles.popper,ma(Object.assign({},T,{offsets:z.modifiersData.popperOffsets,
position:z.options.strategy,adaptive:void 0===t||t,roundOffsets:J}))));null!=z.modifiersData.arrow&&(z.styles.arrow=Object.assign({},z.styles.arrow,ma(Object.assign({},T,{offsets:z.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:J}))));z.attributes.popper=Object.assign({},z.attributes.popper,{"data-popper-placement":z.placement})},data:{}};var xc={passive:!0};let id={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function(t){var z=t.state,J=t.instance;t=t.options;
var T=t.scroll,ea=void 0===T||T;t=t.resize;var pa=void 0===t||t,ya=p(z.elements.popper),Ba=[].concat(z.scrollParents.reference,z.scrollParents.popper);return ea&&Ba.forEach(function(Ra){Ra.addEventListener("scroll",J.update,xc)}),pa&&ya.addEventListener("resize",J.update,xc),function(){ea&&Ba.forEach(function(Ra){Ra.removeEventListener("scroll",J.update,xc)});pa&&ya.removeEventListener("resize",J.update,xc)}},data:{}};var Md={left:"right",right:"left",bottom:"top",top:"bottom"},Nd={start:"end",end:"start"};
let td={name:"flip",enabled:!0,phase:"main",fn:function(t){var z=t.state,J=t.options;t=t.name;if(!z.modifiersData[t]._skip){var T=J.mainAxis;T=void 0===T||T;var ea=J.altAxis;ea=void 0===ea||ea;var pa=J.fallbackPlacements,ya=J.padding,Ba=J.boundary,Ra=J.rootBoundary,$a=J.altBoundary,ua=J.flipVariations,Sa=void 0===ua||ua,Ca=J.allowedAutoPlacements;J=z.options.placement;ua=v(J);pa=pa||(ua!==J&&Sa?function(Fb){if(v(Fb)==="auto")return[];var vb=ca(Fb);return[ra(Fb),vb,ra(vb)]}(J):[ca(J)]);var ab=[J].concat(pa).reduce(function(Fb,
vb){var rb,dc,Vc,Wc,Ig,Jg,Kg,Lg,Mg,Ng,ff,gf;return Fb.concat(v(vb)==="auto"?(dc=(rb={placement:vb,boundary:Ba,rootBoundary:Ra,padding:ya,flipVariations:Sa,allowedAutoPlacements:Ca}).placement,Vc=rb.boundary,Wc=rb.rootBoundary,Ig=rb.padding,Jg=rb.flipVariations,Lg=void 0===(Kg=rb.allowedAutoPlacements)?ob:Kg,0===(ff=(Ng=(Mg=aa(dc))?Jg?Lb:Lb.filter(function(Xc){return aa(Xc)===Mg}):Rb).filter(function(Xc){return Lg.indexOf(Xc)>=0})).length&&(ff=Ng),Object.keys(gf=ff.reduce(function(Xc,Td){return Xc[Td]=
Z(z,{placement:Td,boundary:Vc,rootBoundary:Wc,padding:Ig})[v(Td)],Xc},{})).sort(function(Xc,Td){return gf[Xc]-gf[Td]})):vb)},[]);J=z.rects.reference;pa=z.rects.popper;var Ya=new Map;ua=!0;for(var Va=ab[0],Wa=0;Wa<ab.length;Wa++){var bb=ab[Wa],Cb=v(bb),fb=aa(bb)==="start",Ma=["top","bottom"].indexOf(Cb)>=0,tb=Ma?"width":"height",ub=Z(z,{placement:bb,boundary:Ba,rootBoundary:Ra,altBoundary:$a,padding:ya});fb=Ma?fb?"right":"left":fb?"bottom":"top";J[tb]>pa[tb]&&(fb=ca(fb));tb=ca(fb);Ma=[];if(T&&Ma.push(ub[Cb]<=
0),ea&&Ma.push(ub[fb]<=0,ub[tb]<=0),Ma.every(function(Fb){return Fb})){Va=bb;ua=!1;break}Ya.set(bb,Ma)}if(ua)for(T=function(Fb){var vb=ab.find(function(rb){if(rb=Ya.get(rb))return rb.slice(0,Fb).every(function(dc){return dc})});if(vb)return Va=vb,"break"},ea=Sa?3:1;ea>0&&"break"!==T(ea);ea--);z.placement!==Va&&(z.modifiersData[t]._skip=!0,z.placement=Va,z.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}},F={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function(t){var z=
t.state;t=t.name;var J=z.rects.reference,T=z.rects.popper,ea=z.modifiersData.preventOverflow,pa=Z(z,{elementContext:"reference"}),ya=Z(z,{altBoundary:!0});J=ha(pa,J);T=ha(ya,T,ea);ea=X(J);ya=X(T);z.modifiersData[t]={referenceClippingOffsets:J,popperEscapeOffsets:T,isReferenceHidden:ea,hasPopperEscaped:ya};z.attributes.popper=Object.assign({},z.attributes.popper,{"data-popper-reference-hidden":ea,"data-popper-escaped":ya})}},U={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function(t){var z=
t.state,J=t.name;t=t.options.offset;var T=void 0===t?[0,0]:t;t=ob.reduce(function(ya,Ba){var Ra,$a,ua,Sa,Ca,ab;return ya[Ba]=(Ra=z.rects,ua=["left","top"].indexOf($a=v(Ba))>=0?-1:1,Ca=(Sa="function"==typeof T?T(Object.assign({},Ra,{placement:Ba})):T)[0],ab=Sa[1],Ca=Ca||0,ab=(ab||0)*ua,["left","right"].indexOf($a)>=0?{x:ab,y:Ca}:{x:Ca,y:ab}),ya},{});var ea=t[z.placement],pa=ea.x;ea=ea.y;null!=z.modifiersData.popperOffsets&&(z.modifiersData.popperOffsets.x+=pa,z.modifiersData.popperOffsets.y+=ea);z.modifiersData[J]=
t}},fa={name:"popperOffsets",enabled:!0,phase:"read",fn:function(t){var z=t.state;z.modifiersData[t.name]=na({reference:z.rects.reference,element:z.rects.popper,placement:z.placement})},data:{}},xa={name:"preventOverflow",enabled:!0,phase:"main",fn:function(t){var z=t.state,J=t.options;t=t.name;var T=J.mainAxis,ea=J.altAxis,pa=J.tether;pa=void 0===pa||pa;var ya=J.tetherOffset,Ba=void 0===ya?0:ya,Ra=Z(z,{boundary:J.boundary,rootBoundary:J.rootBoundary,padding:J.padding,altBoundary:J.altBoundary}),
$a=v(z.placement),ua=aa(z.placement),Sa=!ua,Ca=V($a);J="x"===Ca?"y":"x";ya=z.modifiersData.popperOffsets;var ab=z.rects.reference,Ya=z.rects.popper;Ba="function"==typeof Ba?Ba(Object.assign({},z.rects,{placement:z.placement})):Ba;var Va="number"==typeof Ba?{mainAxis:Ba,altAxis:Ba}:Object.assign({mainAxis:0,altAxis:0},Ba),Wa=z.modifiersData.offset?z.modifiersData.offset[z.placement]:null;Ba={x:0,y:0};if(ya){if(void 0===T||T){var bb,Cb="y"===Ca?"top":"left",fb="y"===Ca?"bottom":"right",Ma="y"===Ca?
"height":"width";T=ya[Ca];var tb=T+Ra[Cb],ub=T-Ra[fb],Fb=pa?-Ya[Ma]/2:0,vb=ua==="start"?ab[Ma]:Ya[Ma];ua=ua==="start"?-Ya[Ma]:-ab[Ma];var rb=z.elements.arrow;rb=pa&&rb?D(rb):{width:0,height:0};var dc=z.modifiersData["arrow#persistent"]?z.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0};Cb=dc[Cb];fb=dc[fb];rb=Eb(0,tc(ab[Ma],rb[Ma]));vb=Sa?ab[Ma]/2-Fb-rb-Cb-Va.mainAxis:vb-rb-Cb-Va.mainAxis;Sa=Sa?-ab[Ma]/2+Fb+rb+fb+Va.mainAxis:ua+rb+fb+Va.mainAxis;Fb=(Ma=z.elements.arrow&&P(z.elements.arrow))?
"y"===Ca?Ma.clientTop||0:Ma.clientLeft||0:0;Ma=null!=(bb=null==Wa?void 0:Wa[Ca])?bb:0;bb=pa?tc(tb,T+vb-Ma-Fb):tb;ub=pa?Eb(ub,T+Sa-Ma):ub;bb=Eb(bb,tc(T,ub));ya[Ca]=bb;Ba[Ca]=bb-T}if(void 0!==ea&&ea){var Vc,Wc;ea=ya[J];T="y"===J?"height":"width";bb=ea+Ra["x"===Ca?"top":"left"];Ra=ea-Ra["x"===Ca?"bottom":"right"];$a=-1!==["top","left"].indexOf($a);Ca=null!=(Wc=null==Wa?void 0:Wa[J])?Wc:0;Wc=$a?bb:ea-ab[T]-Ya[T]-Ca+Va.altAxis;ab=$a?ea+ab[T]+Ya[T]-Ca-Va.altAxis:Ra;Ya=pa&&$a?(Vc=Eb(Wc,tc(ea,ab)))>ab?ab:
Vc:Eb(pa?Wc:bb,tc(ea,pa?ab:Ra));ya[J]=Ya;Ba[J]=Ya-ea}z.modifiersData[t]=Ba}},requiresIfExists:["offset"]};var Fa={placement:"bottom",modifiers:[],strategy:"absolute"},sa=Ea(),La=Ea({defaultModifiers:[id,fa,sd,yc]}),db=Ea({defaultModifiers:[id,fa,sd,yc,U,td,xa,rd,F]});let Ib=Object.freeze(Object.defineProperty({__proto__:null,afterMain:"afterMain",afterRead:"afterRead",afterWrite:"afterWrite",applyStyles:yc,arrow:rd,auto:"auto",basePlacements:Rb,beforeMain:"beforeMain",beforeRead:"beforeRead",beforeWrite:"beforeWrite",
bottom:"bottom",clippingParents:"clippingParents",computeStyles:sd,createPopper:db,createPopperBase:sa,createPopperLite:La,detectOverflow:Z,end:"end",eventListeners:id,flip:td,hide:F,left:"left",main:"main",modifierPhases:Ob,offset:U,placements:ob,popper:"popper",popperGenerator:Ea,popperOffsets:fa,preventOverflow:xa,read:"read",reference:"reference",right:"right",start:"start",top:"top",variationPlacements:Lb,viewport:"viewport",write:"write"},Symbol.toStringTag,{value:"Module"})),oc="rtl"===document.documentElement.dir?
"top-end":"top-start",Ic="rtl"===document.documentElement.dir?"top-start":"top-end",lc="rtl"===document.documentElement.dir?"bottom-end":"bottom-start",fe="rtl"===document.documentElement.dir?"bottom-start":"bottom-end",Aa="rtl"===document.documentElement.dir?"left-start":"right-start",Ia="rtl"===document.documentElement.dir?"right-start":"left-start",Oa={autoClose:!0,boundary:"clippingParents",display:"dynamic",offset:[0,2],popperConfig:null,reference:"toggle"},jb={autoClose:"(boolean|string)",boundary:"(string|element)",
display:"string",offset:"(array|string|function)",popperConfig:"(null|object|function)",reference:"(string|element|object)"};class Za extends Nb{static get Default(){return Oa}static get DefaultType(){return jb}static get NAME(){return"dropdown"}toggle(){return this._isShown()?this.hide():this.show()}show(){if(!qb(this._element)&&!this._isShown()){var t={relatedTarget:this._element};if(!ta.trigger(this._element,"show.bs.dropdown",t).defaultPrevented){if(this._createPopper(),"ontouchstart"in document.documentElement&&
!this._parent.closest(".navbar-nav"))for(let z of[].concat(...document.body.children))ta.on(z,"mouseover",Wb);this._element.focus();this._element.setAttribute("aria-expanded",!0);this._menu.classList.add("show");this._element.classList.add("show");ta.trigger(this._element,"shown.bs.dropdown",t)}}}hide(){!qb(this._element)&&this._isShown()&&this._completeHide({relatedTarget:this._element})}dispose(){this._popper&&this._popper.destroy();super.dispose()}update(){this._inNavbar=this._detectNavbar();this._popper&&
this._popper.update()}_completeHide(t){if(!ta.trigger(this._element,"hide.bs.dropdown",t).defaultPrevented){if("ontouchstart"in document.documentElement)for(let z of[].concat(...document.body.children))ta.off(z,"mouseover",Wb);this._popper&&this._popper.destroy();this._menu.classList.remove("show");this._element.classList.remove("show");this._element.setAttribute("aria-expanded","false");Zb.removeDataAttribute(this._menu,"popper");ta.trigger(this._element,"hidden.bs.dropdown",t)}}_getConfig(t){if("object"==
typeof(t=super._getConfig(t)).reference&&!Ua(t.reference)&&"function"!=typeof t.reference.getBoundingClientRect)throw TypeError('DROPDOWN: Option "reference" provided type "object" without a required "getBoundingClientRect" method.');return t}_createPopper(){if(void 0===Ib)throw TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org/docs/v2/)");let t=this._element;"parent"===this._config.reference?t=this._parent:Ua(this._config.reference)?t=Db(this._config.reference):"object"==typeof this._config.reference&&
(t=this._config.reference);let z=this._getPopperConfig();this._popper=db(t,this._menu,z)}_isShown(){return this._menu.classList.contains("show")}_getPlacement(){let t=this._parent;if(t.classList.contains("dropend"))return Aa;if(t.classList.contains("dropstart"))return Ia;if(t.classList.contains("dropup-center"))return"top";if(t.classList.contains("dropdown-center"))return"bottom";let z="end"===getComputedStyle(this._menu).getPropertyValue("--bs-position").trim();return t.classList.contains("dropup")?
z?Ic:oc:z?fe:lc}_detectNavbar(){return null!==this._element.closest(".navbar")}_getOffset(){let {offset:t}=this._config;return"string"==typeof t?t.split(",").map(z=>Number.parseInt(z,10)):"function"==typeof t?z=>t(z,this._element):t}_getPopperConfig(){let t={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return(this._inNavbar||"static"===this._config.display)&&(Zb.setDataAttribute(this._menu,
"popper","static"),t.modifiers=[{name:"applyStyles",enabled:!1}]),{...t,...Hb(this._config.popperConfig,[void 0,t])}}_selectMenuItem({key:t,target:z}){let J=Pa.find(".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",this._menu).filter(T=>kb(T));J.length&&pc(J,z,t==="ArrowDown",!J.includes(z)).focus()}static jQueryInterface(t){return this.each(function(){let z=Za.getOrCreateInstance(this,t);if("string"==typeof t){if(void 0===z[t])throw TypeError(`No method named "${t}"`);z[t]()}})}static clearMenus(t){if(2!==
t.button&&("keyup"!==t.type||"Tab"===t.key))for(let J of Pa.find('[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled).show')){let T=Za.getInstance(J);if(!T||!1===T._config.autoClose)continue;var z=t.composedPath();let ea=z.includes(T._menu);z.includes(T._element)||"inside"===T._config.autoClose&&!ea||"outside"===T._config.autoClose&&ea||T._menu.contains(t.target)&&("keyup"===t.type&&"Tab"===t.key||/input|select|option|textarea|form/i.test(t.target.tagName))||(z={relatedTarget:T._element},"click"===
t.type&&(z.clickEvent=t),T._completeHide(z))}}static dataApiKeydownHandler(t){var z=/input|textarea/i.test(t.target.tagName),J="Escape"===t.key;let T=["ArrowUp","ArrowDown"].includes(t.key);!T&&!J||z&&!J||(t.preventDefault(),z=this.matches('[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)')?this:Pa.prev(this,'[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)')[0]||Pa.next(this,'[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)')[0]||Pa.findOne('[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',
t.delegateTarget.parentNode),J=Za.getOrCreateInstance(z),T?(t.stopPropagation(),J.show(),J._selectMenuItem(t)):J._isShown()&&(t.stopPropagation(),J.hide(),z.focus()))}constructor(t,z){super(t,z);this._popper=null;this._parent=this._element.parentNode;this._menu=Pa.next(this._element,".dropdown-menu")[0]||Pa.prev(this._element,".dropdown-menu")[0]||Pa.findOne(".dropdown-menu",this._parent);this._inNavbar=this._detectNavbar()}}ta.on(document,"keydown.bs.dropdown.data-api",'[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',
Za.dataApiKeydownHandler);ta.on(document,"keydown.bs.dropdown.data-api",".dropdown-menu",Za.dataApiKeydownHandler);ta.on(document,"click.bs.dropdown.data-api",Za.clearMenus);ta.on(document,"keyup.bs.dropdown.data-api",Za.clearMenus);ta.on(document,"click.bs.dropdown.data-api",'[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',function(t){t.preventDefault();Za.getOrCreateInstance(this).toggle()});eb(Za);let sc={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},
hd={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class Og extends ic{static get Default(){return sc}static get DefaultType(){return hd}static get NAME(){return"backdrop"}show(t){if(!this._config.isVisible)return void Hb(t);this._append();let z=this._getElement();this._config.isAnimated&&z.offsetHeight;z.classList.add("show");this._emulateAnimation(()=>{Hb(t)})}hide(t){this._config.isVisible?(this._getElement().classList.remove("show"),
this._emulateAnimation(()=>{this.dispose();Hb(t)})):Hb(t)}dispose(){this._isAppended&&(ta.off(this._element,"mousedown.bs.backdrop"),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){let t=document.createElement("div");t.className=this._config.className;this._config.isAnimated&&t.classList.add("fade");this._element=t}return this._element}_configAfterMerge(t){return t.rootElement=Db(t.rootElement),t}_append(){if(!this._isAppended){var t=this._getElement();this._config.rootElement.append(t);
ta.on(t,"mousedown.bs.backdrop",()=>{Hb(this._config.clickCallback)});this._isAppended=!0}}_emulateAnimation(t){pb(t,this._getElement(),this._config.isAnimated)}constructor(t){super();this._config=this._getConfig(t);this._isAppended=!1;this._element=null}}let gi={autofocus:!0,trapElement:null},hi={autofocus:"boolean",trapElement:"element"};class Pg extends ic{static get Default(){return gi}static get DefaultType(){return hi}static get NAME(){return"focustrap"}activate(){this._isActive||(this._config.autofocus&&
this._config.trapElement.focus(),ta.off(document,".bs.focustrap"),ta.on(document,"focusin.bs.focustrap",t=>this._handleFocusin(t)),ta.on(document,"keydown.tab.bs.focustrap",t=>this._handleKeydown(t)),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,ta.off(document,".bs.focustrap"))}_handleFocusin(t){let {trapElement:z}=this._config;t.target===document||t.target===z||z.contains(t.target)||(t=Pa.focusableChildren(z),0===t.length?z.focus():this._lastTabNavDirection==="backward"?t[t.length-
1].focus():t[0].focus())}_handleKeydown(t){"Tab"===t.key&&(this._lastTabNavDirection=t.shiftKey?"backward":"forward")}constructor(t){super();this._config=this._getConfig(t);this._isActive=!1;this._lastTabNavDirection=null}}class hf{getWidth(){return Math.abs(window.innerWidth-document.documentElement.clientWidth)}hide(){let t=this.getWidth();this._disableOverFlow();this._setElementAttributes(this._element,"padding-right",z=>z+t);this._setElementAttributes(".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",
"padding-right",z=>z+t);this._setElementAttributes(".sticky-top","margin-right",z=>z-t)}reset(){this._resetElementAttributes(this._element,"overflow");this._resetElementAttributes(this._element,"padding-right");this._resetElementAttributes(".fixed-top, .fixed-bottom, .is-fixed, .sticky-top","padding-right");this._resetElementAttributes(".sticky-top","margin-right")}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow");this._element.style.overflow=
"hidden"}_setElementAttributes(t,z,J){let T=this.getWidth();this._applyManipulationCallback(t,ea=>{if(!(ea!==this._element&&window.innerWidth>ea.clientWidth+T)){this._saveInitialAttribute(ea,z);var pa=window.getComputedStyle(ea).getPropertyValue(z);ea.style.setProperty(z,`${J(Number.parseFloat(pa))}px`)}})}_saveInitialAttribute(t,z){let J=t.style.getPropertyValue(z);J&&Zb.setDataAttribute(t,z,J)}_resetElementAttributes(t,z){this._applyManipulationCallback(t,J=>{let T=Zb.getDataAttribute(J,z);null!==
T?(Zb.removeDataAttribute(J,z),J.style.setProperty(z,T)):J.style.removeProperty(z)})}_applyManipulationCallback(t,z){if(Ua(t))z(t);else for(let J of Pa.find(t,this._element))z(J)}constructor(){this._element=document.body}}let ii={backdrop:!0,focus:!0,keyboard:!0},ji={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class zd extends Nb{static get Default(){return ii}static get DefaultType(){return ji}static get NAME(){return"modal"}toggle(t){return this._isShown?this.hide():this.show(t)}show(t){this._isShown||
this._isTransitioning||ta.trigger(this._element,"show.bs.modal",{relatedTarget:t}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add("modal-open"),this._adjustDialog(),this._backdrop.show(()=>this._showElement(t)))}hide(){this._isShown&&!this._isTransitioning&&(ta.trigger(this._element,"hide.bs.modal").defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove("show"),this._queueCallback(()=>
this._hideModal(),this._element,this._isAnimated())))}dispose(){ta.off(window,".bs.modal");ta.off(this._dialog,".bs.modal");this._backdrop.dispose();this._focustrap.deactivate();super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new Og({isVisible:!!this._config.backdrop,isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new Pg({trapElement:this._element})}_showElement(t){document.body.contains(this._element)||document.body.append(this._element);this._element.style.display=
"block";this._element.removeAttribute("aria-hidden");this._element.setAttribute("aria-modal",!0);this._element.setAttribute("role","dialog");this._element.scrollTop=0;let z=Pa.findOne(".modal-body",this._dialog);z&&(z.scrollTop=0);this._element.offsetHeight;this._element.classList.add("show");this._queueCallback(()=>{this._config.focus&&this._focustrap.activate();this._isTransitioning=!1;ta.trigger(this._element,"shown.bs.modal",{relatedTarget:t})},this._dialog,this._isAnimated())}_addEventListeners(){ta.on(this._element,
"keydown.dismiss.bs.modal",t=>{"Escape"===t.key&&(this._config.keyboard?this.hide():this._triggerBackdropTransition())});ta.on(window,"resize.bs.modal",()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()});ta.on(this._element,"mousedown.dismiss.bs.modal",t=>{ta.one(this._element,"click.dismiss.bs.modal",z=>{this._element===t.target&&this._element===z.target&&("static"!==this._config.backdrop?this._config.backdrop&&this.hide():this._triggerBackdropTransition())})})}_hideModal(){this._element.style.display=
"none";this._element.setAttribute("aria-hidden",!0);this._element.removeAttribute("aria-modal");this._element.removeAttribute("role");this._isTransitioning=!1;this._backdrop.hide(()=>{document.body.classList.remove("modal-open");this._resetAdjustments();this._scrollBar.reset();ta.trigger(this._element,"hidden.bs.modal")})}_isAnimated(){return this._element.classList.contains("fade")}_triggerBackdropTransition(){if(!ta.trigger(this._element,"hidePrevented.bs.modal").defaultPrevented){var t=this._element.scrollHeight>
document.documentElement.clientHeight,z=this._element.style.overflowY;"hidden"===z||this._element.classList.contains("modal-static")||(t||(this._element.style.overflowY="hidden"),this._element.classList.add("modal-static"),this._queueCallback(()=>{this._element.classList.remove("modal-static");this._queueCallback(()=>{this._element.style.overflowY=z},this._dialog)},this._dialog),this._element.focus())}}_adjustDialog(){let t=this._element.scrollHeight>document.documentElement.clientHeight,z=this._scrollBar.getWidth(),
J=z>0;J&&!t&&(this._element.style["rtl"===document.documentElement.dir?"paddingLeft":"paddingRight"]=`${z}px`);!J&&t&&(this._element.style["rtl"===document.documentElement.dir?"paddingRight":"paddingLeft"]=`${z}px`)}_resetAdjustments(){this._element.style.paddingLeft="";this._element.style.paddingRight=""}static jQueryInterface(t,z){return this.each(function(){let J=zd.getOrCreateInstance(this,t);if("string"==typeof t){if(void 0===J[t])throw TypeError(`No method named "${t}"`);J[t](z)}})}constructor(t,
z){super(t,z);this._dialog=Pa.findOne(".modal-dialog",this._element);this._backdrop=this._initializeBackDrop();this._focustrap=this._initializeFocusTrap();this._isTransitioning=this._isShown=!1;this._scrollBar=new hf;this._addEventListeners()}}ta.on(document,"click.bs.modal.data-api",'[data-bs-toggle="modal"]',function(t){let z=Pa.getElementFromSelector(this);["A","AREA"].includes(this.tagName)&&t.preventDefault();ta.one(z,"show.bs.modal",J=>{J.defaultPrevented||ta.one(z,"hidden.bs.modal",()=>{kb(this)&&
this.focus()})});(t=Pa.findOne(".modal.show"))&&zd.getInstance(t).hide();zd.getOrCreateInstance(z).toggle(this)});bc(zd);eb(zd);let ki={backdrop:!0,keyboard:!0,scroll:!1},li={backdrop:"(boolean|string)",keyboard:"boolean",scroll:"boolean"};class Yc extends Nb{static get Default(){return ki}static get DefaultType(){return li}static get NAME(){return"offcanvas"}toggle(t){return this._isShown?this.hide():this.show(t)}show(t){this._isShown||ta.trigger(this._element,"show.bs.offcanvas",{relatedTarget:t}).defaultPrevented||
(this._isShown=!0,this._backdrop.show(),this._config.scroll||(new hf).hide(),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add("showing"),this._queueCallback(()=>{this._config.scroll&&!this._config.backdrop||this._focustrap.activate();this._element.classList.add("show");this._element.classList.remove("showing");ta.trigger(this._element,"shown.bs.offcanvas",{relatedTarget:t})},this._element,!0))}hide(){this._isShown&&(ta.trigger(this._element,
"hide.bs.offcanvas").defaultPrevented||(this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.add("hiding"),this._backdrop.hide(),this._queueCallback(()=>{this._element.classList.remove("show","hiding");this._element.removeAttribute("aria-modal");this._element.removeAttribute("role");this._config.scroll||(new hf).reset();ta.trigger(this._element,"hidden.bs.offcanvas")},this._element,!0)))}dispose(){this._backdrop.dispose();this._focustrap.deactivate();super.dispose()}_initializeBackDrop(){let t=
!!this._config.backdrop;return new Og({className:"offcanvas-backdrop",isVisible:t,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:t?()=>{"static"!==this._config.backdrop?this.hide():ta.trigger(this._element,"hidePrevented.bs.offcanvas")}:null})}_initializeFocusTrap(){return new Pg({trapElement:this._element})}_addEventListeners(){ta.on(this._element,"keydown.dismiss.bs.offcanvas",t=>{"Escape"===t.key&&(this._config.keyboard?this.hide():ta.trigger(this._element,"hidePrevented.bs.offcanvas"))})}static jQueryInterface(t){return this.each(function(){let z=
Yc.getOrCreateInstance(this,t);if("string"==typeof t){if(void 0===z[t]||t.startsWith("_")||"constructor"===t)throw TypeError(`No method named "${t}"`);z[t](this)}})}constructor(t,z){super(t,z);this._isShown=!1;this._backdrop=this._initializeBackDrop();this._focustrap=this._initializeFocusTrap();this._addEventListeners()}}ta.on(document,"click.bs.offcanvas.data-api",'[data-bs-toggle="offcanvas"]',function(t){let z=Pa.getElementFromSelector(this);(["A","AREA"].includes(this.tagName)&&t.preventDefault(),
qb(this))||(ta.one(z,"hidden.bs.offcanvas",()=>{kb(this)&&this.focus()}),(t=Pa.findOne(".offcanvas.show"))&&t!==z&&Yc.getInstance(t).hide(),Yc.getOrCreateInstance(z).toggle(this))});ta.on(window,"load.bs.offcanvas.data-api",()=>{for(let t of Pa.find(".offcanvas.show"))Yc.getOrCreateInstance(t).show()});ta.on(window,"resize.bs.offcanvas",()=>{for(let t of Pa.find("[aria-modal][class*=show][class*=offcanvas-]"))"fixed"!==getComputedStyle(t).position&&Yc.getOrCreateInstance(t).hide()});bc(Yc);eb(Yc);
let Qg={"*":["class","dir","id","lang","role",/^aria-[\w-]*$/i],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],dd:[],div:[],dl:[],dt:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:"src srcset alt title width height".split(" "),li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},mi=new Set("background cite href itemtype longdesc poster src xlink:href".split(" ")),ni=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:/?#]*(?:[/?#]|$))/i,oi=(t,z)=>{let J=
t.nodeName.toLowerCase();return z.includes(J)?!mi.has(J)||!!ni.test(t.nodeValue):z.filter(T=>T instanceof RegExp).some(T=>T.test(J))},pi={allowList:Qg,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},qi={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",sanitizeFn:"(null|function)",template:"string"},ri={entry:"(string|element|function|null)",selector:"(string|element)"};class si extends ic{static get Default(){return pi}static get DefaultType(){return qi}static get NAME(){return"TemplateFactory"}getContent(){return Object.values(this._config.content).map(t=>
this._resolvePossibleFunction(t)).filter(Boolean)}hasContent(){return this.getContent().length>0}changeContent(t){return this._checkContent(t),this._config.content={...this._config.content,...t},this}toHtml(){var t=document.createElement("div");for(let [J,T]of(t.innerHTML=this._maybeSanitize(this._config.template),Object.entries(this._config.content)))this._setContent(t,T,J);t=t.children[0];let z=this._resolvePossibleFunction(this._config.extraClass);return z&&t.classList.add(...z.split(" ")),t}_typeCheckConfig(t){super._typeCheckConfig(t);
this._checkContent(t.content)}_checkContent(t){for(let [z,J]of Object.entries(t))super._typeCheckConfig({selector:z,entry:J},ri)}_setContent(t,z,J){(t=Pa.findOne(J,t))&&((z=this._resolvePossibleFunction(z))?Ua(z)?this._putElementInTemplate(Db(z),t):this._config.html?t.innerHTML=this._maybeSanitize(z):t.textContent=z:t.remove())}_maybeSanitize(t){if(this._config.sanitize){var z=this._config.allowList;var J=this._config.sanitizeFn;if(t.length)if(J&&"function"==typeof J)z=J(t);else{t=(new window.DOMParser).parseFromString(t,
"text/html");for(let ea of[].concat(...t.body.querySelectorAll("*"))){var T=ea.nodeName.toLowerCase();if(Object.keys(z).includes(T)){J=[].concat(...ea.attributes);T=[].concat(z["*"]||[],z[T]||[]);for(let pa of J)oi(pa,T)||ea.removeAttribute(pa.nodeName)}else ea.remove()}z=t.body.innerHTML}else z=t}else z=t;return z}_resolvePossibleFunction(t){return Hb(t,[void 0,this])}_putElementInTemplate(t,z){this._config.html?(z.innerHTML="",z.append(t)):z.textContent=t.textContent}constructor(t){super();this._config=
this._getConfig(t)}}let ti=new Set(["sanitize","allowList","sanitizeFn"]),ui={AUTO:"auto",TOP:"top",RIGHT:"rtl"===document.documentElement.dir?"left":"right",BOTTOM:"bottom",LEFT:"rtl"===document.documentElement.dir?"right":"left"},vi={allowList:Qg,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,6],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',
title:"",trigger:"hover focus"},wi={allowList:"object",animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"};class Ad extends Nb{static get Default(){return vi}static get DefaultType(){return wi}static get NAME(){return"tooltip"}enable(){this._isEnabled=
!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){this._isEnabled&&(this._isShown()?this._leave():this._enter())}dispose(){clearTimeout(this._timeout);ta.off(this._element.closest(".modal"),"hide.bs.modal",this._hideModalHandler);this._element.getAttribute("data-bs-original-title")&&this._element.setAttribute("title",this._element.getAttribute("data-bs-original-title"));this._disposePopper();super.dispose()}show(){if("none"===this._element.style.display)throw Error("Please use show on visible elements");
if(this._isWithContent()&&this._isEnabled){var t=ta.trigger(this._element,this.constructor.eventName("show")),z=(Ta(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(!t.defaultPrevented&&z){this._disposePopper();t=this._getTipElement();this._element.setAttribute("aria-describedby",t.getAttribute("id"));({container:z}=this._config);if(this._element.ownerDocument.documentElement.contains(this.tip)||(z.append(t),ta.trigger(this._element,this.constructor.eventName("inserted"))),
this._popper=this._createPopper(t),t.classList.add("show"),"ontouchstart"in document.documentElement)for(let J of[].concat(...document.body.children))ta.on(J,"mouseover",Wb);this._queueCallback(()=>{ta.trigger(this._element,this.constructor.eventName("shown"));!1===this._isHovered&&this._leave();this._isHovered=!1},this.tip,this._isAnimated())}}}hide(){if(this._isShown()&&!ta.trigger(this._element,this.constructor.eventName("hide")).defaultPrevented){if(this._getTipElement().classList.remove("show"),
"ontouchstart"in document.documentElement)for(let t of[].concat(...document.body.children))ta.off(t,"mouseover",Wb);this._activeTrigger.click=!1;this._activeTrigger.focus=!1;this._activeTrigger.hover=!1;this._isHovered=null;this._queueCallback(()=>{this._isWithActiveTrigger()||(this._isHovered||this._disposePopper(),this._element.removeAttribute("aria-describedby"),ta.trigger(this._element,this.constructor.eventName("hidden")))},this.tip,this._isAnimated())}}update(){this._popper&&this._popper.update()}_isWithContent(){return!!this._getTitle()}_getTipElement(){return this.tip||
(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(t){t=this._getTemplateFactory(t).toHtml();if(!t)return null;t.classList.remove("fade","show");t.classList.add(`bs-${this.constructor.NAME}-auto`);var z=this.constructor.NAME;do z+=Math.floor(1E6*Math.random());while(document.getElementById(z));return t.setAttribute("id",z.toString()),this._isAnimated()&&t.classList.add("fade"),t}setContent(t){this._newContent=t;this._isShown()&&(this._disposePopper(),
this.show())}_getTemplateFactory(t){return this._templateFactory?this._templateFactory.changeContent(t):this._templateFactory=new si({...this._config,content:t,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{".tooltip-inner":this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute("data-bs-original-title")}_initializeOnDelegatedTarget(t){return this.constructor.getOrCreateInstance(t.delegateTarget,
this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains("fade")}_isShown(){return this.tip&&this.tip.classList.contains("show")}_createPopper(t){let z=ui[Hb(this._config.placement,[this,t,this._element]).toUpperCase()];return db(this._element,t,this._getPopperConfig(z))}_getOffset(){let {offset:t}=this._config;return"string"==typeof t?t.split(",").map(z=>Number.parseInt(z,10)):"function"==typeof t?z=>t(z,this._element):t}_resolvePossibleFunction(t){return Hb(t,
[this._element,this._element])}_getPopperConfig(t){t={placement:t,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:z=>{this._getTipElement().setAttribute("data-popper-placement",z.state.placement)}}]};return{...t,...Hb(this._config.popperConfig,
[void 0,t])}}_setListeners(){for(let t of this._config.trigger.split(" "))if("click"===t)ta.on(this._element,this.constructor.eventName("click"),this._config.selector,z=>{z=this._initializeOnDelegatedTarget(z);z._activeTrigger.click=!(z._isShown()&&z._activeTrigger.click);z.toggle()});else if("manual"!==t){let z=t==="hover"?this.constructor.eventName("mouseenter"):this.constructor.eventName("focusin"),J=t==="hover"?this.constructor.eventName("mouseleave"):this.constructor.eventName("focusout");ta.on(this._element,
z,this._config.selector,T=>{let ea=this._initializeOnDelegatedTarget(T);ea._activeTrigger["focusin"===T.type?"focus":"hover"]=!0;ea._enter()});ta.on(this._element,J,this._config.selector,T=>{let ea=this._initializeOnDelegatedTarget(T);ea._activeTrigger["focusout"===T.type?"focus":"hover"]=ea._element.contains(T.relatedTarget);ea._leave()})}this._hideModalHandler=()=>{this._element&&this.hide()};ta.on(this._element.closest(".modal"),"hide.bs.modal",this._hideModalHandler)}_fixTitle(){let t=this._element.getAttribute("title");
t&&(this._element.getAttribute("aria-label")||this._element.textContent.trim()||this._element.setAttribute("aria-label",t),this._element.setAttribute("data-bs-original-title",t),this._element.removeAttribute("title"))}_enter(){this._isShown()||this._isHovered?this._isHovered=!0:(this._isHovered=!0,this._setTimeout(()=>{this._isHovered&&this.show()},this._config.delay.show))}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout(()=>{this._isHovered||this.hide()},this._config.delay.hide))}_setTimeout(t,
z){clearTimeout(this._timeout);this._timeout=setTimeout(t,z)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(t){let z=Zb.getDataAttributes(this._element);for(let J of Object.keys(z))ti.has(J)&&delete z[J];return t={...z,...("object"==typeof t&&t?t:{})},t=this._mergeConfigObj(t),t=this._configAfterMerge(t),this._typeCheckConfig(t),t}_configAfterMerge(t){return t.container=!1===t.container?document.body:Db(t.container),"number"==typeof t.delay&&(t.delay={show:t.delay,
hide:t.delay}),"number"==typeof t.title&&(t.title=t.title.toString()),"number"==typeof t.content&&(t.content=t.content.toString()),t}_getDelegateConfig(){let t={};for(let [z,J]of Object.entries(this._config))this.constructor.Default[z]!==J&&(t[z]=J);return t.selector=!1,t.trigger="manual",t}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null);this.tip&&(this.tip.remove(),this.tip=null)}static jQueryInterface(t){return this.each(function(){let z=Ad.getOrCreateInstance(this,t);
if("string"==typeof t){if(void 0===z[t])throw TypeError(`No method named "${t}"`);z[t]()}})}constructor(t,z){if(void 0===Ib)throw TypeError("Bootstrap's tooltips require Popper (https://popper.js.org/docs/v2/)");super(t,z);this._isEnabled=!0;this._timeout=0;this._isHovered=null;this._activeTrigger={};this.tip=this._newContent=this._templateFactory=this._popper=null;this._setListeners();this._config.selector||this._fixTitle()}}eb(Ad);let xi={...Ad.Default,content:"",offset:[0,8],placement:"right",
template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>',trigger:"click"},yi={...Ad.DefaultType,content:"(null|string|element|function)"};class jf extends Ad{static get Default(){return xi}static get DefaultType(){return yi}static get NAME(){return"popover"}_isWithContent(){return this._getTitle()||this._getContent()}_getContentForTemplate(){return{".popover-header":this._getTitle(),".popover-body":this._getContent()}}_getContent(){return this._resolvePossibleFunction(this._config.content)}static jQueryInterface(t){return this.each(function(){let z=
jf.getOrCreateInstance(this,t);if("string"==typeof t){if(void 0===z[t])throw TypeError(`No method named "${t}"`);z[t]()}})}}eb(jf);let zi={offset:null,rootMargin:"0px 0px -25%",smoothScroll:!1,target:null,threshold:[.1,.5,1]},Ai={offset:"(number|null)",rootMargin:"string",smoothScroll:"boolean",target:"element",threshold:"array"};class te extends Nb{static get Default(){return zi}static get DefaultType(){return Ai}static get NAME(){return"scrollspy"}refresh(){for(let t of(this._initializeTargetsAndObservables(),
this._maybeEnableSmoothScroll(),this._observer?this._observer.disconnect():this._observer=this._getNewObserver(),this._observableSections.values()))this._observer.observe(t)}dispose(){this._observer.disconnect();super.dispose()}_configAfterMerge(t){return t.target=Db(t.target)||document.body,t.rootMargin=t.offset?`${t.offset}px 0px -30%`:t.rootMargin,"string"==typeof t.threshold&&(t.threshold=t.threshold.split(",").map(z=>Number.parseFloat(z))),t}_maybeEnableSmoothScroll(){this._config.smoothScroll&&
(ta.off(this._config.target,"click.bs.scrollspy"),ta.on(this._config.target,"click.bs.scrollspy","[href]",t=>{var z=this._observableSections.get(t.target.hash);if(z){t.preventDefault();t=this._rootElement||window;z=z.offsetTop-this._element.offsetTop;if(t.scrollTo)return void t.scrollTo({top:z,behavior:"smooth"});t.scrollTop=z}}))}_getNewObserver(){return new IntersectionObserver(t=>this._observerCallback(t),{root:this._rootElement,threshold:this._config.threshold,rootMargin:this._config.rootMargin})}_observerCallback(t){let z=
pa=>this._targetLinks.get(`#${pa.target.id}`),J=pa=>{this._previousScrollData.visibleEntryTop=pa.target.offsetTop;this._process(z(pa))},T=(this._rootElement||document.documentElement).scrollTop,ea=T>=this._previousScrollData.parentScrollTop;for(let pa of(this._previousScrollData.parentScrollTop=T,t))if(pa.isIntersecting)if(t=pa.target.offsetTop>=this._previousScrollData.visibleEntryTop,ea&&t){if(J(pa),!T)break}else ea||t||J(pa);else this._activeTarget=null,this._clearActiveClass(z(pa))}_initializeTargetsAndObservables(){for(let t of(this._targetLinks=
new Map,this._observableSections=new Map,Pa.find("[href]",this._config.target))){if(!t.hash||qb(t))continue;let z=Pa.findOne(decodeURI(t.hash),this._element);kb(z)&&(this._targetLinks.set(decodeURI(t.hash),t),this._observableSections.set(t.hash,z))}}_process(t){this._activeTarget!==t&&(this._clearActiveClass(this._config.target),this._activeTarget=t,t.classList.add("active"),this._activateParents(t),ta.trigger(this._element,"activate.bs.scrollspy",{relatedTarget:t}))}_activateParents(t){if(t.classList.contains("dropdown-item"))Pa.findOne(".dropdown-toggle",
t.closest(".dropdown")).classList.add("active");else for(let z of Pa.parents(t,".nav, .list-group"))for(let J of Pa.prev(z,".nav-link, .nav-item > .nav-link, .list-group-item"))J.classList.add("active")}_clearActiveClass(t){for(let z of(t.classList.remove("active"),Pa.find("[href].active",t)))z.classList.remove("active")}static jQueryInterface(t){return this.each(function(){let z=te.getOrCreateInstance(this,t);if("string"==typeof t){if(void 0===z[t]||t.startsWith("_")||"constructor"===t)throw TypeError(`No method named "${t}"`);
z[t]()}})}constructor(t,z){super(t,z);this._targetLinks=new Map;this._observableSections=new Map;this._rootElement="visible"===getComputedStyle(this._element).overflowY?null:this._element;this._observer=this._activeTarget=null;this._previousScrollData={visibleEntryTop:0,parentScrollTop:0};this.refresh()}}ta.on(window,"load.bs.scrollspy.data-api",()=>{for(let t of Pa.find('[data-bs-spy="scroll"]'))te.getOrCreateInstance(t)});eb(te);class Bd extends Nb{static get NAME(){return"tab"}show(){let t=this._element;
if(!this._elemIsActive(t)){var z=this._getActiveElem(),J=z?ta.trigger(z,"hide.bs.tab",{relatedTarget:t}):null;ta.trigger(t,"show.bs.tab",{relatedTarget:z}).defaultPrevented||J&&J.defaultPrevented||(this._deactivate(z,t),this._activate(t,z))}}_activate(t,z){t&&(t.classList.add("active"),this._activate(Pa.getElementFromSelector(t)),this._queueCallback(()=>{"tab"===t.getAttribute("role")?(t.removeAttribute("tabindex"),t.setAttribute("aria-selected",!0),this._toggleDropDown(t,!0),ta.trigger(t,"shown.bs.tab",
{relatedTarget:z})):t.classList.add("show")},t,t.classList.contains("fade")))}_deactivate(t,z){t&&(t.classList.remove("active"),t.blur(),this._deactivate(Pa.getElementFromSelector(t)),this._queueCallback(()=>{"tab"===t.getAttribute("role")?(t.setAttribute("aria-selected",!1),t.setAttribute("tabindex","-1"),this._toggleDropDown(t,!1),ta.trigger(t,"hidden.bs.tab",{relatedTarget:z})):t.classList.remove("show")},t,t.classList.contains("fade")))}_keydown(t){if("ArrowLeft ArrowRight ArrowUp ArrowDown Home End".split(" ").includes(t.key)){t.stopPropagation();
t.preventDefault();var z=this._getChildren().filter(J=>!qb(J));if(["Home","End"].includes(t.key))t=z[t.key==="Home"?0:z.length-1];else{let J=["ArrowRight","ArrowDown"].includes(t.key);t=pc(z,t.target,J,!0)}t&&(t.focus({preventScroll:!0}),Bd.getOrCreateInstance(t).show())}}_getChildren(){return Pa.find('.nav-link:not(.dropdown-toggle), .list-group-item:not(.dropdown-toggle), [role="tab"]:not(.dropdown-toggle), [data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',this._parent)}_getActiveElem(){return this._getChildren().find(t=>
this._elemIsActive(t))||null}_setInitialAttributes(t,z){for(let J of(this._setAttributeIfNotExists(t,"role","tablist"),z))this._setInitialAttributesOnChild(J)}_setInitialAttributesOnChild(t){t=this._getInnerElement(t);let z=this._elemIsActive(t),J=this._getOuterElement(t);t.setAttribute("aria-selected",z);J!==t&&this._setAttributeIfNotExists(J,"role","presentation");z||t.setAttribute("tabindex","-1");this._setAttributeIfNotExists(t,"role","tab");this._setInitialAttributesOnTargetPanel(t)}_setInitialAttributesOnTargetPanel(t){let z=
Pa.getElementFromSelector(t);z&&(this._setAttributeIfNotExists(z,"role","tabpanel"),t.id&&this._setAttributeIfNotExists(z,"aria-labelledby",`${t.id}`))}_toggleDropDown(t,z){t=this._getOuterElement(t);if(t.classList.contains("dropdown")){var J=Pa.findOne(".dropdown-toggle",t);J&&J.classList.toggle("active",z);(J=Pa.findOne(".dropdown-menu",t))&&J.classList.toggle("show",z);t.setAttribute("aria-expanded",z)}}_setAttributeIfNotExists(t,z,J){t.hasAttribute(z)||t.setAttribute(z,J)}_elemIsActive(t){return t.classList.contains("active")}_getInnerElement(t){return t.matches('.nav-link:not(.dropdown-toggle), .list-group-item:not(.dropdown-toggle), [role="tab"]:not(.dropdown-toggle), [data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]')?
t:Pa.findOne('.nav-link:not(.dropdown-toggle), .list-group-item:not(.dropdown-toggle), [role="tab"]:not(.dropdown-toggle), [data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',t)}_getOuterElement(t){return t.closest(".nav-item, .list-group-item")||t}static jQueryInterface(t){return this.each(function(){let z=Bd.getOrCreateInstance(this);if("string"==typeof t){if(void 0===z[t]||t.startsWith("_")||"constructor"===t)throw TypeError(`No method named "${t}"`);z[t]()}})}constructor(t){super(t);
(this._parent=this._element.closest('.list-group, .nav, [role="tablist"]'))&&(this._setInitialAttributes(this._parent,this._getChildren()),ta.on(this._element,"keydown.bs.tab",z=>this._keydown(z)))}}ta.on(document,"click.bs.tab",'[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',function(t){["A","AREA"].includes(this.tagName)&&t.preventDefault();qb(this)||Bd.getOrCreateInstance(this).show()});ta.on(window,"load.bs.tab",()=>{for(let t of Pa.find('.active[data-bs-toggle="tab"], .active[data-bs-toggle="pill"], .active[data-bs-toggle="list"]'))Bd.getOrCreateInstance(t)});
eb(Bd);let Bi={animation:"boolean",autohide:"boolean",delay:"number"},Ci={animation:!0,autohide:!0,delay:5E3};class ue extends Nb{static get Default(){return Ci}static get DefaultType(){return Bi}static get NAME(){return"toast"}show(){ta.trigger(this._element,"show.bs.toast").defaultPrevented||(this._clearTimeout(),this._config.animation&&this._element.classList.add("fade"),this._element.classList.remove("hide"),this._element.offsetHeight,this._element.classList.add("show","showing"),this._queueCallback(()=>
{this._element.classList.remove("showing");ta.trigger(this._element,"shown.bs.toast");this._maybeScheduleHide()},this._element,this._config.animation))}hide(){this.isShown()&&(ta.trigger(this._element,"hide.bs.toast").defaultPrevented||(this._element.classList.add("showing"),this._queueCallback(()=>{this._element.classList.add("hide");this._element.classList.remove("showing","show");ta.trigger(this._element,"hidden.bs.toast")},this._element,this._config.animation)))}dispose(){this._clearTimeout();
this.isShown()&&this._element.classList.remove("show");super.dispose()}isShown(){return this._element.classList.contains("show")}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout(()=>{this.hide()},this._config.delay)))}_onInteraction(t,z){switch(t.type){case "mouseover":case "mouseout":this._hasMouseInteraction=z;break;case "focusin":case "focusout":this._hasKeyboardInteraction=z}if(z)return void this._clearTimeout();t=
t.relatedTarget;this._element===t||this._element.contains(t)||this._maybeScheduleHide()}_setListeners(){ta.on(this._element,"mouseover.bs.toast",t=>this._onInteraction(t,!0));ta.on(this._element,"mouseout.bs.toast",t=>this._onInteraction(t,!1));ta.on(this._element,"focusin.bs.toast",t=>this._onInteraction(t,!0));ta.on(this._element,"focusout.bs.toast",t=>this._onInteraction(t,!1))}_clearTimeout(){clearTimeout(this._timeout);this._timeout=null}static jQueryInterface(t){return this.each(function(){let z=
ue.getOrCreateInstance(this,t);if("string"==typeof t){if(void 0===z[t])throw TypeError(`No method named "${t}"`);z[t](this)}})}constructor(t,z){super(t,z);this._timeout=null;this._hasKeyboardInteraction=this._hasMouseInteraction=!1;this._setListeners()}}return bc(ue),eb(ue),{Alert:qc,Button:E,Carousel:Ja,Collapse:hc,Dropdown:Za,Modal:zd,Offcanvas:Yc,Popover:jf,ScrollSpy:te,Tab:Bd,Toast:ue,Tooltip:Ad}}();var Xa={};for(let c of(!function(d){function b(w,D){for(var x=w.length;x--;)if(w[x]===D)return x;
return-1}function g(w,D,x){var G=f(w);void 0===x&&(x=D,D="all");for(var H=0;H<G.length;H++){var N=[];(w=G[H].split("+")).length>1&&(N=e(w),w=[w[w.length-1]]);(w=u(w=w[0]))in h||(h[w]=[]);h[w].push({shortcut:G[H],scope:D,method:x,key:G[H],mods:N})}}function n(){return p||"all"}function f(w){var D;return""==(D=w.replace(/\s/g,"").split(","))[D.length-1]&&(D[D.length-2]+=","),D}function e(w){w=w.slice(0,w.length-1);for(var D=0;D<w.length;D++)w[D]=q[w[D]];return w}function k(w,D,x){w.addEventListener&&
w.addEventListener(D,x,!1)}var l,h={},m={16:!1,18:!1,17:!1,91:!1},p="all",q={"\u21e7":16,shift:16,"\u2325":18,alt:18,option:18,"\u2303":17,ctrl:17,control:17,"\u2318":91,command:91},r={backspace:8,tab:9,clear:12,enter:13,return:13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,del:46,delete:46,home:36,end:35,pageup:33,pagedown:34,",":188,".":190,"/":191,"`":192,"-":189,"=":187,";":186,"'":222,"[":219,"]":221,"\\":220},u=function(w){w=r[w]||w.toUpperCase().charCodeAt(0);return"function"==
typeof w?w():w},v=[];for(l=1;l<20;l++)r["f"+l]=111+l;var y={16:"shiftKey",18:"altKey",17:"ctrlKey",91:"metaKey"};for(l in q)g[l]=!1;k(document,"keydown",function(w){!function(D){var x,G,H,N,B;if(-1==b(v,x=dg(D.key))&&v.push(x),x in m)for(H in m[x]=!0,q)q[H]==x&&(g[H]=!0);else{for(l in m)m[l]=D[y[l]];if(g.filter.call(this,D)&&x in h){var P=0;for(B=n();P<h[x].length;P++)if((G=h[x][P]).scope==B||"all"==G.scope){for(H in N=G.mods.length>0,m)(!m[H]&&b(G.mods,+H)>-1||m[H]&&-1==b(G.mods,+H))&&(N=!1);(0!=
G.mods.length||m[16]||m[18]||m[17]||m[91])&&!N||!1!==G.method(D,G)||(D.preventDefault?D.preventDefault():D.returnValue=!1,D.stopPropagation&&D.stopPropagation(),D.cancelBubble&&(D.cancelBubble=!0))}}}}(w)});k(document,"keyup",function(w){var D;w=dg(w.key);var x=b(v,w);if(x>=0&&v.splice(x,1),w in m)for(D in m[w]=!1,q)q[D]==w&&(g[D]=!1)});k(window,"focus",function(){for(l in m)m[l]=!1;for(l in q)g[l]=!1});var C=d.key;d.key=g;d.key.setScope=function(w){p=w||"all"};d.key.getScope=n;d.key.deleteScope=
function(w){var D,x;for(D in h){var G=0;for(x=h[D];G<x.length;)x[G].scope===w?x.splice(G,1):G++}};d.key.filter=function(w){w=(w.target||w.srcElement).tagName;return"INPUT"!=w&&"SELECT"!=w&&"TEXTAREA"!=w};d.key.isPressed=function(w){return"string"==typeof w&&(w=u(w)),-1!=b(v,w)};d.key.getPressedKeyCodes=function(){return v.slice(0)};d.key.noConflict=function(){var w=d.key;return d.key=C,w};d.key.unbind=function(w,D){var x,G,H,N,B=[];var P=0;for(x=f(w);P<x.length&&((G=x[P].split("+")).length>1&&(B=
e(G)),w=u(w=G[G.length-1]),void 0===D&&(D=n()),h[w]);P++)for(H=0;H<h[w].length;H++){var V;if(V=(N=h[w][H]).scope===D)a:if(N=N.mods,N.length!=B.length)V=!1;else{for(V=0;V<N.length;V++)if(N[V]!==B[V]){V=!1;break a}V=!0}V&&(h[w][H]={})}};Xa=g}(Xa||{}),gd.prototype.clone=function(){for(var d=new gd(Array(this.points.length)),b=0;b<this.points.length;b++)d.points[b]={x:this.points[b].x,y:this.points[b].y};return d},gd.prototype.getTransformed=function(d){for(var b=new gd(Array(this.points.length)),g=0;g<
this.points.length;g++)b.points[g]=d.getTransformedPoint(this.points[g]);return b},gd.prototype.getCenter=function(){for(var d=this.points[0].x,b=this.points[0].y,g=1;g<this.points.length;g++)d+=this.points[g].x,b+=this.points[g].y;return{x:d/this.points.length,y:b/this.points.length}},gd.prototype.containsPoint=function(d){var b,g=!1;var n=0;for(b=this.points.length-1;n<this.points.length;b=n++)this.points[n].y>d.y!=this.points[b].y>d.y&&d.x<(this.points[b].x-this.points[n].x)*(d.y-this.points[n].y)/
(this.points[b].y-this.points[n].y)+this.points[n].x&&(g=!g);return g},yb.prototype.getLength=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},yb.prototype.normalize=function(){var d=this.getLength();return this.x/=d,this.y/=d,this},yb.prototype.getDotProduct=function(d){return this.x*d.x+this.y*d.y},yb.prototype.scale=function(d){return this.x*=d,this.y*=d,this},yb.prototype.getScaled=function(d){var b=new yb(this.x,this.y);return b.scale(d),b},yb.prototype.getRounded=function(){return new yb(Math.round(this.x),
Math.round(this.y))},yb.prototype.getTruncated=function(){return new yb(~~this.x,~~this.y)},yb.prototype.getPerpendicular=function(){return new yb(-this.y,this.x)},yb.prototype.add=function(d){return this.x+=d.x,this.y+=d.y,this},yb.prototype.subtract=function(d){return this.x-=d.x,this.y-=d.y,this},yb.prototype.getSum=function(d){return new yb(this.x+d.x,this.y+d.y)},yb.subtractPoints=function(d,b){return new yb(d.x-b.x,d.y-b.y)},Ld.prototype=Object.create(Ga(Jb).prototype),Ld.prototype.constructor=
Ld,Vb.MODE_INDEX_DEFAULT=0,Vb.MODE_INDEX_USER=1,Vb.prototype.setMode=function(d,b){var g=this.modes[d];g!=b&&(g&&g.leave(),this.modes[d]=b,b.enter())},Vb.prototype.setDefaultMode=function(d){d.transient=!1;d.capture=!1;this.setMode(Vb.MODE_INDEX_DEFAULT,d)},Vb.prototype.setUserMode=function(d){for(var b=this.modes.length-1;b>Vb.MODE_INDEX_USER;b--)this.modes[b].leave(),this.modes.splice(b,1);d.transient=!1;d.capture=!1;this.setMode(Vb.MODE_INDEX_USER,d)},Vb.prototype.deliverEvent=function(d,b){for(var g=
this.modes.length-1;g>=0;g--){var n=this.modes[g];if(n[d].apply(n,b)||n.capture&&"paint"!=d)return!0}return!1},["mouseDown","mouseUp"]))Vb.prototype[c]=function(d,b,g){this.deliverEvent(c,[d,b,g])};for(let c of["mouseDrag","mouseMove"])Vb.prototype[c]=function(d,b){this.deliverEvent(c,[d,b])};for(let c of["keyDown","keyUp"])Vb.prototype[c]=function(d){this.deliverEvent(c,[d])&&d.preventDefault()};Vb.prototype.paint=function(c){this.deliverEvent("paint",[c])};Vb.prototype.push=function(c,d){var b=
this.peek();b&&b.suspend();c.transient=d;c.capture=!1;c.enter();this.modes.push(c)};Vb.prototype.peek=function(){return this.modes.length>0?this.modes[this.modes.length-1]:null};Vb.prototype.pop=function(){var c=this.modes.pop(),d=this.peek();return c&&c.leave(),d&&d.resume(),d};ee.prototype=Object.create(Ga(Jb).prototype);ee.prototype.constructor=ee;Tb.prototype=Object.create(Ga(Jb).prototype);Tb.prototype.constructor=Ga(Jb);he.prototype=Object.create(Tb.prototype);he.prototype.constructor=he;ie.prototype=
Object.create(Tb.prototype);ie.prototype.constructor=ie;je.prototype=Object.create(Tb.prototype);je.prototype.constructor=je;let ve=window.devicePixelRatio||1,jd=Math.round(128*ve),kd=Math.round(128*ve);class hg{_makeBitmap(){if(this._bitmapInvalid){var c=0,d=this._imageData.data;if(this._greyscale)for(var b=0;b<kd;b++){var g=255-Math.round(b/(kd-1)*255);for(var n=0;n<jd;n++)d[c+I.RED_BYTE_OFFSET]=g,d[c+I.GREEN_BYTE_OFFSET]=g,d[c+I.BLUE_BYTE_OFFSET]=g,d[c+I.ALPHA_BYTE_OFFSET]=255,c+=I.BYTES_PER_PIXEL}else for(b=
this.color.clone(),g=0;g<kd;g++)for(b.setValue(255-~~(g/(kd-1)*255)),n=0;n<jd;n++)b.setSaturation(Math.round(n/(jd-1)*255)),d[c+I.RED_BYTE_OFFSET]=b.rgb>>16&255,d[c+I.GREEN_BYTE_OFFSET]=b.rgb>>8&255,d[c+I.BLUE_BYTE_OFFSET]=255&b.rgb,d[c+I.ALPHA_BYTE_OFFSET]=255,c+=I.BYTES_PER_PIXEL;this._bitmapInvalid=!1}}paint(){this._makeBitmap();this._canvasContext.putImageData(this._imageData,0,0);let c=this.color.getSaturation()/255*(jd-1),d=(255-this.color.getValue())/255*(kd-1);de(this._canvasContext,"stroke");
this._canvasContext.lineWidth=1.5*ve;this._canvasContext.beginPath();this._greyscale?(this._canvasContext.moveTo(0,d),this._canvasContext.lineTo(jd,d)):this._canvasContext.arc(c,d,5*ve,0,2*Math.PI);this._canvasContext.stroke();this._canvasContext.globalCompositeOperation="source-over"}_mousePickColor(c){let d=this._canvas.getBoundingClientRect();var b=c.pageX-window.scrollX-d.left;c=Math.max(Math.min(255-~~(255*(c.pageY-window.scrollY-d.top)/127),255),0);this._greyscale?this.color.setGreyscale(c):
(b=Math.max(Math.min(~~(255*b/127),255),0),this.color.setHsv(this.color.getHue(),b,c));this.paint();this._controller.setCurColor(this.color)}_endDrag(c){this._canvas.releasePointerCapture(c.pointerId);this._capturedMouse=!1;this._canvas.removeEventListener("pointerup",this._handleEndDrag);this._canvas.removeEventListener("pointermove",this._handleMousePickColor)}_startDrag(c){this._capturedMouse||(this._capturedMouse=!0,this._canvas.setPointerCapture(c.pointerId),this._canvas.addEventListener("pointerup",
this._handleEndDrag),this._canvas.addEventListener("pointermove",this._handleMousePickColor));this._handleMousePickColor(c)}setHue(c){this.color.getHue()!=c&&(this.color.setHue(c),this._controller.setCurColor(this.color))}getElement(){return this._canvas}constructor(c,d){cc(this,"_controller",void 0);cc(this,"_canvas",void 0);cc(this,"_canvasContext",void 0);cc(this,"_imageData",void 0);cc(this,"_bitmapInvalid",!0);cc(this,"_capturedMouse",!1);cc(this,"_greyscale",!1);cc(this,"color",new lb(0));this._controller=
c;let b=document.createElement("canvas");this._canvas=b;b.className="chickenpaint-colorpicker-select";b.setAttribute("touch-action","none");b.width=jd;b.height=kd;b.style.width="128px";b.style.height="128px";this._canvasContext=b.getContext("2d");this._imageData=this._canvasContext.createImageData(jd,kd);this._canvasContext.getImageData(0,0,1,1);this._handleEndDrag=this._endDrag.bind(this);this._handleMousePickColor=this._mousePickColor.bind(this);b.addEventListener("pointerdown",g=>this._startDrag(g));
d&&this.color.copyFrom(d);c.on("colorChange",g=>{this.color.copyFrom(g);this._bitmapInvalid=!0;this.paint()});c.on("colorModeChange",g=>{this._greyscale="greyscale"==g;this._bitmapInvalid=!0;this.paint()});this.paint()}}class ig{paint(){this._canvasContext.putImageData(this._imageData,0,0);let c=128*this.hue/360;de(this._canvasContext,"stroke");this._canvasContext.lineWidth=1.5;this._canvasContext.beginPath();this._canvasContext.moveTo(0,c);this._canvasContext.lineTo(24,c);this._canvasContext.stroke();
this._canvasContext.globalCompositeOperation="source-over"}_mousePickColor(c){let d=this._canvas.getBoundingClientRect();this.hue=Math.max(0,Math.min(359,~~(360*(c.pageY-d.top)/128)));this.paint();this.selecter&&this.selecter.setHue(this.hue)}_endDrag(c){this._canvas.releasePointerCapture(c.pointerId);this._capturedMouse=!1;this._canvas.removeEventListener("pointerup",this._handleEndDrag);this._canvas.removeEventListener("pointermove",this._handleMousePickColor)}_startDrag(c){this._capturedMouse||
(this._capturedMouse=!0,this._canvas.setPointerCapture(c.pointerId),this._canvas.addEventListener("pointerup",this._handleEndDrag),this._canvas.addEventListener("pointermove",this._handleMousePickColor));this._handleMousePickColor(c)}getElement(){return this._canvas}setHue(c){this.hue=c;this.paint()}constructor(c,d,b){cc(this,"hue",void 0);cc(this,"selecter",void 0);cc(this,"_canvas",void 0);cc(this,"_canvasContext",void 0);cc(this,"_imageData",void 0);cc(this,"_capturedMouse",!1);this.selecter=d;
this.hue=b||0;let g=document.createElement("canvas");this._canvas=g;c.on("colorChange",n=>{this.setHue(n.getHue())});c.on("colorModeChange",n=>{g.style.display="greyscale"==n?"none":"block"});g.setAttribute("touch-action","none");g.addEventListener("pointerdown",n=>this._startDrag(n));g.width=24;g.height=128;g.className="chickenpaint-colorpicker-slider";this._canvasContext=g.getContext("2d");this._imageData=this._canvasContext.createImageData(24,128);this._canvasContext.getImageData(0,0,1,1);this._handleEndDrag=
this._endDrag.bind(this);this._handleMousePickColor=this._mousePickColor.bind(this);(function(n){let f=new lb(65535),e=0,k=n.data;for(let l=0;l<n.height;l++){f.setHue(359*l/n.height);for(let h=0;h<n.width;h++)k[e+I.RED_BYTE_OFFSET]=f.rgb>>16&255,k[e+I.GREEN_BYTE_OFFSET]=f.rgb>>8&255,k[e+I.BLUE_BYTE_OFFSET]=255&f.rgb,k[e+I.ALPHA_BYTE_OFFSET]=255,e+=I.BYTES_PER_PIXEL}})(this._imageData);this.paint()}}ke.prototype=Object.create(Tb.prototype);ke.prototype.constructor=ke;ud.prototype=Object.create(Ga(Jb).prototype);
ud.prototype.constructor=ud;Qb.prototype=Object.create(Ga(Jb).prototype);Qb.prototype.constructor=Qb;Od.prototype=Object.create(Ga(Jb).prototype);Od.prototype.constructor=Od;vd.prototype=Object.create(Tb.prototype);vd.prototype.constructor=vd;vd.CPBrushPreview=function(c){function d(){e.clearRect(0,0,f.width,f.height);e.beginPath();e.arc(f.width/2,f.height/2,n/2*window.devicePixelRatio,0,2*Math.PI);e.stroke()}function b(l){let h=f.getBoundingClientRect();var m=l.clientX-h.left-f.clientWidth/2;l=l.clientY-
h.top-f.clientHeight/2;m=Math.max(1,Math.min(200,Math.round(2*Math.sqrt(m*m+l*l))));d();c.setBrushSize(m)}function g(l){k&&(k=!1,document.removeEventListener("pointerup",g,{capture:!1}),document.removeEventListener("pointermove",b,{capture:!1}))}let n=16,f=document.createElement("canvas"),e=f.getContext("2d"),k=!1;f.addEventListener("pointerdown",function(l){k||(k=!0,document.addEventListener("pointerup",g,{passive:!0,capture:!1}),document.addEventListener("pointermove",b,{passive:!0,capture:!1}),
b(l))});this.getElement=function(){return f};c.on("toolChange",function(l,h){h.size!=n&&(n=h.size,d())});f.width=64;f.height=64;window.devicePixelRatio>1&&(f.style.width=f.width+"px",f.style.height=f.height+"px",f.width*=window.devicePixelRatio,f.height*=window.devicePixelRatio);f.className="chickenpaint-brush-preview";e.strokeStyle="black";e.lineWidth=+window.devicePixelRatio;d()};le.prototype=Object.create(Tb.prototype);le.prototype.constructor=le;me.prototype=Object.create(Tb.prototype);me.prototype.constructor=
me;ne.prototype=Object.create(Tb.prototype);ne.prototype.constructor=ne;oe.prototype=Object.create(Ga(Jb).prototype);oe.prototype.constructor=oe;let mg=[{name:"File",mnemonic:"F",children:[{name:"Export as png",action:"CPExportAsPNG",mnemonic:"S",shortcut:"ctrl+s"},{name:"Export as zip",action:"CPExportAsZIP",title:W("Save the PNG image, CHI project file, and swatches file together as a ZIP package"),mnemonic:"S",shortcut:"shift+alt+s"},{name:"Backup to browser storage",action:"CPSaveDB",title:W("Save the current drawing to the browser's local database"),
mnemonic:"S",shortcut:"shift+alt+s"},{name:"Save Oekaki",action:"CPSend",mnemonic:"S",shortcut:"ctrl+s"}]},{name:"Edit",mnemonic:"E",children:[{name:"Undo",action:"CPUndo",mnemonic:"U",shortcut:"ctrl+z"},{name:"Redo",action:"CPRedo",mnemonic:"R",shortcut:"ctrl+y"},{name:"Clear history",action:"CPClearHistory",mnemonic:"H",title:W("Removes all undo/redo information to regain memory")},{name:"-"},{name:"Cut",action:"CPCut",mnemonic:"T",shortcut:"ctrl+x"},{name:"Copy",action:"CPCopy",mnemonic:"C",shortcut:"ctrl+c"},
{name:"Copy merged",action:"CPCopyMerged",mnemonic:"Y",shortcut:"shift+ctrl+c"},{name:"Paste",action:"CPPaste",mnemonic:"P",shortcut:"ctrl+v"},{name:"-"},{name:"Select all",action:"CPSelectAll",mnemonic:"A",shortcut:"ctrl+a"},{name:"Deselect",action:"CPDeselectAll",mnemonic:"D",shortcut:"ctrl+d"},{name:"-"},{name:"Transform",action:"CPTransform",mnemonic:"T",shortcut:"ctrl+h"}]},{name:"Layers",mnemonic:"L",children:[{name:"Duplicate",action:"CPLayerDuplicate",mnemonic:"D",shortcut:"shift+ctrl+d"},
{name:"-"},{name:"Merge down",action:"CPLayerMergeDown",mnemonic:"E",shortcut:"ctrl+e"},{name:"Merge group",action:"CPGroupMerge",mnemonic:"G",shortcut:"shift+ctrl+g"},{name:"Merge all layers",action:"CPLayerMergeAll",shortcut:"shift+ctrl+e",mnemonic:"A"},{name:"Create merged layer",action:"CPCreateMergedLayer",shortcut:"shift+alt+e"},{name:"-"},{hideIfNotAvailable:!0,name:"Add layer mask",action:"CPAddLayerMask"},{hideIfNotAvailable:!0,name:"Delete layer mask",action:"CPRemoveLayerMask",shortcut:"shift+m"},
{hideIfNotAvailable:!0,name:"Apply layer mask",action:"CPApplyLayerMask",shortcut:"ctrl+m"},{name:"-"},{hideIfNotAvailable:!0,name:"Clip to the layer below",action:"CPCreateClippingMask"},{hideIfNotAvailable:!0,name:"Unclip from the layer below",action:"CPReleaseClippingMask"}]},{name:"Effects",mnemonic:"E",children:[{name:"Clear",action:"CPClear",mnemonic:"D",shortcut:"del,backspace"},{name:"Clear with texture",action:"CPClearWithTexture",mnemonic:"T",shortcut:"shift+x"},{name:"Fill",action:"CPFill",
mnemonic:"F",shortcut:"ctrl+f"},{name:"-"},{name:"Box blur...",action:"CPFXBoxBlur",mnemonic:"B"},{name:"Mosaic",action:"CPFXMosaic",mnemonic:"M"},{name:"Chromatic aberration",action:"CPChromaticAberration",mnemonic:"C"},{name:"-"},{name:"Color halftone",action:"CPColorHalftone",mnemonic:"C"},{name:"Mono halftone",action:"CPMonoHalftone",mnemonic:"M"},{name:"-"},{name:"Edge expand",action:"CPEdgeExpand",mnemonic:"E"},{name:"-"},{name:"Monochromatic noise",action:"CPMNoise",mnemonic:"M",title:W("Fills the selection with noise")},
{name:"Color noise",action:"CPCNoise",mnemonic:"C",title:W("Fills the selection with colored noise")},{name:"-"},{name:"Flip horizontal",action:"CPHFlip",mnemonic:"Q",shortcut:"q"},{name:"Flip vertical",action:"CPVFlip",mnemonic:"V"},{name:"Invert",action:"CPFXInvert",mnemonic:"I",shortcut:"ctrl+i",title:W("Invert the image colors")},{name:"-"},{name:"Convert brightness to opacity",action:"CPBrightnessToOpacity",mnemonic:"B",title:W("Convert brightness to opacity")}]},{name:"View",mnemonic:"V",children:[{name:"Full-screen mode",
action:"CPFullScreen",mnemonic:"F",checkbox:!0,checked:!1},{name:"-"},{name:"Zoom in",action:"CPZoomIn",mnemonic:"I",shortcut:"="},{name:"Zoom out",action:"CPZoomOut",mnemonic:"O",shortcut:"-"},{name:"Zoom 100%",action:"CPZoom100",mnemonic:"1",shortcut:"ctrl+0"},{name:"-"},{name:"Reset Rotation",action:"CPResetCanvasRotation",mnemonic:"R",shortcut:"alt+0"},{name:"-"},{name:"Flip View Horizontal",action:"CPViewHFlip",mnemonic:"H",shortcut:"h"},{name:"-"},{name:"Smooth-out zoomed canvas",action:"CPLinearInterpolation",
mnemonic:"L",title:W("Linear interpolation is used to give a smoothed looked to the picture when zoomed in"),checkbox:!0,checked:!0},{name:"-"},{name:"Show grid",action:"CPToggleGrid",mnemonic:"G",shortcut:"ctrl+g",checkbox:!0,checked:!1},{name:"Grid options...",action:"CPGridOptions",mnemonic:"D"}]},{name:"Palettes",mnemonic:"P",children:[{name:"Rearrange",action:"CPArrangePalettes",title:W("Rearrange the palette windows")},{name:"Toggle palettes",action:"CPTogglePalettes",mnemonic:"P",shortcut:"tab",
title:W("Hides or shows all palettes")},{name:"-"},{name:"Mobile mode",action:"CPToggleSetSmallScreenMode"},{name:"-"},{name:"Show tools",action:"CPPalTool",mnemonic:"T",checkbox:!0,checked:!0},{name:"Show color",action:"CPPalColor",mnemonic:"C",checkbox:!0,checked:!0},{name:"Show stroke",action:"CPPalStroke",mnemonic:"S",checkbox:!0,checked:!0},{name:"Show misc",action:"CPPalMisc",mnemonic:"M",checkbox:!0,checked:!0},{name:"Show swatches",action:"CPPalSwatches",mnemonic:"W",checkbox:!0,checked:!0},
{name:"Show textures",action:"CPPalTextures",mnemonic:"X",checkbox:!0,checked:!0},{name:"Show tool options",action:"CPPalBrush",mnemonic:"B",checkbox:!0,checked:!0},{name:"Show layers",action:"CPPalLayers",mnemonic:"L",checkbox:!0,checked:!0}]},{name:"Help",mnemonic:"H",children:[{name:"Tablet support",mnemonic:"T",action:"CPTabletSupport"},{name:"Shortcuts",mnemonic:"S",action:"CPShortcuts"},{name:"-"},{name:"About",mnemonic:"A",action:"CPAbout"}]}];pe.prototype=Object.create(Ga(Jb).prototype);pe.prototype.constructor=
pe;qe.prototype=Object.create(Ga(Jb).prototype);qe.prototype.constructor=qe;let kf=navigator.userAgent.toLowerCase().includes("mac os"),af=kf?"\u2318":"Ctrl",bf=kf?"\u2325":"Alt",Dh=kf?"\u2303":"Ctrl";re.prototype=Object.create(Ga(Jb).prototype);re.prototype.constructor=re;let Kc={toolbarStyle:"new"};class Mh extends Ga(Jb){setDefaults(){for(let c in Kc)Kc.hasOwnProperty(c)&&this.set(c,Kc[c])}load(){let c={};try{c=JSON.parse(localStorage.getItem("chickenpaint-prefs"))}catch(d){console.error(d)}for(let d in c&&
"object"==typeof c||(c={}),Kc)if(Kc.hasOwnProperty(d))try{this.set(d,c.hasOwnProperty(d)?c[d]:Kc[d])}catch(b){console.error(b)}}save(){try{let c=!1;for(let d in Kc)if(Kc.hasOwnProperty(d)&&this[d]!=Kc[d]){c=!0;break}c?localStorage.setItem("chickenpaint-prefs",JSON.stringify({toolbarStyle:this.toolbarStyle})):localStorage.removeItem("chickenpaint-prefs")}catch(c){console.error(c)}}set(c,d){this[c]=d;this.emitEvent(c,[d])}get(c){return this[c]}constructor(){super();cc(this,"toolbarStyle",void 0);this.setDefaults()}}
la.prototype=Object.create(Ga(Jb).prototype);la.prototype.constructor=la;la.UnsupportedBrowserException=function(c){this.message=c};la.UnsupportedBrowserException.prototype.toString=function(){let c="Sorry, your web browser does not support ChickenPaint.";return this.message?c+=" "+this.message:c+=" Please try a modern browser like Chrome, Safari, Firefox, or Edge.",c};la.M_DRAW=0;la.M_FLOODFILL=1;la.M_RECT_SELECTION=2;la.M_MOVE_TOOL=3;la.M_ROTATE_CANVAS=4;la.M_COLOR_PICKER=5;la.M_GRADIENTFILL=6;
la.M_TRANSFORM=7;la.M_PAN_CANVAS=8;la.T_PENCIL=0;la.T_ERASER=1;la.T_PEN=2;la.T_SOFTERASER=3;la.T_AIRBRUSH=4;la.T_DODGE=5;la.T_BURN=6;la.T_WATER=7;la.T_BLUR=8;la.T_SMUDGE=9;la.T_BLENDER=10;la.T_MAX=11;la.COLOR_MODE_RGB=0;la.COLOR_MODE_GREYSCALE=1;window.ChickenPaint=la}();
